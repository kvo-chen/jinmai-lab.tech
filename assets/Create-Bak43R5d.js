var Xt=Object.defineProperty;var Zt=(t,n,x)=>n in t?Xt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[n]=x;var Ie=(t,n,x)=>Zt(t,typeof n!="symbol"?n+"":n,x);import{u as ds,r,j as e,m as R,t as l,a as ea,l as P,R as sa,P as ta,b as aa,C as wt,L as kt,e as $t,A as ra,c as ia,d as na,T as zs,H as la,f as ls,g as oa,p as ca}from"./index-DW-f9EnK.js";import{M as da}from"./ModelSelector-Brk31RwU.js";import{i as os}from"./imageService-DqV-1dIq.js";class ma{constructor(){Ie(this,"sessions",new Map);Ie(this,"versionHistory",new Map);Ie(this,"nextSessionId",1);Ie(this,"nextVersionId",1);Ie(this,"nextHistoryId",1)}createSession(n,x){const c={id:`session-${this.nextSessionId++}`,name:n,creator:x,createdAt:new Date,updatedAt:new Date,collaborators:[],history:[],currentVersion:"v1.0"};return this.sessions.set(c.id,c),this.versionHistory.set(c.id,[]),c}getSession(n){return this.sessions.get(n)}getAllSessions(){return Array.from(this.sessions.values())}inviteUser(n,x,c){const m=this.sessions.get(n);if(!m)return null;const o={id:`user-${Math.floor(Math.random()*1e3)}`,username:x.split("@")[0],email:x,avatar:`https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=User%20avatar%20${x.split("@")[0]}`,role:c,isOnline:!0,joinedAt:new Date};return m.collaborators.push(o),m.updatedAt=new Date,this.addHistory(n,{userId:m.creator,username:"系统",action:`邀请了 ${o.username} 加入会话`,timestamp:new Date,details:{role:c}}),o}removeUser(n,x){const c=this.sessions.get(n);if(!c)return!1;const m=c.collaborators.findIndex(C=>C.id===x);if(m===-1)return!1;const o=c.collaborators[m];return c.collaborators.splice(m,1),c.updatedAt=new Date,this.addHistory(n,{userId:c.creator,username:"系统",action:`移除了 ${o.username}`,timestamp:new Date}),!0}updateUserRole(n,x,c){const m=this.sessions.get(n);if(!m)return!1;const o=m.collaborators.find(p=>p.id===x);if(!o)return!1;const C=o.role;return o.role=c,m.updatedAt=new Date,this.addHistory(n,{userId:m.creator,username:"系统",action:`将 ${o.username} 的角色从 ${C==="editor"?"编辑者":"查看者"} 更改为 ${c==="editor"?"编辑者":"查看者"}`,timestamp:new Date,details:{oldRole:C,newRole:c}}),!0}updateUserStatus(n,x,c){const m=this.sessions.get(n);if(!m)return!1;const o=m.collaborators.find(C=>C.id===x);return o?(o.isOnline=c,o.lastActive=new Date,m.updatedAt=new Date,!0):!1}updateCursorPosition(n,x,c){const m=this.sessions.get(n);if(!m)return!1;const o=m.collaborators.find(C=>C.id===x);return o?(o.cursorPosition=c,o.lastActive=new Date,m.updatedAt=new Date,!0):!1}addHistory(n,x){const c=this.sessions.get(n);if(!c)throw new Error(`Session ${n} not found`);const m={id:`history-${this.nextHistoryId++}`,...x,timestamp:new Date};return c.history.push(m),c.updatedAt=new Date,c.history.length>100&&(c.history=c.history.slice(-100)),m}createVersion(n,x,c,m){const o=this.sessions.get(n);if(!o)throw new Error(`Session ${n} not found`);const C=this.versionHistory.get(n)||[],p=C.length+1,S={id:`version-${this.nextVersionId++}`,sessionId:n,version:`v1.${p}`,timestamp:new Date,creator:x,description:c,snapshot:m};return C.unshift(S),this.versionHistory.set(n,C),o.currentVersion=S.version,o.updatedAt=new Date,this.addHistory(n,{userId:x,username:x,action:`创建了版本 ${S.version}`,timestamp:new Date,details:{description:c}}),S}getVersionHistory(n){return this.versionHistory.get(n)||[]}getCollaborators(n){const x=this.sessions.get(n);return x?x.collaborators:[]}getHistory(n){const x=this.sessions.get(n);return x?x.history:[]}deleteSession(n){const x=this.sessions.delete(n);return x&&this.versionHistory.delete(n),x}}const oe=new ma,ga=({isOpen:t,onClose:n,sessionId:x="session-1"})=>{const{theme:c,isDark:m}=ds(),[o,C]=r.useState([]),[p,S]=r.useState([]),[k,L]=r.useState([]),[j,D]=r.useState(""),[F,G]=r.useState("editor"),[T,u]=r.useState(!0),[y,_]=r.useState("collaborators"),[Y,ee]=r.useState(null);r.useEffect(()=>{if(t){u(!0),ee(null);try{setTimeout(()=>{let g=oe.getSession(x);g||(g=oe.createSession("新协作项目","当前用户"));const V=oe.getCollaborators(x);C(V);const Q=oe.getHistory(x);S(Q);const K=oe.getVersionHistory(x);L(K),u(!1)},800)}catch{ee("加载协作数据失败，请稍后再试"),u(!1)}}},[t,x]);const ae=()=>{if(!j){l.error("请输入邮箱地址");return}try{const g=oe.inviteUser(x,j,F);g?(C(V=>[...V,g]),l.success(`已邀请 ${j} 加入协作`),D(""),G("editor")):l.error("邀请失败，请稍后再试")}catch{l.error("邀请失败，请稍后再试")}},we=g=>{try{oe.removeUser(x,g)?(C(Q=>Q.filter(K=>K.id!==g)),l.success("已移除协作成员")):l.error("操作失败，请稍后再试")}catch{l.error("操作失败，请稍后再试")}},ce=(g,V)=>{try{oe.updateUserRole(x,g,V)?(C(K=>K.map(de=>de.id===g?{...de,role:V}:de)),l.success("已更新协作成员角色")):l.error("操作失败，请稍后再试")}catch{l.error("操作失败，请稍后再试")}};return t?e.jsxs(R.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},transition:{duration:.3},className:`fixed top-0 right-0 w-full max-w-md h-full ${m?"bg-gray-800":"bg-white"} shadow-2xl z-50 flex flex-col`,children:[e.jsxs("div",{className:`p-4 border-b ${m?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsx("h3",{className:"text-lg font-bold",children:"协作创作"}),e.jsx("button",{onClick:n,className:`p-2 rounded-full ${m?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:`border-b ${m?"border-gray-700":"border-gray-200"}`,children:e.jsx("div",{className:"flex",children:[{id:"collaborators",name:"协作者"},{id:"history",name:"操作历史"},{id:"versions",name:"版本管理"}].map(g=>e.jsx("button",{onClick:()=>_(g.id),className:`px-4 py-3 transition-colors font-medium text-sm ${y===g.id?"text-red-600 border-b-2 border-red-600":m?"text-gray-400 hover:text-white":"text-gray-600 hover:text-black"}`,children:g.name},g.id))})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[Y&&e.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-red-100 text-red-600 text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),Y]}),y==="collaborators"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-users mr-2"}),"协作成员 (",o.length,")"]}),T?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(g=>e.jsxs("div",{className:"flex items-center p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 dark:bg-gray-600 mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 w-1/3 bg-gray-300 dark:bg-gray-600 rounded mb-2"}),e.jsx("div",{className:"h-3 w-1/4 bg-gray-300 dark:bg-gray-600 rounded"})]})]},g))}):e.jsx("div",{className:"space-y-3",children:o.map(g=>e.jsxs("div",{className:`p-3 rounded-xl ${m?"bg-gray-700":"bg-gray-50"} flex items-center`,children:[e.jsxs("div",{className:"relative mr-4",children:[e.jsx("img",{src:g.avatar,alt:g.username,className:"h-10 w-10 rounded-full"}),e.jsx("span",{className:`absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-white ${g.isOnline?"bg-green-500":"bg-gray-400"}`})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"font-medium",children:g.username}),e.jsx("span",{className:`ml-2 text-xs px-2 py-0.5 rounded-full ${g.role==="editor"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:g.role==="editor"?"编辑者":"查看者"})]}),e.jsx("p",{className:"text-xs opacity-70",children:g.isOnline?"在线":`最后在线：${g.lastActive?new Date(g.lastActive).toLocaleString():"未知"}`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("select",{value:g.role,onChange:V=>ce(g.id,V.target.value),className:`text-xs p-1 rounded ${m?"bg-gray-600 border-gray-500":"bg-gray-200 border-gray-300"} border`,children:[e.jsx("option",{value:"editor",children:"编辑者"}),e.jsx("option",{value:"viewer",children:"查看者"})]}),e.jsx("button",{onClick:()=>we(g.id),className:`p-1.5 rounded ${m?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} text-red-500 transition-colors`,"aria-label":"移除",children:e.jsx("i",{className:"fas fa-times"})})]})]},g.id))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"邀请协作者"]}),e.jsx("div",{className:`p-4 rounded-xl ${m?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"邮箱地址"}),e.jsx("input",{type:"email",value:j,onChange:g=>D(g.target.value),placeholder:"输入协作者邮箱",className:`w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${m?"bg-gray-600 border-gray-500 text-white placeholder-gray-400 border":"bg-white border-gray-300 text-gray-900 placeholder-gray-400 border"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"角色"}),e.jsxs("select",{value:F,onChange:g=>G(g.target.value),className:`w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${m?"bg-gray-600 border-gray-500 text-white border":"bg-white border-gray-300 text-gray-900 border"}`,children:[e.jsx("option",{value:"editor",children:"编辑者（可修改内容）"}),e.jsx("option",{value:"viewer",children:"查看者（仅可查看）"})]})]}),e.jsxs("button",{onClick:ae,className:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center",children:[e.jsx("i",{className:"fas fa-paper-plane mr-2"}),"发送邀请"]})]})})]})]}),y==="history"&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-history mr-2"}),"操作历史"]}),T?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(g=>e.jsxs("div",{className:"flex items-center p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-300 dark:bg-gray-600 mr-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 w-1/2 bg-gray-300 dark:bg-gray-600 rounded mb-1"}),e.jsx("div",{className:"h-2 w-1/4 bg-gray-300 dark:bg-gray-600 rounded"})]})]},g))}):e.jsx("div",{className:"space-y-3",children:p.map(g=>e.jsxs("div",{className:`p-3 rounded-xl ${m?"bg-gray-700":"bg-gray-50"} flex items-center`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${m?"bg-gray-600":"bg-gray-200"} mr-3`,children:e.jsx("i",{className:"fas fa-user text-sm"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:g.username}),e.jsx("span",{className:`ml-2 ${m?"text-gray-400":"text-gray-600"}`,children:g.action})]}),e.jsx("p",{className:"text-xs opacity-70",children:new Date(g.timestamp).toLocaleString()})]})]},g.id))})]}),y==="versions"&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-code-branch mr-2"}),"版本管理"]}),T?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(g=>e.jsxs("div",{className:"p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-4 w-1/4 bg-gray-300 dark:bg-gray-600 rounded mb-2"}),e.jsx("div",{className:"h-4 w-1/4 bg-gray-300 dark:bg-gray-600 rounded mb-2"})]}),e.jsx("div",{className:"h-3 w-1/2 bg-gray-300 dark:bg-gray-600 rounded mb-3"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:"h-7 w-20 bg-gray-300 dark:bg-gray-600 rounded"})})]},g))}):e.jsx("div",{className:"space-y-3",children:k.map(g=>e.jsxs("div",{className:`p-3 rounded-xl ${m?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:g.version}),e.jsx("span",{className:"text-xs opacity-70",children:new Date(g.timestamp).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center mr-2",children:e.jsx("i",{className:"fas fa-user text-xs"})}),e.jsx("span",{className:"text-sm",children:g.creator})]}),e.jsx("p",{className:"text-sm mb-3",children:g.description}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{className:`p-1.5 rounded text-sm ${m?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors`,children:"查看差异"}),g.id!=="version-1"&&e.jsx("button",{className:"p-1.5 rounded text-sm bg-blue-600 hover:bg-blue-700 text-white transition-colors",children:"恢复此版本"})]})]},g.id))})]})]}),e.jsx("div",{className:`p-4 border-t ${m?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{className:`flex-1 p-2 rounded-lg ${m?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors flex items-center justify-center`,children:[e.jsx("i",{className:"fas fa-link mr-2"}),e.jsx("span",{children:"复制分享链接"})]}),e.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white p-2 rounded-lg transition-colors flex items-center justify-center",children:e.jsx("i",{className:"fas fa-bell"})})]})})]}):null},xa=({workId:t,onClose:n})=>{const{theme:x,isDark:c}=ds(),{t:m}=ea(),[o,C]=r.useState(null),[p,S]=r.useState(!0),[k,L]=r.useState(!1),[j,D]=r.useState("overall");r.useEffect(()=>{S(!0),setTimeout(async()=>{try{const y=P.diagnoseCreationIssues("This is a design work that integrates traditional cloud pattern elements, using red tones and modern layout");C({overallScore:85,culturalFit:{score:90,details:["Successfully integrated traditional cloud pattern elements","Color matching conforms to traditional Chinese aesthetics","Pattern layout is reasonable, preserving cultural charm"]},creativity:{score:82,details:["Innovative combination of traditional elements with modern design","Novel composition with strong visual impact","Can try more diversified cultural element fusion"]},aesthetics:{score:88,details:["Overall visual effect is harmonious and unified","Clear color hierarchy with natural transitions","Reasonable typography with突出重点"]},suggestions:y.length>0?y:["Suggest adding more diverse traditional pattern combinations","Consider adding intangible cultural heritage elements to enhance cultural depth","Try different color matching schemes to further highlight the national trend style","Add interactive elements to enhance user engagement","Consider commercial application scenarios and optimize design details"],commercialPotential:{score:85,analysis:["Design style conforms to current national trend, with high commercial value","Suitable for cultural and creative products, packaging design and other fields","Suggest applying for copyright certification to protect original rights","Consider participating in commercial docking activities organized by the platform"]},similarWorks:[{id:1,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Similar%20traditional%20Chinese%20design%20work%201",title:"New National Trend Style"},{id:2,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Similar%20traditional%20Chinese%20design%20work%202",title:"Traditional Pattern Innovation"},{id:3,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Similar%20traditional%20Chinese%20design%20work%203",title:"Oriental Aesthetics Reconstruction"}]}),S(!1)}catch(u){console.error("Failed to generate review:",u),S(!1)}},1500)},[t,m]);const F=u=>{l.success(m("review.applySuggestionSuccess"))},G=()=>{l.success(m("review.applyCommercialAdviceSuccess"))},T=u=>u>=90?{text:m("review.excellent"),color:"text-green-500"}:u>=80?{text:m("review.good"),color:"text-blue-500"}:u>=70?{text:m("review.average"),color:"text-yellow-500"}:u>=60?{text:m("review.pass"),color:"text-orange-500"}:{text:m("review.needImprovement"),color:"text-red-500"};return p?e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center ${c?"bg-gray-900":"bg-gray-50"}`,children:e.jsx(R.div,{className:`p-8 rounded-2xl ${c?"bg-gray-800":"bg-white"} shadow-xl max-w-md w-full mx-4`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-600 mb-4"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Generating AI review..."}),e.jsx("p",{className:`text-sm ${c?"text-gray-400":"text-gray-600"}`,children:"Analyzing your work, please wait..."})]})})}):o?e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:`fixed inset-0 z-50 flex items-center justify-center ${c?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:e.jsxs(R.div,{className:`rounded-2xl ${c?"bg-gray-800":"bg-white"} shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto mx-4`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:`p-6 border-b ${c?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsx("h3",{className:"text-xl font-bold",children:"AI Review"}),e.jsx("button",{onClick:n,className:`p-2 rounded-full ${c?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"Close",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:`border-b ${c?"border-gray-700":"border-gray-200"}`,children:e.jsx("div",{className:"flex",children:[{id:"overall",name:"Overall Rating"},{id:"detail",name:"Detailed Review"},{id:"commercial",name:"Commercial Advice"}].map(u=>e.jsx("button",{onClick:()=>D(u.id),className:`px-6 py-3 transition-colors font-medium text-sm ${j===u.id?"text-red-600 border-b-2 border-red-600":c?"text-gray-400 hover:text-white":"text-gray-600 hover:text-black"}`,children:u.name},u.id))})}),e.jsxs("div",{className:"p-6",children:[j==="overall"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center mb-8",children:[e.jsx("div",{className:"flex-shrink-0 mb-6 md:mb-0 md:mr-8",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsx(sa,{width:"100%",height:"100%",children:e.jsx(ta,{children:e.jsxs(aa,{data:[{value:o.overallScore},{value:100-o.overallScore}],cx:"50%",cy:"50%",innerRadius:30,outerRadius:50,startAngle:90,endAngle:-270,paddingAngle:0,dataKey:"value",children:[e.jsx(wt,{fill:"#f87171"}),e.jsx(wt,{fill:c?"#374151":"#e5e7eb"})]})})}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:[e.jsx("span",{className:"text-3xl font-bold",children:o.overallScore}),e.jsx("span",{className:"text-sm opacity-70",children:"总分"})]})]})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{title:"Cultural Fit",score:o.culturalFit.score,color:"text-green-500"},{title:"Creativity",score:o.creativity.score,color:"text-blue-500"},{title:"Aesthetics",score:o.aesthetics.score,color:"text-purple-500"}].map((u,y)=>{const _=T(u.score);return e.jsxs("div",{className:`p-4 rounded-xl ${c?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("p",{className:"text-sm mb-1",children:u.title}),e.jsxs("div",{className:"flex items-end",children:[e.jsx("span",{className:"text-2xl font-bold mr-2",children:u.score}),e.jsx("span",{className:`text-sm ${_.color}`,children:_.text})]})]},y)})})})]}),e.jsxs("div",{className:`p-5 rounded-xl ${c?"bg-gray-700":"bg-gray-50"} mb-8`,children:[e.jsx("h4",{className:"font-medium mb-3",children:"Work Highlights"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"文化元素融入自然，展现了深厚的文化底蕴"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"设计风格现代与传统完美结合，符合当下国潮趋势"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"视觉层次分明，色彩搭配和谐统一"})]})]})]}),o.similarWorks&&o.similarWorks.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium mb-4",children:"推荐参考作品"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:o.similarWorks.map(u=>e.jsxs(R.div,{className:`${c?"bg-gray-700":"bg-gray-50"} rounded-xl overflow-hidden shadow-sm transition-all hover:shadow-md`,whileHover:{y:-5},children:[e.jsx(kt,{src:u.thumbnail,alt:u.title,className:"w-full h-32 object-cover",ratio:"landscape",fit:"cover"}),e.jsx("div",{className:"p-3",children:e.jsx("p",{className:"text-sm font-medium text-center",children:u.title})})]},u.id))})]})]}),j==="detail"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`p-5 rounded-xl ${c?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h5",{className:"font-medium",children:"文化契合度"}),e.jsx("div",{className:`text-sm ${T(o.culturalFit.score).color}`,children:T(o.culturalFit.score).text})]}),e.jsx("ul",{className:"space-y-2",children:o.culturalFit.details.map((u,y)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:u})]},y))})]}),e.jsxs("div",{className:`p-5 rounded-xl ${c?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h5",{className:"font-medium",children:"创意性"}),e.jsx("div",{className:`text-sm ${T(o.creativity.score).color}`,children:T(o.creativity.score).text})]}),e.jsx("ul",{className:"space-y-2",children:o.creativity.details.map((u,y)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:u})]},y))})]}),e.jsxs("div",{className:`p-5 rounded-xl ${c?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h5",{className:"font-medium",children:"美学表现"}),e.jsx("div",{className:`text-sm ${T(o.aesthetics.score).color}`,children:T(o.aesthetics.score).text})]}),e.jsx("ul",{className:"space-y-2",children:o.aesthetics.details.map((u,y)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:u})]},y))})]}),e.jsxs("div",{className:`p-5 rounded-xl ${c?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h5",{className:"font-medium mb-3",children:"改进建议"}),e.jsx("ul",{className:"space-y-3",children:(k?o.suggestions:o.suggestions.slice(0,2)).map((u,y)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mt-1 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm",children:u}),e.jsx("button",{onClick:()=>F(),className:"ml-2 text-xs text-red-600 hover:text-red-700",children:"Apply this suggestion"})]})]},y))}),o.suggestions.length>2&&e.jsxs("button",{onClick:()=>L(!k),className:"mt-3 text-sm text-red-600 hover:text-red-700 flex items-center",children:[k?"Collapse":"View more suggestions",e.jsx("i",{className:`fas fa-chevron-${k?"up":"down"} ml-1`})]})]})]}),j==="commercial"&&o.commercialPotential&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-4",children:e.jsx("i",{className:"fas fa-chart-line text-2xl"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold mb-1",children:"Commercial Potential Assessment"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl font-bold mr-2",children:o.commercialPotential.score}),e.jsx("span",{className:`${T(o.commercialPotential.score).color} text-sm`,children:T(o.commercialPotential.score).text})]})]})]}),e.jsxs("div",{className:`p-5 rounded-xl ${c?"bg-gray-700":"bg-gray-50"} mb-6`,children:[e.jsx("h5",{className:"font-medium mb-3",children:"商业化分析"}),e.jsx("ul",{className:"space-y-2",children:o.commercialPotential.analysis.map((u,y)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-bullseye text-blue-500 mt-1 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:u})]},y))})]}),e.jsxs("div",{className:`p-5 rounded-xl ${c?"bg-gray-700":"bg-gray-50"} mb-6`,children:[e.jsx("h5",{className:"font-medium mb-3",children:"Recommended Commercial Paths"}),e.jsx("div",{className:"space-y-3",children:[{title:"Cultural and Creative Product Development",icon:"gift",description:"Suitable for developing various cultural and creative peripheral products"},{title:"Brand Packaging Design",icon:"box",description:"Can be applied to packaging upgrades for time-honored brands"},{title:"Digital Collectibles",icon:"gem",description:"Has potential for conversion to digital collectibles"}].map((u,y)=>e.jsxs("div",{className:"flex items-start p-3 rounded-lg bg-white bg-opacity-10",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center mr-3 flex-shrink-0",children:e.jsx("i",{className:`fas fa-${u.icon}`})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium",children:u.title}),e.jsx("p",{className:"text-xs opacity-80",children:u.description})]})]},y))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"font-medium mb-3",children:"相关活动推荐"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{title:"Time-honored Brand Innovation Competition",deadline:"2025-12-31",reward:"Maximum prize ¥50,000",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Design%20competition%20poster%20traditional%20Chinese%20elements"},{title:"National Trend Cultural and Creative Design Camp",deadline:"2025-11-30",reward:"Professional mentor guidance + exhibition opportunities",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Cultural%20creative%20design%20workshop"}].map((u,y)=>e.jsx("div",{className:`rounded-lg overflow-hidden ${c?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex",children:[e.jsx(kt,{src:u.image,alt:u.title,className:"w-24 h-24 object-cover",ratio:"square",fit:"cover"}),e.jsxs("div",{className:"p-3 flex-1",children:[e.jsx("h6",{className:"font-medium mb-1",children:u.title}),e.jsxs("div",{className:"text-xs opacity-80 mb-1",children:["Deadline: ",u.deadline]}),e.jsx("div",{className:"text-xs font-medium text-red-600",children:u.reward})]})]})},y))})]})]})]}),e.jsxs("div",{className:`p-6 border-t ${c?"border-gray-700":"border-gray-200"} flex justify-end space-x-3`,children:[j==="commercial"&&o.commercialPotential&&e.jsx("button",{onClick:G,className:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors",children:"Adopt commercial advice"}),j==="detail"&&e.jsx("button",{className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"Apply all suggestions"}),e.jsx("button",{onClick:n,className:`px-4 py-2 rounded-lg ${c?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:"关闭"})]})]})}):null},ua=({onCommandExecuted:t})=>{const{isDark:n}=ds(),[x,c]=r.useState(""),[m,o]=r.useState(!1),[C,p]=r.useState([]),[S,k]=r.useState(!0),[L,j]=r.useState(null),D=r.useRef(null),[F,G]=r.useState(()=>P.getConfig().stream),T=r.useRef(null),[u,y]=r.useState(P.getCurrentModel().id),_={设计风格:["生成融合青花瓷纹样的中秋海报","创建国潮风格的产品包装设计","设计简约现代的传统元素logo","制作复古风格的节日宣传图"],色彩调整:["把红色调改为靛蓝色","将整体色调调整为暖色系","增加色彩对比度","使用传统中国色彩搭配"],元素添加:["添加传统云纹元素","融入中国结图案","添加书法字体标题","加入传统纹样边框"],布局优化:["优化整体布局使其更加平衡","调整元素间距和对齐方式","增加留白空间","优化视觉层次结构"],文化融合:["增加文化元素的识别度","融合天津地方特色元素","加入非遗文化元素","结合传统与现代设计语言"]},[Y,ee]=r.useState([]),[ae,we]=r.useState([]),[ce,g]=r.useState([]);r.useEffect(()=>{D.current&&D.current.scrollIntoView({behavior:"smooth"})},[C]);const V=[{id:"kimi",name:"Kimi",icon:"fa-robot"},{id:"deepseek",name:"DeepSeek",icon:"fa-brain"},{id:"doubao",name:"豆包",icon:"fa-comment-dots"},{id:"wenxinyiyan",name:"文心一言",icon:"fa-lightbulb"},{id:"qwen",name:"通义千问",icon:"fa-star"}],Q=d=>{var N;y(d),P.setCurrentModel(d),l.success(`已切换到 ${(N=V.find(I=>I.id===d))==null?void 0:N.name}`)},K=async()=>{if(!x.trim()||m)return;o(!0);const d={role:"user",content:x};p(N=>[...N,d]);try{if(P.getConfig().stream){let I="";await P.generateResponse(x,{onDelta:E=>{I=E,p(H=>{const W=[...H],B=W[W.length-1];return B&&B.role==="assistant"?W[W.length-1]={role:"assistant",content:E}:W.push({role:"assistant",content:E}),W})}}),t&&t(I)}else{const I=await P.generateResponse(x),E={role:"assistant",content:I};p(H=>[...H,E]),t&&t(I)}J(x)}catch{l.error("生成响应失败，请重试")}finally{c(""),o(!1)}},de=d=>{c(d),j(d)},z=d=>{c(`按照"${d}"的方向优化设计`)},re=d=>{c(`在设计中添加${d}元素`)},J=d=>{const N=P.generateCreativeDirections(d);ee(N);const I=P.recommendCulturalElements(d);we(I);const E=P.diagnoseCreationIssues(d);g(E)},ie=()=>{p([]),P.clearHistory(),l.success("对话历史已清空")},Ue=()=>{try{const d=JSON.stringify(C,null,2),N=new Blob([d],{type:"application/json"}),I=URL.createObjectURL(N),E=document.createElement("a");E.href=I,E.download="conversation.json",document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(I),l.success("已导出对话为 conversation.json")}catch{l.error("导出失败")}},ms=d=>{const N=new FileReader;N.onload=()=>{try{const I=String(N.result||""),E=JSON.parse(I),H=Array.isArray(E)?E.filter(B=>(B.role==="user"||B.role==="assistant")&&typeof B.content=="string"):[];p(H);const W=H.map(B=>({role:B.role,content:B.content,timestamp:Date.now()}));P.importHistory(W),l.success("已导入对话")}catch{l.error("导入失败，文件格式不正确")}},N.readAsText(d)},Re=()=>{const d=!F;G(d),P.updateConfig({stream:d}),l.success(d?"已开启流式输出":"已关闭流式输出")},Ve=d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),K())};return e.jsxs("div",{className:`p-4 rounded-xl ${n?"bg-gray-800":"bg-white"} shadow-md border ${n?"border-gray-700":"border-gray-200"} min-h-[600px]`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center text-red-600",children:[e.jsx("i",{className:"fas fa-magic mr-3"}),"AI文案创作助手"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:u,onChange:d=>Q(d.target.value),className:`appearance-none bg-transparent border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-white rounded-lg px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-red-500 transition-all cursor-pointer ${n?"bg-gray-700":"bg-white"}`,children:V.map(d=>e.jsxs("option",{value:d.id,children:[e.jsx("i",{className:`fas ${d.icon} mr-2`}),d.name]},d.id))}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx("i",{className:"fas fa-chevron-down text-gray-500"})})]}),e.jsxs("span",{className:`text-sm ${n?"text-gray-400":"text-gray-600"}`,children:["当前模型: ",P.getCurrentModel().name]})]})]}),e.jsx("input",{ref:T,type:"file",accept:"application/json",className:"hidden",onChange:d=>{var I;const N=(I=d.target.files)==null?void 0:I[0];N&&ms(N)}}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsxs("div",{className:`rounded-lg ${n?"bg-gray-700":"bg-gray-50"} p-4 shadow-sm border border-gray-200 dark:border-gray-600`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center",children:[e.jsx("i",{className:"fas fa-history text-blue-500 mr-2"}),"对话历史"]}),e.jsx("button",{onClick:()=>k(!S),className:`p-1.5 rounded-full ${n?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors`,"aria-label":S?"隐藏对话历史":"显示对话历史",children:e.jsx("i",{className:`fas ${S?"fa-chevron-up":"fa-chevron-down"}`})})]}),S&&C.length>0?e.jsxs(R.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"max-h-80 overflow-y-auto space-y-4",children:[C.map((d,N)=>e.jsxs("div",{className:`flex flex-col ${d.role==="user"?"items-end":"items-start"}`,children:[e.jsxs("div",{className:"flex items-start w-full",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-3 flex-shrink-0 ${d.role==="user"?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"}`,children:e.jsx("i",{className:`fas ${d.role==="user"?"fa-user":"fa-robot"}`})}),e.jsx("div",{className:`flex-1 rounded-lg p-3 ${d.role==="user"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-600 dark:text-gray-200"}`,children:e.jsx("p",{className:"text-sm break-words",children:d.content})})]}),d.role==="assistant"&&e.jsxs("div",{className:"flex space-x-2 mt-1 ml-11 text-xs",children:[e.jsxs("button",{className:`px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center ${n?"text-gray-300":"text-gray-600"}`,onClick:()=>{c(d.content),l.success("已将生成结果复制到输入框，可继续编辑")},title:"编辑结果",children:[e.jsx("i",{className:"fas fa-edit mr-1"}),"编辑"]}),e.jsxs("button",{className:`px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center ${n?"text-gray-300":"text-gray-600"}`,onClick:()=>{t&&(t(d.content),l.success("已应用到设计中"))},title:"应用到设计",children:[e.jsx("i",{className:"fas fa-magic mr-1"}),"应用"]}),e.jsxs("button",{className:`px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center ${n?"text-gray-300":"text-gray-600"}`,onClick:()=>{navigator.clipboard.writeText(d.content),l.success("已复制到剪贴板")},title:"复制结果",children:[e.jsx("i",{className:"fas fa-copy mr-1"}),"复制"]}),e.jsxs("button",{className:`px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center ${n?"text-gray-300":"text-gray-600"}`,onClick:()=>{const I=new Blob([d.content],{type:"text/plain"}),E=URL.createObjectURL(I),H=document.createElement("a");H.href=E,H.download=`ai-copy-${Date.now()}.txt`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(E),l.success("已导出为文本文件")},title:"导出结果",children:[e.jsx("i",{className:"fas fa-download mr-1"}),"导出"]})]})]},N)),e.jsx("div",{ref:D})]}):S?e.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[e.jsx("i",{className:"fas fa-comments text-2xl mb-2"}),e.jsx("p",{children:"暂无对话历史"}),e.jsx("p",{className:"text-xs mt-1",children:"开始输入创作指令，生成您的第一条对话"})]}):null]}),e.jsxs("div",{className:`rounded-lg ${n?"bg-gray-700":"bg-gray-50"} p-4 shadow-sm border border-gray-200 dark:border-gray-600`,children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center",children:[e.jsx("i",{className:"fas fa-cog text-purple-500 mr-2"}),"对话管理"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:ie,className:`flex items-center justify-center px-3 py-2 rounded-lg ${n?"bg-gray-600 hover:bg-red-600":"bg-gray-200 hover:bg-red-100"} transition-all text-sm font-medium`,children:[e.jsx("i",{className:"fas fa-trash-alt mr-2 text-red-500"}),"清空历史"]}),e.jsxs("button",{onClick:Ue,className:`flex items-center justify-center px-3 py-2 rounded-lg ${n?"bg-gray-600 hover:bg-blue-600":"bg-gray-200 hover:bg-blue-100"} transition-all text-sm font-medium`,children:[e.jsx("i",{className:"fas fa-download mr-2 text-blue-500"}),"导出对话"]}),e.jsxs("button",{onClick:()=>{var d;return(d=T.current)==null?void 0:d.click()},className:`flex items-center justify-center px-3 py-2 rounded-lg ${n?"bg-gray-600 hover:bg-green-600":"bg-gray-200 hover:bg-green-100"} transition-all text-sm font-medium col-span-2`,children:[e.jsx("i",{className:"fas fa-upload mr-2 text-green-500"}),"导入对话"]})]}),e.jsx("div",{className:"mt-4 flex items-center justify-between",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:F,onChange:Re,className:"sr-only peer"}),e.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-red-300 dark:peer-focus:ring-red-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-red-600"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"流式输出"})]})})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:`rounded-lg ${n?"bg-gray-700":"bg-white"} p-5 shadow-sm border border-gray-200 dark:border-gray-600`,children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-edit text-green-500 mr-2"}),"创作指令"]}),e.jsx("textarea",{value:x,onChange:d=>c(d.target.value),onKeyPress:Ve,placeholder:"输入您的创作指令，例如：生成融合青花瓷纹样的中秋海报...\\n\\n支持多行输入，您可以详细描述您的设计需求、风格偏好和文化元素要求。",className:`w-full px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 resize-none min-h-[120px] transition-colors ${n?"bg-gray-600 border-gray-500 text-white placeholder-gray-400 border":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 border"} shadow-sm`}),e.jsxs("div",{className:"flex justify-between items-center mt-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[x.length," 字"]}),e.jsx("span",{children:"按 Enter 发送，Shift+Enter 换行"})]}),e.jsx("button",{onClick:K,disabled:m||!x.trim(),className:`w-full mt-4 py-3 rounded-lg transition-all flex items-center justify-center font-semibold text-lg ${m?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 hover:shadow-lg text-white"} shadow-md`,children:m?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-3 text-xl"}),"创作中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-paper-plane mr-3 text-xl"}),"生成文案"]})})]}),e.jsxs("div",{className:`rounded-lg ${n?"bg-gray-700":"bg-white"} p-5 shadow-sm border border-gray-200 dark:border-gray-600`,children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-bolt text-yellow-500 mr-2"}),"快速指令"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(_).map(([d,N])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-red-500 mr-2"}),d]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N.map((I,E)=>e.jsx(R.button,{onClick:()=>de(I),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${L===I?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300":n?"bg-gray-600 hover:bg-gray-500":"bg-gray-100 hover:bg-gray-200"}`,whileHover:{scale:1.05,translateY:-2},whileTap:{scale:.95},children:I},E))})]},d))})]}),(Y.length>0||ae.length>0||ce.length>0)&&e.jsxs("div",{className:`rounded-lg ${n?"bg-gray-700":"bg-white"} p-5 shadow-sm border border-gray-200 dark:border-gray-600`,children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mr-2"}),"创意助手"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:[Y.length>0&&e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`${n?"bg-gray-600":"bg-blue-50"} p-4 rounded-lg border border-blue-200 dark:border-blue-800`,children:[e.jsxs("h4",{className:"font-medium text-blue-600 dark:text-blue-400 mb-3 flex items-center",children:[e.jsx("i",{className:"fas fa-compass mr-2"}),"创意方向"]}),e.jsx("div",{className:"space-y-2",children:Y.map((d,N)=>e.jsxs(R.button,{onClick:()=>z(d),className:`w-full text-left px-3 py-2 rounded-lg text-sm ${n?"hover:bg-blue-800":"hover:bg-blue-100"} transition-colors`,whileHover:{translateX:5},children:[e.jsx("i",{className:"fas fa-arrow-right text-blue-500 mr-2"}),d]},N))})]}),ae.length>0&&e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:`${n?"bg-gray-600":"bg-purple-50"} p-4 rounded-lg border border-purple-200 dark:border-purple-800`,children:[e.jsxs("h4",{className:"font-medium text-purple-600 dark:text-purple-400 mb-3 flex items-center",children:[e.jsx("i",{className:"fas fa-gem mr-2"}),"文化元素"]}),e.jsx("div",{className:"space-y-2",children:ae.map((d,N)=>e.jsxs(R.button,{onClick:()=>re(d),className:`w-full text-left px-3 py-2 rounded-lg text-sm ${n?"hover:bg-purple-800":"hover:bg-purple-100"} transition-colors`,whileHover:{translateX:5},children:[e.jsx("i",{className:"fas fa-plus text-purple-500 mr-2"}),d]},N))})]}),ce.length>0&&e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:`${n?"bg-gray-600":"bg-yellow-50"} p-4 rounded-lg border border-yellow-200 dark:border-yellow-800`,children:[e.jsxs("h4",{className:"font-medium text-yellow-600 dark:text-yellow-400 mb-3 flex items-center",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),"创作建议"]}),e.jsx("div",{className:"space-y-3",children:ce.map((d,N)=>e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mr-2"}),d]},N))})]})]})]})]})]})]})},ha=()=>{const[t,n]=r.useState(os.getPerformanceStats()),[x,c]=r.useState(os.getCacheStats()),[m,o]=r.useState(!1),[C,p]=r.useState("image"),[S,k]=r.useState({loadTime:0,apiTime:0,domContentLoaded:0,firstPaint:0,memoryUsage:0,fps:0}),[L,j]=r.useState($t.getErrorStats(5)),D=r.useRef(0),F=r.useRef(0),G=r.useRef(performance.now());return r.useEffect(()=>{const T=()=>{F.current++;const y=performance.now(),_=y-G.current;_>=1e3&&(D.current=Math.round(F.current*1e3/_),F.current=0,G.current=y),requestAnimationFrame(T)},u=requestAnimationFrame(T);return()=>cancelAnimationFrame(u)},[]),r.useEffect(()=>{const T=()=>{n(os.getPerformanceStats()),c(os.getCacheStats()),j($t.getErrorStats(5));const y=performance.getEntriesByType("navigation");if(y.length>0){const _=y[0];k(Y=>{var ee;return{...Y,loadTime:Math.round(_.loadEventEnd-_.loadEventStart),domContentLoaded:Math.round(_.domContentLoadedEventEnd-_.domContentLoadedEventStart),firstPaint:Math.round(((ee=performance.getEntriesByType("paint")[0])==null?void 0:ee.startTime)||0),fps:D.current,memoryUsage:typeof performance<"u"&&"memory"in performance?Math.round(performance.memory.usedJSHeapSize/1048576):0}})}},u=setInterval(T,5e3);return T(),()=>clearInterval(u)},[]),null},Ct=[{id:"tpl-1",name:"青花瓷海报",text:"生成融合青花瓷纹样的中秋主题海报，色调以靛蓝与白为主，加入月亮与桂花元素，风格现代简约。"},{id:"tpl-2",name:"国潮包装",text:"设计一款国潮风格零食包装，融入云纹与回纹，色彩采用中国红与金色，突出年轻化与传统融合。"},{id:"tpl-3",name:"老字号焕新",text:"为天津老字号品牌做视觉焕新，结合历史故事与现代审美，使用经典纹样做装饰。"},{id:"tpl-4",name:"节日限定",text:"创作春节限定礼盒设计，包含剪纸元素与灯笼符号，整体喜庆但不过度拥挤。"},{id:"tpl-5",name:"非遗传承",text:"围绕杨柳青年画进行现代演绎的插画海报，保留传统色彩与构图原则。"},{id:"tpl-6",name:"城市文化",text:"以海河两岸为主题做城市文化宣传画，融合历史建筑与现代艺术表现。"}],Hs=[{id:1,thumbnail:"https://images.unsplash.com/photo-1606787366850-de6330128bfc?w=600&h=400&fit=crop",score:85},{id:2,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=AI%20generated%20traditional%20Chinese%20design%202",score:78},{id:3,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=AI%20generated%20traditional%20Chinese%20design%203",score:92},{id:4,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=AI%20generated%20traditional%20Chinese%20design%204",score:75}],cs=[{id:1,name:"云纹",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Traditional%20Chinese%20cloud%20pattern",description:"象征吉祥如意，常用于传统服饰和建筑"},{id:2,name:"龙纹",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Traditional%20Chinese%20dragon%20pattern",description:"象征权力与尊贵，中国传统文化的重要象征"},{id:3,name:"凤纹",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Traditional%20Chinese%20phoenix%20pattern",description:"象征美好与幸福，常与龙纹配合使用"},{id:4,name:"回纹",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Traditional%20Chinese%20key%20pattern",description:"寓意吉祥绵延，是传统装饰中常见的纹样"},{id:5,name:"花卉纹",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Traditional%20Chinese%20flower%20pattern",description:"象征自然与生机，常见牡丹、莲花等纹样"},{id:6,name:"几何纹",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Traditional%20Chinese%20geometric%20pattern",description:"简洁明快，富有节奏感和韵律感"}];function ka(){var yt,ft;const{isDark:t}=ds(),{isAuthenticated:n,user:x}=r.useContext(ra),c=ia(),m=na(),[o,C]=r.useState("sketch"),[p,S]=r.useState(""),[k,L]=r.useState(Hs),[j,D]=r.useState(null),[F,G]=r.useState(!1),[T,u]=r.useState(!1),[y,_]=r.useState(1),[Y,ee]=r.useState(!0),[ae,we]=r.useState(!1),[ce,g]=r.useState(!1),[V,Q]=r.useState(!1),[K,de]=r.useState(!0),[z,re]=r.useState(null),[J,ie]=r.useState(""),[Ue,ms]=r.useState(!1),[Re,Ve]=r.useState("doubao"),[d,N]=r.useState(!1),[I,E]=r.useState(!1),[H,W]=r.useState(!1),[B,Us]=r.useState(!1),[q,St]=r.useState(""),[gs,At]=r.useState(3),[xs,Et]=r.useState([]),[_e,Ge]=r.useState(!1),[Tt,It]=r.useState("云纹是中国传统装饰纹样中常见的一种，象征着吉祥如意、高升和祥瑞。"),[us,Vs]=r.useState(""),[Be,Gs]=r.useState(!1),[Je,Bs]=r.useState(null),De=r.useRef([]),[ke,Js]=r.useState(null),[Ke,Ks]=r.useState("复古胶片"),[Pe,Oe]=r.useState("idle"),[Ws,hs]=r.useState(null),[Me,qs]=r.useState(5),[se,bs]=r.useState(!0),[ps,Ys]=r.useState(!1),We=r.useRef(null);r.useEffect(()=>{const s=a=>{We.current&&!We.current.contains(a.target)&&Ys(!1)};return ps&&document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[ps]);const[ba,pa]=r.useState(!1),[qe,Qs]=r.useState([]),[Ye,Xs]=r.useState([]),[Qe,Zs]=r.useState(!1),[et,st]=r.useState(""),[me,ys]=r.useState("标准"),[$e,fs]=r.useState({}),[tt,Rt]=r.useState(!1),[at,js]=r.useState(""),[rt,vs]=r.useState(""),[_t,Dt]=r.useState(()=>{try{return JSON.parse(localStorage.getItem("TOOLS_SAVED_PLANS")||"[]")}catch{return[]}}),Ns={标准:"包含：1) 创作方向，2) 视觉风格，3) 配色建议（可引用传统色），4) 文化元素融合建议，5) 可落地物料清单（海报/包装/IP形象等），语言精炼、结构清晰、可执行",商业合作:"面向品牌联合与商业落地：1) 品牌契合点与受众画像，2) 视觉与物料清单（KV/包装/周边），3) 预算与里程碑（简要），4) 风险与合规注意事项，语气专业",校园活动:"适用于校园传播与比赛组织：1) 主题设计与互动玩法，2) 视觉风格与配色，3) 活动物料清单，4) 宣传渠道与执行建议",文旅宣传:"面向文旅场景：1) 地域文化元素融入策略，2) 视觉风格与配色，3) 物料清单（海报/导览/纪念品），4) 场景落地建议",社媒传播:"适用于社媒运营：1) 内容主题与排期，2) 视觉风格与模板，3) 互动话题与标签，4) KPI与复盘建议"};r.useEffect(()=>{try{const s=localStorage.getItem("TOOLS_CURATION_TEMPLATE");s&&Ns[s]&&ys(s);const a=localStorage.getItem("TOOLS_CURATION_CUSTOM_TEMPLATES");a&&fs(JSON.parse(a))}catch{}},[]),r.useEffect(()=>{try{localStorage.setItem("TOOLS_CURATION_TEMPLATE",me)}catch{}},[me]),r.useEffect(()=>{try{localStorage.setItem("TOOLS_CURATION_CUSTOM_TEMPLATES",JSON.stringify($e))}catch{}},[$e]);const ws=r.useMemo(()=>({...Ns,...$e}),[$e]),ks=r.useMemo(()=>{const s=ws[me]||Ns.标准,a=(p||"").trim();return`请基于以下输入生成一个“${me}”风格的国潮与非遗策展方案：${s}。

创作提示：${a||"无"}；工具：${o}；风格预设：${q||"无"}`},[me,ws,p,o,q]),Pt=async()=>{try{st(""),Zs(!0);const s=await P.generateResponse(ks),i=[{id:`curation-${Date.now()}`,title:`策展方案（${me}）`,query:p||`${o}${q?" · "+q:""}`,aiText:s,ts:Date.now()},..._t].slice(0,20);Dt(i);try{localStorage.setItem("TOOLS_SAVED_PLANS",JSON.stringify(i))}catch{}}catch{st("生成失败：请检查密钥配置或稍后重试")}finally{Zs(!1)}},ge=[{id:"sketch",name:"一键设计",icon:"magic"},{id:"pattern",name:"纹样嵌入",icon:"th"},{id:"filter",name:"AI滤镜",icon:"filter"},{id:"trace",name:"文化溯源",icon:"book-open"},{id:"remix",name:"风格重混",icon:"random"},{id:"layout",name:"版式生成",icon:"th-large"},{id:"mockup",name:"Mockup预览",icon:"box-open"},{id:"tile",name:"图案平铺",icon:"border-all"}],Le=s=>{C(s);const a=new URLSearchParams(m.search);a.set("tool",s),c(`${m.pathname}?${a.toString()}`,{replace:!0})},[Fe,$s]=r.useState(null),[xe,Cs]=r.useState(1),[ue,Ss]=r.useState(100),[he,As]=r.useState(100),[be,Es]=r.useState(100),[pe,Ts]=r.useState(0),[ye,Is]=r.useState(0),[ne,Xe]=r.useState(""),[fe,Rs]=r.useState(20),[Ce,_s]=r.useState("#111827"),[Ze,it]=r.useState(!1),[ya,nt]=r.useState([]),[fa,Ds]=r.useState([]),X=()=>{nt(s=>[...s.slice(-19),{scale:xe,brightness:ue,contrast:he,saturate:be,hueRotate:pe,blur:ye,overlayText:ne,overlaySize:fe,overlayColor:Ce}]),Ds([])},Ot=()=>{nt(s=>{if(!s.length)return s;const a=s[s.length-1];return Ds(i=>[...i,{scale:xe,brightness:ue,contrast:he,saturate:be,hueRotate:pe,blur:ye,overlayText:ne,overlaySize:fe,overlayColor:Ce}]),Cs(a.scale),Ss(a.brightness),As(a.contrast),Es(a.saturate),Ts(a.hueRotate),Is(a.blur),Xe(a.overlayText),Rs(a.overlaySize),_s(a.overlayColor),s.slice(0,-1)})},Mt=()=>{Ds(s=>{if(!s.length)return s;const a=s[s.length-1];return X(),Cs(a.scale),Ss(a.brightness),As(a.contrast),Es(a.saturate),Ts(a.hueRotate),Is(a.blur),Xe(a.overlayText),Rs(a.overlaySize),_s(a.overlayColor),s.slice(0,-1)})},[Se,Lt]=r.useState(()=>{try{return JSON.parse(localStorage.getItem("CREATE_AUTOSAVE_ENABLED")||"true")}catch{return!0}}),[ze,Ft]=r.useState(()=>{try{return JSON.parse(localStorage.getItem("CREATE_AUTOSAVE_INTERVAL_SEC")||"30")}catch{return 30}}),[lt,zt]=r.useState(()=>{try{return JSON.parse(localStorage.getItem("CREATE_HISTORY")||"[]")}catch{return[]}});r.useEffect(()=>{try{localStorage.setItem("CREATE_HISTORY",JSON.stringify(lt.slice(0,20)))}catch{}},[lt]),r.useEffect(()=>{try{localStorage.setItem("CREATE_AUTOSAVE_ENABLED",JSON.stringify(Se))}catch{}},[Se]),r.useEffect(()=>{try{localStorage.setItem("CREATE_AUTOSAVE_INTERVAL_SEC",JSON.stringify(ze))}catch{}},[ze]);const Ht=()=>({prompt:p,selectedResult:j,currentStep:y,aiExplanation:J,scale:xe,brightness:ue,contrast:he,saturate:be,hueRotate:pe,blur:ye,overlayText:ne,overlaySize:fe,overlayColor:Ce,updatedAt:Date.now()}),Ps=(s="manual")=>{try{const a=Ht();localStorage.setItem("CREATE_DRAFT",JSON.stringify(a)),Bs(a.updatedAt),zt(i=>[a,...i].slice(0,20)),s==="manual"&&l.success("已保存到草稿与历史")}catch{s==="manual"&&l.error("保存失败")}};r.useEffect(()=>{if(!Se)return;const s=Math.max(ze,5)*1e3,a=setInterval(()=>Ps("autosave"),s);return()=>clearInterval(a)},[Se,ze,p,j,y,J,xe,ue,he,be,pe,ye,ne,fe,Ce]),r.useEffect(()=>{const s=()=>{try{Ps("beforeunload")}catch{}};return window.addEventListener("beforeunload",s),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&s()}),()=>{window.removeEventListener("beforeunload",s)}},[]);const Ut=`brightness(${ue}%) contrast(${he}%) saturate(${be}%) hue-rotate(${pe}deg) blur(${ye}px)`;r.useEffect(()=>{j&&Ys(!0)},[j]),r.useEffect(()=>{!n||!x?c("/login"):setTimeout(()=>{ee(!1);try{const s=localStorage.getItem("CREATE_DRAFT");if(s){const a=JSON.parse(s);!new URLSearchParams(m.search).get("prompt")&&typeof a.prompt=="string"&&S(a.prompt),(typeof a.selectedResult=="number"||a.selectedResult===null)&&D(a.selectedResult),typeof a.currentStep=="number"&&_(a.currentStep),typeof a.aiExplanation=="string"&&ie(a.aiExplanation),typeof a.updatedAt=="number"&&Bs(a.updatedAt)}}catch{}},800)},[n,x,c]),r.useEffect(()=>{const s=new URLSearchParams(m.search),a=s.get("tool");a&&["sketch","pattern","filter","trace","remix","layout","mockup","tile"].includes(a)&&C(a);const i=s.get("prompt");i&&(S(i),D(null),_(1),ie(""))},[m.search]),r.useEffect(()=>{try{const s=localStorage.getItem("CREATE_RECENTS");if(s){const a=JSON.parse(s);Array.isArray(a.patterns)&&Qs(a.patterns.slice(0,5)),Array.isArray(a.filters)&&Xs(a.filters.slice(0,5))}}catch{}},[]),r.useEffect(()=>{try{const s={prompt:p,selectedResult:j,currentStep:y,aiExplanation:J,updatedAt:Date.now()};localStorage.setItem("CREATE_DRAFT",JSON.stringify(s))}catch{}},[p,j,y,J]);const Vt=()=>{Ws&&(Ws.abort(),hs(null),Oe("idle"),G(!1),l.info("AI生成已取消"))},Os=async()=>{var a;if(!p.trim()){l.error("请输入创作提示");return}G(!0),Oe("running"),ie("");const s=new AbortController;hs(s);try{if(P.getConfig().stream)await P.generateResponse(p,{onDelta:f=>{ie(f)},signal:s.signal});else{const f=q?`${p}；风格：${q}`:p,h=await P.generateResponse(f,{signal:s.signal});ie(h)}if(Oe("completed"),_(2),l.success("AI创作完成！请选择一个方案进行编辑"),Re==="doubao")try{const f=q?`${p}；风格：${q}`:p,h=await ls.generateImage({prompt:f,size:"1024x1024",n:Math.min(Math.max(gs,1),6),response_format:"url",watermark:!0}),A=(((a=h==null?void 0:h.data)==null?void 0:a.data)||[]).map(b=>b!=null&&b.url?b.url:b!=null&&b.b64_json?`data:image/png;base64,${b.b64_json}`:"").filter(b=>!!b);if(A.length){const b=A.map(($,w)=>({id:w+1,thumbnail:$,score:80}));L(b)}else L(Hs)}catch{L(Hs)}}catch(i){i instanceof Error&&i.name==="AbortError"?Oe("idle"):(Oe("error"),l.error("生成失败，请稍后重试"))}finally{G(!1),hs(null)}},ot=()=>{const s=(p||"").trim(),a=cs.find(h=>h.id===ke),i=(a==null?void 0:a.name)||"传统纹样",f=`${s}，嵌入${i}纹样元素，强调协调与文化表达`;S(f),l.success("已嵌入纹样到提示词"),ke&&Qs(h=>{const v=[ke,...h.filter(A=>A!==ke)].slice(0,5);try{localStorage.setItem("CREATE_RECENTS",JSON.stringify({patterns:v,filters:Ye}))}catch{}return v}),se&&Ae()},ct=()=>{const a=`${(p||"").trim()}；滤镜：${Ke}；强度：${Me}/10`;S(a),l.success("已应用AI滤镜到提示词"),Xs(i=>{const f=`${Ke}:${Me}`,h=[{name:Ke,intensity:Me},...i.filter(v=>`${v.name}:${v.intensity}`!==f)].slice(0,5);try{localStorage.setItem("CREATE_RECENTS",JSON.stringify({patterns:qe,filters:h}))}catch{}return h}),se&&Ae()},Gt=()=>{if(o==="sketch")return e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"一键设计"}),e.jsx("div",{className:"text-xs mb-3 text-gray-600 dark:text-gray-300",children:"输入提示后点击生成即可获得方案"}),F&&e.jsxs("div",{className:"mb-3 flex items-center justify-between text-xs p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300",children:[e.jsxs("span",{children:[Pe==="running"&&e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),Pe==="running"&&"AI正在生成内容...",Pe==="paused"&&"AI生成已暂停",Pe==="completed"&&"AI生成完成",Pe==="error"&&"AI生成出错"]}),e.jsx("button",{onClick:Vt,className:"text-xs px-2 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300 dark:hover:bg-red-900/50",children:"取消"})]}),e.jsx("button",{onClick:Os,disabled:F||!p.trim(),className:"w-full text-sm px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 min-h-[44px]",children:F?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"生成中..."]}):"立即生成"})]});if(o==="pattern")return e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"纹样嵌入"}),e.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"应用后自动生成"}),e.jsx("button",{onClick:()=>bs(s=>!s),className:`${se?"bg-green-600":"bg-gray-400"} text-white px-2 py-0.5 rounded-full`,children:se?"开启":"关闭"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:cs.slice(0,6).map(s=>e.jsx("button",{onClick:()=>Js(s.id),className:`rounded-lg overflow-hidden border ${ke===s.id?"border-red-500":"border-gray-200 dark:border-gray-600"}`,children:e.jsx("img",{src:s.thumbnail,alt:s.name,className:"w-full h-full object-cover"})},s.id))}),e.jsx("button",{onClick:ot,disabled:!ke,className:"w-full text-sm px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50",children:"嵌入到提示词"})]});if(o==="filter"){const s=["复古胶片","国画质感","霓虹赛博","黑白素描","水彩晕染"];return e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"AI滤镜"}),e.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"应用后自动生成"}),e.jsx("button",{onClick:()=>bs(a=>!a),className:`${se?"bg-green-600":"bg-gray-400"} text-white px-2 py-0.5 rounded-full`,children:se?"开启":"关闭"})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("select",{value:Ke,onChange:a=>Ks(a.target.value),className:"text-xs px-2 py-1 rounded bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600",children:s.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx("input",{type:"range",min:1,max:10,value:Me,onChange:a=>qs(parseInt(a.target.value)),className:"flex-1"}),e.jsxs("span",{className:"text-xs",children:[Me,"/10"]})]}),e.jsx("button",{onClick:ct,className:"w-full text-sm px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white",children:"应用到提示词"})]})}return o==="trace"?e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"文化溯源"}),e.jsx("div",{className:"text-xs mb-3 text-gray-600 dark:text-gray-300",children:"生成文化元素说明并在右侧显示"}),e.jsx("button",{onClick:es,className:"w-full text-sm px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white",children:"生成说明"})]}):o==="remix"?e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"风格重混"}),e.jsx("textarea",{value:us,onChange:s=>Vs(s.target.value),placeholder:"输入第二提示词",className:"w-full p-2 rounded-lg h-20 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 mb-3"}),e.jsx("button",{onClick:He,disabled:Be,className:"w-full text-sm px-3 py-2 rounded-lg bg-gradient-to-r from-indigo-600 via-fuchsia-600 to-cyan-600 text-white disabled:opacity-50",children:"混合生成"})]}):o==="layout"?e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"版式生成"}),e.jsx("button",{onClick:ts,className:"w-full text-sm px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white",children:"生成版式建议"})]}):o==="mockup"?e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"Mockup预览"}),e.jsx("button",{onClick:as,className:"w-full text-sm px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white",children:"应用预览效果"})]}):o==="tile"?e.jsxs("div",{className:"mb-6 p-3 rounded-xl bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("div",{className:"font-medium mb-2",children:"图案平铺"}),e.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"切换后自动生成"}),e.jsx("button",{onClick:()=>bs(s=>!s),className:`${se?"bg-green-600":"bg-gray-400"} text-white px-2 py-0.5 rounded-full`,children:se?"开启":"关闭"})]}),e.jsx("button",{onClick:rs,className:"w-full text-sm px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white",children:"切换为平铺风格"})]}):null},Bt=async()=>{if(!p.trim()){l.error("请输入创作提示");return}Us(!0);try{const s=`请将下面的创作提示优化为更清晰的中文指令，保留原意，突出关键元素（主题、风格、色彩、素材）。用1-3个短句表达，避免礼貌语或解释，只输出优化后的文本：

${p}`,a=await P.generateResponse(s),i=String(a||"").trim();i?(S(i),l.success("润色完成")):l.warning("未获得有效润色结果")}catch{l.error("润色失败，请稍后重试")}finally{Us(!1)}},Ms=()=>{try{const s=Ct||[];if(!s.length){l.info("暂未找到模板");return}const a=s[Math.floor(Math.random()*s.length)];S(a.text),l.success("已填充随机灵感模板")}catch{l.error("随机灵感失败")}},dt=s=>{D(s),_(3)},mt=async()=>{var a,i,f;if(!j){l.error("请先在上一步选择一个方案");return}const s=(p||"天津文化设计灵感").trim();E(!0);try{const h=await ls.generateImage({prompt:s,size:"1024x1024",n:1,response_format:"url",watermark:!0}),v=((a=h==null?void 0:h.data)==null?void 0:a.data)||[],A=((i=v[0])==null?void 0:i.url)||((f=v[0])!=null&&f.b64_json?`data:image/png;base64,${v[0].b64_json}`:"");A?(L(b=>b.map($=>$.id===j?{...$,thumbnail:A}:$)),l.success("豆包已重新生成并更新预览")):l.info("豆包未返回图片，保持原图不变")}catch{l.error("豆包生成失败，请稍后重试")}finally{E(!1)}},Ae=async()=>{var i,f;const s=(p||"天津文化设计灵感").trim(),a=q?`${s}；风格：${q}`:s;W(!0);try{const h=await ls.generateImage({prompt:a,size:"1024x1024",n:Math.min(Math.max(gs,1),6),response_format:"url",watermark:!0}),A=(((i=h==null?void 0:h.data)==null?void 0:i.data)||[]).map(b=>b!=null&&b.url?b.url:b!=null&&b.b64_json?`data:image/png;base64,${b.b64_json}`:"").filter(b=>!!b);if(A.length){const b=A.map(($,w)=>({id:w+1,thumbnail:$,score:80}));L(b),D(((f=b[0])==null?void 0:f.id)??null),_(2),l.success(`豆包已生成${A.length}张方案`)}else L([{id:1,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Tianjin%20design%20A",score:80},{id:2,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Tianjin%20design%20B",score:80},{id:3,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Tianjin%20design%20C",score:80}]),D(1),_(2),l.info("豆包未返回图片，已提供占位图")}catch{l.error("豆包生成失败，已保留现有方案")}finally{W(!1)}},He=async()=>{const s=(p||"").trim(),a=(us||"").trim();if(!s||!a){l.error("请填写两个提示词进行融合");return}Gs(!0);try{const i=`请将以下两个中文提示融合为一个更具创意且结构清晰的中文指令：保留核心主题，强调风格与版式要点；输出2-3句精炼描述，无多余解释：

提示A：${s}
提示B：${a}`,h=String(await P.generateResponse(i)||"").trim()||`${s} 与 ${a} 的融合设计`;S(h),N(!0),await Ae(),l.success("融合生成完成，已更新三张方案"),_(2)}catch{l.error("融合生成失败，请稍后重试")}finally{Gs(!1)}},Jt=async()=>{var a,i,f;if(!j){l.error("请先选择一个方案");return}const s=(p||"天津文化设计灵感").trim();E(!0);try{const h=await ls.generateImage({prompt:`${s} 的创意变体`,size:"1024x1024",n:1,response_format:"url",watermark:!0}),v=((a=h==null?void 0:h.data)==null?void 0:a.data)||[],A=((i=v[0])==null?void 0:i.url)||((f=v[0])!=null&&f.b64_json?`data:image/png;base64,${v[0].b64_json}`:"");A?(L(b=>b.map($=>$.id===j?{...$,thumbnail:A}:$)),l.success("已生成变体并更新预览")):l.info("未获取到变体图片")}catch{l.error("变体生成失败")}finally{E(!1)}},Kt=s=>{const a=k.find(i=>i.id===s);a&&Et(i=>i.some(h=>h.id===s)?i.filter(h=>h.id!==s):[...i,{id:s,thumbnail:a.thumbnail}])},gt=async()=>{var a;if(!j){l.error("请先选择一个方案");return}const s=((a=k.find(i=>i.id===j))==null?void 0:a.thumbnail)||"";if(!s){l.error("未找到图片");return}try{const i=document.createElement("a");i.href=s,i.download=`design_${j}.png`,document.body.appendChild(i),i.click(),document.body.removeChild(i),l.success("已开始下载")}catch{l.error("下载失败")}},xt=async()=>{var a;if(!j){l.error("请先选择一个方案");return}const s=((a=k.find(i=>i.id===j))==null?void 0:a.thumbnail)||"";try{await navigator.clipboard.writeText(s),l.success("已复制图片链接")}catch{l.error("复制失败")}},ut=async()=>{var h,v,A,b,$,w,O,le,is,ns,Ee,Te,jt,vt;let s=j;if(!s){const M=(h=k[0])==null?void 0:h.id;if(M)D(M),s=M;else{l.error("请先选择一个方案");return}}const a=k.find(M=>M.id===s),i=(a==null?void 0:a.thumbnail)||"";if(!i){l.error("未找到图片");return}if(i.startsWith("data:")){l.error("首帧为本地数据，需使用可公网访问的图片URL");return}const f=`${p}  --resolution 720p  --duration 5 --camerafixed false`;Ge(!0),L(M=>M.map(je=>je.id===s?{...je,video:"生成中..."}:je));try{const M=await oa({model:"doubao-seedance-1-0-pro-250528",content:[{type:"text",text:f},{type:"image_url",image_url:{url:i}}]});if(!M.ok||!((v=M.data)!=null&&v.id)){const Z=(M==null?void 0:M.error)||((b=(A=M==null?void 0:M.data)==null?void 0:A.error)==null?void 0:b.code)||"UNKNOWN",te=(M==null?void 0:M.error)==="CONFIG_MISSING"?"服务端未配置 DOUBAO_API_KEY，请在 .env.local 设置后重启":`创建视频任务失败：${Z}`;l.error(te),L(ve=>ve.map(Ne=>Ne.id===s?{...Ne,video:`视频生成失败：${Z}`}:Ne)),Ge(!1);return}const je=M.data.id,U=await ca(je,{intervalMs:1e4,timeoutMs:6e5});if(!U.ok){const Z=(U==null?void 0:U.error)||((w=($=U==null?void 0:U.data)==null?void 0:$.error)==null?void 0:w.code)||"UNKNOWN",te=(U==null?void 0:U.error)==="CONFIG_MISSING"?"服务端未配置 DOUBAO_API_KEY，请在 .env.local 设置后重启":`查询视频任务失败：${Z}`;l.error(te),L(ve=>ve.map(Ne=>Ne.id===s?{...Ne,video:`视频生成失败：${Z}`}:Ne)),Ge(!1);return}const Qt=(O=U.data)==null?void 0:O.status,Nt=((is=(le=U.data)==null?void 0:le.content)==null?void 0:is.video_url)||"";if(Qt==="succeeded"&&Nt)L(Z=>Z.map(te=>te.id===s?{...te,video:Nt}:te)),l.success("视频生成完成");else{const Z=((Ee=(ns=U.data)==null?void 0:ns.error)==null?void 0:Ee.code)||((jt=(Te=U.data)==null?void 0:Te.error)==null?void 0:jt.message)||((vt=U.data)==null?void 0:vt.status)||"UNKNOWN";l.error(`视频生成失败：${Z}`),L(te=>te.map(ve=>ve.id===s?{...ve,video:`视频生成失败：${Z}`}:ve))}}catch{l.error("视频生成异常"),L(je=>je.map(U=>U.id===s?{...U,video:"视频生成失败"}:U))}finally{Ge(!1)}},es=async()=>{const s=(p||"中国传统文化元素").trim();try{const a=`请用中文概括该创作提示涉及的文化元素（最多60字，通俗易懂）：

${s}`,i=String(await P.generateResponse(a)||"").trim();i&&It(i),u(!0),l.success("文化识别完成")}catch{u(!0),l.error("文化识别失败，已显示默认说明")}},Wt=s=>{const a=String(s||"").split(/\r?\n/),i=[];let f=null;for(const h of a){let v=h.trim();if(v=v.replace(/^#{1,6}\s*/,""),v=v.replace(/^```+\s*/,""),v=v.replace(/^>+\s*/,""),!v)continue;const A=v.match(/^(\d+)\)\s*(.+?)：/)||v.match(/^([一二三四五六七八九十]+)\)\s*(.+?)：/);if(A){f&&i.push(f),f={title:A[2],items:[]};continue}f||(f={title:"说明",items:[]});const b=v.replace(/^[-•]\s*/,"");f.items.push(b)}return f&&i.push(f),i},ht=s=>{const a=f=>{const h=f||"";return h.includes("诊断")?"search":h.includes("优化")?"magic":h.includes("步骤")?"list-check":h.includes("参考")||h.includes("风格")?"book-open":"pen-nib"},i=Wt(s);return i.length===0?e.jsx("pre",{className:`${t?"bg-gray-800/80 text-gray-100 ring-1 ring-gray-700":"bg-white/80 text-gray-800 ring-1 ring-gray-200"} whitespace-pre-wrap break-words rounded-2xl p-5 leading-relaxed shadow-md backdrop-blur-sm border border-white/40 dark:border-gray-700/40`,children:s}):e.jsx("div",{className:"grid gap-4 md:gap-6",children:i.map((f,h)=>e.jsxs("div",{className:`${t?"bg-gray-900/50 ring-1 ring-gray-700":"bg-white/60 ring-1 ring-gray-200"} rounded-2xl p-5 shadow-lg backdrop-blur-sm border border-white/40 dark:border-gray-700/40`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:`fas fa-${a(f.title)} mr-2 text-blue-600`}),e.jsx("div",{className:"font-semibold tracking-wide",children:f.title})]})}),e.jsx("div",{className:"h-px w-full bg-gradient-to-r from-indigo-500 via-fuchsia-500 to-cyan-500 mb-3 opacity-60"}),e.jsx("ul",{className:"grid md:grid-cols-2 gap-x-6 gap-y-2",children:f.items.map((v,A)=>{const b=String(v||""),$=/^#{1,6}\s*\d+\)\s*/.test(b)||/^#{1,6}\s*[一二三四五六七八九十]+\)\s*/.test(b),w=b.replace(/^#{1,6}\s*\d+\)\s*/,"").replace(/^#{1,6}\s*[一二三四五六七八九十]+\)\s*/,""),O=b.match(/^\*\*(.+?)\*\*：?(.*)$/),le=!!O,is=le&&(O==null?void 0:O[1])||"",ns=le&&(O==null?void 0:O[2])||"",Ee=!le&&!$?b.match(/^([^：:]+)[:：]\s*(.+)$/):null,Te=!le&&!$?b.match(/^(\d+|[一二三四五六七八九十]+)[\.、]\s*(.+)$/):null;return e.jsx("li",{className:$?"md:col-span-2 flex items-center py-1":"flex items-start py-1",children:$?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-angle-right mr-2 text-blue-600"}),e.jsx("span",{className:`${t?"text-gray-100":"text-gray-800"} text-sm font-semibold tracking-wide`,children:w})]}):le?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mt-1 mr-2 h-1.5 w-1.5 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500"}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 ring-1 ring-blue-200 mr-2 dark:bg-blue-900/20 dark:text-blue-300 dark:ring-blue-800",children:is}),e.jsx("span",{className:`${t?"text-gray-200":"text-gray-700"} text-sm md:text-base leading-relaxed md:leading-7 break-words max-w-[68ch]`,children:ns})]}):Ee?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mt-1 mr-2 h-1.5 w-1.5 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500"}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 ring-1 ring-blue-200 mr-2 dark:bg-blue-900/20 dark:text-blue-300 dark:ring-blue-800",children:Ee[1]}),e.jsx("span",{className:`${t?"text-gray-200":"text-gray-700"} text-sm md:text-base leading-relaxed md:leading-7 break-words max-w-[68ch]`,children:Ee[2]})]}):Te?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mt-1 mr-2 h-1.5 w-1.5 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500"}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 ring-1 ring-gray-300 mr-2 dark:bg-gray-700 dark:text-gray-200 dark:ring-gray-600",children:Te[1]}),e.jsx("span",{className:`${t?"text-gray-200":"text-gray-700"} text-sm md:text-base leading-relaxed md:leading-7 break-words max-w-[68ch]`,children:Te[2]})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mt-1 mr-2 h-1.5 w-1.5 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500"}),e.jsx("span",{className:`${t?"text-gray-200":"text-gray-700"} text-sm md:text-base leading-relaxed md:leading-7 break-words max-w-[68ch]`,children:b})]})},A)})})]},h))})},ss=()=>{Ps("manual")},ts=async()=>{try{const a=`请针对“${(p||"品牌视觉设计").trim()}”给出中文版式建议：使用1)2)3)编号列出模块（标题、主视觉、卖点、配色、字体、留白），每条尽量短句。只输出建议。`,i=String(await P.generateResponse(a)||"").trim();ie(i),l.success("已生成版式建议")}catch{l.error("版式建议生成失败")}},as=()=>{N(!0),l.info("已应用 Mockup 预览效果（示意）")},rs=()=>{const a=`${(p||"").trim()}，重复平铺的图案纹样，适用于包装/壁纸`;S(a),l.success("已切换为图案平铺风格"),se&&Ae()},bt=()=>{K?qt():Ls()},qt=()=>{re({status:"pending",issues:[]}),setTimeout(()=>{const a=P.diagnoseCreationIssues((J||p||"").slice(0,1e3)).map(i=>({type:/版权/.test(i)?"copyright":"content",severity:"warning",message:i}));a.length===0?re({status:"passed",issues:[]}):re({status:"warning",issues:a})},800)},Ls=()=>{l.success("作品发布成功！正在进行版权存证..."),setTimeout(()=>{l.success("版权存证完成！"),setTimeout(()=>{c("/dashboard")},1e3)},1500)},pt=()=>{y>1?_(y-1):c("/dashboard")},Yt=()=>{(z==null?void 0:z.status)==="warning"&&Ls()},Fs=()=>{u(!T)};return Y?e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:`sticky top-0 z-50 ${t?"bg-gray-800":"bg-white"} border-b ${t?"border-gray-700":"border-gray-200"} px-4 py-3`,children:e.jsx("div",{className:"container mx-auto flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xl font-bold text-red-600",children:"AI"}),e.jsx("span",{className:"text-xl font-bold",children:"共创"})]})})}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:`h-8 w-1/3 rounded ${t?"bg-gray-800":"bg-white"} animate-pulse`}),e.jsx("div",{className:`h-10 rounded ${t?"bg-gray-800":"bg-white"} animate-pulse`}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:`col-span-1 ${t?"bg-gray-800":"bg-white"} rounded-2xl p-6 animate-pulse`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`h-12 rounded ${t?"bg-gray-700":"bg-gray-100"} animate-pulse`}),e.jsx("div",{className:`h-32 rounded ${t?"bg-gray-700":"bg-gray-100"} animate-pulse`}),e.jsx("div",{className:`h-12 rounded ${t?"bg-gray-700":"bg-gray-100"} animate-pulse`})]})}),e.jsx("div",{className:`col-span-2 ${t?"bg-gray-800":"bg-white"} rounded-2xl p-6 animate-pulse`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`h-6 rounded ${t?"bg-gray-700":"bg-gray-100"} animate-pulse w-1/4`}),e.jsx("div",{className:`h-40 rounded ${t?"bg-gray-700":"bg-gray-100"} animate-pulse`}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[1,2].map(s=>e.jsx("div",{className:`h-12 rounded ${t?"bg-gray-700":"bg-gray-100"} animate-pulse`},s))})]})})]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:`sticky top-0 z-50 ${t?"bg-gray-800":"bg-white"} border-b ${t?"border-gray-700":"border-gray-200"} px-4 py-3`,children:[e.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xl font-bold text-red-600",children:"AI"}),e.jsx("span",{className:"text-xl font-bold",children:"共创"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"生成引擎"}),e.jsx("button",{onClick:()=>Ve("sdxl"),className:`px-3 py-1.5 rounded-full text-sm ${Re==="sdxl"?"bg-red-600 text-white":t?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"}`,children:"SDXL"}),e.jsx("button",{onClick:()=>Ve("doubao"),className:`px-3 py-1.5 rounded-full text-sm ${Re==="doubao"?"bg-red-600 text-white":t?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"}`,children:"Doubao"})]}),e.jsx("button",{onClick:()=>we(!0),className:`px-4 py-2 rounded-full transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"协作"}),e.jsx("button",{onClick:()=>Q(!0),className:`px-4 py-2 rounded-full transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"选择模型"}),e.jsx("button",{onClick:()=>g(!0),className:`px-4 py-2 rounded-full transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"AI点评"}),e.jsx(ha,{}),e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsx("label",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:"自动保存"}),e.jsx("button",{onClick:()=>Lt(s=>!s),className:`px-3 py-1.5 rounded-full text-sm ${Se?"bg-green-600 text-white":t?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"}`,children:Se?"开启":"关闭"}),e.jsxs("select",{value:ze,onChange:s=>Ft(parseInt(s.target.value)||30),className:`px-2 py-1.5 rounded-full text-sm ${t?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"}`,children:[e.jsx("option",{value:15,children:"15秒"}),e.jsx("option",{value:30,children:"30秒"}),e.jsx("option",{value:60,children:"60秒"})]})]}),e.jsx("button",{onClick:ss,className:`px-3 py-1.5 md:px-4 md:py-2 rounded-full transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} text-sm`,children:"保存"}),e.jsx("button",{onClick:bt,className:`px-3 py-1.5 md:px-4 md:py-2 rounded-full transition-colors ${d?"bg-gradient-to-r from-indigo-600 via-fuchsia-600 to-cyan-600 text-white":"bg-red-600 hover:bg-red-700 text-white"} text-sm`,disabled:y<3,children:"发布"})]})]}),e.jsx("div",{className:"container mx-auto mt-3 hidden",children:e.jsxs("div",{className:"space-y-3",ref:We,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:`${t?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"} p-3 rounded-xl`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center",children:[e.jsx("i",{className:"far fa-clock mr-2"}),"历史记录"]}),e.jsx("button",{onClick:ss,className:`${t?"bg-gray-800 text-gray-200":"bg-white text-gray-800"} text-xs px-3 py-1 rounded-full hover:opacity-90`,children:"保存草稿"})]}),e.jsx("div",{className:"text-sm opacity-80",children:Je?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["最近草稿时间：",new Date(Je).toLocaleString()]}),e.jsxs("div",{className:"mt-1",children:["提示摘要：",(p||"").slice(0,24)||"（无）"]})]}):e.jsx("div",{children:"暂无创作历史"})})]}),e.jsxs("div",{className:`${t?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"} p-3 rounded-xl`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center",children:[e.jsx("i",{className:"fas fa-microchip mr-2"}),"AI生成引擎"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>c(`/generate?prompt=${encodeURIComponent(p||"")}`),className:`${t?"bg-gray-800 text-gray-200":"bg-white text-gray-800"} text-xs px-3 py-1 rounded-full hover:opacity-90`,children:"前往生成引擎"})})]}),e.jsx("div",{className:`${t?"text-gray-300":"text-gray-600"} text-xs`,children:"文案优化、朗读与图片问答"})]})]}),e.jsxs("div",{className:`${t?"bg-gray-800 ring-1 ring-gray-700":"bg-white ring-1 ring-gray-200"} p-3 rounded-2xl shadow-sm`,children:[e.jsx("div",{className:"mb-2 px-1 flex items-center justify-between",children:e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"} text-xs font-medium`,children:"更多玩法"})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>{He()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-random mr-2"}),"风格重混"]}),e.jsxs("button",{onClick:()=>{ts()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items中心 transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-th-large mr-2"}),"版式生成"]}),e.jsxs("button",{onClick:()=>{as()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-box-open mr-2"}),"Mockup预览"]}),e.jsxs("button",{onClick:()=>{rs()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-border-all mr-2"}),"图案平铺"]}),e.jsxs("button",{onClick:()=>{Ms()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-lightbulb mr-2"}),"随机灵感"]}),e.jsxs("button",{onClick:()=>{es()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-book-open mr-2"}),"AI文化识别"]})]})]})]})})]}),e.jsxs("main",{className:"flex-1 container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"space-y-3",ref:We,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:`${t?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"} p-3 rounded-xl`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center",children:[e.jsx("i",{className:"far fa-clock mr-2"}),"历史记录"]}),e.jsx("button",{onClick:ss,className:`${t?"bg-gray-800 text-gray-200":"bg-white text-gray-800"} text-xs px-3 py-1 rounded-full hover:opacity-90`,children:"保存草稿"})]}),e.jsx("div",{className:"text-sm opacity-80",children:Je?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["最近草稿时间：",new Date(Je).toLocaleString()]}),e.jsxs("div",{className:"mt-1",children:["提示摘要：",(p||"").slice(0,24)||"（无）"]})]}):e.jsx("div",{children:"暂无创作历史"})})]}),e.jsxs("div",{className:`${t?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"} p-3 rounded-xl`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center",children:[e.jsx("i",{className:"fas fa-microchip mr-2"}),"AI生成引擎"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>c(`/generate?prompt=${encodeURIComponent(p||"")}`),className:`${t?"bg-gray-800 text-gray-200":"bg-white text-gray-800"} text-xs px-3 py-1 rounded-full hover:opacity-90`,children:"前往生成引擎"})})]}),e.jsx("div",{className:`${t?"text-gray-300":"text-gray-600"} text-xs`,children:"文案优化、朗读与图片问答"})]})]}),e.jsxs("div",{className:`${t?"bg-gray-800 ring-1 ring-gray-700":"bg-white ring-1 ring-gray-200"} p-3 rounded-2xl shadow-sm`,children:[e.jsx("div",{className:"mb-2 px-1 flex items-center justify-between",children:e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"} text-xs font-medium`,children:"更多玩法"})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>{He()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-random mr-2"}),"风格重混"]}),e.jsxs("button",{onClick:()=>{ts()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-th-large mr-2"}),"版式生成"]}),e.jsxs("button",{onClick:()=>{as()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-box-open mr-2"}),"Mockup预览"]}),e.jsxs("button",{onClick:()=>{rs()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-border-all mr-2"}),"图案平铺"]}),e.jsxs("button",{onClick:()=>{Ms()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-lightbulb mr-2"}),"随机灵感"]}),e.jsxs("button",{onClick:()=>{es()},className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-2 rounded-xl text-sm flex items-center transition-colors transform hover:scale-105`,children:[e.jsx("i",{className:"fas fa-book-open mr-2"}),"AI文化识别"]})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("nav",{className:"flex items-center text-sm","aria-label":"面包屑",children:[e.jsx("a",{href:"/dashboard",className:"hover:text-red-600 transition-colors",children:"首页"}),e.jsx("i",{className:"fas fa-chevron-right text-xs mx-2 opacity-50"}),e.jsx("a",{href:"#",className:"hover:text-red-600 transition-colors",children:"创作中心"}),e.jsx("i",{className:"fas fa-chevron-right text-xs mx-2 opacity-50"}),e.jsx("span",{className:"opacity-70",children:"AI创作"})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex justify-between items-center",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-2 transition-all ${s<y?"bg-green-500 text-white":s===y?"bg-red-600 text-white scale-110 shadow-md":t?"bg-gray-700 text-gray-400":"bg-gray-200 text-gray-500"}`,children:s<y?e.jsx("i",{className:"fas fa-check"}):s}),e.jsxs("span",{className:`text-xs ${s===y?"font-medium":t?"text-gray-400":"text-gray-500"}`,children:[s===1&&"输入提示词",s===2&&"选择方案",s===3&&"编辑优化"]})]},s))}),e.jsxs("div",{className:"relative h-1 mt-2",children:[e.jsx("div",{className:`absolute inset-0 rounded-full ${t?"bg-gray-700":"bg-gray-200"}`}),e.jsx("div",{className:`absolute left-0 top-0 h-full rounded-full transition-all ${d?"bg-gradient-to-r from-indigo-600 via-fuchsia-600 to-cyan-600":"bg-red-600"}`,style:{width:`${(y-1)/2*100}%`},role:"progressbar","aria-label":"创作进度","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Math.round((y-1)/2*100)})]})]}),e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2",children:[e.jsx(R.button,{type:"button",whileHover:{scale:1.03},onClick:()=>N(s=>!s),className:`px-3 py-1.5 rounded-lg ${d?"bg-indigo-600 hover:bg-indigo-700 text-white":t?"bg-gray-800 text-white hover:bg-gray-700 ring-1 ring-gray-700":"bg-white text-gray-900 hover:bg-gray-50 ring-1 ring-gray-200"} focus:outline-none focus:ring-2 ${d?"focus:ring-indigo-500":t?"focus:ring-gray-600":"focus:ring-gray-300"} focus:ring-offset-2`,children:d?"融合模式：开":"融合模式：关"}),e.jsx(R.button,{type:"button",whileHover:{scale:Qe?1:1.03},onClick:Pt,disabled:Qe,className:`px-3 py-1.5 rounded-lg ${Qe?"opacity-70 cursor-not-allowed":""} ${t?"bg-purple-700 text-white hover:bg-purple-600":"bg-purple-600 text-white hover:bg-purple-500"} focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2`,children:Qe?"生成策展中…":"AI智能策展"}),e.jsx("select",{value:me,onChange:s=>ys(s.target.value),className:`px-2 py-1.5 rounded-lg text-sm ${t?"bg-gray-800 text-white ring-1 ring-gray-700":"bg-white text-gray-900 ring-1 ring-gray-200"}`,children:Object.keys(ws).map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("button",{type:"button",onClick:()=>Rt(s=>!s),className:`${t?"bg-gray-800 text-white ring-1 ring-gray-700":"bg-white text-gray-900 ring-1 ring-gray-200"} px-3 py-1.5 rounded-lg text-sm`,children:tt?"收起模板管理":"自定义模板"}),et&&e.jsx("span",{className:`text-xs ${t?"text-red-400":"text-red-600"}`,children:et})]}),tt&&e.jsxs("div",{className:`${t?"bg-gray-800 ring-1 ring-gray-700":"bg-white ring-1 ring-gray-200"} rounded-2xl p-4 shadow-sm mb-4`,children:[e.jsx("div",{className:"font-medium mb-2",children:"新增模板"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-3",children:[e.jsx("input",{value:at,onChange:s=>js(s.target.value),placeholder:"模板名称（如：品牌活动方案）",className:`${t?"bg-gray-700 text-white ring-1 ring-gray-600":"bg-white text-gray-900 ring-1 ring-gray-300"} px-3 py-2 rounded-lg`}),e.jsx("input",{value:rt,onChange:s=>vs(s.target.value),placeholder:"模板指引（如：结构要点）",className:`${t?"bg-gray-700 text-white ring-1 ring-gray-600":"bg-white text-gray-900 ring-1 ring-gray-300"} px-3 py-2 rounded-lg md:col-span-2`})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{className:"px-3 py-1.5 rounded bg-purple-600 text-white",onClick:()=>{const s=at.trim(),a=rt.trim();!s||!a||(fs(i=>({...i,[s]:a})),js(""),vs(""))},children:"添加模板"}),e.jsx("button",{className:`${t?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1.5 rounded`,onClick:()=>{js(""),vs("")},children:"清空"})]}),e.jsx("div",{className:"font-medium mb-2",children:"我的模板"}),e.jsx("ul",{className:"space-y-2",children:Object.keys($e).length===0?e.jsx("li",{className:"text-sm opacity-60",children:"暂无自定义模板"}):Object.entries($e).map(([s,a])=>e.jsxs("li",{className:`${t?"bg-gray-900":"bg-gray-50"} border ${t?"border-gray-700":"border-gray-200"} rounded p-2 text-xs`,children:[e.jsx("div",{className:"font-medium mb-1",children:s}),e.jsx("div",{className:"opacity-80 mb-2",children:a}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white",onClick:()=>ys(s),children:"设为当前"}),e.jsx("button",{className:`${t?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-2 py-1 rounded`,onClick:async()=>{try{await navigator.clipboard.writeText(a)}catch{}},children:"复制指引"}),e.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white",onClick:()=>fs(i=>{const f={...i};return delete f[s],f}),children:"删除"})]})]},s))})]}),e.jsxs(R.div,{className:`${t?"bg-gray-800 ring-1 ring-gray-700":"bg-white ring-1 ring-gray-200"} rounded-2xl p-4 shadow-sm mb-6`,initial:{opacity:0,y:-8},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium",children:"提示词预览"}),e.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(ks)}catch{}},className:`${t?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-2 py-1 rounded text-xs`,children:"复制提示词"})]}),e.jsx("div",{className:`${t?"bg-gray-900":"bg-gray-50"} rounded-lg p-3 text-xs whitespace-pre-wrap`,children:ks})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`${t?"bg-gray-800":"bg-white"} rounded-2xl p-6 shadow-md lg:sticky lg:top-6`,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"创作工具"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",role:"group","aria-label":"创作工具",children:ge.map((s,a)=>e.jsxs(R.button,{onClick:()=>Le(s.id),className:`p-3 rounded-xl flex flex-col items-center transition-all ${o===s.id?"bg-red-50 text-red-600 border-red-200 border":t?"bg-gray-700 hover:bg-gray-600 border border-gray-600":"bg-gray-50 hover:bg-gray-100 border border-gray-200"} focus:outline-none focus-visible:ring-2 focus-visible:ring-red-500`,whileHover:{scale:1.03},whileTap:{scale:.97},"aria-pressed":o===s.id,"aria-label":s.name,tabIndex:0,ref:i=>{De.current[a]=i},onKeyDown:i=>{var v,A,b,$;const h=a;if(i.key==="ArrowRight"){i.preventDefault();const w=Math.min(h+1,ge.length-1),O=ge[w];O&&(Le(O.id),(v=De.current[w])==null||v.focus())}else if(i.key==="ArrowLeft"){i.preventDefault();const w=Math.max(h-1,0),O=ge[w];O&&(Le(O.id),(A=De.current[w])==null||A.focus())}else if(i.key==="ArrowDown"){i.preventDefault();const w=Math.min(h+2,ge.length-1),O=ge[w];O&&(Le(O.id),(b=De.current[w])==null||b.focus())}else if(i.key==="ArrowUp"){i.preventDefault();const w=Math.max(h-2,0),O=ge[w];O&&(Le(O.id),($=De.current[w])==null||$.focus())}},children:[e.jsx("i",{className:`fas fa-${s.icon} text-xl mb-2`}),e.jsx("span",{className:"text-sm font-medium",children:s.name})]},s.id))})]}),Gt(),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"创作提示"}),e.jsx("button",{onClick:Bt,disabled:B||!p.trim(),className:`text-sm px-3 py-1 rounded-full flex items-center transition-colors ${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} ${B?"opacity-70 cursor-not-allowed":""}`,"aria-label":"智能润色创作提示",children:B?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"智能润色中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-pen-fancy mr-1"}),"智能润色"]})}),e.jsxs("button",{onClick:Ms,className:`text-sm px-3 py-1 rounded-full ml-2 ${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"}`,children:[e.jsx("i",{className:"fas fa-lightbulb mr-1"}),"随机灵感"]})]}),e.jsxs("div",{className:"mb-3 grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xs mr-2",children:"风格预设"}),e.jsxs("select",{value:q,onChange:s=>St(s.target.value),className:`text-xs px-2 py-1 rounded ${t?"bg-gray-700 text-white border border-gray-600":"bg-gray-100 text-gray-900 border border-gray-200"}`,"aria-label":"风格预设",children:[e.jsx("option",{value:"",children:"无"}),e.jsx("option",{value:"国潮",children:"国潮"}),e.jsx("option",{value:"极简",children:"极简"}),e.jsx("option",{value:"复古",children:"复古"}),e.jsx("option",{value:"教育科普",children:"教育科普"})]})]}),e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("span",{className:"text-xs mr-2",children:"批量生成"}),e.jsx("input",{type:"number",min:1,max:6,value:gs,onChange:s=>At(Math.min(Math.max(parseInt(s.target.value||"3"),1),6)),className:`w-16 text-xs px-2 py-1 rounded ${t?"bg-gray-700 text-white border border-gray-600":"bg-gray-100 text-gray-900 border border-gray-200"}`,"aria-label":"批量生成数量"})]})]}),e.jsx("textarea",{value:p,onChange:s=>S(s.target.value),placeholder:"描述您想要创作的内容，例如：具有中国传统元素的现代包装设计...",className:`w-full p-3 rounded-xl h-32 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${t?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 border":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 border"}`,"aria-label":"创作提示",autoCapitalize:"none",autoCorrect:"off",enterKeyHint:"send"}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:Ct.map(s=>e.jsx(R.button,{onClick:()=>S(s.text),className:`text-xs px-3 py-1 rounded-full ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-red-500`,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":`填充模板：${s.name}`,children:s.name},s.id))}),(qe.length>0||Ye.length>0)&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"最近使用"}),qe.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-xs mb-1",children:"纹样"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:qe.map((s,a)=>{const i=cs.find(h=>h.id===s),f=(i==null?void 0:i.name)||`纹样${s}`;return e.jsx("button",{onClick:()=>{Js(s),ot()},className:`text-xs px-3 py-1 rounded-full ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:f},`${s}-${a}`)})})]}),Ye.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs mb-1",children:"滤镜"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ye.map((s,a)=>e.jsxs("button",{onClick:()=>{Ks(s.name),qs(s.intensity),ct()},className:`text-xs px-3 py-1 rounded-full ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:[s.name," ",s.intensity,"/10"]},`${s.name}-${s.intensity}-${a}`))})]})]}),o==="remix"&&e.jsxs("div",{className:`mt-4 p-3 rounded-xl ${t?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-flask mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"融合玩法"})]}),e.jsx("button",{onClick:()=>N(s=>!s),className:`text-xs px-2 py-1 rounded-full ${d?"bg-gradient-to-r from-indigo-600 via-fuchsia-600 to-cyan-600 text-white":t?"bg-gray-800 text-gray-200":"bg-white text-gray-800"}`,children:d?"已启用":"未启用"})]}),e.jsx("textarea",{value:us,onChange:s=>Vs(s.target.value),placeholder:"输入第二提示词，例如：东方美学配色与极简版式...",className:`w-full p-2 rounded-lg h-20 focus:outline-none focus:ring-2 focus:ring-fuchsia-500 transition-colors ${t?"bg-gray-800 border-gray-700 text-white placeholder-gray-400 border":"bg-white border-gray-200 text-gray-900 placeholder-gray-400 border"}`}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:He,disabled:Be,className:`w-full text-sm px-3 py-2 rounded-lg ${Be?"opacity-60 cursor-not-allowed":""} ${d?"bg-gradient-to-r from-indigo-600 via-fuchsia-600 to-cyan-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:Be?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"混合生成中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-bezier-curve mr-1"}),"混合生成（三张）"]})})})]}),o==="sketch"&&e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:Os,disabled:F||y>1||!p.trim(),className:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-4 rounded-xl transition-colors flex items-center justify-center",children:F?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"正在生成..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic mr-2"}),"生成设计"]})})})]})]}),e.jsxs("div",{className:`lg:col-span-2 ${t?"bg-gray-800":"bg-white"} rounded-2xl p-6 shadow-md`,children:[T&&e.jsx(R.div,{className:`mb-6 p-4 rounded-xl border ${t?"bg-gray-700 border-gray-600":"bg-yellow-50 border-yellow-200"}`,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center mr-3 flex-shrink-0",children:e.jsx("i",{className:"fas fa-info"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-1",children:"文化元素：云纹"}),e.jsx("p",{className:"text-sm opacity-80",children:Tt})]})]}),e.jsx("button",{onClick:Fs,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"fas fa-times"})})]})}),y===1&&e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"text-center py-12",children:[e.jsx("div",{className:"mb-6 text-6xl text-red-600",children:e.jsx("i",{className:"fas fa-magic"})}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"开始您的AI创作之旅"}),e.jsx("p",{className:"opacity-80 max-w-lg mx-auto mb-8",children:"在左侧输入创作提示，AI将根据您的描述生成独特的设计作品。 您可以添加传统元素、指定风格，让AI为您带来无限创意。"}),e.jsx("img",{src:"https://images.unsplash.com/photo-1606787366850-de6330128bfc?w=600&h=338&fit=crop",alt:"AI创作流程",className:"rounded-xl mx-auto max-w-full h-auto",loading:"lazy",decoding:"async"})]}),y===2&&e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[J&&!Ue&&e.jsxs("div",{className:`mb-6 p-4 rounded-xl ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h3",{className:"font-medium mb-2",children:"AI生成说明"}),e.jsx("div",{className:"text-sm",children:ht(J)})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"选择您喜欢的设计方案"}),J&&e.jsx("button",{onClick:()=>ms(s=>!s),className:`text-sm px-3 py-1 rounded-full ${t?"bg-gray-700":"bg-gray-100"}`,children:Ue?"展开说明":"收起说明"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:k.map((s,a)=>e.jsxs(R.div,{role:"radio","aria-checked":j===s.id,className:`text-left rounded-xl overflow-hidden border-2 transition-all focus:outline-none focus-visible:ring-2 focus-visible:ring-red-500 ${j===s.id?"border-red-600 shadow-lg bg-red-50":t?"border-gray-700":"border-gray-200"}`,whileHover:{y:-5},onClick:()=>dt(s.id),onKeyDown:i=>{var h,v,A,b;if(i.key==="Enter"||i.key===" "){i.preventDefault(),dt(s.id);return}const f=2;if(i.key==="ArrowRight"){i.preventDefault();const $=Math.min(a+1,k.length-1),w=(h=k[$])==null?void 0:h.id;w&&D(w);return}if(i.key==="ArrowLeft"){i.preventDefault();const $=Math.max(a-1,0),w=(v=k[$])==null?void 0:v.id;w&&D(w);return}if(i.key==="ArrowDown"){i.preventDefault();const $=Math.min(a+f,k.length-1),w=(A=k[$])==null?void 0:A.id;w&&D(w);return}if(i.key==="ArrowUp"){i.preventDefault();const $=Math.max(a-f,0),w=(b=k[$])==null?void 0:b.id;w&&D(w);return}},tabIndex:0,children:[e.jsxs("div",{className:"relative",children:[e.jsx(zs,{src:s.thumbnail,alt:`AI生成方案 ${s.id}`,ratio:"landscape",rounded:"xl"}),e.jsxs("div",{className:"absolute top-3 right-3 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded-full",children:["匹配度 ",s.score,"%"]}),e.jsx("button",{className:"absolute top-3 left-3 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded-full",onClick:i=>{i.stopPropagation(),Kt(s.id)},children:xs.some(i=>i.id===s.id)?"已收藏":"收藏"}),j===s.id&&e.jsxs("div",{className:"absolute bottom-3 left-3 bg-red-600 text-white text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"已选择"]})]}),e.jsx("div",{className:`p-4 ${t?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-medium",children:["AI生成方案 ",s.id]}),e.jsx("button",{onClick:i=>{i.stopPropagation(),Fs()},className:"text-sm text-red-600 hover:underline",children:"查看文化元素"})]})}),j===s.id&&e.jsx("span",{className:"absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-red-600 text-white",children:"已选择"})]},s.id))}),j&&e.jsx("div",{className:"mt-4 text-sm",children:e.jsxs("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:["当前已选择：方案 ",j]})}),xs.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"我的收藏"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:xs.map(s=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.thumbnail,alt:`收藏 ${s.id}`,className:"w-full h-full object-cover rounded-lg"}),e.jsxs("span",{className:`absolute top-2 left-2 text-xs px-2 py-1 rounded-full ${t?"bg-gray-800/70 text-gray-200":"bg-white/80 text-gray-700"}`,children:["方案 ",s.id]})]},s.id))})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap justify-between gap-3",children:[e.jsx("button",{onClick:pt,className:`px-4 py-2 rounded-full transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} text-sm flex-1 md:flex-none`,children:"返回"}),e.jsx("button",{onClick:es,className:`px-4 py-2 rounded-full ${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} transition-colors text-sm flex-1 md:flex-none`,children:"AI文化识别"}),e.jsx("button",{onClick:Os,disabled:F,className:"px-4 py-2 rounded-full bg-blue-600 hover:bg-blue-700 text-white transition-colors text-sm flex-1 md:flex-none",children:F?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"重新生成"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-sync-alt mr-1"}),"重新生成"]})}),e.jsxs("button",{onClick:Jt,className:`px-4 py-2 rounded-full ${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} transition-colors text-sm flex-1 md:flex-none`,children:[e.jsx("i",{className:"fas fa-clone mr-1"}),"生成变体"]})]})]}),y===3&&e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"编辑您的设计作品"}),J&&e.jsxs("div",{className:`mb-6 p-4 rounded-xl ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h3",{className:"font-medium mb-2",children:"AI生成说明"}),e.jsx("div",{className:"text-sm",children:ht(J)})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:`relative rounded-xl overflow-hidden ${t?"bg-gray-700":"bg-gray-100"} flex items-center justify-center`,role:"button",tabIndex:0,"aria-label":"编辑预览",onClick:()=>{$s("resize")},onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),$s("resize"))},children:j?e.jsxs("div",{className:"relative w-full",style:{transform:`scale(${xe})`,filter:Ut},children:[e.jsx(zs,{src:((yt=k.find(s=>s.id===j))==null?void 0:yt.thumbnail)||"",alt:"选中的设计方案",ratio:"square",rounded:"xl",fit:"contain",onClick:mt,className:"cursor-pointer"}),ne&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("span",{style:{fontSize:`${fe}px`,color:Ce},className:"font-semibold drop-shadow",children:ne})}),ps&&e.jsxs("div",{className:"absolute inset-x-3 bottom-3 flex flex-wrap gap-2 items-center justify-center",children:[e.jsx("button",{type:"button",onClick:Ae,disabled:H,className:`px-2.5 py-1.5 rounded-md text-xs ${t?"bg-gray-800 hover:bg-gray-700 text-white ring-1 ring-gray-700":"bg-white/90 hover:bg-white text-gray-900 ring-1 ring-gray-200"} ${H?"opacity-60 cursor-not-allowed":""}`,children:H?"生成中…":"一键生成(3)"}),e.jsx("button",{type:"button",onClick:mt,className:`px-2.5 py-1.5 rounded-md text-xs ${t?"bg-gray-800 hover:bg-gray-700 text-white ring-1 ring-gray-700":"bg-white/90 hover:bg-white text-gray-900 ring-1 ring-gray-200"}`,children:"重新生成"}),e.jsx("button",{type:"button",onClick:gt,className:`px-2.5 py-1.5 rounded-md text-xs ${t?"bg-gray-800 hover:bg-gray-700 text-white ring-1 ring-gray-700":"bg-white/90 hover:bg-white text-gray-900 ring-1 ring-gray-200"}`,children:"下载图片"}),e.jsx("button",{type:"button",onClick:xt,className:`px-2.5 py-1.5 rounded-md text-xs ${t?"bg-gray-800 hover:bg-gray-700 text-white ring-1 ring-gray-700":"bg-white/90 hover:bg-white text-gray-900 ring-1 ring-gray-200"}`,children:"复制链接"}),e.jsx("button",{type:"button",onClick:ut,disabled:_e,className:`px-2.5 py-1.5 rounded-md text-xs bg-blue-600 hover:bg-blue-700 text-white ${_e?"opacity-60 cursor-not-allowed":""}`,children:"生成视频"})]})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"absolute inset-0 grid grid-cols-1 md:grid-cols-3 gap-3 p-3",children:k.slice(0,3).map(s=>e.jsxs("button",{type:"button",onClick:()=>{D(s.id),_(3)},className:"relative group",children:[e.jsx("img",{src:s.thumbnail,alt:`AI生成方案 ${s.id}`,className:"w-full h-full object-cover rounded-lg",loading:"lazy",decoding:"async"}),e.jsxs("span",{className:`absolute top-2 right-2 text-xs px-2 py-1 rounded-full ${t?"bg-gray-800/70 ring-1 ring-gray-700 text-gray-200":"bg-white/80 ring-1 ring-gray-200 text-gray-700"}`,children:["方案 ",s.id]})]},s.id))})})}),I&&e.jsx("div",{className:`mt-2 text-xs ${t?"text-gray-400":"text-gray-500"}`,children:"豆包生成中…"}),j&&((ft=k.find(s=>s.id===j))==null?void 0:ft.video)&&(k.find(s=>s.id===j).video.startsWith("http")?e.jsxs("div",{className:`${t?"bg-gray-700":"bg-gray-50"} rounded-lg p-3 text-sm mt-3`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("a",{href:k.find(s=>s.id===j).video,target:"_blank",rel:"noreferrer",className:"text-blue-600",children:"打开视频"}),e.jsx("button",{className:`text-xs px-2 py-1 rounded ${t?"bg-gray-600 text-white":"bg-white ring-1 ring-gray-200"}`,onClick:async()=>{try{await navigator.clipboard.writeText(k.find(s=>s.id===j).video),l.success("链接已复制")}catch{l.error("复制失败")}},children:"复制链接"})]}),e.jsx("video",{controls:!0,src:`/api/proxy/video?url=${encodeURIComponent(k.find(s=>s.id===j).video)}`,className:"w-full mt-2 rounded"})]}):e.jsx("div",{className:`${t?"bg-gray-700":"bg-gray-50"} rounded-lg p-3 text-sm mt-3 break-all`,children:k.find(s=>s.id===j).video})),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx("button",{type:"button",onClick:Ae,disabled:H,className:`flex-1 px-3 py-1.5 rounded-md text-sm bg-red-600 hover:bg-red-700 text-white transition-colors ${H?"opacity-60 cursor-not-allowed":""}`,children:H?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"正在生成（三张）"]}):e.jsx(e.Fragment,{children:"一键生成（三张）"})}),e.jsx("button",{type:"button",onClick:gt,className:`flex-1 px-3 py-1.5 rounded-md text-sm ${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} transition-colors`,children:"下载图片"}),e.jsx("button",{type:"button",onClick:xt,className:`flex-1 px-3 py-1.5 rounded-md text-sm ${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} transition-colors`,children:"复制链接"}),e.jsx("button",{type:"button",onClick:ut,disabled:_e,className:`flex-1 px-3 py-1.5 rounded-md text-sm bg-blue-600 hover:bg-blue-700 text-white transition-colors ${_e?"opacity-60 cursor-not-allowed":""}`,children:_e?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"生成视频中..."]}):e.jsx(e.Fragment,{children:"生成视频"})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-medium mb-3 cursor-pointer select-none",role:"button",tabIndex:0,"aria-expanded":!Ze,onClick:()=>it(!Ze),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),it(!Ze))},children:"调整工具"}),!Ze&&e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{name:"调整大小",icon:"arrows-alt"},{name:"滤镜效果",icon:"image"},{name:"色彩调整",icon:"palette"},{name:"添加文字",icon:"font"},{name:"图层管理",icon:"layers"},{name:"撤销/重做",icon:"undo"}].map((s,a)=>e.jsxs("button",{className:`p-2 rounded-lg flex flex-col items-center ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,onClick:()=>{const f={调整大小:"resize",滤镜效果:"filter",色彩调整:"color",添加文字:"text",图层管理:"layers","撤销/重做":"history"}[s.name]||null;$s(f),s.name==="添加文字"&&!ne&&Xe("示例文字")},children:[e.jsx("i",{className:`fas fa-${s.icon} mb-1`}),e.jsx("span",{className:"text-xs",children:s.name})]},a))}),Fe==="resize"&&e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-3",children:e.jsxs("label",{className:"text-sm",children:["缩放：",xe.toFixed(2),e.jsx("input",{type:"range",min:.5,max:2,step:.01,value:xe,onChange:s=>{Cs(Number(s.target.value)),X()},className:"w-full"})]})}),Fe==="filter"&&e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-3",children:e.jsxs("label",{className:"text-sm",children:["模糊：",ye,"px",e.jsx("input",{type:"range",min:0,max:10,step:1,value:ye,onChange:s=>{Is(Number(s.target.value)),X()},className:"w-full"})]})}),Fe==="color"&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsxs("label",{className:"text-sm",children:["亮度：",ue,"%",e.jsx("input",{type:"range",min:50,max:150,step:1,value:ue,onChange:s=>{Ss(Number(s.target.value)),X()},className:"w-full"})]}),e.jsxs("label",{className:"text-sm",children:["对比度：",he,"%",e.jsx("input",{type:"range",min:50,max:150,step:1,value:he,onChange:s=>{As(Number(s.target.value)),X()},className:"w-full"})]}),e.jsxs("label",{className:"text-sm",children:["饱和度：",be,"%",e.jsx("input",{type:"range",min:50,max:150,step:1,value:be,onChange:s=>{Es(Number(s.target.value)),X()},className:"w-full"})]}),e.jsxs("label",{className:"text-sm",children:["色相：",pe,"°",e.jsx("input",{type:"range",min:-180,max:180,step:1,value:pe,onChange:s=>{Ts(Number(s.target.value)),X()},className:"w-full"})]})]}),Fe==="text"&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx("input",{type:"text",value:ne,onChange:s=>{Xe(s.target.value),X()},placeholder:"输入叠加文字",className:`${t?"bg-gray-700 text-white":"bg-white"} px-3 py-2 rounded-md`}),e.jsxs("label",{className:"text-sm",children:["文字大小：",fe,"px",e.jsx("input",{type:"range",min:12,max:64,step:1,value:fe,onChange:s=>{Rs(Number(s.target.value)),X()},className:"w-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"颜色"}),e.jsx("input",{type:"color",value:Ce,onChange:s=>{_s(s.target.value),X()}})]})]}),Fe==="history"&&e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-1.5 rounded-md text-sm`,onClick:Ot,children:"撤销"}),e.jsx("button",{className:`${t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} px-3 py-1.5 rounded-md text-sm`,onClick:Mt,children:"重做"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-medium mb-3",children:"玩法扩展"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("button",{onClick:He,className:`${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} p-3 rounded-lg text-sm`,children:[e.jsx("i",{className:"fas fa-random mr-1"}),"风格重混"]}),e.jsxs("button",{onClick:ts,className:`${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} p-3 rounded-lg text-sm`,children:[e.jsx("i",{className:"fas fa-th-large mr-1"}),"版式生成"]}),e.jsxs("button",{onClick:as,className:`${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} p-3 rounded-lg text-sm`,children:[e.jsx("i",{className:"fas fa-box-open mr-1"}),"Mockup预览"]}),e.jsxs("button",{onClick:rs,className:`${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} p-3 rounded-lg text-sm`,children:[e.jsx("i",{className:"fas fa-border-all mr-1"}),"图案平铺"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-medium mb-3",children:"AI共创对话"}),e.jsx(ua,{})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-3",children:"传统纹样素材"}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:cs.map(s=>e.jsxs(R.div,{className:`rounded-lg overflow-hidden border ${t?"border-gray-700":"border-gray-200"} cursor-pointer`,whileHover:{scale:1.05},onClick:Fs,children:[e.jsx(zs,{src:s.thumbnail,alt:s.name,ratio:"square",rounded:"lg"}),e.jsx("div",{className:`p-2 text-xs text-center ${t?"bg-gray-700":"bg-gray-50"}`,children:s.name})]},s.id))})]}),e.jsxs("div",{className:"mt-8 flex justify-between",children:[e.jsx("button",{onClick:pt,className:`px-5 py-2.5 rounded-full transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"返回"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:ss,className:`px-5 py-2.5 rounded-full transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"保存草稿"}),e.jsx("button",{onClick:bt,className:"px-5 py-2.5 rounded-full bg-red-600 hover:bg-red-700 text-white transition-colors",children:"发布作品"})]})]})]})]})]})]}),ae&&e.jsx(ga,{isOpen:ae,onClose:()=>we(!1)}),ce&&e.jsx(la,{children:e.jsx(xa,{workId:"123",onClose:()=>g(!1)})}),V&&e.jsx(da,{isOpen:V,onClose:()=>Q(!1)}),z&&z.status!=="pending"&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${t?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:e.jsxs(R.div,{className:`rounded-2xl ${t?"bg-gray-800":"bg-white"} shadow-xl max-w-2xl w-full mx-4`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:`p-6 border-b ${t?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsx("h3",{className:"text-xl font-bold",children:"AI内容预审"}),e.jsx("button",{onClick:()=>re(null),className:`p-2 rounded-full ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mr-3 ${z.status==="passed"?"bg-green-100 text-green-600":z.status==="warning"?"bg-yellow-100 text-yellow-600":"bg-red-100 text-red-600"}`,children:z.status==="passed"?e.jsx("i",{className:"fas fa-check"}):z.status==="warning"?e.jsx("i",{className:"fas fa-exclamation-triangle"}):e.jsx("i",{className:"fas fa-times"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg",children:z.status==="passed"?"预审通过":z.status==="warning"?"预审有警告":"预审未通过"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:z.status==="passed"?"您的作品符合平台规范，可以发布。":z.status==="warning"?"您的作品存在一些潜在问题，建议进行调整。":"您的作品存在不符合平台规范的内容，请修改后重新提交。"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"font-medium mb-3",children:"预审详情"}),e.jsx("div",{className:"space-y-3",children:z.issues.map((s,a)=>e.jsx("div",{className:`p-3 rounded-lg ${s.severity==="error"?t?"bg-red-900 bg-opacity-30":"bg-red-50":t?"bg-yellow-900 bg-opacity-30":"bg-yellow-50"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:`fas ${s.severity==="error"?"fa-times-circle":"fa-exclamation-circle"} mr-2 mt-0.5 text-${s.severity==="error"?"red-500":"yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.type==="content"?"内容合规性":"版权问题"}),e.jsx("p",{className:"text-sm mt-1",children:s.message})]})]})},a))})]}),e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("input",{type:"checkbox",id:"enable-precheck",checked:K,onChange:s=>de(s.target.checked),className:"mr-2 rounded text-red-600 focus:ring-red-500"}),e.jsx("label",{htmlFor:"enable-precheck",className:"text-sm",children:"启用AI内容预审（建议开启，帮助确保作品合规）"})]})]}),e.jsxs("div",{className:`p-6 border-t ${t?"border-gray-700":"border-gray-200"} flex justify-end space-x-3`,children:[z.status==="warning"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>re(null),className:`px-4 py-2 rounded-lg ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:"返回修改"}),e.jsx("button",{onClick:Yt,className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"确认发布"})]}),z.status==="passed"&&e.jsx("button",{onClick:Ls,className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"继续发布"}),z.status==="failed"&&e.jsx("button",{onClick:()=>re(null),className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"返回修改"})]})]})}),e.jsx("footer",{className:"border-t border-gray-200 bg-white py-6 px-4 z-10 relative",children:e.jsxs("div",{className:"container mx-auto flex flex-col md:flex-row justify-between items-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"© 2025 AI共创平台. 保留所有权利"}),e.jsxs("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[e.jsx("a",{href:"#",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"隐私政策"}),e.jsx("a",{href:"#",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"服务条款"}),e.jsx("a",{href:"#",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"帮助中心"})]})]})})]})}export{ka as default};
