var I=Object.defineProperty;var k=(t,i,a)=>i in t?I(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a;var h=(t,i,a)=>k(t,typeof i!="symbol"?i+"":i,a);import{u as $,r as g,j as e,m as n,T as j,t as v}from"./index-DW-f9EnK.js";class S{constructor(){h(this,"blindBoxes",[{id:"1",name:"创意新手盲盒",description:"适合新手的入门盲盒，包含基础创作资源",price:50,rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=creative%20blind%20box%20design",available:!0,totalCount:1e3,remainingCount:850},{id:"2",name:"文化传承盲盒",description:"包含传统文化元素的盲盒，适合喜欢文化创作的用户",price:100,rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20traditional%20culture%20blind%20box",available:!0,totalCount:500,remainingCount:320},{id:"3",name:"大师之作盲盒",description:"包含知名创作者作品的高级盲盒，有机会获得稀有资源",price:200,rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=masterpiece%20blind%20box%20premium%20design",available:!0,totalCount:200,remainingCount:85},{id:"4",name:"传奇典藏盲盒",description:"限量版盲盒，包含稀有度极高的创作资源和成就",price:500,rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=legendary%20collection%20blind%20box%20golden%20design",available:!0,totalCount:50,remainingCount:12}]);h(this,"blindBoxContents",[{id:"c1",type:"素材",name:"水墨风格背景",description:"传统水墨风格的创作背景",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20ink%20painting%20background",value:20,unlockable:!0},{id:"c2",type:"模板",name:"国潮海报模板",description:"适合国潮风格的海报设计模板",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20trend%20poster%20template",value:30,unlockable:!0},{id:"c3",type:"作品",name:"古风插画",description:"精美的古风插画作品",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=ancient%20chinese%20style%20illustration",value:40,creator:"古风大师",unlockable:!0},{id:"c4",type:"素材",name:"传统纹样",description:"中国传统纹样集合",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=traditional%20chinese%20patterns",value:25,unlockable:!0},{id:"r1",type:"模板",name:"非遗文化模板",description:"包含非遗文化元素的高级模板",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=intangible%20cultural%20heritage%20template",value:80,unlockable:!0},{id:"r2",type:"作品",name:"大师级书法",description:"知名书法家的书法作品",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=master%20calligraphy%20work",value:120,creator:"书法大师",unlockable:!0},{id:"r3",type:"素材",name:"3D文化资产",description:"可用于3D创作的文化资产",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=3D%20chinese%20cultural%20asset",value:100,unlockable:!0},{id:"r4",type:"成就",name:"盲盒收藏家",description:"开启10个盲盒获得的成就",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=blind%20box%20collector%20achievement",value:0,unlockable:!1},{id:"e1",type:"作品",name:"国潮IP设计",description:"完整的国潮IP设计方案",rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20trend%20IP%20design",value:300,creator:"IP设计师",unlockable:!0},{id:"e2",type:"模板",name:"品牌合作模板",description:"与知名品牌合作的限定模板",rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=brand%20collaboration%20template",value:250,unlockable:!0},{id:"e3",type:"素材",name:"动态文化素材",description:"可用于动画的动态文化素材",rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=dynamic%20chinese%20cultural%20material",value:200,unlockable:!0},{id:"l1",type:"作品",name:"典藏级国画",description:"具有收藏价值的国画作品",rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=collection%20level%20chinese%20painting",value:1e3,creator:"国画大师",unlockable:!0},{id:"l2",type:"成就",name:"传奇收藏家",description:"开启50个盲盒获得的传奇成就",rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=legendary%20collector%20achievement",value:0,unlockable:!1},{id:"l3",type:"模板",name:"定制化创作模板",description:"可定制的高级创作模板",rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=customizable%20premium%20template",value:800,unlockable:!0}]);h(this,"openingHistory",[]);h(this,"userCollections",new Map)}getAllBlindBoxes(){return[...this.blindBoxes]}getBlindBoxById(i){return this.blindBoxes.find(a=>a.id===i)}purchaseBlindBox(i,a){const s=this.getBlindBoxById(i);return s&&s.available&&s.remainingCount>0?(s.remainingCount--,s.remainingCount===0&&(s.available=!1),!0):!1}generateRandomContent(i){const s={common:{common:.7,rare:.25,epic:.04,legendary:.01},rare:{common:.4,rare:.45,epic:.1,legendary:.05},epic:{common:.2,rare:.3,epic:.4,legendary:.1},legendary:{common:.1,rare:.2,epic:.3,legendary:.4}}[i],l=Math.random();let c="common",p=0;for(const[d,x]of Object.entries(s))if(p+=x,l<=p){c=d;break}const u=this.blindBoxContents.filter(d=>d.rarity===c),y=Math.floor(Math.random()*u.length);return{...u[y]}}openBlindBox(i,a){const s=this.getBlindBoxById(i);if(!s||typeof s.available>"u")return null;const l=this.generateRandomContent(s.rarity),c={blindBox:{...s},content:l,isNew:!0,timestamp:new Date};return this.openingHistory.push(c),c}getOpeningHistory(i){return[...this.openingHistory]}getUserBlindBoxContents(i){const a=[];return this.openingHistory.forEach(s=>{a.some(l=>l.id===s.content.id)||a.push(s.content)}),a}toggleCollection(i,a){this.userCollections.has(i)||this.userCollections.set(i,new Set);const s=this.userCollections.get(i);return s.has(a)?(s.delete(a),!1):(s.add(a),!0)}isContentCollected(i,a){const s=this.userCollections.get(i);return s?s.has(a):!1}getUserCollections(i){const a=this.userCollections.get(i);return!a||a.size===0?[]:this.blindBoxContents.filter(s=>a.has(s.id))}getCollectionCount(i){const a=this.userCollections.get(i);return a?a.size:0}}const o=new S,O=({blindBox:t,onPurchase:i,isDark:a})=>e.jsxs(n.div,{className:`rounded-xl overflow-hidden shadow-lg transition-all hover:shadow-xl ${a?"bg-gray-800":"bg-white"}`,whileHover:{y:-5},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{src:t.image,alt:t.name,className:"w-full h-48 object-cover",loading:"lazy"}),e.jsxs("div",{className:`absolute top-2 right-2 px-3 py-1 rounded-full text-sm font-medium ${a?"bg-gray-700":"bg-white"}`,children:[t.rarity==="common"&&"普通",t.rarity==="rare"&&"稀有",t.rarity==="epic"&&"史诗",t.rarity==="legendary"&&"传奇"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:t.name}),e.jsx("p",{className:`text-sm mb-3 ${a?"text-gray-400":"text-gray-600"}`,children:t.description}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"text-red-600 font-bold",children:[t.price," 积分"]}),e.jsxs("div",{className:`text-xs ${a?"text-gray-400":"text-gray-600"}`,children:["剩余: ",t.remainingCount,"/",t.totalCount]})]}),e.jsx("button",{onClick:()=>i(t),disabled:!t.available,className:`w-full py-2 rounded-lg font-medium transition-colors ${t.available?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-500 cursor-not-allowed text-white"}`,children:t.available?"立即购买":"已售罄"})]})]}),P=({result:t,onClose:i,isDark:a,onToggleCollection:s,isCollected:l})=>e.jsx(n.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(n.div,{className:`rounded-2xl p-8 max-w-md w-full ${a?"bg-gray-800":"bg-white"}`,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:20},children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"恭喜你获得！"}),e.jsxs(n.div,{className:"flex flex-col items-center mb-6",initial:{rotateY:180,opacity:0},animate:{rotateY:0,opacity:1},transition:{delay:.3,duration:.6},children:[e.jsx(n.div,{className:"absolute -top-10 -right-10 w-40 h-40 bg-yellow-500 rounded-full opacity-50",animate:{scale:[1,1.5,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),e.jsxs("div",{className:"w-48 h-48 rounded-full overflow-hidden border-4 border-yellow-500 mb-4 relative",children:[e.jsx(n.div,{className:"absolute inset-0 rounded-full border-4 border-transparent bg-gradient-to-r from-red-500 via-yellow-500 to-purple-500",animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"}}),e.jsx(j,{src:t.content.image,alt:t.content.name,className:"w-full h-full object-cover relative z-10"})]}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:t.content.name}),e.jsx("p",{className:`text-center mb-3 ${a?"text-gray-400":"text-gray-600"}`,children:t.content.description}),e.jsxs("div",{className:`px-4 py-1 rounded-full text-sm font-medium ${a?"bg-gray-700":"bg-gray-100"} mb-4`,children:[t.content.rarity==="common"&&"普通",t.content.rarity==="rare"&&"稀有",t.content.rarity==="epic"&&"史诗",t.content.rarity==="legendary"&&"传奇"]}),e.jsxs(n.button,{onClick:()=>s(t.content.id),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${l?"bg-red-600 text-white hover:bg-red-700":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx("i",{className:"fas fa-heart",style:{color:l?"#ffffff":"#ff6b6b"}}),l?"已收藏":"收藏"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:i,className:`flex-1 py-3 rounded-lg font-medium transition-colors ${a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"关闭"}),e.jsx("button",{onClick:i,className:"flex-1 py-3 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white transition-colors",children:"再开一个"})]})]})}),A=()=>{const{isDark:t}=$(),[i,a]=g.useState(()=>o.getAllBlindBoxes()),[s,l]=g.useState(null),[c,p]=g.useState(!1),[u,y]=g.useState(null),[d,x]=g.useState(!1),[b,w]=g.useState([]),m="current-user",_=r=>{o.purchaseBlindBox(r.id,m)?(l(r),p(!0),setTimeout(()=>{const C=o.openBlindBox(r.id,m);C&&(y(C),p(!1),a(o.getAllBlindBoxes()),f(),v.success("盲盒开启成功！"))},2e3)):v.error("盲盒购买失败，请稍后重试")},B=()=>{y(null)},N=r=>{o.toggleCollection(m,r),f(),v.success(o.isContentCollected(m,r)?"收藏成功！":"取消收藏成功！")},f=()=>{const r=o.getUserCollections(m);w(r)};g.useEffect(()=>{f()},[]);const z=({content:r})=>e.jsxs(n.div,{className:`rounded-xl overflow-hidden shadow-lg transition-all hover:shadow-xl ${t?"bg-gray-800":"bg-white"}`,whileHover:{y:-5},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{src:r.image,alt:r.name,className:"w-full h-40 object-cover",loading:"lazy"}),e.jsxs("div",{className:`absolute top-2 right-2 px-3 py-1 rounded-full text-sm font-medium ${t?"bg-gray-700":"bg-white"}`,children:[r.rarity==="common"&&"普通",r.rarity==="rare"&&"稀有",r.rarity==="epic"&&"史诗",r.rarity==="legendary"&&"传奇"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:r.name}),e.jsx("p",{className:`text-sm mb-3 ${t?"text-gray-400":"text-gray-600"}`,children:r.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm font-medium",children:r.type}),e.jsxs("button",{onClick:()=>N(r.id),className:`text-sm transition-colors ${t?"hover:text-red-400":"hover:text-red-600"}`,children:[e.jsx("i",{className:"fas fa-heart",style:{color:"#ff6b6b"}})," 取消收藏"]})]})]})]});return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"作品盲盒商店"}),e.jsx("p",{className:`${t?"text-gray-400":"text-gray-600"}`,children:"开启盲盒，发现惊喜创作资源！每个盲盒都有机会获得稀有作品、模板和素材"}),e.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[e.jsx("button",{onClick:()=>x(!1),className:`px-6 py-2 rounded-full text-sm font-medium transition-all ${d?t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200":"bg-red-600 text-white hover:bg-red-700"}`,children:"盲盒商店"}),e.jsxs("button",{onClick:()=>x(!0),className:`px-6 py-2 rounded-full text-sm font-medium transition-all ${d?"bg-red-600 text-white hover:bg-red-700":t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:["我的收藏 (",o.getCollectionCount(m),")"]})]})]}),e.jsx("div",{className:"mb-8",children:d?e.jsx("div",{children:b.length===0?e.jsxs("div",{className:`rounded-xl p-8 text-center ${t?"bg-gray-800":"bg-white"} shadow-lg`,children:[e.jsx("i",{className:"fas fa-heart-broken text-6xl text-red-600 mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"还没有收藏的内容"}),e.jsx("p",{className:`mb-4 ${t?"text-gray-400":"text-gray-600"}`,children:"开启盲盒获得内容后，可以收藏喜欢的作品、模板和素材"}),e.jsx("button",{onClick:()=>x(!1),className:"px-6 py-2 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white transition-colors",children:"去开启盲盒"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-xl font-bold mb-4",children:["我的收藏 (",b.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:b.map(r=>e.jsx(z,{content:r},r.id))})]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:i.map(r=>e.jsx(O,{blindBox:r,onPurchase:_,isDark:t},r.id))})}),c&&e.jsx(n.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",initial:{opacity:0},animate:{opacity:1},children:e.jsxs("div",{className:"text-center",children:[e.jsxs(n.div,{className:"relative w-40 h-40 mb-6",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:20},children:[e.jsx(n.div,{className:"absolute inset-0 rounded-full bg-gradient-to-r from-red-500 via-purple-500 to-blue-500 opacity-70",animate:{scale:[1,1.2,1],opacity:[.7,.3,.7]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),e.jsxs(n.div,{className:"w-40 h-40 rounded-2xl bg-gradient-to-br from-red-500 to-purple-600 flex items-center justify-center relative z-10",animate:{rotate:360,scale:[1,1.05,1]},transition:{rotate:{duration:1,repeat:1/0,ease:"linear"},scale:{duration:1,repeat:1/0,ease:"easeInOut"}},children:[e.jsx(n.div,{className:"absolute top-0 left-0 w-full h-20 bg-gradient-to-b from-purple-600 to-red-500 rounded-t-2xl",animate:{y:[0,-10,0]},transition:{duration:1,repeat:1/0,ease:"easeInOut"}}),e.jsx("div",{className:"w-24 h-24 rounded-full bg-white flex items-center justify-center relative z-20",children:e.jsx("span",{className:"text-red-600 text-3xl font-bold",children:"?"})})]})]}),e.jsxs(n.h3,{className:`text-xl font-bold ${t?"text-white":"text-black"} mb-2`,animate:{scale:[1,1.1,1]},transition:{duration:1,repeat:1/0,ease:"easeInOut"},children:["正在开启 ",s==null?void 0:s.name,"..."]}),e.jsx("div",{className:"w-64 h-2 bg-gray-600 rounded-full overflow-hidden mx-auto",children:e.jsx(n.div,{className:"h-full bg-red-600",initial:{width:0},animate:{width:"100%"},transition:{duration:2,ease:"linear"}})})]})}),u&&e.jsx(P,{result:u,onClose:B,isDark:t,onToggleCollection:N,isCollected:o.isContentCollected(m,u.content.id)}),e.jsxs("div",{className:`rounded-xl p-6 ${t?"bg-gray-800":"bg-gray-50"}`,children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"盲盒规则说明"}),e.jsxs("ul",{className:`space-y-2 ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),e.jsx("span",{children:"盲盒包含作品、模板、素材和成就等多种内容"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),e.jsx("span",{children:"不同稀有度的盲盒对应不同品质的内容，传奇盲盒有机会获得典藏级作品"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),e.jsx("span",{children:"每个盲盒数量有限，售完即止"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),e.jsx("span",{children:"开启的内容将自动添加到您的创作资源库中"})]})]})]})]})};export{A as default};
