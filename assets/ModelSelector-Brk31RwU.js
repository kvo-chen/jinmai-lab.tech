import{u as Me,r as n,l as m,j as e,m as y,q as N,t as _}from"./index-DW-f9EnK.js";const Le=({isOpen:w,onClose:k})=>{const{isDark:r}=Me(),[o,D]=n.useState(m.getCurrentModel()),[l,u]=n.useState(m.getConfig()),[K,T]=n.useState(!1),[i,b]=n.useState(!1),[V,j]=n.useState(null),[q,W]=n.useState([]),[p,G]=n.useState(m.getCurrentRole()),[Ye,Re]=n.useState(!1),I=n.useRef(null),[f,F]=n.useState(!1),[h,S]=n.useState([m.getCurrentModel().id]),[E,Be]=n.useState(()=>localStorage.getItem("KIMI_API_KEY")||""||""),[H,L]=n.useState("https://api.moonshot.cn/v1"),[Z,O]=n.useState("moonshot-v1-32k"),[C,De]=n.useState(()=>localStorage.getItem("DEEPSEEK_API_KEY")||""||""),[Q,U]=n.useState("https://api.deepseek.com"),[X,J]=n.useState("deepseek-chat"),[$,Ve]=n.useState(()=>localStorage.getItem("DOUBAO_API_KEY")||""||""),[ee,se]=n.useState("https://api.doubao.com/v1"),[te,ae]=n.useState("doubao-pro-32k"),[A,qe]=n.useState(()=>localStorage.getItem("WENXIN_API_KEY")||""||""),[re,ne]=n.useState("https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions"),[le,ie]=n.useState("ERNIE-Speed-8K"),[P,Ge]=n.useState(()=>localStorage.getItem("QWEN_API_KEY")||""||""),[oe,de]=n.useState("https://dashscope.aliyuncs.com/api/v1"),[ce,me]=n.useState("qwen-plus"),[M,ze]=n.useState(()=>localStorage.getItem("CHATGPT_API_KEY")||""||""),[xe,ue]=n.useState("https://api.openai.com/v1"),[ge,pe]=n.useState("gpt-4o"),[Y,Te]=n.useState(()=>localStorage.getItem("GEMINI_API_KEY")||""||""),[he,be]=n.useState("https://generativelanguage.googleapis.com/v1"),[ye,fe]=n.useState("gemini-1.5-flash"),[R,We]=n.useState(()=>localStorage.getItem("GORK_API_KEY")||""||""),[je,ve]=n.useState("https://api.x.ai/v1"),[Ne,_e]=n.useState("grok-beta"),[B,Fe]=n.useState(()=>localStorage.getItem("ZHIPU_API_KEY")||""||""),[we,ke]=n.useState("https://open.bigmodel.cn/api/paas/v4"),[Ke,Ie]=n.useState("glm-4-plus"),z=n.useRef(null);n.useEffect(()=>{if(w){const s=m.getCurrentModel();D(s),u(m.getConfig());const t=m.getRoles();W(t),G(m.getCurrentRole()),S([s.id])}},[w]);const Se=()=>{F(!f),f&&h.length===0&&S([m.getCurrentModel().id])},Ee=s=>{S(t=>{if(t.includes(s)){const a=t.filter(x=>x!==s);return a.length>0?a:[s]}else return[...t,s]})},Ce=s=>{const t=q.find(a=>a.id===s);t&&(G(t),setTimeout(()=>{I.current&&I.current.scrollIntoView({behavior:"smooth",block:"start"})},50))},v=s=>{const t=N.find(a=>a.id===s);t&&(D(t),setTimeout(()=>{z.current&&z.current.scrollIntoView({behavior:"smooth",block:"start"})},50))},$e=(s,t)=>{const a=N.map(x=>x.id);if(s.key==="Enter"||s.key===" ")s.preventDefault(),v(a[t]);else if(s.key==="ArrowRight"){s.preventDefault();const x=(t+1)%a.length;v(a[x])}else if(s.key==="ArrowLeft"){s.preventDefault();const x=(t-1+a.length)%a.length;v(a[x])}},d=(s,t)=>{u(a=>({...a,[s]:t}))},g=(s,t)=>{if(!t)return!0;switch(s){case"kimi":case"deepseek":case"qwen":case"chatgpt":return t.startsWith("sk-");case"doubao":return/^[a-zA-Z0-9-_]+$/.test(t);case"wenxinyiyan":return/^[a-zA-Z0-9-_/.=]+$/.test(t);case"gemini":return t.startsWith("AIzaSy");case"gork":return t.startsWith("xai-");case"zhipu":return/^[a-zA-Z0-9-_.]+$/.test(t);default:return!0}},c=(s,t)=>{if(!t){localStorage.removeItem(s);return}const a=btoa(t);localStorage.setItem(s,a)},Ae=()=>{try{b(!0),j(null),setTimeout(()=>{let s=!0,t="";if(o.id==="kimi"?(E?g("kimi",E)?c("KIMI_API_KEY",E):(s=!1,t="Kimi 密钥格式不正确，应为 sk- 开头"):c("KIMI_API_KEY",""),u(a=>({...a,kimi_base_url:H,kimi_model:Z}))):o.id==="deepseek"?(C?g("deepseek",C)?c("DEEPSEEK_API_KEY",C):(s=!1,t="DeepSeek 密钥格式不正确，应为 sk- 开头"):c("DEEPSEEK_API_KEY",""),u(a=>({...a,deepseek_base_url:Q,deepseek_model:X}))):o.id==="doubao"?($?g("doubao",$)?c("DOUBAO_API_KEY",$):(s=!1,t="豆包 密钥格式不正确"):c("DOUBAO_API_KEY",""),u(a=>({...a,doubao_base_url:ee,doubao_model:te}))):o.id==="wenxinyiyan"?(A?g("wenxinyiyan",A)?c("WENXIN_API_KEY",A):(s=!1,t="文心一言 密钥格式不正确"):c("WENXIN_API_KEY",""),u(a=>({...a,wenxin_base_url:re,wenxin_model:le}))):o.id==="qwen"?(P?g("qwen",P)?c("QWEN_API_KEY",P):(s=!1,t="通义千问 密钥格式不正确，应为 sk- 开头"):c("QWEN_API_KEY",""),u(a=>({...a,qwen_base_url:oe,qwen_model:ce}))):o.id==="chatgpt"?(M?g("chatgpt",M)?c("CHATGPT_API_KEY",M):(s=!1,t="ChatGPT 密钥格式不正确，应为 sk- 开头"):c("CHATGPT_API_KEY",""),u(a=>({...a,chatgpt_base_url:xe,chatgpt_model:ge}))):o.id==="gemini"?(Y?g("gemini",Y)?c("GEMINI_API_KEY",Y):(s=!1,t="Gemini 密钥格式不正确"):c("GEMINI_API_KEY",""),u(a=>({...a,gemini_base_url:he,gemini_model:ye}))):o.id==="gork"?(R?g("gork",R)?c("GORK_API_KEY",R):(s=!1,t="Gork 密钥格式不正确，应为 xai- 开头"):c("GORK_API_KEY",""),u(a=>({...a,gork_base_url:je,gork_model:Ne}))):o.id==="zhipu"&&(B?g("zhipu",B)?c("ZHIPU_API_KEY",B):(s=!1,t="智谱 密钥格式不正确"):c("ZHIPU_API_KEY",""),u(a=>({...a,zhipu_base_url:we,zhipu_model:Ke}))),!s){j(t),b(!1);return}m.setCurrentModel(o.id),m.setCurrentRole(p.id),m.updateConfig(l),_.success("模型和角色设置已保存"),k(),b(!1)},500)}catch{j("保存模型设置失败，请稍后再试"),b(!1)}},Pe=async()=>{try{b(!0),j(null),m.setCurrentModel(o.id),m.updateConfig({stream:!1});let s;const t=x=>{x.detail.modelId===o.id&&x.detail.status==="error"&&(s=x.detail.error)};window.addEventListener("llm-connection-status-changed",t),await m.generateResponse("ping"),window.removeEventListener("llm-connection-status-changed",t),m.getConnectionStatus(o.id)==="connected"?_.success("连接正常"):_.error(`连接失败: ${s||"未知错误"}`)}catch(s){const t=s instanceof Error?s.message:String(s);_.error(`连接失败: ${t}`)}finally{b(!1)}};return w?e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${r?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:e.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:`rounded-2xl ${r?"bg-gray-800":"bg-white"} shadow-xl max-w-md w-full mx-4 overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:`p-6 border-b ${r?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsx("h3",{className:"text-xl font-bold",children:"模型选择"}),e.jsx("button",{onClick:k,className:`p-2 rounded-full ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[V&&e.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-red-100 text-red-600 text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),V]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"font-medium",children:"选择大语言模型"}),e.jsx("button",{type:"button",onClick:Se,className:`px-3 py-1 rounded-full text-xs font-medium transition-all ${f?"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400 border border-purple-300 dark:border-purple-700":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600"}`,children:f?"单模型模式":"多模型模式"})]}),f?e.jsxs("div",{"aria-label":"模型列表",className:"space-y-3",children:[N.map(s=>e.jsxs(y.button,{type:"button","aria-checked":h.includes(s.id),tabIndex:0,className:`relative w-full text-left p-4 rounded-xl border transition-all ${h.includes(s.id)?"border-purple-600 bg-purple-100 dark:bg-purple-900/20 ring-2 ring-purple-500 shadow-md":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,whileHover:{y:-2},onClick:()=>Ee(s.id),"aria-label":`选择模型 ${s.name}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`font-bold ${h.includes(s.id)?"text-purple-600":""}`,children:s.name}),e.jsx("p",{className:`text-sm mt-1 ${r?"text-gray-400":"text-gray-600"}`,children:s.description})]}),e.jsx("div",{className:`w-5 h-5 rounded border-2 transition-all ${h.includes(s.id)?"border-purple-600 bg-purple-600":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,children:h.includes(s.id)&&e.jsx("i",{className:"fas fa-check text-white text-xs flex items-center justify-center w-full h-full"})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:s.strengths.map((t,a)=>e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${r?"bg-gray-700":"bg-gray-100"}`,children:t},a))})]},s.id)),e.jsxs("div",{className:"mt-3 p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"已选择 ",h.length," 个模型"]}),e.jsxs("div",{className:"flex items-center justify-center text-xs ${isDark ? 'text-gray-400' : 'text-gray-600'}",children:[e.jsx("i",{className:"fas fa-chevron-down mr-2"}),"向下查看更多设置"]})]}):e.jsxs("div",{role:"radiogroup","aria-label":"模型列表",className:"space-y-3",children:[N.map((s,t)=>e.jsxs(y.button,{type:"button",role:"radio","aria-checked":o.id===s.id,tabIndex:0,className:`relative w-full text-left p-4 rounded-xl border transition-all ${o.id===s.id?"border-red-600 bg-red-100 dark:bg-red-900/20 ring-2 ring-red-500 shadow-md":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,whileHover:{y:-2},onClick:()=>v(s.id),onKeyDown:a=>$e(a,t),"aria-label":`选择模型 ${s.name}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`font-bold ${o.id===s.id?"text-red-600":""}`,children:s.name}),e.jsx("p",{className:`text-sm mt-1 ${r?"text-gray-400":"text-gray-600"}`,children:s.description})]}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${o.id===s.id?"border-red-600":r?"border-gray-600":"border-gray-300"} flex items-center justify-center`,children:o.id===s.id&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:s.strengths.map((a,x)=>e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${r?"bg-gray-700":"bg-gray-100"}`,children:a},x))}),o.id===s.id&&e.jsx("span",{className:"absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-red-600 text-white",children:"已选择"})]},s.id)),e.jsxs("div",{className:"mt-3 flex items-center justify-center text-xs ${isDark ? 'text-gray-400' : 'text-gray-600'}",children:[e.jsx("i",{className:"fas fa-chevron-down mr-2"}),"向下查看更多设置"]})]})]}),e.jsxs("div",{className:"mb-6",ref:I,children:[e.jsx("h4",{className:"font-medium mb-4",children:"选择角色"}),e.jsx("div",{role:"radiogroup","aria-label":"角色列表",className:"space-y-3",children:q.map(s=>{var t;return e.jsxs(y.button,{type:"button",role:"radio","aria-checked":p.id===s.id,tabIndex:0,className:`relative w-full text-left p-4 rounded-xl border transition-all ${p.id===s.id?"border-blue-600 bg-blue-100 dark:bg-blue-900/20 ring-2 ring-blue-500 shadow-md":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,whileHover:{y:-2},onClick:()=>Ce(s.id),"aria-label":`选择角色 ${s.name}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`font-bold ${p.id===s.id?"text-blue-600":""}`,children:s.name}),e.jsx("p",{className:`text-sm mt-1 ${r?"text-gray-400":"text-gray-600"}`,children:s.description}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(t=s.tags)==null?void 0:t.map((a,x)=>e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${r?"bg-gray-700":"bg-gray-100"}`,children:a},x))})]}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${p.id===s.id?"border-blue-600":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"} flex items-center justify-center`,children:p.id===s.id&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})})]}),p.id===s.id&&e.jsx("span",{className:"absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-blue-600 text-white",children:"已选择"})]},s.id)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>T(!K),className:`flex items-center justify-between w-full p-3 rounded-xl text-left transition-all ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:[e.jsx("span",{className:"font-medium",children:"高级设置"}),e.jsx("i",{className:`fas fa-chevron-${K?"up":"down"} transition-transform duration-300`})]}),K&&e.jsxs(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"创作自由度 (Temperature)"}),e.jsx("span",{className:"text-sm",children:l.temperature.toFixed(1)})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:l.temperature,onChange:s=>d("temperature",parseFloat(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"严谨"}),e.jsx("span",{children:"平衡"}),e.jsx("span",{children:"创意"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型输出的随机性和创造性。值越低，输出越严谨一致；值越高，输出越多样化和创造性。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"多样性 (Top P)"}),e.jsx("span",{className:"text-sm",children:l.top_p.toFixed(1)})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:l.top_p,onChange:s=>d("top_p",parseFloat(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"集中"}),e.jsx("span",{children:"适中"}),e.jsx("span",{children:"多样"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型输出的多样性。值越低，模型只考虑最可能的输出；值越高，模型会考虑更多可能的输出，增加多样性。"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsx("label",{className:"text-sm font-medium",children:"系统提示词"})}),e.jsx("textarea",{value:l.system_prompt,onChange:s=>d("system_prompt",s.target.value),className:`w-full p-3 rounded-lg border ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,rows:3,disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"定义模型的角色和行为，指导模型在对话中的表现。系统提示词会影响模型的整体输出风格和内容方向。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"上下文历史条数"}),e.jsx("span",{className:"text-sm",children:l.max_history})]}),e.jsx("input",{type:"range",min:"1",max:"50",step:"1",value:l.max_history,onChange:s=>d("max_history",parseInt(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型在生成回复时参考的历史对话条数。值越大，模型能记住更多上下文，但可能增加响应时间和 token 消耗。"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用流式输出"}),e.jsx("input",{type:"checkbox",checked:l.stream,onChange:s=>d("stream",s.target.checked),disabled:i})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"启用后，模型会实时返回生成的内容，而不是等待完整生成后一次性返回，提供更好的交互体验。"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"最大响应长度"}),e.jsx("span",{className:"text-sm",children:l.max_tokens})]}),e.jsx("input",{type:"range",min:"500",max:"5000",step:"500",value:l.max_tokens,onChange:s=>d("max_tokens",parseInt(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"短"}),e.jsx("span",{children:"中"}),e.jsx("span",{children:"长"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型生成回复的最大长度，单位为 token。值越大，生成的内容可能越长，但响应时间也会增加。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"响应超时 (秒)"}),e.jsx("span",{className:"text-sm",children:Math.round(l.timeout/1e3)})]}),e.jsx("input",{type:"range",min:"5",max:"60",step:"5",value:Math.round(l.timeout/1e3),onChange:s=>d("timeout",parseInt(s.target.value)*1e3),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"快"}),e.jsx("span",{children:"标准"}),e.jsx("span",{children:"慢"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置模型生成回复的最大等待时间。值过小可能导致频繁超时，值过大可能让用户等待时间过长。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"新主题权重 (Presence Penalty)"}),e.jsx("span",{className:"text-sm",children:l.presence_penalty.toFixed(1)})]}),e.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:l.presence_penalty,onChange:s=>d("presence_penalty",parseFloat(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"抑制新主题"}),e.jsx("span",{children:"平衡"}),e.jsx("span",{children:"鼓励新主题"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型引入新主题的倾向。正值鼓励模型讨论新主题，负值抑制模型引入新主题。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"重复内容惩罚 (Frequency Penalty)"}),e.jsx("span",{className:"text-sm",children:l.frequency_penalty.toFixed(1)})]}),e.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:l.frequency_penalty,onChange:s=>d("frequency_penalty",parseFloat(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"允许重复"}),e.jsx("span",{children:"平衡"}),e.jsx("span",{children:"抑制重复"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型重复使用相同词语的倾向。正值惩罚重复内容，负值鼓励重复内容。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"重试次数"}),e.jsx("span",{className:"text-sm",children:l.retry})]}),e.jsx("input",{type:"range",min:"0",max:"5",step:"1",value:l.retry,onChange:s=>d("retry",parseInt(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置模型请求失败时的自动重试次数。值越大，重试机会越多，但总等待时间可能越长。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"退避时间 (ms)"}),e.jsx("span",{className:"text-sm",children:l.backoff_ms})]}),e.jsx("input",{type:"range",min:"0",max:"2000",step:"100",value:l.backoff_ms,onChange:s=>d("backoff_ms",parseInt(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置重试之间的等待时间，采用指数退避策略。值越大，重试间隔越长，降低服务器压力。"})]}),e.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[e.jsx("h5",{className:"text-sm font-medium mb-3",children:"对话记忆配置"}),e.jsx("p",{className:`text-xs mb-3 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型如何记住和使用对话历史，影响模型的上下文理解能力。"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用对话记忆"}),e.jsx("input",{type:"checkbox",checked:l.enable_memory,onChange:s=>d("enable_memory",s.target.checked),disabled:i})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"记忆窗口大小"}),e.jsx("span",{className:"text-sm",children:l.memory_window})]}),e.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:l.memory_window,onChange:s=>d("memory_window",parseInt(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i||!l.enable_memory}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型保留的对话轮数，影响模型的长期记忆能力。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"上下文窗口大小"}),e.jsx("span",{className:"text-sm",children:l.context_window})]}),e.jsx("input",{type:"range",min:"2048",max:"128000",step:"2048",value:l.context_window,onChange:s=>d("context_window",parseInt(s.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型能处理的最大上下文长度，单位为 token。值越大，模型能理解更长的对话内容。"})]})]}),e.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[e.jsx("h5",{className:"text-sm font-medium mb-3",children:"多模态配置"}),e.jsx("p",{className:`text-xs mb-3 ${r?"text-gray-400":"text-gray-500"}`,children:"配置模型处理图像等多媒体内容的能力，适用于支持多模态的模型。"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用多模态支持"}),e.jsx("input",{type:"checkbox",checked:l.enable_multimodal,onChange:s=>d("enable_multimodal",s.target.checked),disabled:i})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"图像分辨率"}),e.jsx("span",{className:"text-sm",children:l.image_resolution})]}),e.jsxs("select",{value:l.image_resolution,onChange:s=>d("image_resolution",s.target.value),className:`w-full px-3 py-2 rounded-lg border ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,disabled:i||!l.enable_multimodal,children:[e.jsx("option",{value:"512x512",children:"512x512"}),e.jsx("option",{value:"1024x1024",children:"1024x1024"}),e.jsx("option",{value:"2048x2048",children:"2048x2048"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置图像输入的分辨率，影响图像理解的细节和处理速度。"})]})]}),e.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[e.jsx("h5",{className:"text-sm font-medium mb-3",children:"安全配置"}),e.jsx("p",{className:`text-xs mb-3 ${r?"text-gray-400":"text-gray-500"}`,children:"配置模型的安全检查机制，过滤不安全或违规内容。"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用安全检查"}),e.jsx("input",{type:"checkbox",checked:l.enable_safety_check,onChange:s=>d("enable_safety_check",s.target.checked),disabled:i})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"安全级别"}),e.jsx("span",{className:"text-sm",children:l.safety_level})]}),e.jsxs("select",{value:l.safety_level,onChange:s=>d("safety_level",s.target.value),className:`w-full px-3 py-2 rounded-lg border ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,disabled:i||!l.enable_safety_check,children:[e.jsx("option",{value:"low",children:"低"}),e.jsx("option",{value:"medium",children:"中"}),e.jsx("option",{value:"high",children:"高"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置安全检查的严格程度： - 低：较少过滤，允许更多内容 - 中：平衡过滤，兼顾安全和自由表达 - 高：严格过滤，确保内容安全"})]})]})]})]})]}),e.jsxs("div",{className:`p-6 border-t ${r?"border-gray-700":"border-gray-200"} flex justify-between items-center space-x-3`,children:[e.jsxs("span",{className:`text-sm ${r?"text-gray-400":"text-gray-600"}`,children:["当前模型：",o.name]}),e.jsx("button",{onClick:()=>{const s=m.getConfig();u({...s,temperature:.7,top_p:.9,max_tokens:2e3,timeout:3e4,system_prompt:"你是一个帮助创作者进行设计构思与文化融合的助手。",max_history:10,stream:!1,kimi_model:"moonshot-v1-32k",kimi_base_url:"https://api.moonshot.cn/v1",retry:2,backoff_ms:800,deepseek_model:"deepseek-chat",deepseek_base_url:"https://api.deepseek.com",doubao_model:"doubao-pro-32k",doubao_base_url:"https://api.doubao.com/v1",wenxin_model:"ERNIE-Speed-8K",wenxin_base_url:"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions",qwen_model:"qwen-plus",qwen_base_url:"https://dashscope.aliyuncs.com/api/v1",chatgpt_model:"gpt-4o",chatgpt_base_url:"https://api.openai.com/v1",gemini_model:"gemini-1.5-flash",gemini_base_url:"https://generativelanguage.googleapis.com/v1",gork_model:"grok-beta",gork_base_url:"https://api.x.ai/v1",zhipu_model:"glm-4-plus",zhipu_base_url:"https://open.bigmodel.cn/api/paas/v4"}),L("https://api.moonshot.cn/v1"),O("moonshot-v1-32k"),U("https://api.deepseek.com"),J("deepseek-chat"),se("https://api.doubao.com/v1"),ae("doubao-pro-32k"),ne("https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions"),ie("ERNIE-Speed-8K"),de("https://dashscope.aliyuncs.com/api/v1"),me("qwen-plus"),ue("https://api.openai.com/v1"),pe("gpt-4o"),be("https://generativelanguage.googleapis.com/v1"),fe("gemini-1.5-flash"),ve("https://api.x.ai/v1"),_e("grok-beta"),ke("https://open.bigmodel.cn/api/paas/v4"),Ie("glm-4-plus")},className:`px-5 py-2.5 rounded-lg transition-colors ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:"恢复默认"}),e.jsx("button",{onClick:Pe,className:`px-5 py-2.5 rounded-lg transition-colors ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:"连接测试"}),e.jsx("button",{onClick:k,className:`px-5 py-2.5 rounded-lg transition-colors ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:"取消"}),e.jsx("button",{onClick:Ae,className:`px-5 py-2.5 rounded-lg transition-colors ${i?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"}`,disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"保存中..."]}):"保存设置"})]})]})}):null};export{Le as M};
