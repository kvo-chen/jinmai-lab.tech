import{r as _,j as e,bF as D,m as f,t as b}from"./index-DW-f9EnK.js";const te=({isDark:r,messages:c,onSend:m,showModeration:x,onDelete:g,onTogglePin:o})=>{const[d,y]=_.useState(""),u=()=>{d.trim()&&(m(d.trim()),y(""))};return e.jsxs("div",{children:[e.jsx("div",{className:"space-y-3 mb-4 max-h-72 overflow-y-auto pr-1",children:c.length===0?e.jsx("div",{className:"text-sm opacity-60 text-center py-4",children:"æš‚æ— æ¶ˆæ¯ï¼Œå¿«æ¥å‘ç¬¬ä¸€æ¡æ¶ˆæ¯å§ï¼"}):c.map(n=>e.jsx("div",{className:`p-3 rounded-xl ${r?"bg-gray-700":"bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(D,{src:n.avatar,alt:n.user,size:"sm",className:"mr-3",variant:"heritage"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"text-sm font-medium",children:n.user})}),e.jsx("div",{className:"text-xs text-gray-400",children:n.createdAt?new Date(n.createdAt).toLocaleTimeString():""})]}),e.jsx("div",{className:`text-sm ${r?"text-gray-200":"text-gray-800"}`,children:n.text}),x&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o==null?void 0:o(n.id),className:`${r?"bg-gray-800 text-white":"bg-white text-gray-800"} px-2 py-1 rounded-lg text-xs ring-1 ${r?"ring-gray-700":"ring-gray-300"} transition-colors`,children:n.pinned?"å–æ¶ˆç½®é¡¶":"ç½®é¡¶"}),e.jsx("button",{onClick:()=>g==null?void 0:g(n.id),className:`${r?"bg-red-700 text-white":"bg-red-500 text-white"} px-2 py-1 rounded-lg text-xs transition-colors`,children:"åˆ é™¤"})]})]})]})},n.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:d,onChange:n=>y(n.target.value),onKeyPress:n=>n.key==="Enter"&&u(),placeholder:"å‘è¡¨ä½ çš„çœ‹æ³•...",className:`flex-1 px-3 py-2 rounded-lg focus:outline-none focus:ring-2 ${r?"bg-gray-700 text-white ring-1 ring-gray-600 focus:ring-purple-500":"bg-white text-gray-900 ring-1 ring-gray-300 focus:ring-pink-300"}`}),e.jsx("button",{onClick:u,className:"px-3 py-2 rounded-lg bg-gradient-to-r from-red-600 to-pink-600 text-white transition-colors hover:opacity-90",children:"å‘é€"})]})]})},re=({isDark:r,threads:c,onThreadsChange:m,mode:x,selectedStyle:g,selectedTopic:o,newTitle:d,onNewTitleChange:y,newContent:u,onNewContentChange:n,threadSearch:z,onThreadSearchChange:K,threadSort:N,onThreadSortChange:O,favOnly:j,onFavOnlyChange:M,favoriteThreads:p,onFavoriteThreadsChange:R,replyText:v,onReplyTextChange:S,threadDraft:a,onThreadDraftChange:B,hotTopics:w,STYLE_LIST:L,TOPIC_LIST:q,onModeChange:I,onSelectedStyleChange:A,onSelectedTopicChange:J,onInsertRandomIdea:Q,upvoteGuard:E,onUpvoteGuardChange:U})=>{const[$,V]=_.useState("");_.useEffect(()=>{const t=setTimeout(()=>{V(z.trim())},300);return()=>clearTimeout(t)},[z]);const W=()=>{const t=d.trim(),s=u.trim(),i=["å¹¿å‘Š","è¿è§„"];if(!t||!s||i.some(F=>t.includes(F)||s.includes(F)))return;const h=[{id:`t-${Date.now()}`,title:t,content:s,createdAt:Date.now(),replies:[],topic:x==="style"?g:o,upvotes:0},...c];m(h),localStorage.setItem("jmzf_threads",JSON.stringify(h)),y(""),n(""),b.success("å¸–å­å·²å‘å¸ƒ")},X=()=>{a&&(y(a.title||""),n(a.content||""),a.mode&&(I(a.mode),a.mode==="style"&&a.selected&&A(a.selected),a.mode==="topic"&&a.selected&&J(a.selected)))},Y=()=>{B(null);try{localStorage.removeItem("jmzf_thread_draft")}catch{}},H=t=>{const s=(v[t]||"").trim();if(!s)return;const i=c.map(l=>l.id===t?{...l,replies:[...l.replies,{id:`r-${Date.now()}`,content:s,createdAt:Date.now()}]}:l);m(i),localStorage.setItem("jmzf_threads",JSON.stringify(i)),S({...v,[t]:""}),b.success("å›å¤å·²æ·»åŠ ")},Z=t=>{if(E[t]){b.info("å·²ç‚¹è¿‡èµ");return}const s=c.map(l=>l.id===t?{...l,upvotes:(l.upvotes||0)+1}:l);m(s),localStorage.setItem("jmzf_threads",JSON.stringify(s));const i={...E,[t]:!0};U(i),localStorage.setItem("jmzf_upvote_guard",JSON.stringify(i))},G=t=>{const s=p.includes(t)?p.filter(i=>i!==t):[t,...p];R(s)},P=t=>{const s=c.map(i=>i.id===t?{...i,pinned:!i.pinned}:i);m(s),localStorage.setItem("jmzf_threads",JSON.stringify(s)),b.success("ç½®é¡¶çŠ¶æ€å·²æ›´æ–°")},k=t=>{const s=c.filter(i=>i.id!==t);m(s),localStorage.setItem("jmzf_threads",JSON.stringify(s)),b.success("å¸–å­å·²åˆ é™¤")},T=(t,s)=>{const i=c.map(l=>l.id===t?{...l,replies:l.replies.filter(h=>h.id!==s)}:l);m(i),localStorage.setItem("jmzf_threads",JSON.stringify(i)),b.success("å›å¤å·²åˆ é™¤")},C=_.useMemo(()=>c.filter(t=>x==="style"?t.topic===g:t.topic===o).filter(t=>j?p.includes(t.id):!0).filter(t=>$?t.title.includes($)||t.content.includes($):!0).sort((t,s)=>{const i=Number(s.pinned)-Number(t.pinned);return i!==0?i:N==="new"?s.createdAt-t.createdAt:N==="reply"?s.replies.length-t.replies.length:(s.upvotes||0)+s.replies.length-((t.upvotes||0)+t.replies.length)}),[c,x,g,o,j,p,$,N]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`mb-6 rounded-2xl p-4 ${r?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"}`,children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-sm opacity-70",children:"å­ç¤¾åŒºï¼š"}),e.jsx(f.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>I("style"),className:`${x==="style"?"bg-red-600 text-white":r?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm transition-colors hover:opacity-90`,children:"é£æ ¼"}),e.jsx(f.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>I("topic"),className:`${x==="topic"?"bg-red-600 text-white":r?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm transition-colors hover:opacity-90`,children:"é¢˜æ"})]}),x==="style"?e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(t=>{const s=c.filter(i=>i.topic===t).length;return e.jsxs(f.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>A(t),className:`${g===t?"bg-red-600 text-white":r?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm flex items-center gap-2 transition-colors hover:opacity-90`,children:[e.jsx("span",{children:t}),e.jsx("span",{className:`${g===t?"bg-white text-red-600 ring-1 ring-red-200":r?"bg-gray-600 text-white ring-1 ring-gray-700":"bg-gray-300 text-gray-900 ring-1 ring-gray-300"} text-xs px-2 py-0.5 rounded-full`,children:s})]},t)})}):e.jsx("div",{className:"flex flex-wrap gap-2",children:q.map(t=>{const s=c.filter(i=>i.topic===t).length;return e.jsxs(f.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>J(t),className:`${o===t?"bg-red-600 text-white":r?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm flex items-center gap-2 transition-colors hover:opacity-90`,children:[e.jsx("span",{children:t}),e.jsx("span",{className:`${o===t?"bg-white text-red-600 ring-1 ring-red-200":r?"bg-gray-600 text-white ring-1 ring-gray-700":"bg-gray-300 text-gray-900 ring-1 ring-gray-300"} text-xs px-2 py-0.5 rounded-full`,children:s})]},t)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:`rounded-2xl p-4 lg:col-span-1 ${r?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"}`,children:[e.jsx("div",{className:"font-medium mb-3",children:e.jsx("span",{className:"flex items-center gap-2",children:"ğŸ”¥ è¯é¢˜çƒ­æ¦œ"})}),e.jsxs("ul",{children:[w.map(([t,s],i)=>{const l=w.length?w[0][1]:1,h=Math.max(6,Math.round(s/Math.max(1,l)*100));return e.jsxs("li",{className:"py-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"mr-3",children:[i+1,". ",t]}),e.jsx("span",{className:"opacity-70",children:s})]}),e.jsx("div",{className:`${r?"bg-gray-700":"bg-gray-200"} w-full h-2 rounded-full mt-1`,children:e.jsx("div",{style:{width:`${h}%`},className:`h-2 rounded-full ${r?"bg-red-500":"bg-red-600"} transition-all duration-300`})})]},t)}),w.length===0&&e.jsx("li",{className:"text-sm opacity-60",children:"æš‚æ— æ•°æ®"})]})]}),e.jsxs("div",{className:`rounded-2xl p-4 lg:col-span-2 ${r?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"font-medium",children:[x==="style"?g:o," å­ç¤¾åŒºè®¨è®º"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:z,onChange:t=>K(t.target.value),className:`${r?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} px-3 py-1 rounded-lg border text-sm focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"æœç´¢è®¨è®º","aria-label":"æœç´¢è®¨è®º"}),e.jsxs("select",{value:N,onChange:t=>O(t.target.value),className:`${r?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} px-3 py-1 rounded-lg border text-sm focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,children:[e.jsx("option",{value:"new",children:"æœ€æ–°"}),e.jsx("option",{value:"reply",children:"æœ€å¤šå›å¤"}),e.jsx("option",{value:"hot",children:"çƒ­åº¦"})]}),e.jsx("button",{onClick:()=>M(!j),className:`${j?"bg-red-600 text-white":r?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-lg text-sm transition-colors`,children:j?"åªçœ‹æ”¶è—":"å…¨éƒ¨"}),e.jsx("button",{onClick:Q,className:`${r?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-lg text-sm transition-colors`,children:"éšæœºçµæ„Ÿ"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[e.jsx("input",{value:d,onChange:t=>y(t.target.value),className:`${r?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} px-3 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"å¸–å­æ ‡é¢˜ï¼ˆå¦‚ï¼šäº¬å‰§è§’è‰²è®¾è®¡æ‰“ç£¨å»ºè®®ï¼‰","aria-label":"å¸–å­æ ‡é¢˜"}),e.jsx("button",{onClick:W,disabled:!d.trim()||!u.trim(),"aria-disabled":!d.trim()||!u.trim(),className:`px-3 py-2 rounded-lg transition-colors ${!d.trim()||!u.trim()?r?"bg-gray-600 text-gray-300":"bg-gray-300 text-gray-600":"bg-red-600 text-white hover:bg-red-700 shadow-sm"}`,children:"å‘å¸ƒæ–°å¸–"})]}),a&&(a.title||a.content)&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`${r?"text-gray-400":"text-gray-600"} text-xs`,children:"æ£€æµ‹åˆ°è‰ç¨¿ï¼Œå¯æ¢å¤ä¸Šä¸€ç¼–è¾‘"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:X,className:`${r?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${r?"ring-gray-700":"ring-gray-200"}`,children:"æ¢å¤è‰ç¨¿"}),e.jsx("button",{onClick:Y,className:`${r?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${r?"ring-gray-700":"ring-gray-200"}`,children:"æ¸…é™¤è‰ç¨¿"})]})]}),e.jsx("textarea",{value:u,onChange:t=>n(t.target.value),className:`${r?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} w-full h-24 px-3 py-2 rounded-lg border mb-4 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"è¯¦ç»†å†…å®¹"}),e.jsxs("div",{className:"space-y-3",children:[C.map(t=>e.jsxs(f.div,{whileHover:{y:-2},className:`${r?"bg-gray-700 ring-1 ring-gray-700":"bg-gray-50 ring-1 ring-gray-200"} rounded-xl p-4`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"font-medium",children:[t.title,t.pinned&&e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-red-600 text-white",children:"ç½®é¡¶"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>Z(t.id),"aria-label":"ç‚¹èµå¸–å­",className:"px-3 py-1 rounded-lg text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",children:["ç‚¹èµ ",t.upvotes||0]}),e.jsx("button",{onClick:()=>G(t.id),"aria-label":"æ”¶è—å¸–å­",className:`${p.includes(t.id)?"bg-blue-600 text-white":r?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${r?"ring-gray-700":"ring-gray-200"} transition-colors`,children:p.includes(t.id)?"å·²æ”¶è—":"æ”¶è—"}),e.jsx("button",{onClick:()=>P(t.id),"aria-label":t.pinned?"å–æ¶ˆç½®é¡¶":"ç½®é¡¶",className:`${r?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${r?"ring-gray-700":"ring-gray-200"} transition-colors`,children:t.pinned?"å–æ¶ˆç½®é¡¶":"ç½®é¡¶"}),e.jsx("button",{onClick:()=>k(t.id),"aria-label":"åˆ é™¤å¸–å­",className:`${r?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${r?"ring-gray-700":"ring-gray-200"} transition-colors`,children:"åˆ é™¤"})]})]}),e.jsx("div",{className:`text-sm opacity-80 mt-1 ${r?"text-gray-300":"text-gray-700"}`,children:t.content}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("input",{value:v[t.id]||"",onChange:s=>S({...v,[t.id]:s.target.value}),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),H(t.id))},className:`${r?"bg-gray-800 text-white":"bg-white text-gray-900"} flex-1 px-3 py-1 rounded-lg border focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"å›å¤å†…å®¹","aria-label":"å›å¤å†…å®¹"}),e.jsx("button",{onClick:()=>H(t.id),"aria-label":"æ·»åŠ å›å¤",className:`${r?"bg-gray-800 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-lg text-xs hover:opacity-90 transition-colors`,children:"å›å¤"})]}),t.replies.length>0&&e.jsx("div",{className:"mt-3 text-sm",children:t.replies.map(s=>e.jsxs("div",{className:`${r?"border-gray-700":"border-gray-200"} border-t py-2 flex items-center justify-between`,children:[e.jsx("span",{children:s.content}),e.jsx("button",{onClick:()=>T(t.id,s.id),"aria-label":"åˆ é™¤å›å¤",className:`${r?"bg-gray-800 text-white":"bg-white text-gray-900"} px-2 py-0.5 rounded-lg text-xs ring-1 ${r?"ring-gray-700":"ring-gray-200"} transition-colors`,children:"åˆ é™¤"})]},s.id))})]},t.id)),C.length===0&&e.jsx("div",{className:"text-sm opacity-60",children:"æš‚æ— è®¨è®ºï¼Œå‘å¸ƒç¬¬ä¸€æ¡å§ï½"})]})]})]})]})};export{re as CommunityDiscussion,te as DiscussionSection};
