import{u as b,c as f,r as i,j as e,t as l}from"./index-DW-f9EnK.js";function N(){const{isDark:t}=b(),d=f(),[a,c]=i.useState(null),[x,o]=i.useState([]);i.useEffect(()=>{try{const r=localStorage.getItem("CREATE_DRAFT");if(r){const s=JSON.parse(r),y={prompt:String(s.prompt||""),selectedResult:typeof s.selectedResult=="number"?s.selectedResult:null,currentStep:typeof s.currentStep=="number"?s.currentStep:1,aiExplanation:String(s.aiExplanation||""),updatedAt:typeof s.updatedAt=="number"?s.updatedAt:Date.now()};c(y)}else c(null);const n=localStorage.getItem("CREATE_HISTORY");if(n){const s=JSON.parse(n);Array.isArray(s)&&o(s)}}catch{c(null)}},[]);const m=i.useMemo(()=>{if(!a)return"";try{return new Date(a.updatedAt).toLocaleString()}catch{return""}},[a]),g=()=>{d("/create")},u=()=>{try{localStorage.removeItem("CREATE_DRAFT"),c(null),l.success("草稿已删除")}catch{l.error("删除草稿失败")}},p=r=>{try{localStorage.setItem("CREATE_DRAFT",JSON.stringify(r)),l.success("已恢复到当前草稿"),d("/create")}catch{l.error("恢复失败")}},h=()=>{try{localStorage.removeItem("CREATE_HISTORY"),o([]),l.success("历史记录已清空")}catch{l.error("清空失败")}};return e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"草稿箱"}),e.jsx("p",{className:`${t?"text-gray-400":"text-gray-600"} mt-2 text-sm`,children:"管理你在创作中心保存的本地草稿"})]}),a?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:`${t?"bg-gray-800 ring-1 ring-gray-700":"bg-white ring-1 ring-gray-200"} rounded-2xl p-6`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg font-bold",children:"AI创作草稿"}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${t?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"}`,children:["步骤 ",a.currentStep,"/3"]})]}),e.jsxs("span",{className:`text-xs ${t?"text-gray-400":"text-gray-500"}`,children:["更新于 ",m]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"提示词"}),e.jsx("p",{className:`${t?"bg-gray-700":"bg-gray-50"} rounded-lg p-3 text-sm`,children:a.prompt||"（无）"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"AI说明"}),e.jsx("p",{className:`${t?"bg-gray-700":"bg-gray-50"} rounded-lg p-3 text-sm max-h-40 overflow-auto`,children:a.aiExplanation||"（暂无说明）"})]})]}),e.jsxs("div",{className:"mt-6 flex items-center space-x-3",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 rounded-full bg-red-600 hover:bg-red-700 text白",children:"继续编辑"}),e.jsx("button",{onClick:u,className:`${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} px-4 py-2 rounded-full`,children:"删除草稿"})]})]}),e.jsxs("div",{className:`${t?"bg-gray-800 ring-1 ring-gray-700":"bg-white ring-1 ring-gray-200"} rounded-2xl p-6`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-lg font-bold",children:"历史记录"}),e.jsx("button",{onClick:h,className:"px-3 py-1.5 rounded-full bg-red-600 hover:bg-red-700 text-white text-sm",children:"清空"})]}),x.length===0?e.jsx("div",{className:`${t?"text-gray-400":"text-gray-600"} text-sm`,children:"暂无历史快照"}):e.jsx("ul",{className:"space-y-3 max-h-80 overflow-auto",children:x.map((r,n)=>e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 mr-3",children:[e.jsx("div",{className:`${t?"text-gray-300":"text-gray-700"} text-sm truncate`,children:r.prompt||"（无提示）"}),e.jsxs("div",{className:"text-gray-500 text-xs",children:["步骤 ",r.currentStep,"/3 · ",new Date(r.updatedAt).toLocaleString()]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>p(r),className:"px-3 py-1 rounded-full bg-red-600 hover:bg-red-700 text-white text-xs",children:"恢复"})})]},`${r.updatedAt}-${n}`))})]})]}):e.jsxs("div",{className:`${t?"bg-gray-800 ring-1 ring-gray-700":"bg-white ring-1 ring-gray-200"} rounded-2xl p-8 text-center`,children:[e.jsx("i",{className:"fas fa-inbox text-3xl mb-3"}),e.jsx("div",{className:"font-medium mb-1",children:"暂无草稿"}),e.jsx("p",{className:`${t?"text-gray-400":"text-gray-600"} text-sm`,children:"去创作中心开始创作并点击“保存草稿”"}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>d("/create"),className:"px-4 py-2 rounded-full bg-red-600 hover:bg-red-700 text-white",children:"前往创作中心"})})]})]})}export{N as default};
