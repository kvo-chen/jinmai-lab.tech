var re=Object.defineProperty;var le=(y,a,t)=>a in y?re(y,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):y[a]=t;var T=(y,a,t)=>le(y,typeof a!="symbol"?a+"":a,t);import{u as ne,r as n,A as ce,t as C,j as e,m as N,x as Y,L as W}from"./index-DW-f9EnK.js";class de{constructor(){T(this,"cards",[]);T(this,"levels",[]);T(this,"gameProgress",new Map);T(this,"nextCardId",1);T(this,"nextLevelId",1);this.initCards(),this.initLevels()}initCards(){this.cards=[{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Yangliuqing%20New%20Year%20Painting%20traditional%20Chinese%20art",name:"杨柳青年画",description:"中国四大木版年画之一，以色彩鲜艳、构图饱满著称",culturalElement:"传统绘画",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Nirenzhang%20clay%20sculpture%20traditional%20Chinese%20art",name:"泥人张彩塑",description:"天津传统民间艺术，以细腻的造型和生动的表情著称",culturalElement:"传统雕塑",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Tianjin%20crosstalk%20performance%20traditional%20Chinese%20art",name:"天津相声",description:"中国北方传统曲艺形式，以幽默风趣的对话著称",culturalElement:"传统曲艺",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Tianjin%20mahua%20traditional%20Chinese%20snack",name:"天津麻花",description:"天津传统名点，以酥脆香甜著称",culturalElement:"传统美食",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Goubuli%20steamed%20buns%20traditional%20Chinese%20food",name:"狗不理包子",description:"天津传统名点，以皮薄馅大、鲜香可口著称",culturalElement:"传统美食",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Tianjin%20dialect%20conversation%20illustration",name:"天津方言",description:"天津地区的方言，以幽默风趣、表现力强著称",culturalElement:"方言文化",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Beijing%20Opera%20face%20paint%20traditional%20Chinese%20art",name:"京剧脸谱",description:"京剧艺术的重要组成部分，以色彩象征人物性格",culturalElement:"传统戏曲",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20calligraphy%20art%20traditional%20writing",name:"书法艺术",description:"中国传统艺术形式，以毛笔书写汉字为表现手段",culturalElement:"传统书画",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Traditional%20Chinese%20patterns%20cloud%20design",name:"传统纹样",description:"中国传统装饰图案，具有丰富的文化内涵",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20knot%20traditional%20decorative%20art",name:"中国结",description:"中国传统手工艺品，象征吉祥如意",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20paper%20cutting%20art%20traditional%20craft",name:"剪纸艺术",description:"中国传统民间艺术，以剪刀或刻刀在纸上剪刻花纹",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Blue%20and%20white%20porcelain%20traditional%20Chinese%20ceramics",name:"青花瓷",description:"中国传统瓷器品种，以青花为装饰手法",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20dragon%20symbol%20traditional%20culture",name:"龙",description:"中国传统文化中的祥瑞动物，象征权力和尊贵",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20phoenix%20symbol%20traditional%20culture",name:"凤",description:"中国传统文化中的祥瑞动物，象征吉祥和美好",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20character%20Fu%20symbol%20good%20luck",name:"福字",description:"中国传统文化中的吉祥符号，象征幸福和福气",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Traditional%20Chinese%20cloud%20pattern%20design",name:"祥云",description:"中国传统文化中的吉祥图案，象征祥瑞和好运",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Bagua%20symbol%20traditional%20Chinese%20philosophy",name:"八卦",description:"中国传统文化中的哲学符号，象征宇宙万物的变化规律",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Taiji%20symbol%20yin%20yang%20traditional%20Chinese%20philosophy",name:"太极",description:"中国传统文化中的哲学符号，象征阴阳对立统一",culturalElement:"文化符号",category:"文化符号"}]}initLevels(){const a=(t,i=2)=>{const d=t.map(p=>this.cards[p-1]),m=[];for(const p of d)for(let b=0;b<i;b++)m.push({...p,id:`${p.id}-copy-${b}`});return m};this.levels=[{id:`level-${this.nextLevelId++}`,name:"天津文化入门",description:"了解天津的传统特色文化元素",cards:a([1,2,3,4]),gridSize:{rows:4,cols:4},difficulty:"easy",reward:"解锁天津文化素材包",culturalTheme:"天津地方文化",imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Tianjin%20cultural%20heritage%20tourism"},{id:`level-${this.nextLevelId++}`,name:"传统艺术探索",description:"探索中国传统艺术形式",cards:a([7,8,9,10,11,12]),gridSize:{rows:6,cols:4},difficulty:"medium",unlockCondition:{type:"level",value:1},reward:"解锁传统纹样素材包",culturalTheme:"中国传统艺术",imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Chinese%20traditional%20art%20collection"},{id:`level-${this.nextLevelId++}`,name:"文化符号挑战",description:"挑战识别中国文化符号",cards:a([13,14,15,16,17,18,1,2]),gridSize:{rows:4,cols:8},difficulty:"hard",unlockCondition:{type:"level",value:2},reward:"解锁高级配色方案",culturalTheme:"中国文化符号",imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Chinese%20cultural%20symbols%20collection"}]}getLevels(){return[...this.levels]}getLevelById(a){return this.levels.find(t=>t.id===a)}getCards(){return[...this.cards]}getCardById(a){const t=a.split("-copy-")[0];return this.cards.find(i=>i.id===t)}getGameProgress(a){if(!this.gameProgress.has(a)){const t={userId:a,completedLevels:[],totalScore:0,levelScores:{},unlockedHints:3,bestTimes:{},lastPlayed:new Date};this.gameProgress.set(a,t)}return this.gameProgress.get(a)}updateGameProgress(a,t){const d={...this.getGameProgress(a),...t,lastPlayed:new Date};return this.gameProgress.set(a,d),d}checkMatch(a,t){const i=a.id.split("-copy-")[0],d=t.id.split("-copy-")[0];return i===d}calculateScore(a,t,i){const d=a*10,m={easy:.3,medium:.5,hard:.8}[i]||.5,p=Math.max(0,600-t)*m,b={easy:1,medium:1.2,hard:1.5}[i]||1;return Math.round((d+p)*b)}completeLevel(a,t,i,d){const m=this.getGameProgress(a),p={...m.bestTimes};(!p[t]||d<p[t])&&(p[t]=d);const b={...m,completedLevels:[...new Set([...m.completedLevels,t])],totalScore:m.totalScore+i,levelScores:{...m.levelScores,[t]:i},bestTimes:p,lastPlayed:new Date};return this.gameProgress.set(a,b),b}useHint(a){const t=this.getGameProgress(a);return t.unlockedHints>0?(this.updateGameProgress(a,{unlockedHints:t.unlockedHints-1}),!0):!1}unlockHint(a){const t=this.getGameProgress(a);this.updateGameProgress(a,{unlockedHints:t.unlockedHints+1})}isLevelUnlocked(a,t){const i=this.getLevelById(t);if(!i||!i.unlockCondition)return!0;const d=this.getGameProgress(a),{unlockCondition:m}=i;return m.type==="level"?d.completedLevels.length>=m.value:m.type==="score"?d.totalScore>=m.value:!1}shuffleCards(a){const t=[...a];for(let i=t.length-1;i>0;i--){const d=Math.floor(Math.random()*(i+1));[t[i],t[d]]=[t[d],t[i]]}return t}}const f=new de,pe=({isOpen:y,onClose:a})=>{const{isDark:t}=ne(),{user:i}=n.useContext(ce),[d,m]=n.useState("menu"),[p,b]=n.useState([]),[o,A]=n.useState(null),[g,P]=n.useState(null),[w,$]=n.useState([]),[R,L]=n.useState([]),[_,H]=n.useState(0),[q,E]=n.useState(0),[k,V]=n.useState(null),[X,G]=n.useState(null),[S,B]=n.useState(!1),[oe,U]=n.useState(!1),[me,z]=n.useState([]),[I,J]=n.useState(!0);n.useEffect(()=>{if(y){J(!0);const s=f.getLevels();if(b(s),i){const l=f.getGameProgress(i.id);P(l)}J(!1)}},[y,i]);const M=n.useCallback(s=>{A(s),m("playing"),H(0),E(0),V(new Date),G(null),B(!0),U(!1),z([]),L([]);const r=f.shuffleCards(s.cards).map(h=>({card:h,isFlipped:!1,isMatched:!1,isHinted:!1}));$(r)},[]),Z=n.useCallback(s=>{!S||R.length>=2||($(l=>{const r=[...l];return r[s].isFlipped||r[s].isMatched||(r[s].isFlipped=!0),r}),L(l=>{const r=[...l,w[s]];return r.length===2&&setTimeout(()=>O(r),1e3),r}))},[S,R,w]),O=n.useCallback(s=>{if(s.length!==2)return;const[l,r]=s;f.checkMatch(l.card,r.card)?($(u=>{const c=[...u],x=c.findIndex(j=>j.card.id===l.card.id),v=c.findIndex(j=>j.card.id===r.card.id);return x!==-1&&(c[x].isMatched=!0,c[x].isHinted=!1),v!==-1&&(c[v].isMatched=!0,c[v].isHinted=!1),c}),H(u=>u+1),C.success("匹配成功！")):($(u=>{const c=[...u],x=c.findIndex(j=>j.card.id===l.card.id),v=c.findIndex(j=>j.card.id===r.card.id);return x!==-1&&(c[x].isFlipped=!1,c[x].isHinted=!1),v!==-1&&(c[v].isFlipped=!1,c[v].isHinted=!1),c}),C.error("匹配失败，再试一次！")),L([]),U(!1),z([])},[]),ee=n.useCallback(()=>{if(!i||!g)return;if(f.useHint(i.id)){const l=w.filter(u=>!u.isMatched&&!u.isFlipped);if(l.length<2){C.info("没有可提示的卡片了！");return}let r=null,h=null;for(let u=0;u<l.length;u++){for(let c=u+1;c<l.length;c++)if(f.checkMatch(l[u].card,l[c].card)){r=l[u],h=l[c];break}if(r&&h)break}if(r&&h){$(c=>{const x=[...c],v=x.findIndex(F=>F.card.id===(r==null?void 0:r.card.id)),j=x.findIndex(F=>F.card.id===(h==null?void 0:h.card.id));return v!==-1&&(x[v].isHinted=!0),j!==-1&&(x[j].isHinted=!0),x}),U(!0),z([r,h]),C.success("已显示提示卡片！");const u=f.getGameProgress(i.id);P(u)}}else C.error("提示次数已用完！")},[i,g,w]),K=n.useCallback(()=>{if(!i||!o)return;const l=k?Math.round((new Date().getTime()-k.getTime())/1e3):0;G(l);const r=f.calculateScore(_,l,o.difficulty);E(r);const h=f.completeLevel(i.id,o.id,r,l);P(h),m("completed"),B(!1),C.success(`关卡完成！得分：${r}`)},[i,o,_,k]);n.useEffect(()=>{if(o&&w.length>0){const s=o.cards.length/2;_===s&&S&&K()}},[_,o,w.length,S,K]);const te=n.useCallback(s=>{if(!i){C.error("请先登录！");return}f.isLevelUnlocked(i.id,s.id)?M(s):C.error("该关卡尚未解锁！")},[i,M]),Q=n.useCallback(()=>{m("menu"),A(null),$([]),L([]),H(0),E(0),V(null),G(null),B(!1),U(!1),z([])},[]),se=n.useCallback(()=>{o&&M(o)},[o,M]),D=n.useCallback(s=>{if(!s)return"00:00";const l=Math.floor(s/60),r=s%60;return`${l.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`},[]),[ae,ie]=n.useState(0);return n.useEffect(()=>{let s;return k&&S&&(s=setInterval(()=>{const r=Math.round((new Date().getTime()-k.getTime())/1e3);ie(r)},1e3)),()=>clearInterval(s)},[k,S]),y?e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4 overflow-y-auto",onClick:s=>s.target===s.currentTarget&&a(),children:e.jsxs(N.div,{initial:{scale:.9,y:50},animate:{scale:1,y:0},exit:{scale:.9,y:50},transition:{type:"spring",stiffness:300,damping:30},className:`w-full max-w-6xl rounded-xl overflow-hidden shadow-2xl ${t?"bg-gray-800":"bg-white"} text-${t?"white":"gray-900"}`,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b ${t?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsx("h3",{className:"text-xl font-bold",children:"文化元素连连看"}),e.jsx("button",{onClick:a,className:`p-2 rounded-full ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-6",children:[I&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-600 mb-4"}),e.jsx("p",{className:"text-lg",children:"加载游戏数据..."})]}),e.jsx(Y,{mode:"wait",children:d==="menu"&&!I&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"欢迎来到文化元素连连看"}),e.jsx("p",{className:`${t?"text-gray-400":"text-gray-600"}`,children:"通过匹配相同的文化元素卡片，了解中国传统文化和天津地方特色"})]}),g&&e.jsxs("div",{className:`mb-6 p-4 rounded-lg ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"游戏进度"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"已完成关卡"}),e.jsx("p",{className:"text-xl font-bold",children:g.completedLevels.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"总得分"}),e.jsx("p",{className:"text-xl font-bold",children:g.totalScore})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"可用提示"}),e.jsx("p",{className:"text-xl font-bold",children:g.unlockedHints})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"关卡总数"}),e.jsx("p",{className:"text-xl font-bold",children:p.length})]})]})]}),e.jsx("h3",{className:"text-lg font-medium mb-4",children:"选择关卡"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(s=>{const l=(g==null?void 0:g.completedLevels.includes(s.id))||!1,r=!i||f.isLevelUnlocked(i.id,s.id);return e.jsxs(N.div,{className:`p-4 rounded-lg border cursor-pointer transition-all ${t?"border-gray-700":"border-gray-200"} ${r?"hover:shadow-md":"opacity-50 cursor-not-allowed"}`,whileHover:r?{y:-4}:{},onClick:()=>r&&te(s),children:[s.imageUrl&&e.jsxs("div",{className:"relative aspect-video overflow-hidden rounded-lg mb-3",children:[e.jsx(W,{src:s.imageUrl,alt:s.name,className:"w-full h-full object-cover transition-transform hover:scale-105",ratio:"landscape",fit:"cover"}),l&&e.jsx("div",{className:"absolute top-2 right-2 bg-green-600 text-white text-xs px-2 py-1 rounded-full",children:"已完成"}),!r&&e.jsx("div",{className:"absolute top-2 right-2 bg-gray-600 text-white text-xs px-2 py-1 rounded-full",children:"未解锁"})]}),e.jsx("h4",{className:"font-medium mb-1",children:s.name}),e.jsx("p",{className:`text-sm mb-2 ${t?"text-gray-400":"text-gray-600"}`,children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-gray-700":"bg-gray-100"}`,children:s.difficulty.toUpperCase()}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-gray-700":"bg-gray-100"}`,children:[s.gridSize.rows,"x",s.gridSize.cols]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-gray-700":"bg-gray-100"}`,children:s.culturalTheme})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs font-medium",children:[s.cards.length/2," 对卡片"]}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-yellow-900 bg-opacity-30 text-yellow-200":"bg-yellow-100 text-yellow-800"}`,children:["奖励: ",s.reward]})]})]},s.id)})})]},"menu")}),e.jsx(Y,{mode:"wait",children:d==="playing"&&o&&!I&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-medium",children:o.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Q,className:`px-3 py-1 rounded-lg text-sm transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"返回菜单"}),e.jsxs("button",{onClick:ee,disabled:!g||g.unlockedHints<=0,className:`px-3 py-1 rounded-lg text-sm transition-colors ${t?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx("i",{className:"fas fa-lightbulb mr-1"}),"提示 (",(g==null?void 0:g.unlockedHints)||0,")"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:`p-2 rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("span",{className:"text-xs block mb-1",children:"匹配进度"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:_}),e.jsxs("span",{className:"text-xs",children:["/ ",o.cards.length/2," 对"]})]})]}),e.jsxs("div",{className:`p-2 rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("span",{className:"text-xs block mb-1",children:"当前得分"}),e.jsx("span",{className:"font-medium",children:q})]}),e.jsxs("div",{className:`p-2 rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("span",{className:"text-xs block mb-1",children:"用时"}),e.jsx("span",{className:"font-medium",children:D(ae)})]})]})]}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${o.gridSize.cols}, minmax(60px, 100px))`,gridTemplateRows:`repeat(${o.gridSize.rows}, minmax(60px, 100px))`},children:w.map((s,l)=>e.jsx(N.div,{className:"relative w-full h-full perspective",onClick:()=>Z(l),children:e.jsx(N.div,{className:`w-full h-full rounded-lg overflow-hidden cursor-pointer ${s.isMatched?"opacity-0":"opacity-100"}`,animate:{opacity:s.isMatched?0:1,scale:s.isMatched?.8:1},transition:{duration:.3},children:e.jsxs(N.div,{className:"relative w-full h-full transition-transform duration-500 transform-style-3d",animate:{rotateY:s.isFlipped?180:0},style:{transformStyle:"preserve-3d"},children:[e.jsx("div",{className:`absolute inset-0 backface-hidden flex items-center justify-center rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,style:{backfaceVisibility:"hidden"},children:e.jsx("i",{className:"fas fa-question text-2xl"})}),e.jsxs("div",{className:`absolute inset-0 backface-hidden flex flex-col items-center justify-center p-2 rounded-lg ${t?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"} ${s.isHinted?"ring-2 ring-yellow-500":""}`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:[e.jsx(W,{src:s.card.imageUrl,alt:s.card.name,className:"w-full h-24 object-cover rounded mb-2",ratio:"auto",fit:"cover",priority:!0}),e.jsx("span",{className:"text-xs font-medium text-center",children:s.card.name})]})]})})},s.card.id))})})]},"playing")}),e.jsx(Y,{mode:"wait",children:d==="completed"&&o&&g&&!I&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"text-center",children:[e.jsx(N.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:"mb-6",children:e.jsx("i",{className:"fas fa-trophy text-6xl text-yellow-500"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"恭喜完成关卡！"}),e.jsxs("p",{className:`mb-6 ${t?"text-gray-400":"text-gray-600"}`,children:["你成功完成了「",o.name,"」关卡"]}),e.jsx("div",{className:`p-4 rounded-lg mb-6 ${t?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"最终得分"}),e.jsx("p",{className:"text-xl font-bold",children:q})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"完成时间"}),e.jsx("p",{className:"text-xl font-bold",children:D(X||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"匹配对数"}),e.jsxs("p",{className:"text-xl font-bold",children:[_," / ",o.cards.length/2]})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"历史最佳"}),e.jsx("p",{className:"text-xl font-bold",children:g.bestTimes[o.id]?D(g.bestTimes[o.id]):"-"})]})]})}),e.jsxs("div",{className:`p-4 rounded-lg mb-6 ${t?"bg-yellow-900 bg-opacity-30":"bg-yellow-100"} border ${t?"border-yellow-700":"border-yellow-200"}`,children:[e.jsx("h3",{className:"font-medium mb-2",children:"获得奖励"}),e.jsx("p",{className:t?"text-yellow-200":"text-yellow-800",children:o.reward})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{onClick:se,className:`px-4 py-2 rounded-lg transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"重新挑战"}),e.jsx("button",{onClick:Q,className:`px-4 py-2 rounded-lg transition-colors ${t?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white`,children:"返回关卡选择"})]})]},"completed")})]})]})}):null};export{pe as default};
