<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- 全局错误防护脚本 - 极简版本 -->
    <script>
      // 最直接的解决方案：在所有脚本加载前，确保knowledge和lazilyLoaded对象存在
      // 这种方式比任何复杂的保护机制都更可靠
      console.log('Initializing global objects...');
      
      // 直接在全局作用域创建这些对象，确保任何脚本都能访问到
      // 即使在非浏览器环境（如SSR）中也不会出错
      if (typeof window !== 'undefined') {
        // 直接赋值，确保它们总是存在
        window.knowledge = {};
        window.lazilyLoaded = {};
        
        // 验证初始化结果
        console.log('Global objects initialized:');
        console.log('- window.knowledge:', typeof window.knowledge, window.knowledge);
        console.log('- window.lazilyLoaded:', typeof window.lazilyLoaded, window.lazilyLoaded);
      }
      
      // 捕获并显示所有错误，便于调试
      window.addEventListener('error', function(event) {
        console.error('Global error:', event.message, 'at', event.filename + ':' + event.lineno + ':' + event.colno);
        console.error('Error details:', event);
      });
      
      console.log('Global protection initialized.');
    </script>

    <title>津脉智坊 - 津门老字号共创平台</title>
    <!-- 页面描述 -->
    <meta name="theme-color" content="#2563eb" />
    <meta name="description" content="津门老字号共创平台，传承与创新的桥梁" />
    
    <!-- 优化资源加载策略 -->
    
    <!-- 1. DNS预解析 - 提前解析关键域名 -->
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" />
    <link rel="dns-prefetch" href="https://images.unsplash.com" />
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    
    <!-- 2. 预连接 - 建立与关键资源服务器的连接 -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
    <link rel="preconnect" href="https://images.unsplash.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- 3. 预加载关键字体资源 -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- 4. 移除构建时可能导致问题的预加载资源 -->
    <!-- 这些资源会在构建过程中被正确处理，不需要手动预加载 -->
    
    <!-- 6. 预加载关键图片资源 -->
    <link rel="preload" href="./icons/icon-192x192.svg" as="image" type="image/svg+xml" />
    
    <!-- 图标配置 -->
    <link rel="icon" href="./icons/icon-192x192.svg" type="image/svg+xml" sizes="192x192" />
    <link rel="icon" href="./icons/icon-512x512.svg" type="image/svg+xml" sizes="512x512" />
    <link rel="apple-touch-icon" href="./icons/icon-192x192.svg" />
    <!-- 兼容旧浏览器 -->
    <link rel="shortcut icon" href="./icons/icon-192x192.svg" type="image/svg+xml" />
    
    <!-- iOS 相关配置 -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="津脉智坊" />
    <!-- Vercel 分析配置 -->
    <meta name="analytics-web-vitals" content="yes" />
    <!-- 修复mobile-web-app-capable配置 -->
    <meta name="mobile-web-app-capable" content="yes" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
