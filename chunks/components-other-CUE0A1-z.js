import{r as e,j as t,m as s,o as a,t as i,A as r,u as n,N as l,i as o,l as c,R as d,P as m,a as g,C as h,p,T as u,B as x,b as y,X as b,Y as f,c as v,g as j,q as N,s as w,L as _}from"./vendor-react-7rlDZYVK.js";import{u as k,t as S}from"./components-analytics-D0Glag6r.js";import{s as C,A as T}from"./components-admin-u5o8ISLL.js";import{L as E,p as I}from"./components-media-BNdY5qC-.js";import"./components-layout-Bz7ZwRP6.js";import{i as R}from"./i18n-CPi6PAmy.js";import{c as D}from"./vendor-other-CRhi5s5X.js";const A=({children:i,onClick:r,primary:n=!1,className:l="",ariaLabel:o,type:c="button",variant:d,size:m="md",loading:g=!1,disabled:h=!1,fullWidth:p=!1,leftIcon:u,rightIcon:x})=>{const{isDark:y=!1}=k()||{},b=a(),f=e.useMemo(()=>({rest:{scale:1,transition:{duration:.25}},hover:{scale:1.03,y:-2,transition:{duration:.25,type:"spring",stiffness:380,damping:14}}}),[]),v=e.useMemo(()=>({sm:"px-3 py-2 text-sm min-h-[44px] sm:px-3 sm:py-2 md:px-3 md:py-2",md:"px-3 py-2.5 text-sm min-h-[44px] sm:px-4 sm:py-2.5 md:px-4 md:py-2.5",lg:"px-4 py-3 text-base min-h-[48px] sm:px-5 sm:py-3 md:px-5 md:py-3"}),[]),j=e.useMemo(()=>d||(n?"primary":"secondary"),[d,n]),N=e.useMemo(()=>({primary:"bg-[var(--color-primary)] hover:bg-[var(--color-primary)]/90",secondary:"bg-[var(--bg-secondary)] hover:bg-[var(--bg-hover)] ring-1 ring-[var(--border-primary)]",danger:"bg-[var(--color-danger, #ef4444)] hover:bg-[var(--color-danger, #dc2626)]",ghost:"bg-transparent hover:bg-[var(--bg-hover)] ring-1 ring-[var(--border-secondary)]",heritage:"bg-gradient-to-r from-red-700 to-amber-500 hover:from-red-600 hover:to-amber-600"}),[y]),w=e.useMemo(()=>({primary:"text-white",secondary:"text-[var(--text-primary)]",danger:"text-white",ghost:"text-[var(--text-secondary)]",heritage:"text-white"}),[y]),_=e.useMemo(()=>h||g?"opacity-60 cursor-not-allowed":"",[h,g]),S=e.useMemo(()=>p?"w-full":"",[p]),C=e.useMemo(()=>`rounded-lg font-medium transition-colors relative overflow-hidden focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500 ${v[m]} ${N[j]} ${w[j]} ${S} ${_} ${l}`,[m,N,j,w,S,_,l,v]);return t.jsxs(s.button,{variants:f,initial:b?void 0:"rest",whileHover:h||g||b?void 0:"hover",whileTap:h||g||b?void 0:{scale:.98},onClick:h||g?void 0:r,type:c,"aria-label":o,"aria-busy":g,disabled:h||g,className:C,children:[!h&&!g&&!b&&t.jsx(s.div,{className:"absolute inset-0 bg-white opacity-20 rounded-full scale-0 origin-center",initial:{scale:0},whileTap:{scale:4,opacity:0,transition:{duration:.6}}}),t.jsxs("span",{className:"relative z-10 inline-flex items-center gap-2",children:[g&&t.jsx("span",{className:"inline-block w-4 h-4 border-2 border-white/70 border-t-transparent rounded-full animate-spin","aria-hidden":"true"}),u,t.jsx("span",{children:i}),x]})]})},P=()=>t.jsxs("div",{className:"flex items-center my-8",children:[t.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-blue-600 to-transparent"}),t.jsxs("div",{className:"mx-4 relative",children:[t.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center text-white font-bold",children:"津"}),t.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-yellow-500 rounded-full opacity-50"}),t.jsx("div",{className:"absolute -bottom-2 -left-2 w-6 h-6 bg-blue-600 rounded-full opacity-50"})]}),t.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-blue-600 to-transparent"})]}),z=({children:a,color:i="blue",className:r=""})=>{const{isDark:n=!1}=k()||{},l=e.useMemo(()=>({blue:`bg-[var(--color-blue, ${n?"#1e3a8a":"#dbeafe"})] text-[var(--color-blue-text, ${n?"#93c5fd":"#1e40af"})] border-[var(--color-blue-border, ${n?"#3b82f6":"#bfdbfe"})]`,red:`bg-[var(--color-red, ${n?"#7f1d1d":"#fee2e2"})] text-[var(--color-red-text, ${n?"#fca5a5":"#dc2626"})] border-[var(--color-red-border, ${n?"#ef4444":"#fecaca"})]`,green:`bg-[var(--color-green, ${n?"#166534":"#dcfce7"})] text-[var(--color-green-text, ${n?"#86efac":"#15803d"})] border-[var(--color-green-border, ${n?"#22c55e":"#bbf7d0"})]`,yellow:`bg-[var(--color-yellow, ${n?"#92400e":"#fef3c7"})] text-[var(--color-yellow-text, ${n?"#fde68a":"#b45309"})] border-[var(--color-yellow-border, ${n?"#f59e0b":"#fde68a"})]`}),[n]),o=e.useMemo(()=>`inline-flex items-center px-3 py-1 text-sm font-medium rounded-full border transform rotate-1 ${l[i]} ${r}`,[l,i,r]);return t.jsx(s.span,{className:o,whileHover:{scale:1.05,rotate:-1},whileTap:{scale:.95},children:a})},$=({children:e,className:a=""})=>t.jsx(s.div,{initial:{x:"100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"-100%",opacity:0},transition:{duration:.5,ease:"easeInOut"},className:a,children:e}),L=({src:s,alt:a,className:i="",ratio:r="auto",rounded:n="xl",withBorder:l=!1,badge:o,fit:c="cover",position:d,onClick:m,loading:g="lazy",imageTag:h,priority:p=!1,quality:u="medium",disableFallback:x=!1,fallbackSrc:y,onLoad:b,onError:f})=>{const{isDark:v=!1}=k()||{},j=e.useMemo(()=>({none:"",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl",full:"rounded-full"}),[]),N=e.useMemo(()=>`relative overflow-hidden ${j[n]} ${i} ${l?v?"ring-1 ring-gray-700":"ring-1 ring-gray-200":""} cursor-pointer sm:max-w-full md:max-w-full lg:max-w-full`,[j,n,i,l,v]);return t.jsxs("div",{className:N,onClick:m,children:[t.jsx(E,{src:s,alt:a,className:"w-full h-full",ratio:r,fit:c,position:d,loading:g,priority:p,quality:u,onLoad:b,onError:f,disableFallback:x,fallbackSrc:y||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iMTAwIiBmaWxsPSIjZmZmZmZmIi8+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iNzAiIGZpbGw9IiM2NjY2NjYiLz4KPHN2ZyB4PSI3MCIgeT0iNzAiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgZmlsbD0ibm9uZSI+CjxyZWN0IHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iODAiIHk9IjgwIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIGZpbGw9IiNkY2RjZGMiLz4KPHJlY3QgeD0iOTAuNSIgeT0iOTEiIHdpZHRoPSIxOSIgaGVpZ2h0PSIxOCIgc3Ryb2tlPSIjNzc3Nzc3IiBzdHJva2Utb3BhY2l0eT0iMC41IiBzdHJva2Utd2lkdGg9IjIiLz4KPC9zdmc+Cjwvc3ZnPg=="}),o&&t.jsx("span",{className:`absolute top-3 left-3 text-xs px-2 py-1 rounded-full ${v?"bg-gray-800/70 ring-1 ring-gray-700 text-gray-200":"bg-white/80 ring-1 ring-gray-200 text-gray-700"} backdrop-blur-sm`,children:o}),h&&t.jsx("span",{className:`absolute bottom-2 right-2 text-xs px-2 py-1 rounded-full ${v?"bg-gray-800/90 ring-1 ring-gray-700 text-gray-200":"bg-white/90 ring-1 ring-gray-200 text-gray-700"} backdrop-blur-sm z-50`,style:{fontSize:"10px",fontWeight:"bold"},children:"unsplash"===h?"Unsplash":h.split("_").find(e=>["png","jpg","jpeg","gif","webp"].includes(e))||""})]})},O=({src:a,alt:i,className:r="",size:n="md",online:l=!1,onClick:o,withBorder:c=!0,variant:d="default",position:m="center"})=>{const{isDark:g=!1}=k()||{},h=e.useMemo(()=>({xs:"w-6 h-6",sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12",xl:"w-16 h-16"}),[]),p=e.useMemo(()=>({default:c?g?"ring-2 ring-gray-700":"ring-2 ring-gray-300":"",gradient:c?g?"ring-2 ring-blue-500/60":"ring-2 ring-blue-600":"",heritage:c?g?"ring-2 ring-red-500/60":"ring-2 ring-red-600":""}),[c,g]),u=e.useMemo(()=>`relative ${h[n]} ${r} cursor-pointer group transition-all duration-300`,[h,n,r]);return t.jsxs("div",{className:u,onClick:o,children:["gradient"===d&&t.jsx(s.div,{className:"absolute inset-[-2px] rounded-full bg-gradient-to-r from-red-500 via-blue-500 to-green-500 blur-sm opacity-70",initial:{scale:.95},whileHover:{scale:1.1},animate:{opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),"heritage"===d&&t.jsx(s.div,{className:"absolute inset-[-3px] rounded-full border-2 border-dashed border-red-500/60 opacity-80",whileHover:{rotate:5,scale:1.05},animate:{rotate:[0,360]},transition:{duration:15,repeat:1/0,ease:"linear"}}),t.jsxs(s.div,{className:`relative z-10 w-full h-full rounded-full overflow-hidden ${p[d]}`,whileHover:{scale:1.05},transition:{type:"spring",stiffness:300,damping:15},children:[t.jsx(E,{src:a,alt:i,className:"w-full h-full object-cover object-center transition-transform duration-300 group-hover:scale-105",ratio:"square",fit:"cover",position:m,loading:"lazy"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),l&&t.jsx(s.span,{className:`absolute bottom-0 right-0 w-2.5 h-2.5 rounded-full bg-green-500 ${g?"ring-2 ring-gray-800":"ring-2 ring-white"} z-20`,initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:t.jsx(s.span,{className:"absolute inset-[-2px] rounded-full bg-green-500 opacity-50",animate:{scale:[1,2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})})]})},M={maxConcurrentTasks:3,defaultPriority:"medium",retryAttempts:2,retryDelay:1e3},q=new class{queue=[];runningTasks=new Set;config;taskIdCounter=0;isProcessing=!1;taskExecutors={};constructor(e){this.config={...M,...e}}generateTaskId(){return`task_${Date.now()}_${this.taskIdCounter++}`}addTask(e,t,s){const a={id:this.generateTaskId(),type:e,prompt:t,priority:s?.priority||this.config.defaultPriority,status:"pending",createdAt:Date.now(),metadata:s?.metadata,onProgress:s?.onProgress,onComplete:s?.onComplete,onError:s?.onError};return this.queue.push(a),this.queue.sort((e,t)=>{const s={urgent:4,high:3,medium:2,low:1};return s[t.priority]-s[e.priority]||e.createdAt-t.createdAt}),this.processQueue(),a}async processQueue(){if(!(this.isProcessing||0===this.queue.length||this.runningTasks.size>=this.config.maxConcurrentTasks)){this.isProcessing=!0;try{const e=this.queue.find(e=>"pending"===e.status);if(!e)return void(this.isProcessing=!1);e.status="running",e.startedAt=Date.now(),this.runningTasks.add(e.id),this.queue=this.queue.filter(t=>t.id!==e.id),await this.executeTask(e)}finally{this.isProcessing=!1,this.processQueue()}}}registerTaskExecutor(e,t){this.taskExecutors[e]=t}async executeTask(e){let t,s=0;for(;s<=this.config.retryAttempts;)try{const t=this.taskExecutors[e.type];if(!t)throw new Error(`No executor registered for task type: ${e.type}`);const s=await t(e);return e.status="completed",e.completedAt=Date.now(),e.result={success:!0,data:s},e.onComplete&&e.onComplete(e.result),void this.runningTasks.delete(e.id)}catch(a){if(s++,t=a instanceof Error?a.message:"Unknown error",s<=this.config.retryAttempts){const e=this.config.retryDelay*Math.pow(2,s-1);await new Promise(t=>setTimeout(t,e))}}e.status="failed",e.completedAt=Date.now(),e.error=t,e.onError&&e.onError(t||"Unknown error"),this.runningTasks.delete(e.id)}getTaskStatus(e){const t=this.queue.find(t=>t.id===e);return t?t.status:this.runningTasks.has(e)?"running":void 0}getAllTasks(){return[...this.queue]}cancelTask(e){const t=this.queue.findIndex(t=>t.id===e);return-1!==t?(this.queue[t].status="cancelled",this.queue.splice(t,1),!0):!!this.runningTasks.has(e)&&(this.runningTasks.delete(e),!0)}getQueueStats(){return{totalTasks:this.queue.length+this.runningTasks.size,pendingTasks:this.queue.length,runningTasks:this.runningTasks.size,byStatus:{pending:this.queue.filter(e=>"pending"===e.status).length,running:this.runningTasks.size,completed:this.queue.filter(e=>"completed"===e.status).length,failed:this.queue.filter(e=>"failed"===e.status).length,cancelled:this.queue.filter(e=>"cancelled"===e.status).length},byPriority:{low:this.queue.filter(e=>"low"===e.priority).length,medium:this.queue.filter(e=>"medium"===e.priority).length,high:this.queue.filter(e=>"high"===e.priority).length,urgent:this.queue.filter(e=>"urgent"===e.priority).length}}}clearQueue(){this.queue=[],this.runningTasks.clear()}setMaxConcurrentTasks(e){this.config.maxConcurrentTasks=e,this.processQueue()}},U=new class{metrics=[];networkRequests=[];componentRenders=[];memoryUsage=[];observers=[];isInitialized=!1;memoryMonitoringInterval=null;componentRenderCounts=new Map;init(){this.isInitialized||(this.setupWebVitalsObserver(),this.isInitialized=!0)}cleanup(){for(const e of this.observers)e.disconnect();this.observers=[],this.memoryMonitoringInterval&&(clearInterval(this.memoryMonitoringInterval),this.memoryMonitoringInterval=null),this.isInitialized=!1}setupWebVitalsObserver(){if("PerformanceObserver"in window)try{const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{if("measure"===e.entryType){const t=e;this.isWebVital(t.name)&&this.recordMetric({name:t.name,value:t.duration,unit:"ms",description:this.getWebVitalDescription(t.name),timestamp:Date.now(),category:"web-vitals"})}else if("largest-contentful-paint"===e.entryType){const t=e;this.recordMetric({name:"LCP",value:t.renderTime||t.loadTime||0,unit:"ms",description:"Largest Contentful Paint",timestamp:Date.now(),category:"web-vitals",metadata:{element:t.element?.tagName,size:t.size}})}else if("layout-shift"===e.entryType){const t=e;t.hadRecentInput||this.recordMetric({name:"CLS",value:t.value,unit:"count",description:"Cumulative Layout Shift",timestamp:Date.now(),category:"web-vitals"})}else if("first-input"===e.entryType){const t=e;this.recordMetric({name:"FID",value:t.processingStart-t.startTime,unit:"ms",description:"First Input Delay",timestamp:Date.now(),category:"web-vitals",metadata:{target:t.target?.tagName,type:t.type}})}else if("event"===e.entryType){const t=e;this.recordMetric({name:"INP",value:t.duration,unit:"ms",description:"Interaction to Next Paint",timestamp:Date.now(),category:"web-vitals",metadata:{target:t.target?.tagName,type:t.type}})}})});e.observe({type:"measure",buffered:!0}),e.observe({type:"largest-contentful-paint",buffered:!0}),e.observe({type:"layout-shift",buffered:!0}),e.observe({type:"first-input",buffered:!0}),e.observe({type:"event",buffered:!0}),this.observers.push(e)}catch(e){}}setupResourceObserver(){if("PerformanceObserver"in window)try{const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric({name:`resource-${e.name.split("/").pop()}`,value:e.duration,unit:"ms",description:`${e.initiatorType} resource load time`,timestamp:Date.now(),category:"resource",metadata:{url:e.name,initiatorType:e.initiatorType,transferSize:e.transferSize,encodedBodySize:e.encodedBodySize,decodedBodySize:e.decodedBodySize}})})});e.observe({type:"resource",buffered:!0}),this.observers.push(e)}catch(e){}}setupNavigationObserver(){if("PerformanceObserver"in window)try{const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric({name:"TTFB",value:e.responseStart,unit:"ms",description:"Time to First Byte",timestamp:Date.now(),category:"navigation"}),this.recordMetric({name:"DOMContentLoaded",value:e.domContentLoadedEventEnd-e.startTime,unit:"ms",description:"DOM Content Loaded Time",timestamp:Date.now(),category:"navigation"}),this.recordMetric({name:"LoadEvent",value:e.loadEventEnd-e.startTime,unit:"ms",description:"Load Event Time",timestamp:Date.now(),category:"navigation"})})});e.observe({type:"navigation",buffered:!0}),this.observers.push(e)}catch(e){}}setupLongTaskObserver(){if("PerformanceObserver"in window)try{const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{e.duration>50&&this.recordMetric({name:"LongTask",value:e.duration,unit:"ms",description:"Long Task Duration",timestamp:Date.now(),category:"long-task",metadata:{sources:e.attribution.map(e=>({type:e.entryType,name:e.name,duration:e.duration}))}})})});e.observe({type:"longtask",buffered:!0}),this.observers.push(e)}catch(e){}}setupMemoryMonitoring(){"performance"in window&&"memory"in performance&&(this.recordMemoryUsage(),this.memoryMonitoringInterval=setInterval(()=>{this.recordMemoryUsage()},3e4))}recordMemoryUsage(){if("performance"in window&&"memory"in performance){const e=performance.memory,t={usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit,timestamp:Date.now()};this.memoryUsage.push(t),this.memoryUsage.length>100&&(this.memoryUsage=this.memoryUsage.slice(-50)),this.recordMetric({name:"MemoryUsage",value:e.usedJSHeapSize,unit:"bytes",description:"Used JavaScript Heap Size",timestamp:Date.now(),category:"memory",metadata:{totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit,usagePercentage:e.usedJSHeapSize/e.jsHeapSizeLimit*100}})}}isWebVital(e){return["LCP","FID","CLS","TTFB","INP"].includes(e)}getWebVitalDescription(e){return{LCP:"Largest Contentful Paint",FID:"First Input Delay",CLS:"Cumulative Layout Shift",TTFB:"Time to First Byte",INP:"Interaction to Next Paint"}[e]||e}recordMetric(e){this.isWebVital(e.name)&&(this.metrics.push(e),this.metrics.length>500&&(this.metrics=this.metrics.slice(-200)))}recordNetworkRequest(e){}recordComponentRender(e){}getMetrics(){return[...this.metrics]}getNetworkRequests(){return[...this.networkRequests]}getComponentRenders(){return[...this.componentRenders]}getMemoryUsage(){return[...this.memoryUsage]}clearMetrics(){this.metrics=[],this.networkRequests=[],this.componentRenders=[],this.memoryUsage=[],this.componentRenderCounts.clear()}clearNetworkRequests(){this.networkRequests=[]}clearComponentRenders(){this.componentRenders=[],this.componentRenderCounts.clear()}clearMemoryUsage(){this.memoryUsage=[]}getComponentRenderStats(){const e=new Map;for(const t of this.componentRenders){e.has(t.componentName)||e.set(t.componentName,{renderCount:0,averageRenderTime:0,minRenderTime:1/0,maxRenderTime:0,initialRenderTime:t.isInitialRender?t.renderTime:null});const s=e.get(t.componentName);s.renderCount++,s.averageRenderTime=(s.averageRenderTime*(s.renderCount-1)+t.renderTime)/s.renderCount,s.minRenderTime=Math.min(s.minRenderTime,t.renderTime),s.maxRenderTime=Math.max(s.maxRenderTime,t.renderTime),t.isInitialRender&&(s.initialRenderTime=t.renderTime)}return Object.fromEntries(e)}getNetworkRequestStats(){const e={totalRequests:this.networkRequests.length,averageDuration:0,averageSize:0,cacheHitRate:0,successRate:0,methods:new Map,statusCodes:new Map};if(0===e.totalRequests)return e;let t=0,s=0,a=0,i=0;for(const r of this.networkRequests)e.methods.set(r.method,(e.methods.get(r.method)||0)+1),e.statusCodes.set(r.status,(e.statusCodes.get(r.status)||0)+1),r.fromCache&&t++,r.status>=200&&r.status<300&&s++,a+=r.duration,i+=r.size;return e.averageDuration=a/e.totalRequests,e.averageSize=i/e.totalRequests,e.cacheHitRate=t/e.totalRequests,e.successRate=s/e.totalRequests,{...e,methods:Object.fromEntries(e.methods),statusCodes:Object.fromEntries(e.statusCodes)}}measureExecutionTime(e,t){const s=performance.now(),a=t(),i=performance.now();return this.recordMetric({name:e,value:i-s,unit:"ms",description:`Execution time for ${e}`,timestamp:Date.now()}),a}startMeasure(e){performance.mark(`${e}-start`)}endMeasure(e){performance.mark(`${e}-end`),performance.measure(e,`${e}-start`,`${e}-end`);const t=performance.getEntriesByName(e).pop();t&&this.recordMetric({name:e,value:t.duration,unit:"ms",description:`Performance measure for ${e}`,timestamp:Date.now()}),performance.clearMarks(`${e}-start`),performance.clearMarks(`${e}-end`),performance.clearMeasures(e)}async runAudit(){try{await new Promise(e=>setTimeout(e,1e3));const e=performance.getEntriesByType("navigation")[0],t=performance.getEntriesByType("resource"),s=performance.getEntriesByType("longtask");return{timestamp:Date.now(),metrics:{LCP:this.getMetricValue("LCP")||0,FID:this.getMetricValue("FID")||0,CLS:this.getMetricValue("CLS")||0,TTFB:e?.responseStart||0,INP:this.getMetricValue("INP")||0,navigationStart:e?.startTime||0,domContentLoaded:e?.domContentLoadedEventEnd||0,loadEvent:e?.loadEventEnd||0,totalResources:t.length,totalResourceSize:t.reduce((e,t)=>e+(t.transferSize||0),0),longTasks:s.length,totalLongTaskDuration:s.reduce((e,t)=>e+t.duration,0),networkRequests:this.networkRequests.length,averageRequestDuration:this.getNetworkRequestStats().averageDuration,cacheHitRate:this.getNetworkRequestStats().cacheHitRate,componentRenders:this.componentRenders.length,averageComponentRenderTime:this.componentRenders.length>0?this.componentRenders.reduce((e,t)=>e+t.renderTime,0)/this.componentRenders.length:0,memoryUsage:this.memoryUsage.length>0?this.memoryUsage[this.memoryUsage.length-1].usedJSHeapSize:0,customMetrics:this.metrics},score:this.calculatePerformanceScore(),suggestions:this.generateOptimizationSuggestions(),detailedStats:{network:this.getNetworkRequestStats(),components:this.getComponentRenderStats(),memory:this.memoryUsage.length>0?this.memoryUsage[this.memoryUsage.length-1]:void 0}}}catch(e){return{timestamp:Date.now(),metrics:{LCP:0,FID:0,CLS:0,TTFB:0,INP:0,navigationStart:0,domContentLoaded:0,loadEvent:0,totalResources:0,totalResourceSize:0,longTasks:0,totalLongTaskDuration:0,networkRequests:0,averageRequestDuration:0,cacheHitRate:0,componentRenders:0,averageComponentRenderTime:0,memoryUsage:0,customMetrics:[]},score:0,suggestions:[],detailedStats:{network:this.getNetworkRequestStats(),components:this.getComponentRenderStats(),memory:void 0}}}}getMetricValue(e){const t=this.metrics.find(t=>t.name===e);return t?.value}calculatePerformanceScore(){let e=100;const t=this.getMetricValue("LCP")||0;t>4e3?e-=30:t>2500&&(e-=15);const s=this.getMetricValue("FID")||0;s>300?e-=25:s>100&&(e-=10);const a=this.getMetricValue("CLS")||0;a>.25?e-=25:a>.1&&(e-=10);const i=this.getMetricValue("INP")||0;return i>500?e-=20:i>200&&(e-=10),Math.max(0,Math.min(100,e))}generateOptimizationSuggestions(){const e=[],t=this.getMetricValue("LCP")||0,s=this.getMetricValue("FID")||0,a=this.getMetricValue("CLS")||0,i=this.getMetricValue("INP")||0;return t>2500&&e.push("优化最大内容绘制 (LCP)：考虑优化图片大小、使用 CDN 或预加载关键资源"),s>100&&e.push("优化首次输入延迟 (FID)：减少主线程阻塞，考虑代码分割或懒加载"),a>.1&&e.push("优化累积布局偏移 (CLS)：为图片添加固定尺寸，避免动态插入内容"),i>200&&e.push("优化交互到下一次绘制 (INP)：减少事件处理器执行时间，使用防抖/节流"),e}};U.recordMetric.bind(U);const H=U.recordNetworkRequest.bind(U);U.recordComponentRender.bind(U),U.getMetrics.bind(U),U.getNetworkRequests.bind(U),U.getComponentRenders.bind(U),U.getMemoryUsage.bind(U),U.getComponentRenderStats.bind(U),U.getNetworkRequestStats.bind(U),U.clearMetrics.bind(U),U.clearNetworkRequests.bind(U),U.clearComponentRenders.bind(U),U.clearMemoryUsage.bind(U),U.measureExecutionTime.bind(U),U.startMeasure.bind(U),U.endMeasure.bind(U),U.runAudit.bind(U),U.cleanup.bind(U);const F=[],K=new class{cache=new Map;cleanupInterval=null;stats={hits:0,misses:0,sets:0,deletes:0,evictions:0,size:0};storage=null;storageType;storagePrefix="api_cache_";constructor(e="memory"){this.storageType=e,"undefined"!=typeof window&&("session"===e?this.storage=sessionStorage:"local"===e&&(this.storage=localStorage),this.loadFromStorage()),this.cleanupInterval=setInterval(()=>this.cleanupExpired(),12e4)}loadFromStorage(){if(this.storage)try{for(let e=0;e<this.storage.length;e++){const t=this.storage.key(e);if(t&&t.startsWith(this.storagePrefix)){const e=t.replace(this.storagePrefix,""),s=this.storage.getItem(t);if(s){const t=JSON.parse(s);this.cache.set(e,t)}}}this.stats.size=this.cache.size}catch(e){}}saveToStorage(e,t){if(this.storage)try{this.storage.setItem(this.storagePrefix+e,JSON.stringify(t))}catch(s){this.cleanupExpired()}}removeFromStorage(e){if(this.storage)try{this.storage.removeItem(this.storagePrefix+e)}catch(t){}}get(e,t){const s=this.cache.get(e);if(!s)return this.stats.misses++,null;const a=Date.now(),i=a-s.timestamp>s.ttl;return(i&&s.staleTtl?a-s.timestamp>s.staleTtl:i)?(this.cache.delete(e),this.removeFromStorage(e),this.stats.evictions++,this.stats.size--,this.stats.misses++,null):(this.stats.hits++,{data:s.data,isStale:i})}set(e,t,s){const a=s?.ttl??6e4,i=s?.staleTtl??2*a,r={data:t,timestamp:Date.now(),ttl:a,staleTtl:i};this.cache.set(e,r),this.saveToStorage(e,r),this.stats.sets++,this.stats.size=this.cache.size}delete(e){this.cache.delete(e),this.removeFromStorage(e),this.stats.deletes++,this.stats.size=this.cache.size}clear(){if(this.cache.clear(),this.storage)try{for(let e=0;e<this.storage.length;e++){const t=this.storage.key(e);t&&t.startsWith(this.storagePrefix)&&this.storage.removeItem(t)}}catch(e){}this.stats.deletes+=this.stats.size,this.stats.size=0}cleanupExpired(){const e=Date.now();let t=0;for(const[s,a]of this.cache.entries())(a.staleTtl?e-a.timestamp>a.staleTtl:e-a.timestamp>a.ttl)&&(this.cache.delete(s),this.removeFromStorage(s),t++);t>0&&(this.stats.evictions+=t,this.stats.size=this.cache.size)}getStats(){return{...this.stats}}getKeys(){return Array.from(this.cache.keys())}prefetch(e,t,s){this.set(e,t,s)}destroy(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}},B=new Map,V=new Map;async function W(e,t){let s;const a=new Promise((e,a)=>{s=setTimeout(()=>a(new Error("timeout")),t)});try{const t=await Promise.race([e,a]);return clearTimeout(s),t}catch(i){throw clearTimeout(s),i}}const Y=(e,t)=>{const s=t.method||"GET",a=t.cache?.key;return a||("GET"===s?`${s}:${e}`:`${s}:${e}:${t.body?JSON.stringify(t.body).substring(0,100):""}`)};async function G(e,t={}){const s=`http://localhost:3010${e}`,a=e,i=t.method||"GET",r={"Content-Type":"application/json",...t.headers||{}},n=t.timeoutMs??1e4,l=t.retries??1,o=Y(e,t),c=t.cache||{},d=!1!==c.enabled&&"GET"===i;let m=null;if(d&&(m=K.get(o,{allowStale:!0}),m))return m.isStale&&g().catch(e=>{}),H({url:s,method:i,duration:0,status:200,size:0,timestamp:Date.now(),fromCache:!0,retries:0}),{ok:!0,status:200,data:m.data,fromCache:!0};async function g(){let m=0,g=!1;const h=["ECONNREFUSED","ECONNRESET","ETIMEDOUT","TIMEOUT","NETWORK_ERROR","fetch failed","Failed to fetch"];for(;m<=l;)try{const l=g?a:s,m=performance.now(),h=Date.now(),p=t.body?JSON.stringify(t.body):"",u=`${i}:${l}:${h}:${p}`,x=await C.generateSignature(u,h),y={...r,"X-Request-Timestamp":h.toString(),"X-Request-Signature":x,"X-Request-Id":C.generateUUID()},b=Date.now(),f=fetch(l,{method:i,headers:y,body:t.body?JSON.stringify(t.body):void 0,signal:t.signal}),v=await W(f,n),j=performance.now()-m,N=v.headers.get("content-length"),w=N?parseInt(N,10):0,_=v.headers.get("content-type");let k,S;if(k=_?.includes("application/json")?await v.json():await v.text(),v.ok){let e;return e="object"==typeof k&&null!==k&&"ok"in k&&"data"in k?k.data:k,d&&v.ok&&K.set(o,e,{ttl:c.ttl,staleTtl:c.staleTtl}),H({url:l,method:i,duration:j,status:v.status,size:w,timestamp:b,fromCache:!1,retries:0}),{ok:!0,status:v.status,data:e,fromCache:!1}}let T=k;S="object"==typeof k&&null!==k?"error"in k?String(k.error||`Request failed with status ${v.status}`):"message"in k?String(k.message||`Request failed with status ${v.status}`):"errors"in k?Array.isArray(k.errors)?k.errors.join(", "):String(k.errors||`Request failed with status ${v.status}`):JSON.stringify(k)||`Request failed with status ${v.status}`:String(k||`Request failed with status ${v.status}`);const E=new Error(S);throw E.status=v.status,E.data=T,E.path=e,E.method=i,H({url:l,method:i,duration:j,status:v.status,size:w,timestamp:b,fromCache:!1,retries:0,error:S}),E}catch(p){if(m++,H({url:g?a:s,method:i,duration:n,status:500,size:0,timestamp:Date.now(),fromCache:!1,retries:m-1,error:p instanceof Error?p.message:"Unknown error"}),m>l||!h.some(e=>p instanceof Error&&p.message.includes(e))){if(!g&&a){g=!0,m=0;continue}return{ok:!1,status:500,error:p.message||"Unknown error",data:null,fromCache:!1}}const e=Math.min(1e3*Math.pow(2,m-1)+500*Math.random(),1e4);await new Promise(t=>setTimeout(t,e))}return{ok:!1,status:500,error:"Max retries exceeded",data:null,fromCache:!1}}const h={path:e,options:t,method:i,url:s,headers:r,body:t.body,signal:t.signal,retries:l,timeoutMs:n,cacheKey:o,isCacheEnabled:d},p=async e=>{if(e>=F.length)return g();const t=F[e];try{return await t.process(h,()=>p(e+1))}catch(s){return{ok:!1,status:500,error:`Middleware ${t.name} failed: ${s instanceof Error?s.message:"Unknown error"}`,data:null,fromCache:!1}}};return p(0)}const Z={get:(e,t)=>G(e,{...t,method:"GET"}),post:(e,t,s)=>G(e,{...s,method:"POST",body:t}),put:(e,t,s)=>G(e,{...s,method:"PUT",body:t}),patch:(e,t,s)=>G(e,{...s,method:"PATCH",body:t}),delete:(e,t)=>G(e,{...t,method:"DELETE"}),middleware:{register:e=>(e=>{F.push(e)})(e),clearAll:()=>{F.length=0},getAll:()=>[...F]},cache:{clear:e=>K.delete(e),clearAll:()=>K.clear(),getKey:(e,t)=>Y(e,t||{method:"GET"}),getStats:()=>K.getStats(),getKeys:()=>K.getKeys(),prefetch:(e,t,s)=>{K.prefetch(e,t,s)},revalidate:(e,t)=>G(e,{...t,method:"GET",cache:{...t?.cache,enabled:!0}})},debounce:{clear:e=>{const t=B.get(e);t&&(clearTimeout(t),B.delete(e))},clearAll:()=>{for(const e of B.values())clearTimeout(e);B.clear()}},throttle:{clear:e=>V.delete(e),clearAll:()=>V.clear()},cancelAll:()=>{},performance:{getCacheStats:()=>K.getStats()}},X={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"sb_publishable_AYUZnzF2LNBPXi2o_3LGbA_7ceksBnv",VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY:"sb_publishable_AYUZnzF2LNBPXi2o_3LGbA_7ceksBnv",VITE_SUPABASE_URL:"https://pptqdicaaewtnaiflfcs.supabase.co"};var J={};const Q=[{id:"kimi",name:"Kimi",description:"Kimi（Moonshot AI），擅长中文长文创作与协作",strengths:["中文对话","长上下文写作","检索增强"],isDefault:!0},{id:"deepseek",name:"DeepSeek",description:"擅长传统纹样生成和文化元素融合",strengths:["中文对话","文化元素融合","设计创意"],isDefault:!1},{id:"qwen",name:"通义千问",description:"阿里云DashScope，中文对话与综合任务表现优秀，支持图像生成",strengths:["中文对话","综合任务","工具调用","图像生成","语音合成"],isDefault:!1}],ee=[{id:"default",name:"默认助手",description:"帮助创作者进行设计构思、文化融合和平台使用的全能助手",system_prompt:"你是一个专注于传统文化创作与设计的全能AI助手，服务于文创平台。请提供详细、具体、有用的回答，帮助用户解决在平台使用过程中遇到的各种问题，包括创作流程、AI生成功能、文化元素融合、作品上传、编辑、分享、推广、数据分析、账户设置等方面。你的回答应该友好、专业、易于理解，并且提供清晰的步骤和建议。同时，你需要具备丰富的传统文化知识，能够为用户提供关于传统纹样、非遗技艺、文化元素创新应用等方面的专业指导。",temperature:.7,top_p:.9,presence_penalty:0,frequency_penalty:0,is_default:!0,created_at:Date.now(),updated_at:Date.now(),tags:["默认","创意","帮助"]},{id:"designer",name:"设计专家",description:"专注于设计领域的专家，提供专业的设计建议和创意",system_prompt:"你是一位资深的设计专家，专注于视觉设计、UI/UX设计、创意设计、文化融合设计和传统元素创新应用。请提供专业、详细、实用的设计建议和创意构思，包括色彩搭配、排版设计、元素运用、风格定位等方面。你的回答应该具体、可操作，并且结合最新的设计趋势和传统美学。",temperature:.8,top_p:.95,presence_penalty:.1,frequency_penalty:.1,is_default:!1,created_at:Date.now(),updated_at:Date.now(),tags:["设计","创意","文化"]},{id:"coder",name:"代码助手",description:"帮助编写和优化代码的助手",system_prompt:"你是一位资深的软件开发工程师，擅长多种编程语言和技术栈。请提供准确、高效、安全的代码解决方案和优化建议。你的回答应该包括完整的代码示例、详细的解释和最佳实践。对于问题，要先理解需求，然后提供清晰、可运行的代码，并解释代码的工作原理和优化点。",temperature:.3,top_p:.8,presence_penalty:0,frequency_penalty:0,is_default:!1,created_at:Date.now(),updated_at:Date.now(),tags:["编程","技术","代码"]},{id:"writer",name:"文案专家",description:"专注于文案创作的专家，提供吸引人的文案建议",system_prompt:"你是一位资深的文案专家，擅长创作各种类型的文案，包括广告文案、营销文案、社交媒体文案、产品描述、品牌故事等。请提供吸引人、有创意、符合品牌调性的文案内容。你的回答应该结合目标受众、传播渠道和营销目标，提供具体、可直接使用的文案示例，并解释文案的创作思路和效果预期。",temperature:.9,top_p:.95,presence_penalty:.2,frequency_penalty:.1,is_default:!1,created_at:Date.now(),updated_at:Date.now(),tags:["文案","创作","营销"]},{id:"teacher",name:"教育导师",description:"提供详细解释和指导的教育导师",system_prompt:"你是一位耐心、详细的教育导师，擅长将复杂的概念简单化，帮助学习者理解各种知识。请提供清晰、详细、循序渐进的解释和指导。你的回答应该包括基本概念、核心原理、实际应用和练习建议，使用通俗易懂的语言和生动的例子，帮助学习者建立完整的知识体系。",temperature:.6,top_p:.85,presence_penalty:0,frequency_penalty:0,is_default:!1,created_at:Date.now(),updated_at:Date.now(),tags:["教育","学习","指导"]}],te={temperature:.7,top_p:.9,max_tokens:2e3,timeout:3e4,system_prompt:"你是一个帮助创作者进行设计构思与文化融合的助手。",max_history:10,stream:!1,kimi_model:"moonshot-v1-32k",kimi_base_url:"https://api.moonshot.cn/v1",retry:2,backoff_ms:800,deepseek_model:"deepseek-chat",deepseek_base_url:"https://api.deepseek.com",presence_penalty:0,frequency_penalty:0,stop:[],doubao_model:"doubao-pro-32k",doubao_base_url:"https://api.doubao.com/v1",wenxin_model:"ERNIE-Speed-8K",wenxin_base_url:"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions",qwen_model:"qwen-plus",qwen_base_url:"https://dashscope.aliyuncs.com/api/v1",chatgpt_model:"gpt-4o",chatgpt_base_url:"https://api.openai.com/v1",gemini_model:"gemini-1.5-flash",gemini_base_url:"https://generativelanguage.googleapis.com/v1",gork_model:"grok-beta",gork_base_url:"https://api.x.ai/v1",zhipu_model:"glm-4-plus",zhipu_base_url:"https://open.bigmodel.cn/api/paas/v4",enable_memory:!0,memory_window:20,context_window:8192,enable_multimodal:!0,image_resolution:"1024x1024",enable_safety_check:!0,safety_level:"medium",current_role_id:"default",personality:"friendly",theme:"auto",customThemeConfig:{primaryColor:"#6366f1",secondaryColor:"#8b5cf6",backgroundColor:"#ffffff",textColor:"#1f2937",accentColor:"#ec4899",borderColor:"#e5e7eb",hoverColor:"#f3f4f6",successColor:"#10b981",warningColor:"#f59e0b",errorColor:"#ef4444",infoColor:"#3b82f6"},show_preset_questions:!0,enable_typing_effect:!0,auto_scroll:!0,shortcut_key:"ctrl+k",enable_notifications:!1},se=new class{currentModel=Q.find(e=>e.isDefault)||Q[0];modelConfig={...te};conversationSessions=[];currentSessionId="";performanceData={};performanceRecords=[];maxPerformanceRecords=1e3;roles=[...ee];currentRole=ee.find(e=>e.is_default)||ee[0];connectionStatus={};connectionStatusListeners=[];responseCache=new Map;cacheExpiryTime=36e5;maxCacheSize=100;cacheStats={hits:0,misses:0,evictions:0,totalRequests:0};constructor(){this.loadConfigFromStorage(),this.loadApiKeysFromEnv(),this.initializeSessions(),this.loadCurrentModelFromStorage(),this.registerTaskExecutors()}registerTaskExecutors(){q.registerTaskExecutor("text",this.executeAITask.bind(this)),q.registerTaskExecutor("image",this.executeAITask.bind(this)),q.registerTaskExecutor("audio",this.executeAITask.bind(this)),q.registerTaskExecutor("video",this.executeAITask.bind(this)),q.registerTaskExecutor("3d",this.executeAITask.bind(this))}loadConfigFromStorage(){try{const e=localStorage.getItem("LLM_CONFIG");if(e){const t=JSON.parse(e);this.modelConfig={...this.modelConfig,...t}}}catch(e){}}loadCurrentModelFromStorage(){try{const e=localStorage.getItem("LLM_CURRENT_MODEL");e&&this.setCurrentModel(e,!0)}catch(e){}}getEnvVar(e){try{if("undefined"!=typeof window&&window.env)return window.env[e];if(void 0!==import.meta)return X?.[e];if("undefined"!=typeof process&&J)return J[e]}catch(t){}}loadApiKeysFromEnv(){const e={kimi_api_key:this.getEnvVar("VITE_KIMI_API_KEY")||this.getEnvVar("KIMI_API_KEY"),deepseek_api_key:this.getEnvVar("VITE_DEEPSEEK_API_KEY")||this.getEnvVar("DEEPSEEK_API_KEY"),qwen_api_key:this.getEnvVar("VITE_QWEN_API_KEY")||this.getEnvVar("QWEN_API_KEY"),openai_api_key:this.getEnvVar("VITE_OPENAI_API_KEY")||this.getEnvVar("OPENAI_API_KEY"),gemini_api_key:this.getEnvVar("VITE_GEMINI_API_KEY")||this.getEnvVar("GEMINI_API_KEY"),zhipu_api_key:this.getEnvVar("VITE_ZHIPU_API_KEY")||this.getEnvVar("ZHIPU_API_KEY")};this.modelConfig={...this.modelConfig,...e}}setCurrentModel(e,t=!1){const s=Q.find(t=>t.id===e);if(s){t||this.clearHistory();const e=this.currentModel.id;this.currentModel=s;try{localStorage.setItem("LLM_CURRENT_MODEL",s.id)}catch(a){}this.emitModelChangeEvent(e,s.id)}}emitModelChangeEvent(e,t){const s=new CustomEvent("llm-model-changed",{detail:{previousModelId:e,newModelId:t,timestamp:Date.now()}});"undefined"!=typeof window&&window.dispatchEvent(s)}getCurrentModel(){return this.currentModel}updateConfig(e){this.modelConfig={...this.modelConfig,...e};try{localStorage.setItem("LLM_CONFIG",JSON.stringify(this.modelConfig))}catch{}}getConfig(){return{...this.modelConfig}}clearHistory(){const e=this.getCurrentSession();e&&(e.messages=[],e.updatedAt=Date.now(),this.saveSessions())}initializePerformanceData(e){this.performanceData[e]||(this.performanceData[e]={modelId:e,requestCount:0,successCount:0,failureCount:0,totalResponseTime:0,averageResponseTime:0,minResponseTime:1/0,maxResponseTime:0,lastRequestTime:0,lastSuccessTime:0,lastFailureTime:0})}updatePerformanceData(e){const{modelId:t,responseTime:s,success:a}=e;this.initializePerformanceData(t);const i=this.performanceData[t];i.requestCount++,i.lastRequestTime=Date.now(),a?(i.successCount++,i.lastSuccessTime=Date.now()):(i.failureCount++,i.lastFailureTime=Date.now()),i.totalResponseTime+=s,i.averageResponseTime=i.totalResponseTime/i.requestCount,i.minResponseTime=Math.min(i.minResponseTime,s),i.maxResponseTime=Math.max(i.maxResponseTime,s),this.performanceRecords.push(e),this.performanceRecords.length>this.maxPerformanceRecords&&this.performanceRecords.shift()}getPerformanceData(e){return e?(this.initializePerformanceData(e),{...this.performanceData[e]}):(Q.forEach(e=>{this.initializePerformanceData(e.id)}),{...this.performanceData})}getPerformanceRecords(e,t=100){let s=[...this.performanceRecords];return e&&(s=s.filter(t=>t.modelId===e)),s.sort((e,t)=>t.timestamp-e.timestamp).slice(0,t)}resetPerformanceData(e){e?(delete this.performanceData[e],this.performanceRecords=this.performanceRecords.filter(t=>t.modelId!==e)):(this.performanceData={},this.performanceRecords=[])}initializeRoles(){try{const e=localStorage.getItem("LLM_ROLES");if(e){const t=JSON.parse(e),s=new Map;ee.forEach(e=>{s.set(e.id,e)}),t.forEach(e=>{s.set(e.id,e)}),this.roles=Array.from(s.values())}const t=localStorage.getItem("LLM_CURRENT_ROLE_ID");if(t){const e=this.roles.find(e=>e.id===t);e&&(this.currentRole=e,this.applyRoleToConfig(e))}}catch(e){this.roles=[...ee],this.currentRole=ee.find(e=>e.is_default)||ee[0],this.applyRoleToConfig(this.currentRole)}}recognizeIntent(e){const t=e.toLowerCase();return t.includes("查询")||t.includes("怎么")||t.includes("如何")||t.includes("什么")?{intent:"QUERY",confidence:.9}:t.includes("生成")||t.includes("创建")||t.includes("写")||t.includes("设计")?{intent:"GENERATE",confidence:.9}:t.includes("解释")||t.includes("说明")||t.includes("什么是")||t.includes("意思")?{intent:"EXPLAIN",confidence:.9}:t.includes("帮助")||t.includes("使用")||t.includes("教程")?{intent:"HELP",confidence:.9}:t.includes("设置")||t.includes("配置")||t.includes("调整")?{intent:"SETTING",confidence:.9}:t.includes("反馈")||t.includes("建议")||t.includes("评价")?{intent:"FEEDBACK",confidence:.9}:{intent:"UNKNOWN",confidence:.5}}recognizeEntities(e){const t=[],s=/(\d{4}年\d{1,2}月\d{1,2}日|\d{4}-\d{1,2}-\d{1,2}|\d{1,2}\/\d{1,2}\/\d{4}|今天|明天|昨天|本周|下周|上个月|下个月)/g;let a;for(;null!==(a=s.exec(e));)t.push({type:"DATE",value:a[0],confidence:.9});const i=["北京","上海","广州","深圳","天津","重庆","成都","杭州"];for(const l of i)e.includes(l)&&t.push({type:"PLACE",value:l,confidence:.8});const r=["李白","杜甫","苏轼","白居易","王维","孟浩然"];for(const l of r)e.includes(l)&&t.push({type:"PERSON",value:l,confidence:.8});const n=["AI助手","创作工具","文化知识","文创产品","社区活动"];for(const l of n)e.includes(l)&&t.push({type:"PRODUCT",value:l,confidence:.8});return t}analyzeComplexQuery(e){const t=this.recognizeIntent(e),s=this.recognizeEntities(e),a=e.includes("?")&&e.indexOf("?")!==e.lastIndexOf("?"),i=e.includes("和")||e.includes("并且")||e.includes("同时")||e.includes("还有");let r,n="simple";return(a||i)&&(n="complex",a?r=e.split("?").filter(e=>e.trim().length>0).map(e=>e.trim()+"?"):i&&(r=e.split(/[和并且同时还有]/).filter(e=>e.trim().length>0).map(e=>e.trim()))),{intent:t.intent,entities:s,queryType:n,subQueries:r}}generateDynamicPrompt(e,t){const s=this.getCurrentSession(),a=[];switch(t?.page&&a.push(`\n\n当前用户正在访问页面：${t.page}`),t?.path&&a.push(`路径：${t.path}`),s?.currentTopic&&(a.push(`\n\n当前对话主题：${s.currentTopic}`),s.topicHistory&&s.topicHistory.length>0&&a.push(`\n历史主题：${s.topicHistory.join(", ")}`)),this.modelConfig.personality){case"friendly":a.push("\n\n请以友好、热情的语气回答用户的问题。");break;case"professional":a.push("\n\n请以专业、严谨的语气回答用户的问题，提供详细的技术解释。");break;case"creative":a.push("\n\n请以富有创意、想象力的语气回答用户的问题，提供创新的解决方案。");break;case"humorous":a.push("\n\n请以幽默、轻松的语气回答用户的问题，适当加入玩笑和有趣的比喻。");break;case"concise":a.push("\n\n请以简洁、明了的语气回答用户的问题，避免冗长的解释。");break;case"warm":a.push("\n\n请以温暖、亲切的语气回答用户的问题，让用户感到舒适和被关心。");break;case"enthusiastic":a.push("\n\n请以充满热情和活力的语气回答用户的问题，展现积极向上的态度。");break;case"calm":a.push("\n\n请以冷静、沉稳的语气回答用户的问题，提供理性和客观的分析。");break;case"witty":a.push("\n\n请以机智、风趣的语气回答用户的问题，展现敏捷的思维和幽默。");break;case"scholarly":a.push("\n\n请以博学、严谨的语气回答用户的问题，提供深入的分析和专业知识。");break;case"casual":a.push("\n\n请以随意、轻松的语气回答用户的问题，就像和朋友聊天一样。");break;case"strict":a.push("\n\n请以严格、认真的语气回答用户的问题，强调准确性和规范性。");break;case"empathetic":a.push("\n\n请以富有同理心和理解力的语气回答用户的问题，表现出对用户感受的理解和支持。")}switch(s?.contextSummary&&a.push(`\n\n对话历史摘要：${s.contextSummary}`),this.currentModel.id){case"kimi":a.push("\n\n请充分利用Kimi的长上下文能力，提供详细、全面的回答。");break;case"deepseek":a.push("\n\n请结合Deepseek在文化元素融合方面的优势，提供富有文化内涵的回答。");break;case"qwen":a.push("\n\n请利用通义千问的综合能力，提供全面、准确的回答。")}return`${e}${a.join("")}`}updateContextSummary(){const e=this.getCurrentSession();if(!e||e.messages.length<10)return;const t=e.messages.slice(-5).map(e=>e.content).join(" ").toLowerCase().split(/\s+/),s=new Set(["的","了","是","在","我","有","和","就","不","人","都","一","一个","上","也","很","到","说","要","去","你","会","着","没有","看","好","自己","这"]),a=t.filter(e=>!s.has(e)&&e.length>1),i={};a.forEach(e=>{i[e]=(i[e]||0)+1});const r=Object.entries(i).sort((e,t)=>t[1]-e[1]).slice(0,10).map(e=>e[0]);e.contextSummary=`对话围绕以下主题展开：${r.join(", ")}`,this.saveSessions()}applyRoleToConfig(e){this.modelConfig={...this.modelConfig,system_prompt:e.system_prompt,temperature:e.temperature,top_p:e.top_p,presence_penalty:e.presence_penalty,frequency_penalty:e.frequency_penalty,current_role_id:e.id};try{localStorage.setItem("LLM_CONFIG",JSON.stringify(this.modelConfig))}catch(t){}}saveRoles(){try{localStorage.setItem("LLM_ROLES",JSON.stringify(this.roles)),localStorage.setItem("LLM_CURRENT_ROLE_ID",this.currentRole.id)}catch(e){}}initializeSessions(){this.initializeRoles();try{const e=localStorage.getItem("LLM_CONVERSATION_SESSIONS");e&&(this.conversationSessions=JSON.parse(e));const t=localStorage.getItem("LLM_CURRENT_SESSION_ID");t&&(this.currentSessionId=t),0!==this.conversationSessions.length&&this.getCurrentSession()||this.createSession("新对话")}catch(e){this.createSession("新对话")}}saveSessions(){try{localStorage.setItem("LLM_CONVERSATION_SESSIONS",JSON.stringify(this.conversationSessions)),localStorage.setItem("LLM_CURRENT_SESSION_ID",this.currentSessionId)}catch(e){}}createSession(e,t){const s={id:`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:e,modelId:t||this.currentModel.id,messages:[],createdAt:Date.now(),updatedAt:Date.now(),isActive:!0,currentTopic:"",topicHistory:[],contextSummary:"",lastMessageTimestamp:Date.now()},a=this.getCurrentSession();return a&&(a.isActive=!1),this.conversationSessions.push(s),this.currentSessionId=s.id,this.saveSessions(),s}switchSession(e){const t=this.conversationSessions.find(t=>t.id===e);if(t){const e=this.getCurrentSession();e&&(e.isActive=!1),t.isActive=!0,this.currentSessionId=t.id,this.setCurrentModel(t.modelId,!0),this.saveSessions()}}deleteSession(e){const t=this.conversationSessions.findIndex(t=>t.id===e);if(-1!==t){if(e===this.currentSessionId)if(this.conversationSessions.splice(t,1),this.conversationSessions.length>0){const e=this.conversationSessions[0];e.isActive=!0,this.currentSessionId=e.id,this.setCurrentModel(e.modelId,!0)}else this.createSession("新对话");else this.conversationSessions.splice(t,1);this.saveSessions()}}renameSession(e,t){const s=this.conversationSessions.find(t=>t.id===e);s&&(s.name=t,s.updatedAt=Date.now(),this.saveSessions())}getCurrentSession(){return this.conversationSessions.find(e=>e.id===this.currentSessionId)}getSessions(){return[...this.conversationSessions].sort((e,t)=>t.updatedAt-e.updatedAt)}getSession(e){return this.conversationSessions.find(t=>t.id===e)}getHistory(){const e=this.getCurrentSession();return e?[...e.messages]:[]}getSessionHistory(e){const t=this.getSession(e);return t?[...t.messages]:[]}importHistory(e){const t=this.getCurrentSession();if(t){const a=this.modelConfig.max_history||10,i=e.slice(-a);t.messages=[...i],t.updatedAt=Date.now(),this.saveSessions();try{localStorage.setItem("LLM_HISTORY_IMPORTED_AT",String(Date.now()))}catch(s){}}}exportSession(){const e=this.getCurrentSession();if(!e)throw new Error("No active session");return JSON.parse(JSON.stringify(e))}importSession(e){const t={...e,id:`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isActive:!1,createdAt:Date.now(),updatedAt:Date.now()};return this.conversationSessions.push(t),this.saveSessions(),t}getRoles(){return[...this.roles]}getCurrentRole(){return{...this.currentRole}}setCurrentRole(e){const t=this.roles.find(t=>t.id===e);t&&(this.currentRole=t,this.applyRoleToConfig(t),this.saveRoles(),this.emitRoleChangeEvent(e))}getConnectionStatus(e){return this.connectionStatus[e]||"disconnected"}setConnectionStatus(e,t,s){this.connectionStatus[e]=t,this.emitConnectionStatusChange(e,t,s)}emitConnectionStatusChange(e,t,s){this.connectionStatusListeners.forEach(a=>{a(e,t,s)}),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("llm-connection-status-changed",{detail:{modelId:e,status:t,error:s,timestamp:Date.now()}}))}emitRoleChangeEvent(e){const t=new CustomEvent("llm-role-changed",{detail:{roleId:e,timestamp:Date.now()}});"undefined"!=typeof window&&window.dispatchEvent(t)}createRole(e){const t={...e,id:`role_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,created_at:Date.now(),updated_at:Date.now()};return this.roles.push(t),this.saveRoles(),t}updateRole(e,t){const s=this.roles.findIndex(t=>t.id===e);if(-1!==s){const a={...this.roles[s],...t,updated_at:Date.now()};return this.roles[s]=a,this.saveRoles(),e===this.currentRole.id&&(this.currentRole=a,this.applyRoleToConfig(a)),a}return null}deleteRole(e){const t=this.roles.find(t=>t.id===e);if(t&&t.is_default)return!1;const s=this.roles.findIndex(t=>t.id===e);if(-1!==s){if(this.roles.splice(s,1),this.saveRoles(),e===this.currentRole.id){const e=this.roles.find(e=>e.is_default)||this.roles[0];this.setCurrentRole(e.id)}return!0}return!1}generateCacheKey(e,t,s,a="global"){const i=JSON.stringify(s||{}),r=this.getCurrentSession(),n=r?.id||"global";switch(a){case"global":default:return`${t}:${this.currentRole.id}:${e}:${i}`;case"conversation":return`${t}:${this.currentRole.id}:${n}:${e}:${i}`;case"model":return`${t}:${e}:${i}`}}checkCache(e,t,s){this.cacheStats.totalRequests++;const a=[this.generateCacheKey(e,t,s,"conversation"),this.generateCacheKey(e,t,s,"global"),this.generateCacheKey(e,t,s,"model")],i=Date.now();for(const r of a){const e=this.responseCache.get(r);if(e){if(i-e.timestamp<this.cacheExpiryTime)return this.cacheStats.hits++,e.response;this.responseCache.delete(r),this.cacheStats.evictions++}}return this.cacheStats.misses++,null}calculateCachePriority(e,t){const s=this.getCurrentSession();return e.includes("系统")||e.includes("设置")||e.includes("配置")?"high":s?.currentTopic&&e.includes(s.currentTopic)?"medium":"low"}updateCache(e,t,s,a){const i=this.generateCacheKey(e,t,a,"conversation"),r=this.getCurrentSession(),n=this.calculateCachePriority(e,s);if(this.responseCache.size>=this.maxCacheSize){const e=Array.from(this.responseCache.entries());e.sort((e,t)=>{const s={high:3,medium:2,low:1},a=s[t[1].priority]-s[e[1].priority];return 0!==a?a:e[1].timestamp-t[1].timestamp});const t=e[e.length-1];this.responseCache.delete(t[0]),this.cacheStats.evictions++}this.responseCache.set(i,{response:s,timestamp:Date.now(),conversationId:r?.id,topic:r?.currentTopic,priority:n})}async generateImage(e){let t="/api/doubao/images/generate";switch(this.currentModel.id){case"qwen":t="/api/qwen/images/generate";break;case"deepseek":t="/api/deepseek/images/generate";break;case"kimi":t="/api/kimi/images/generate";break;default:t="/api/doubao/images/generate"}try{const s=await Z.post(t,e,{retries:2,timeoutMs:3e4});return s.ok?s.data:{ok:!1,error:s.error||"图片生成请求失败"}}catch(s){return{ok:!1,error:s instanceof Error?s.message:"图片生成失败"}}}clearCache(e){if(e)for(const[t,s]of this.responseCache.entries()){let a=!1;e.modelId&&t.startsWith(`${e.modelId}:`)&&(a=!0),e.conversationId&&s.conversationId===e.conversationId&&(a=!0),e.topic&&s.topic===e.topic&&(a=!0),e.priority&&s.priority===e.priority&&(a=!0),a&&(this.responseCache.delete(t),this.cacheStats.evictions++)}else this.responseCache.clear()}getCacheStats(){return{...this.cacheStats}}resetCacheStats(){this.cacheStats={hits:0,misses:0,evictions:0,totalRequests:0}}getFriendlyErrorInfo(e,t){const s=Q.find(e=>e.id===t)?.name||t;switch(e){case"NETWORK_ERROR":case"CONNECTION_TIMEOUT":return{userFriendlyMessage:"网络连接失败，请检查您的网络设置后重试。",suggestedActions:["检查网络连接","刷新页面重试","稍后再试"]};case"AUTH_ERROR":case"API_KEY_INVALID":return{userFriendlyMessage:`${s} API密钥无效，请检查并更新API密钥。`,suggestedActions:["检查API密钥是否正确","更新API密钥","联系管理员获取帮助"]};case"API_KEY_MISSING":return{userFriendlyMessage:`${s} API密钥缺失，请配置API密钥。`,suggestedActions:["在设置中配置API密钥","联系管理员获取API密钥"]};case"QUOTA_ERROR":return{userFriendlyMessage:`${s} 配额已用完，请稍后再试或联系管理员。`,suggestedActions:["稍后再试","联系管理员增加配额","切换到其他可用模型"]};case"RATE_LIMIT_ERROR":case"THROTTLING_ERROR":return{userFriendlyMessage:"请求频率过高，请稍等片刻后重试。",suggestedActions:["稍等片刻后重试","减少请求频率","稍后再试"]};case"SERVER_ERROR":case"SERVICE_UNAVAILABLE":return{userFriendlyMessage:`${s} 服务暂时不可用，请稍后再试。`,suggestedActions:["稍后再试","刷新页面","切换到其他可用模型"]};case"MODEL_ERROR":case"MODEL_UNAVAILABLE":return{userFriendlyMessage:`${s} 模型暂时不可用，请尝试其他模型。`,suggestedActions:["切换到其他可用模型","稍后再试","联系管理员获取帮助"]};case"VALIDATION_ERROR":case"REQUEST_TOO_LARGE":return{userFriendlyMessage:"请求参数无效或过大，请检查输入内容后重试。",suggestedActions:["检查输入内容是否符合要求","减少输入内容的长度","重新尝试"]};case"RESPONSE_PARSE_ERROR":return{userFriendlyMessage:"系统处理响应时出现错误，请稍后再试。",suggestedActions:["稍后再试","刷新页面","联系管理员获取帮助"]};case"FEATURE_NOT_SUPPORTED":return{userFriendlyMessage:"当前模型不支持该功能，请尝试其他模型。",suggestedActions:["切换到其他可用模型","联系管理员获取帮助"]};case"CONTEXT_OVERFLOW":return{userFriendlyMessage:"对话历史过长，请清空部分历史或开始新对话。",suggestedActions:["清空对话历史","开始新对话","减少单次输入内容"]};default:return{userFriendlyMessage:"系统出现未知错误，请稍后再试。",suggestedActions:["稍后再试","刷新页面","联系管理员获取帮助"]}}}optimizeConversationHistory(e,t,s){return e.length<=s?e:e.slice(-s)}updateConversationTopic(e,t){const s=t.toLowerCase().split(/\s+/),a=new Set(["的","了","是","在","我","有","和","就","不","人","都","一","一个","上","也","很","到","说","要","去","你","会","着","没有","看","好","自己","这"]);return s.filter(e=>!a.has(e)&&e.length>1).slice(0,3).join(" ")}buildMultimodalContent(e,t){return t&&0!==t.length?{text:e,images:t.map(e=>({url:e}))}:{text:e}}generateCreativeDirections(e){return["基于传统文化元素的创新设计","结合现代科技的创意表现","跨文化融合的设计思路","注重可持续发展的设计理念","以用户为中心的交互设计"]}recommendCulturalElements(e){return["传统纹样","民族色彩","非遗技艺","古典诗词","历史典故"]}diagnoseCreationIssues(e){return["创意方向不明确","文化元素融合不够自然","视觉层次不清晰","色彩搭配不协调","缺乏创新亮点"]}getFallbackResponse(e,t){return`当前模型 ${e} 暂时无法提供服务，请稍后再试。错误信息：${t}`}async ensureAvailableModel(e=[]){const t=!!this.getEnvVar("VITE_API_BASE_URL"),s=this.getCurrentModel();if(this.hasValidApiKey(s.id,t))return s.id;for(const i of e)if(this.hasValidApiKey(i,t))return i;const a=[...Q.filter(e=>this.hasValidApiKey(e.id,t))].sort((e,t)=>e.isDefault?-1:t.isDefault?1:e.id.localeCompare(t.id));return a.length>0?a[0].id:s.id}async generateResponse(e,t){const s=this.getCurrentModel().id,a=this.generateCacheKey(e,s,{},"conversation"),i=this.responseCache.get(a);return i?(this.cacheStats.hits++,this.cacheStats.totalRequests++,t?.onDelta&&t.onDelta(i.response),i.response):(this.cacheStats.misses++,this.cacheStats.totalRequests++,new Promise((a,i)=>{const r=q.addTask("text",e,{priority:t?.priority||"medium",metadata:{modelId:s,context:t?.context,conversationId:this.getCurrentSession()?.id},onProgress:(e,s)=>{t?.onDelta&&s?.chunk&&t.onDelta(s.chunk)},onComplete:async t=>{if(t.success){const i=t.data;this.updateCache(e,s,i);const r=this.getCurrentSession();if(r){const t={role:"user",content:e,timestamp:Date.now()};r.messages.push(t,{role:"assistant",content:i,timestamp:Date.now()}),r.updatedAt=Date.now(),r.lastMessageTimestamp=Date.now(),this.saveSessions()}a(i)}else i(new Error(t.error||"任务执行失败"))},onError:e=>{i(new Error(e))}});t?.signal&&t.signal.addEventListener("abort",()=>{q.cancelTask(r.id),i(new Error("Request aborted"))})}))}async executeAITask(e){try{const t=Date.now(),s=e.metadata?.modelId||this.getCurrentModel().id,a=e.metadata,i=a?.conversationId?this.conversationSessions.find(e=>e.id===a.conversationId):this.getCurrentSession(),r=i?.messages||[],n=this.modelConfig.max_history||10,l=this.optimizeConversationHistory(r,e.prompt,n),o={role:"system",content:this.generateDynamicPrompt(this.modelConfig.system_prompt,e.metadata?.context),timestamp:Date.now()},c={role:"user",content:e.prompt,timestamp:Date.now()},d=[o,...l,c],m=!!this.getEnvVar("VITE_API_BASE_URL");this.setConnectionStatus(s,"connecting");const g=d.map(e=>({role:e.role,content:e.content,timestamp:e.timestamp}));let h;h=m?await this.callApiViaProxy(s,g,{onDelta:t=>{e.onProgress&&e.onProgress(50,{chunk:t})}}):await this.callModelApiDirectly(s,g,{onDelta:t=>{e.onProgress&&e.onProgress(50,{chunk:t})}}),this.setConnectionStatus(s,"connected");const p=Date.now();return this.updatePerformanceData({modelId:s,startTime:t,endTime:p,responseTime:p-t,success:!0,timestamp:Date.now()}),h}catch(t){const e=t instanceof Error?t.message:"未知错误";return this.setConnectionStatus(this.getCurrentModel().id,"error",e),this.updatePerformanceData({modelId:this.getCurrentModel().id,startTime:Date.now(),endTime:Date.now(),responseTime:0,success:!1,error:e,timestamp:Date.now()}),this.getFallbackResponse(this.getCurrentModel().id,e)}}async callApiViaProxy(e,t,s){const a=this.getEnvVar("VITE_API_BASE_URL")||"",i=this.getEnvVar("VITE_API_KEY")||"",r=await fetch(`${a}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({model:e,messages:t.map(e=>({role:e.role,content:e.content})),stream:!!s?.onDelta,temperature:this.modelConfig.temperature,top_p:this.modelConfig.top_p,max_tokens:this.modelConfig.max_tokens}),signal:s?.signal});if(!r.ok)throw new Error(`API请求失败: ${r.status} ${r.statusText}`);if(s?.onDelta)return this.handleStreamingResponse(r,s.onDelta);{const e=await r.json();return e.choices[0]?.message?.content||"未获取到响应"}}async callModelApiDirectly(e,t,s){switch(e){case"kimi":return this.callKimiApi(t,s);case"deepseek":return this.callDeepseekApi(t,s);case"qwen":return this.callQwenApi(t,s);default:throw new Error(`不支持的模型类型: ${e}`)}}async callKimiApi(e,t){const s=this.modelConfig.kimi_api_key;if(!s)throw new Error("Kimi API密钥未配置");const a=await fetch(`${this.modelConfig.kimi_base_url}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:this.modelConfig.kimi_model,messages:e.map(e=>({role:e.role,content:e.content})),stream:!!t?.onDelta,temperature:this.modelConfig.temperature,top_p:this.modelConfig.top_p,max_tokens:this.modelConfig.max_tokens}),signal:t?.signal});if(!a.ok)throw new Error(`Kimi API请求失败: ${a.status} ${a.statusText}`);if(t?.onDelta)return this.handleStreamingResponse(a,t.onDelta);{const e=await a.json();return e.choices[0]?.message?.content||"未获取到响应"}}async callDeepseekApi(e,t){const s=this.modelConfig.deepseek_api_key;if(!s)throw new Error("Deepseek API密钥未配置");const a=await fetch(`${this.modelConfig.deepseek_base_url}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:this.modelConfig.deepseek_model,messages:e.map(e=>({role:e.role,content:e.content})),stream:!!t?.onDelta,temperature:this.modelConfig.temperature,top_p:this.modelConfig.top_p,max_tokens:this.modelConfig.max_tokens}),signal:t?.signal});if(!a.ok)throw new Error(`Deepseek API请求失败: ${a.status} ${a.statusText}`);if(t?.onDelta)return this.handleStreamingResponse(a,t.onDelta);{const e=await a.json();return e.choices[0]?.message?.content||"未获取到响应"}}async callQwenApi(e,t){if(!t?.onDelta){const t=await Z.post("/api/qwen/chat/completions",{model:this.modelConfig.qwen_model,messages:e.map(e=>({role:e.role,content:e.content})),stream:!1,temperature:this.modelConfig.temperature,top_p:this.modelConfig.top_p,max_tokens:this.modelConfig.max_tokens},{timeoutMs:3e4,retries:2});if(!t.ok)throw new Error(`通义千问API请求失败: ${t.error||"未知错误"}`);const s=t.data;return s.data?.output?.text||s.output?.text||"未获取到响应"}try{const s=await fetch("/api/qwen/chat/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.modelConfig.qwen_model,messages:e.map(e=>({role:e.role,content:e.content})),stream:!0,temperature:this.modelConfig.temperature,top_p:this.modelConfig.top_p,max_tokens:this.modelConfig.max_tokens}),signal:t?.signal});if(!s.ok){const e=await s.json().catch(()=>({}));throw new Error(`通义千问API请求失败: ${s.status} ${s.statusText} - ${e.error||""}`)}return this.handleStreamingResponse(s,t.onDelta)}catch(s){throw new Error("通义千问服务暂时不可用，请稍后再试")}}async handleStreamingResponse(e,t){const s=e.body?.getReader();if(!s)throw new Error("无法获取响应流");const a=new TextDecoder("utf-8");let i="";try{for(;;){const{done:e,value:n}=await s.read();if(e)break;const l=a.decode(n,{stream:!0}).split("\n");for(const s of l){const e=s.trim();if(""!==e&&e.startsWith("data: ")){const s=e.slice(6);if("[DONE]"===s)continue;try{const e=JSON.parse(s),a=e.choices[0]?.delta?.content||"";a&&(i+=a,t(a))}catch(r){}}}}}finally{s.releaseLock()}return i}hasValidApiKey(e,t){if(t)return!0;switch(e){case"kimi":return!!this.modelConfig.kimi_api_key;case"deepseek":return!!this.modelConfig.deepseek_api_key;case"qwen":return!!this.modelConfig.qwen_api_key;case"chatgpt":return!!this.modelConfig.openai_api_key;case"gemini":return!!this.modelConfig.gemini_api_key;case"zhipu":return!!this.modelConfig.zhipu_api_key;default:return!1}}},ae=e.memo(({value:s,onChange:a,isDark:i,placeholder:r="输入创作提示词...",onFocus:n,onBlur:l,onKeyPress:o})=>{const c=e.useCallback(e=>{a(e.target.value)},[a]),d=i?"bg-gray-800 text-white focus:bg-gray-800":"bg-gray-50 text-gray-900 focus:bg-white",m=i?"bg-gray-800 ring-gray-700":"bg-white ring-gray-200";return t.jsx("div",{className:"relative",children:t.jsxs("div",{className:`flex items-center rounded-lg ring-1 ${m} px-3 py-2 transition-all duration-300 hover:shadow-lg`,children:[t.jsx("div",{className:"flex items-center justify-center text-gray-500 mr-2",children:t.jsx("i",{className:"fas fa-search"})}),t.jsx("input",{value:s,onChange:c,onFocus:n,onBlur:l,onKeyPress:o,className:`${d} flex-1 px-2 py-2 border-0 focus:outline-none focus:ring-0 transition-all duration-300`,placeholder:r,"aria-label":"创作提示词"})]})})});function ie({open:e,onAccept:s,onClose:a}){const{isDark:i}=k();return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),t.jsxs("div",{className:`relative z-10 w-full max-w-lg ${i?"bg-gray-800":"bg-white"} rounded-2xl shadow-xl p-6`,children:[t.jsx("h3",{className:"text-lg font-bold mb-3",children:"隐私协议"}),t.jsx("p",{className:(i?"text-gray-400":"text-gray-600")+" text-sm mb-6",children:"我们将收集用于个性化推荐的基础信息，包含年龄与兴趣标签，遵循最小化原则并仅用于平台服务。"}),t.jsxs("div",{className:"flex justify-end space-x-3",children:[t.jsx("button",{onClick:a,className:(i?"bg-gray-700":"bg-gray-100")+" px-4 py-2 rounded-lg",children:"取消"}),t.jsx("button",{onClick:s,className:"bg-red-600 text-white px-4 py-2 rounded-lg",children:"同意并继续"})]})]})]}):null}const re=["国潮爱好者","非遗迷","插画控","视频剪辑","包装设计","纹样研究","文创产品"];function ne({value:s,onChange:a}){const{isDark:i}=k(),[r,n]=e.useState(s);return t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"text-sm",children:"兴趣标签"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:re.map(e=>t.jsx("button",{onClick:()=>(e=>{const t=r.includes(e)?r.filter(t=>t!==e):[...r,e];n(t),a(t)})(e),className:"px-3 py-1 rounded-full text-sm border "+(r.includes(e)?"bg-red-600 text-white border-red-600":i?"bg-gray-700 text-white border-gray-600":"bg-gray-100 text-gray-800 border-gray-200"),children:e},e))})]})}class le{errors=[];MAX_ERRORS=100;storageKey="ai_creation_platform_errors";cache={};cacheExpiry=3e5;alertConfigs=[{threshold:5,timeWindow:36e5,alertLevel:"low"},{threshold:15,timeWindow:36e5,alertLevel:"medium"},{threshold:30,timeWindow:36e5,alertLevel:"high"},{threshold:100,timeWindow:864e5,alertLevel:"high"}];alerts=[];MAX_ALERTS=50;alertsStorageKey="ai_creation_platform_alerts";recentErrorCounts={};constructor(){this.loadErrors(),this.loadAlerts(),this.initializeRecentErrorCounts()}loadErrors(){try{const e=localStorage.getItem(this.storageKey);if(e){const t=JSON.parse(e);Array.isArray(t)?(this.errors=t.sort((e,t)=>t.timestamp-e.timestamp),this.errors.length>this.MAX_ERRORS&&(this.errors=this.errors.slice(0,this.MAX_ERRORS))):this.errors=[]}}catch(e){this.errors=[]}this.clearCache()}saveErrors(){try{const e=this.errors.filter(e=>"high"===e.severity),t=this.errors.filter(e=>"medium"===e.severity),s=this.errors.filter(e=>"low"===e.severity),a=Math.min(e.length,Math.floor(.5*this.MAX_ERRORS)),i=this.MAX_ERRORS-a,r=Math.min(t.length,Math.floor(.7*i)),n=Math.min(s.length,i-r),l=[...e.slice(0,a),...t.slice(0,r),...s.slice(0,n)].sort((e,t)=>t.timestamp-e.timestamp);localStorage.setItem(this.storageKey,JSON.stringify(l))}catch(e){}this.clearCache()}logError(e){this.errors.some(t=>t.message===e.message&&t.errorType===e.errorType&&t.location===e.location&&Math.abs(t.timestamp-e.timestamp)<6e4)||(this.errors.unshift(e),this.saveErrors(),this.sendToServer(e),this.checkErrorThresholds())}sendToServer(e){"high"===e.severity?this.sendImmediate(e):this.sendDelayed(e)}sendImmediate(e){setTimeout(()=>{},0)}sendDelayed(e){setTimeout(()=>{},5e3)}getAllErrors(e){let t=[...this.errors];return e&&(e.severity&&(t=t.filter(t=>t.severity===e.severity)),void 0!==e.startTime&&(t=t.filter(t=>t.timestamp>=e.startTime)),void 0!==e.endTime&&(t=t.filter(t=>t.timestamp<=e.endTime)),e.errorType&&(t=t.filter(t=>t.errorType===e.errorType))),t}clearErrors(){this.errors=[],localStorage.removeItem(this.storageKey),this.clearCache()}clearErrorsBySeverity(e){this.errors=this.errors.filter(t=>t.severity!==e),this.saveErrors(),this.clearCache()}getErrorStats(e=8){const t=`errorStats_${e}`,s=Date.now();if(this.cache[t]&&s-this.cache[t].timestamp<this.cacheExpiry)return this.cache[t].data;const a=this.alerts.reduce((e,t)=>(e[t.alertLevel]?e[t.alertLevel]++:e[t.alertLevel]=1,e),{}),i={total:this.errors.length,byType:{},bySeverity:{},byDevice:{},recent:e>0?this.errors.slice(0,e):[],criticalErrors:this.errors.filter(e=>"high"===e.severity).slice(0,10),alertStats:{total:this.alerts.length,unresolved:this.getUnresolvedAlertCount(),byLevel:a}};return this.errors.forEach(e=>{i.byType[e.errorType]?i.byType[e.errorType]++:i.byType[e.errorType]=1}),this.errors.forEach(e=>{const t=e.severity||"medium";i.bySeverity[t]?i.bySeverity[t]++:i.bySeverity[t]=1}),this.errors.forEach(e=>{const t=e.deviceInfo.device;i.byDevice[t]?i.byDevice[t]++:i.byDevice[t]=1}),this.cache[t]={data:i,timestamp:s},i}getErrorTrend(e=36e5,t=864e5){const s=Date.now(),a=s-t,i=[];let r=a;for(;r<s;){const t=r+e;i.push({startTime:r,endTime:t,count:0,bySeverity:{high:0,medium:0,low:0}}),r=t}return this.errors.forEach(t=>{if(t.timestamp>=a&&t.timestamp<s){const s=Math.floor((t.timestamp-a)/e);if(i[s]){i[s].count++;const e=t.severity||"medium";i[s].bySeverity[e]++}}}),{intervals:i,total:i.reduce((e,t)=>e+t.count,0)}}loadAlerts(){try{const e=localStorage.getItem(this.alertsStorageKey);if(e){const t=JSON.parse(e);Array.isArray(t)&&(this.alerts=t.sort((e,t)=>t.timestamp-e.timestamp),this.alerts.length>this.MAX_ALERTS&&(this.alerts=this.alerts.slice(0,this.MAX_ALERTS)))}}catch(e){this.alerts=[]}}saveAlerts(){try{localStorage.setItem(this.alertsStorageKey,JSON.stringify(this.alerts))}catch(e){}}initializeRecentErrorCounts(){const e=Date.now();this.alertConfigs.forEach(t=>{const s=e-t.timeWindow,a=this.errors.filter(e=>e.timestamp>=s).length;this.recentErrorCounts[`${t.threshold}_${t.timeWindow}`]=a})}checkErrorThresholds(){const e=Date.now();let t=!1;this.alertConfigs.forEach(s=>{const a=e-s.timeWindow,i=this.errors.filter(e=>e.timestamp>=a).length;this.recentErrorCounts[`${s.threshold}_${s.timeWindow}`]=i,i>=s.threshold&&0===this.alerts.filter(t=>t.alertLevel===s.alertLevel&&t.timestamp>e-s.timeWindow&&!t.isResolved).length&&(this.createAlert(s,i),t=!0)}),t&&this.sendAlertNotification()}createAlert(e,t){const s=`alert_${Date.now().toString(36)}_${Math.random().toString(36).substr(2)}`,a=Date.now();let i="";i=36e5===e.timeWindow?`在过去1小时内发生了${t}个错误，超过了阈值${e.threshold}`:864e5===e.timeWindow?`在过去24小时内发生了${t}个错误，超过了阈值${e.threshold}`:`在过去${e.timeWindow/6e4}分钟内发生了${t}个错误，超过了阈值${e.threshold}`;const r={alertId:s,timestamp:a,alertLevel:e.alertLevel,errorCount:t,threshold:e.threshold,timeWindow:e.timeWindow,message:i,isResolved:!1};this.alerts.unshift(r),this.alerts.length>this.MAX_ALERTS&&(this.alerts=this.alerts.slice(0,this.MAX_ALERTS)),this.saveAlerts()}resolveAlert(e){const t=this.alerts.find(t=>t.alertId===e);t&&(t.isResolved=!0,this.saveAlerts())}getAlerts(e){let t=[...this.alerts];return e&&(e.alertLevel&&(t=t.filter(t=>t.alertLevel===e.alertLevel)),void 0!==e.isResolved&&(t=t.filter(t=>t.isResolved===e.isResolved)),void 0!==e.startTime&&(t=t.filter(t=>t.timestamp>=e.startTime)),void 0!==e.endTime&&(t=t.filter(t=>t.timestamp<=e.endTime))),t}getUnresolvedAlertCount(){return this.alerts.filter(e=>!e.isResolved).length}sendAlertNotification(){if("Notification"in window&&"granted"===Notification.permission){const e=this.alerts.find(e=>!e.isResolved);e&&new Notification("错误预警",{body:e.message,icon:"./icons/icon-192x192.svg",tag:"error-alert",requireInteraction:"high"===e.alertLevel})}else"Notification"in window&&"denied"!==Notification.permission&&Notification.requestPermission().then(e=>{"granted"===e&&this.sendAlertNotification()})}clearAlerts(){this.alerts=[],localStorage.removeItem(this.alertsStorageKey)}clearCache(){this.cache={}}}const oe={NETWORK_ERROR:"网络连接失败，请检查您的网络设置后重试。",TIMEOUT_ERROR:"请求超时，请检查网络后重试，或切换至4G网络。",SERVER_ERROR:"服务器暂时不可用，请稍后再试。",PERMISSION_DENIED:"您没有权限执行此操作。",AUTH_REQUIRED:"请先登录后再继续操作。",RESOURCE_NOT_FOUND:"找不到请求的资源。",RESOURCE_LOAD_FAILED:"资源加载失败，请检查网络后重试。",VALIDATION_ERROR:"请检查您输入的信息是否正确。",FIELD_REQUIRED:"{field} 不能为空。",COLLABORATION_ERROR:"协作功能暂时不可用，请稍后再试。",USER_NOT_FOUND:"找不到该用户。",INVITE_ERROR:"邀请发送失败，请稍后再试。",MODEL_SWITCH_ERROR:"模型切换失败，请稍后再试。",MODEL_TIMEOUT:"AI模型响应超时，请尝试切换其他模型。",MODEL_ERROR:"AI模型处理失败，请稍后再试。",TIANJIN_ASSETS_ERROR:"天津素材库加载失败，请稍后再试。","素材加载失败":"素材加载失败，请检查网络后重试，或切换至4G网络。",BROWSER_COMPAT_ERROR:"您的浏览器版本过低，建议升级Chrome至90+版本以获得最佳体验。",DEFAULT_ERROR:"操作失败，请稍后再试。"},ce={NETWORK_ERROR:["检查您的网络连接是否正常","尝试刷新页面","如果使用Wi-Fi，请尝试切换到移动数据","清除浏览器缓存后重试"],BROWSER_COMPAT_ERROR:["升级Chrome浏览器至90+版本","使用其他现代浏览器如Firefox或Edge","确保浏览器已启用JavaScript"],PERMISSION_DENIED:["确认您有足够的权限执行此操作","联系管理员获取帮助","刷新页面并重试"]},de=()=>{const e=navigator.userAgent;let t="Unknown",s="Unknown",a="Unknown",i="Desktop";if(e.includes("Chrome")){t="Chrome";const a=e.match(/Chrome\/(\d+)/);a&&(s=a[1])}else if(e.includes("Firefox")){t="Firefox";const a=e.match(/Firefox\/(\d+)/);a&&(s=a[1])}else if(e.includes("Safari")){t="Safari";const a=e.match(/Version\/(\d+)/);a&&(s=a[1])}else if(e.includes("Edg")){t="Edge";const a=e.match(/Edg\/(\d+)/);a&&(s=a[1])}return e.includes("Windows")?a="Windows":e.includes("Macintosh")?a="macOS":e.includes("Linux")?a="Linux":e.includes("Android")?(a="Android",i="Mobile"):(e.includes("iOS")||e.includes("iPhone")||e.includes("iPad"))&&(a="iOS",i="Mobile"),{browser:t,browserVersion:s,os:a,device:i}},me=new class{logger=new le;getFriendlyErrorMessage(e,t={}){let s=R.t(`error.${e}`);return s===`error.${e}`&&(s=R.t("error.DEFAULT_ERROR")),Object.keys(t).forEach(e=>{const a=`{${e}}`;s.includes(a)&&(s=s.replace(a,t[e]))}),s}getErrorFixSuggestions(e){return ce[e]||["请尝试刷新页面后重试","如果问题持续，请联系客服获取帮助"]}logError(e,t={}){let s="UNKNOWN_ERROR",a="未知错误",i="",r="Error";e instanceof Error?(a=e.message,i=e.stack||"",r=e.name,"TypeError"===r?s="TYPE_ERROR":"ReferenceError"===r?s="REFERENCE_ERROR":"RangeError"===r?s="RANGE_ERROR":"SyntaxError"===r?s="SYNTAX_ERROR":"URIError"===r?s="URI_ERROR":"EvalError"===r?s="EVAL_ERROR":"AggregateError"===r&&(s="AGGREGATE_ERROR"),a.includes("NetworkError")||a.includes("Failed to fetch")||a.includes("net::ERR_")?s="NETWORK_ERROR":a.includes("timeout")||a.includes("Timeout")?s="TIMEOUT_ERROR":a.includes("Permission denied")||a.includes("permission")?s="PERMISSION_DENIED":a.includes("Not found")||a.includes("404")?s="RESOURCE_NOT_FOUND":a.includes("CORS")||a.includes("cross-origin")?s="CORS_ERROR":a.includes("Invalid token")||a.includes("Unauthorized")||a.includes("401")?s="AUTH_ERROR":a.includes("Forbidden")||a.includes("403")?s="FORBIDDEN_ERROR":a.includes("Server")||a.includes("500")?s="SERVER_ERROR":a.includes("Texture")||a.includes("texture")?s="TEXTURE_ERROR":a.includes("Model")||a.includes("model")?s="MODEL_ERROR":a.includes("Canvas")||a.includes("canvas")?s="CANVAS_ERROR":(a.includes("WebGL")||a.includes("webgl"))&&(s="WEBGL_ERROR")):(s=e,a=this.getFriendlyErrorMessage(e));const n={...t,page:{url:window.location.href,path:window.location.pathname,search:window.location.search,hash:window.location.hash},browser:{screenWidth:window.screen.width,screenHeight:window.screen.height,viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,isMobile:window.innerWidth<768,scrollPosition:{x:window.scrollX,y:window.scrollY}},memory:"performance"in window&&"memory"in performance?{usedJSHeapSize:performance.memory.usedJSHeapSize,totalJSHeapSize:performance.memory.totalJSHeapSize,jsHeapSizeLimit:performance.memory.jsHeapSizeLimit}:void 0,navigation:{referrer:document.referrer,navigationType:window.performance?.navigation?.type||"unknown"},time:{timestamp:Date.now(),isoString:(new Date).toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}};let l="medium";["SERVER_ERROR","AUTH_ERROR","NETWORK_ERROR","TIMEOUT_ERROR","PERMISSION_DENIED","FORBIDDEN_ERROR"].includes(s)?l="high":["TYPE_ERROR","REFERENCE_ERROR","SYNTAX_ERROR","URI_ERROR","RANGE_ERROR"].includes(s)&&(l="low");let o="";if(i){const e=i.split("\n").find(e=>e.includes("src/")&&!e.includes("errorService"));if(e){const t=e.match(/(src\/[^:]+):(\d+):(\d+)/);t&&(o=`${t[1]}:${t[2]}`)}}const c={errorId:Date.now().toString(36)+Math.random().toString(36).substr(2),errorType:s,errorName:r,message:a,stackTrace:i,timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href,deviceInfo:de(),context:n,severity:l,location:o};return this.logger.logError(c),this.reportErrorToServer(c).catch(e=>{}),c}getErrorStats(e=8){return this.logger.getErrorStats(e)}getErrorCategoryStats(e=864e5){const t=this.logger.getAllErrors(),s=Date.now()-e,a=t.filter(e=>e.timestamp>=s),i=a.reduce((e,t)=>(e[t.errorType]?e[t.errorType]++:e[t.errorType]=1,e),{}),r=a.reduce((e,t)=>{const s=t.deviceInfo.device;return e[s]?e[s]++:e[s]=1,e},{}),n=a.reduce((e,t)=>{const s=`${t.deviceInfo.browser} v${t.deviceInfo.browserVersion}`;return e[s]?e[s]++:e[s]=1,e},{}),l=a.reduce((e,t)=>{const s=t.deviceInfo.os;return e[s]?e[s]++:e[s]=1,e},{});return{total:a.length,byCategory:i,byDevice:r,byBrowser:n,byOS:l,timeRange:e,cutoffTime:s}}getErrorTrendStats(e=36e5,t=864e5){const s=this.logger.getAllErrors(),a=Date.now()-t,i=s.filter(e=>e.timestamp>=a).reduce((t,s)=>{const a=Math.floor(s.timestamp/e)*e;return t[a]?t[a]++:t[a]=1,t},{});return{trend:Object.entries(i).map(([e,t])=>({timestamp:parseInt(e),count:t})).sort((e,t)=>e.timestamp-t.timestamp),interval:e,timeRange:t,cutoffTime:a}}async reportErrorToServer(e){try{let t="";return"undefined"!=typeof window&&(t=window.env?.REACT_APP_ERROR_REPORT_URL||window.env?.NEXT_PUBLIC_ERROR_REPORT_URL||""),t?(await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0})).ok:!1}catch(t){return!1}}async batchReportErrors(e=10){const t=this.getErrorStats().recent.slice(0,e);let s=0;for(const a of t)await this.reportErrorToServer(a)&&s++;return s}clearErrors(){this.logger.clearErrors()}getAlerts(e){return this.logger.getAlerts(e)}resolveAlert(e){return this.logger.resolveAlert(e)}getUnresolvedAlertCount(){return this.logger.getUnresolvedAlertCount()}clearAlerts(){this.logger.clearAlerts?.()}checkBrowserCompatibility(){const e=de();return"Chrome"===e.browser&&parseInt(e.browserVersion)<90?{isCompatible:!1,message:this.getFriendlyErrorMessage("BROWSER_COMPAT_ERROR")}:{isCompatible:!0}}},ge=({errorInfo:a,error:r,onClose:n,autoShow:l=!1})=>{const{isDark:o}=k(),[c,d]=e.useState(""),[m,g]=e.useState(""),[h,p]=e.useState(!1),[u,x]=e.useState(a||null);e.useState(!1);const[y,b]=e.useState("功能异常"),[f,v]=e.useState([]),[j,N]=e.useState(!0),[w,_]=e.useState(""),[S,C]=e.useState(!1),T=(e=!1)=>`w-full px-4 py-2.5 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-300 hover:shadow-md ${o?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 border hover:border-gray-500 focus:border-red-400 focus:ring-offset-gray-800":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 border hover:border-gray-300 focus:border-red-400 focus:ring-offset-white"}${e?" border-red-500 focus:ring-red-500":""}`,E=()=>"block text-sm font-medium mb-2 "+(o?"text-gray-300":"text-gray-700");if(e.useEffect(()=>{if(r&&!u){const e=me.logError(r);x(e)}},[r,u]),l&&!u){const e=me.getErrorStats();e.recent.length>0&&x(e.recent[e.recent.length-1])}const I=async()=>{if(!h&&R(m)){p(!0);try{await new Promise(e=>setTimeout(e,1e3)),i.success(t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 text-lg"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:"提交成功！"}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"感谢您的反馈，我们会尽快处理"})]})]}),{duration:3e3}),d(""),g(""),b("功能异常"),v([]),N(!0),_(""),C(!1),setTimeout(()=>{n()},500)}catch(e){i.error(t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-times-circle text-red-500 text-lg"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:"提交失败"}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"请稍后再试"})]})]}))}finally{p(!1)}}},R=e=>e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||/^1[3-9]\d{9}$/.test(e)?(_(""),!0):(_("请输入有效的邮箱或手机号"),!1):(_(""),!0),D=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?C(!0):"dragleave"===e.type&&C(!1)},A=e=>{v(t=>t.filter((t,s)=>s!==e))};return t.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${o?"bg-gray-900/80":"bg-gray-50/80"} backdrop-blur-md transition-opacity duration-300`,children:t.jsxs(s.div,{className:`rounded-2xl ${o?"bg-gray-800":"bg-white"} shadow-2xl max-w-2xl w-full mx-4 overflow-hidden md:max-h-[90vh] md:overflow-y-auto`,initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.4,ease:"easeOut"},children:[t.jsxs("div",{className:`p-6 border-b ${o?"border-gray-700":"border-gray-200"} flex justify-between items-center bg-gradient-to-r ${o?"from-gray-800 to-gray-750":"from-white to-gray-50"}`,children:[t.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[t.jsx(s.div,{initial:{rotate:0},animate:{rotate:[0,10,-10,10,0]},transition:{duration:.5,repeat:0},children:t.jsx("i",{className:"fas fa-bug text-red-600"})}),"问题反馈"]}),t.jsx("button",{onClick:n,className:"p-2 rounded-full transition-all duration-300 hover:scale-110 "+(o?"bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white":"bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-900"),"aria-label":"关闭",tabIndex:0,onKeyDown:e=>"Enter"===e.key&&n(),children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[u&&t.jsx(s.div,{className:`p-5 rounded-xl ${o?"bg-gray-750/80":"bg-gray-50"} border ${o?"border-gray-700":"border-gray-200"} shadow-sm`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:`w-10 h-10 rounded-full ${P=u.errorType,P.includes("NETWORK")?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":P.includes("PERMISSION")?"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400":P.includes("MODEL")?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":P.includes("VALIDATION")?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"} flex items-center justify-center flex-shrink-0 shadow-sm`,children:t.jsx("i",{className:"fas fa-exclamation-triangle text-lg"})}),t.jsx("div",{className:"flex-1",children:t.jsxs("div",{children:[t.jsxs("h5",{className:"text-sm font-medium mb-2 flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-lightbulb text-yellow-500"}),"推荐解决方案:"]}),t.jsx("ul",{className:"space-y-2 text-sm",children:me.getErrorFixSuggestions(u.errorType).map((e,s)=>t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mt-0.5 flex-shrink-0"}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:e})]},s))})]})})]})}),t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"feedbackType",className:E(),children:"反馈类型"}),t.jsxs("select",{id:"feedbackType",value:y,onChange:e=>b(e.target.value),className:T(),tabIndex:0,"aria-label":"反馈类型",children:[t.jsx("option",{value:"功能异常",children:"功能异常"}),t.jsx("option",{value:"界面问题",children:"界面问题"}),t.jsx("option",{value:"性能问题",children:"性能问题"}),t.jsx("option",{value:"建议改进",children:"建议改进"}),t.jsx("option",{value:"其他",children:"其他"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"description",className:E(),children:["问题描述 ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{id:"description",value:c,onChange:e=>d(e.target.value.slice(0,500)),placeholder:"请详细描述您遇到的问题，以便我们更好地解决...",className:`${T(!c.trim()&&c.length>0)} resize-none h-36`,required:!0,tabIndex:0,"aria-required":"true",maxLength:500,"aria-describedby":"description-count"}),t.jsxs("div",{className:"flex justify-between items-center mt-1",children:[!c.trim()&&c.length>0&&t.jsxs(s.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"text-xs text-red-500 flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-exclamation-circle"}),"请输入问题描述"]}),t.jsxs("p",{id:"description-count",className:"text-xs "+(c.length>400?"text-yellow-500":500===c.length?"text-red-500":"text-gray-500 dark:text-gray-400"),children:[c.length,"/500"]})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"contactInfo",className:E(),children:"联系方式 (可选)"}),t.jsx("input",{id:"contactInfo",type:"text",value:m,onChange:e=>{const t=e.target.value;g(t),R(t)},placeholder:"请留下您的邮箱或手机号，方便我们联系您",className:T(!!w),tabIndex:0,"aria-label":"联系方式","aria-describedby":w?"contact-error":void 0}),w&&t.jsxs(s.p,{id:"contact-error",initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"text-xs text-red-500 mt-1 flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-exclamation-circle"}),w]})]}),t.jsxs("div",{children:[t.jsx("label",{className:E(),children:"截图上传 (可选)"}),t.jsxs("div",{className:"space-y-3",children:[f.length>0&&t.jsx("div",{className:"flex flex-wrap gap-3",children:f.map((e,a)=>t.jsxs(s.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"relative group",children:[t.jsx("div",{className:`w-20 h-20 sm:w-24 sm:h-24 rounded-lg border ${o?"border-gray-600":"border-gray-200"} overflow-hidden bg-gray-100 dark:bg-gray-700 flex items-center justify-center shadow-sm`,children:t.jsx("img",{src:URL.createObjectURL(e),alt:`截图 ${a+1}`,className:"w-full h-full object-cover"})}),t.jsx("button",{onClick:()=>A(a),className:"absolute -top-2 -right-2 p-1.5 rounded-full bg-red-600 text-white shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2","aria-label":`删除截图 ${a+1}`,tabIndex:0,onKeyDown:e=>"Enter"===e.key&&A(a),children:t.jsx("i",{className:"fas fa-times text-xs"})})]},a))}),t.jsxs("label",{htmlFor:"screenshotUpload",onDragEnter:D,onDragLeave:D,onDragOver:D,onDrop:e=>{if(e.preventDefault(),e.stopPropagation(),C(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/"));t.length>0&&v(e=>[...e,...t])}},className:"flex items-center justify-center gap-2 px-4 py-3 rounded-lg cursor-pointer transition-all duration-300 border-2 border-dashed "+(o?"border-gray-600 hover:border-red-500 hover:bg-gray-700/50 "+(S?"border-red-500 bg-gray-700/50":""):"border-gray-200 hover:border-red-500 hover:bg-gray-50 "+(S?"border-red-500 bg-gray-100/80":"")),children:[t.jsx("i",{className:"fas fa-cloud-upload-alt text-gray-500 dark:text-gray-400"}),t.jsx("span",{className:"text-sm "+(o?"text-gray-300":"text-gray-600"),children:S?"释放文件以上传":"点击上传截图或拖拽文件到此处"}),t.jsx("input",{id:"screenshotUpload",type:"file",accept:"image/*",multiple:!0,onChange:e=>{const t=e.target.files;t&&t.length>0&&v(e=>[...e,...Array.from(t)]),e.target.value=""},className:"hidden"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",id:"includeLogs",checked:j,onChange:e=>N(e.target.checked),className:"w-5 h-5 rounded text-red-600 focus:ring-red-500 transition-all duration-200",tabIndex:0}),t.jsx("label",{htmlFor:"includeLogs",className:"text-sm "+(o?"text-gray-300":"text-gray-600"),children:"包含错误日志信息（有助于我们更快定位问题）"})]})]})]}),t.jsxs("div",{className:`p-6 border-t ${o?"border-gray-700":"border-gray-200"} flex justify-end gap-3 bg-gradient-to-r ${o?"from-gray-800 to-gray-750":"from-white to-gray-50"} flex-wrap`,children:[t.jsx("button",{onClick:n,className:"px-4 py-2.5 sm:px-5 rounded-lg transition-all duration-300 hover:scale-105 "+(o?"bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white":"bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-900"),tabIndex:0,onKeyDown:e=>"Enter"===e.key&&n(),children:"取消"}),t.jsx(s.button,{onClick:I,disabled:h||!c.trim(),className:"px-5 py-2.5 sm:px-6 rounded-lg transition-all duration-300 hover:scale-105 font-medium "+(h||!c.trim()?"bg-gray-500 cursor-not-allowed text-gray-200":"bg-red-600 hover:bg-red-700 text-white shadow-md hover:shadow-lg"),tabIndex:0,onKeyDown:e=>"Enter"===e.key&&!h&&c.trim()&&I(),whileTap:{scale:.98},whileHover:{scale:1.05},children:h?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(s.div,{animate:{rotate:360,scale:[1,1.2,1]},transition:{duration:1,repeat:1/0,ease:"easeInOut"},children:t.jsx("i",{className:"fas fa-spinner fa-spin"})}),t.jsx(s.span,{animate:{opacity:[1,.5,1]},transition:{duration:1,repeat:1/0,ease:"easeInOut"},children:"提交中..."})]}):t.jsx(s.span,{initial:{opacity:1},whileTap:{opacity:.8},children:"提交反馈"})})]})]})});var P},he=({isOpen:a,onClose:i,onSelectTheme:n,currentTheme:l})=>{const o=e.useRef(null);e.useEffect(()=>{const e=e=>{"Escape"===e.key&&i()};return a&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[a,i]);const c=({themeValue:e,label:a,icon:i})=>{const r={light:{bg:"#ffffff",text:"#111827",textSecondary:"#6b7280",cardBg:"#f9fafb",primary:"#dc2626",secondary:"#7c3aed"},dark:{bg:"#0f172a",text:"#f1f5f9",textSecondary:"#94a3b8",cardBg:"#1e293b",primary:"#f87171",secondary:"#a78bfa"},pink:{bg:"#fdf2f8",text:"#831843",textSecondary:"#be185d",cardBg:"#fce7f3",primary:"#be185d",secondary:"#db2777"},blue:{bg:"#f0f9ff",text:"#0c4a6e",textSecondary:"#0369a1",cardBg:"#e0f2fe",primary:"#0ea5e9",secondary:"#3b82f6"},green:{bg:"#f0fdf4",text:"#15803d",textSecondary:"#16a34a",cardBg:"#dcfce7",primary:"#22c55e",secondary:"#10b981"},auto:{bg:"#f3f4f6",text:"#111827",textSecondary:"#6b7280",cardBg:"#ffffff",primary:"#dc2626",secondary:"#7c3aed"}}[e];return t.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},whileHover:{scale:1.05},whileTap:{scale:.98},className:"relative cursor-pointer rounded-xl overflow-hidden shadow-lg transition-all duration-300 hover:shadow-2xl",style:{backgroundColor:r.bg,color:r.text},onClick:()=>n(e),children:[t.jsxs("div",{className:"p-6 min-h-[200px] flex flex-col justify-between relative overflow-hidden",style:{backgroundColor:r.bg},children:[t.jsxs("div",{className:"absolute inset-0 opacity-30",children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br",style:{backgroundImage:`linear-gradient(135deg, ${r.primary}20, ${r.secondary}20)`}}),"auto"===e&&t.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-1/2 bg-black opacity-50 rounded-bl-full"})]}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("i",{className:`${i} text-3xl`,style:{color:r.text}}),t.jsx("h3",{className:"text-xl font-bold",style:{color:r.text},children:a})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"p-3 rounded-lg",style:{backgroundColor:r.cardBg,borderRadius:"0.75rem"},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium",style:{color:r.text},children:"预览标题"}),t.jsx("span",{className:"text-xs",style:{color:r.textSecondary},children:"示例文本"})]}),t.jsx("div",{className:"w-full rounded-full h-2",style:{backgroundColor:`${r.textSecondary}30`,borderRadius:"9999px"},children:t.jsx("div",{className:"h-2 rounded-full w-3/4",style:{backgroundColor:r.primary,borderRadius:"9999px"}})})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"px-3 py-1 rounded-lg text-sm text-white",style:{backgroundColor:r.primary,borderRadius:"0.5rem"},children:"主按钮"}),t.jsx("button",{className:"px-3 py-1 rounded-lg text-sm",style:{backgroundColor:r.secondary,color:"#ffffff",borderRadius:"0.5rem"},children:"次按钮"})]})]})]}),t.jsx("div",{className:"relative z-10 mt-4",children:t.jsx(s.div,{initial:{scale:0},animate:{scale:l===e?1:0},transition:{type:"spring",stiffness:300,damping:20},className:"absolute -bottom-2 -right-2 bg-white border-2 rounded-full p-1",style:{borderColor:r.primary},children:t.jsx("i",{className:"fas fa-check",style:{color:r.primary}})})})]}),t.jsx("div",{className:"px-4 py-2 text-center text-sm font-medium",style:{backgroundColor:`${r.textSecondary}10`,color:r.text},children:a})]},e)};return t.jsx(r,{children:a&&t.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e=>{o.current&&!o.current.contains(e.target)&&i()},children:t.jsxs(s.div,{ref:o,initial:{y:50,opacity:0,scale:.95},animate:{y:0,opacity:1,scale:1},exit:{y:50,opacity:0,scale:.95},transition:{duration:.4,type:"spring",stiffness:300,damping:20},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h2",{className:"text-2xl font-bold",children:"选择主题"}),t.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:i,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:t.jsx("i",{className:"fas fa-times text-lg"})})]}),t.jsxs("div",{className:"p-6",children:[t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"预览并选择您喜欢的主题，点击卡片即可应用"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(({value:e,label:s,icon:a})=>t.jsx(c,{themeValue:e,label:s,icon:a},e))})]}),t.jsxs("div",{className:"flex justify-end gap-4 p-6 border-t border-gray-200 dark:border-gray-700",children:[t.jsx(s.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:i,className:"px-6 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"取消"}),t.jsx(s.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>n(l),className:"px-6 py-2.5 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:"应用当前主题"})]})]})})})},pe={WORK:"work",USER:"user",CATEGORY:"category",TAG:"tag",PAGE:"page"},ue=e.memo(({suggestion:s,isDark:a,onSelect:i})=>{const r=a?"hover:bg-gray-700":"hover:bg-gray-50",n=(e=>{switch(e){case pe.WORK:return{icon:"fas fa-image",color:"text-blue-500"};case pe.USER:return{icon:"fas fa-user",color:"text-green-500"};case pe.CATEGORY:return{icon:"fas fa-folder",color:"text-purple-500"};case pe.TAG:return{icon:"fas fa-tag",color:"text-yellow-500"};case pe.PAGE:return{icon:"fas fa-file",color:"text-indigo-500"};default:return{icon:"fas fa-search",color:"text-gray-500"}}})(s.type),l=e.useCallback(()=>{i(s)},[s,i]);return t.jsxs("div",{onMouseDown:l,className:`${r} px-3 py-2 text-sm cursor-pointer flex items-center justify-between`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("i",{className:`${n.icon} ${n.color} text-sm`}),t.jsx("span",{children:s.text})]}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"),children:(e=>{switch(e){case pe.WORK:return"作品";case pe.USER:return"用户";case pe.CATEGORY:return"分类";case pe.TAG:return"标签";case pe.PAGE:return"页面";default:return"搜索结果"}})(s.type)})]})}),xe=e.memo(({search:s,setSearch:a,showSuggest:i,setShowSuggest:r,suggestions:n,isDark:l,onSearch:o,onSuggestionSelect:c})=>{const d=e.useCallback(e=>{const t=e.target.value;a(t),r(!0)},[a,r]),m=e.useCallback(()=>{r(!0)},[r]),g=e.useCallback(()=>{setTimeout(()=>r(!1),150)},[r]),h=e.useCallback(e=>{a(e.text),r(!1),c(e)},[a,r,c]),p=e.useCallback(e=>{"Enter"===e.key&&(r(!1),o(s.trim()))},[s,o,r]),u=e.useCallback(()=>{r(!1),o(s.trim())},[s,o,r]),x=l?"bg-gray-800 text-white focus:bg-gray-800":"bg-gray-50 text-gray-900 focus:bg-white",y=l?"bg-gray-800 text-white ring-gray-700 shadow-lg":"bg-white text-gray-900 ring-gray-200 shadow-lg";return t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"flex items-center rounded-lg ring-1 bg-white ring-gray-200 px-3 py-2 transition-all duration-300 hover:shadow-lg",children:[t.jsx("div",{className:"flex items-center justify-center text-gray-500 mr-2",children:t.jsx("i",{className:"fas fa-search"})}),t.jsx("input",{value:s,onChange:d,onFocus:m,onBlur:g,onKeyPress:p,className:`${x} flex-1 px-2 py-2 border-0 focus:outline-none focus:ring-0 transition-all duration-300`,placeholder:"搜索作品、用户、分类、标签或页面","aria-label":"搜索内容"}),t.jsx("button",{onClick:u,className:"ml-2 px-3 py-1 rounded-md bg-red-600 hover:bg-red-700 text-white text-sm font-medium transition-all duration-300 hover:shadow-md transform hover:-translate-y-0.5","aria-label":"搜索",children:"搜索"})]}),i&&n.length>0&&t.jsx("div",{className:`${y} absolute z-10 mt-2 w-full rounded-xl ring-1 max-h-48 overflow-auto transition-all duration-300 transform origin-top scale-100 opacity-100`,children:n.map(e=>t.jsx(ue,{suggestion:e,isDark:l,onSelect:h},e.id))})]})}),ye=Object.freeze(Object.defineProperty({__proto__:null,SearchResultType:pe,default:xe},Symbol.toStringTag,{value:"Module"})),be=e.memo(({component:s,children:a})=>{const{isAuthenticated:i}=e.useContext(T),r=n();return!1===i?t.jsx(l,{to:"/login",state:{from:r},replace:!0}):void 0===i?null:a?t.jsx(t.Fragment,{children:a}):s?t.jsx(s,{}):null});be.displayName="PrivateRoute";let fe=class extends e.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){me.logError(e,{componentStack:t.componentStack,componentName:this.constructor.name,props:this.props}),this.props.onError&&this.props.onError(e,t),i.error("抱歉，应用程序发生了错误",{duration:5e3,action:{label:"刷新页面",onClick:()=>window.location.reload()}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white",children:t.jsxs("div",{className:"w-full max-w-md text-center",children:[t.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),t.jsx("h1",{className:"text-2xl font-bold mb-2",children:"应用程序发生错误"}),t.jsx("p",{className:"mb-6 text-gray-600 dark:text-gray-400",children:"抱歉，应用程序遇到了一个问题。请尝试刷新页面或联系支持团队。"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[t.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 rounded-lg font-medium bg-blue-500 hover:bg-blue-600 text-white transition-colors",children:"刷新页面"}),t.jsx("button",{onClick:()=>{const e=document.querySelector('[title="用户反馈"]');e?.click()},className:"px-6 py-3 rounded-lg font-medium bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 transition-colors",children:"联系支持"})]}),this.state.error&&t.jsxs("details",{className:"mt-6 p-4 rounded-lg text-left bg-gray-100 dark:bg-gray-800",children:[t.jsx("summary",{className:"cursor-pointer font-medium",children:"错误详情"}),t.jsxs("pre",{className:"mt-2 whitespace-pre-wrap text-sm",children:[this.state.error.toString(),this.state.errorInfo?.componentStack&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),"组件栈:",t.jsx("br",{}),this.state.errorInfo.componentStack]}),this.state.error.stack&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),"错误栈:",t.jsx("br",{}),this.state.error.stack]}),t.jsx("br",{}),"错误名称: ",this.state.error.name,t.jsx("br",{}),"错误消息: ",this.state.error.message]})]})]})}):this.props.children}};const ve=new class{creatorLevels=[{level:1,name:"创作新手",icon:"🌱",requiredPoints:0,"权益":["基础创作工具","作品发布权限","社区评论权限"],description:"刚刚开始创作之旅的新手"},{level:2,name:"创作爱好者",icon:"✏️",requiredPoints:100,"权益":["高级创作工具","模板库访问","作品打赏权限"],description:"热爱创作的积极用户"},{level:3,name:"创作达人",icon:"🌟",requiredPoints:300,"权益":["AI创意助手","专属客服支持","作品推广机会"],description:"创作能力突出的达人"},{level:4,name:"创作大师",icon:"🎨",requiredPoints:800,"权益":["限量模板使用权","线下活动邀请","品牌合作机会"],description:"创作领域的大师级人物"},{level:5,name:"创作传奇",icon:"👑",requiredPoints:2e3,"权益":["平台荣誉认证","定制化创作工具","IP孵化支持"],description:"创作界的传奇人物"}];achievements=[{id:1,name:"初次创作",description:"完成第一篇创作作品",icon:"star",rarity:"common",criteria:"完成1篇作品",progress:100,isUnlocked:!0,unlockedAt:"2025-11-01",points:10},{id:2,name:"活跃创作者",description:"连续7天登录平台",icon:"fire",rarity:"common",criteria:"连续登录7天",progress:100,isUnlocked:!0,unlockedAt:"2025-11-07",points:20},{id:3,name:"人气王",description:"获得100个点赞",icon:"thumbs-up",rarity:"rare",criteria:"获得100个点赞",progress:32,isUnlocked:!1,points:50},{id:4,name:"文化传播者",description:"使用5种不同文化元素",icon:"book",rarity:"rare",criteria:"使用5种不同文化元素",progress:60,isUnlocked:!1,points:40},{id:5,name:"作品达人",description:"发布10篇作品",icon:"image",rarity:"rare",criteria:"发布10篇作品",progress:30,isUnlocked:!1,points:80},{id:6,name:"商业成功",description:"作品被品牌采纳",icon:"handshake",rarity:"epic",criteria:"作品被品牌采纳1次",progress:0,isUnlocked:!1,points:200},{id:7,name:"传统文化大师",description:"精通传统文化知识",icon:"graduation-cap",rarity:"legendary",criteria:"完成10个文化知识问答",progress:0,isUnlocked:!1,points:300}];pointsRecords=[{id:1,source:"初次创作",type:"achievement",points:10,date:"2025-11-01",description:"完成第一篇创作作品",balanceAfter:10},{id:2,source:"活跃创作者",type:"achievement",points:20,date:"2025-11-07",description:"连续登录7天",balanceAfter:30},{id:3,source:"完成新手引导",type:"task",points:50,date:"2025-11-01",description:"完成平台新手引导",balanceAfter:80},{id:4,source:"发布第一篇作品",type:"task",points:100,date:"2025-11-01",description:"在平台发布第一篇作品",balanceAfter:180},{id:5,source:"每日签到",type:"daily",points:5,date:"2025-11-08",description:"每日签到奖励",balanceAfter:185}];consumptionRecords=[];userPoints=0;CASH_TO_POINTS_RATIO=1;POINTS_TO_CASH_RATIO=100;MAX_DISCOUNT_RATIO=.3;getAllAchievements(){return[...this.achievements]}getUnlockedAchievements(){return this.achievements.filter(e=>e.isUnlocked)}getLockedAchievements(){return this.achievements.filter(e=>!e.isUnlocked)}getAchievementById(e){return this.achievements.find(t=>t.id===e)}updateAchievementProgress(e,t){const s=this.getAchievementById(e);return!!(s&&!s.isUnlocked&&(s.progress=Math.min(t,100),s.progress>=100))&&(s.isUnlocked=!0,s.unlockedAt=(new Date).toISOString().split("T")[0],this.addPoints(s.points,"achievement",s.name,`解锁成就：${s.name}`),!0)}updateMultipleAchievements(e){const t=[];return e.forEach(e=>{this.updateAchievementProgress(e.id,e.progress)&&t.push(e.id)}),t}getAchievementStats(){const e=this.getUnlockedAchievements();return{total:this.achievements.length,unlocked:e.length,locked:this.achievements.length-e.length,completionRate:Math.round(e.length/this.achievements.length*100),recentUnlocks:e.sort((e,t)=>new Date(t.unlockedAt||"").getTime()-new Date(e.unlockedAt||"").getTime()).slice(0,3)}}getRarityDistribution(){const e={common:0,rare:0,epic:0,legendary:0};return this.achievements.forEach(t=>{e[t.rarity]++}),e}calculateUserPoints(){const e=this.getUnlockedAchievements();this.userPoints=e.reduce((e,t)=>e+t.points,0);const t=this.pointsRecords.filter(e=>"achievement"!==e.type).reduce((e,t)=>e+t.points,0);return this.userPoints+=t,this.userPoints}getCreatorLevelInfo(){const e=this.calculateUserPoints();let t=this.creatorLevels[0],s=null;for(let r=0;r<this.creatorLevels.length&&e>=this.creatorLevels[r].requiredPoints;r++)t=this.creatorLevels[r],s=r<this.creatorLevels.length-1?this.creatorLevels[r+1]:null;let a=0,i=0;if(s){a=s.requiredPoints-e;const r=s.requiredPoints-t.requiredPoints;i=Math.min(100,Math.round((e-t.requiredPoints)/r*100))}else a=0,i=100;return{currentLevel:t,nextLevel:s,currentPoints:e,pointsToNextLevel:a,levelProgress:i}}getAllCreatorLevels(){return[...this.creatorLevels]}getCreatorLevelByLevel(e){return this.creatorLevels.find(t=>t.level===e)}getCreatorLevelByPoints(e){let t=this.creatorLevels[0];for(const s of this.creatorLevels)e>=s.requiredPoints&&(t=s);return t}getPointsSourceStats(){const e={achievement:0,task:0,daily:0,consumption:0,exchange:0,other:0};return this.pointsRecords.forEach(t=>{const s=t.type in e?t.type:"other";e[s]+=t.points}),e}getRecentPointsRecords(e=5){return[...this.pointsRecords].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(0,e)}calculateAvailablePoints(){return this.achievements.filter(e=>!e.isUnlocked).reduce((e,t)=>e+t.points,0)+300+5}getPointsStats(){const e=this.calculateUserPoints(),t=this.calculateAvailablePoints();return{currentPoints:e,availablePoints:t,totalPossiblePoints:e+t,sourceStats:this.getPointsSourceStats(),recentRecords:this.getRecentPointsRecords()}}addPoints(e,t,s,a,i){const r=this.calculateUserPoints()+e;this.pointsRecords.push({id:this.pointsRecords.length+1,source:s,type:t,points:e,date:(new Date).toISOString().split("T")[0],description:a,relatedId:i,balanceAfter:r})}convertCashToPoints(e,t="消费兑换积分",s){const a=Math.floor(e*this.CASH_TO_POINTS_RATIO);return this.addPoints(a,"consumption","消费兑换",t,s),a}calculatePointsDiscount(e,t){const s=e*this.MAX_DISCOUNT_RATIO,a=t/this.POINTS_TO_CASH_RATIO,i=Math.min(s,a);return{discountAmount:i,actualPointsUsed:Math.floor(i*this.POINTS_TO_CASH_RATIO),finalAmount:e-i}}usePointsForDiscount(e,t,s="积分抵扣消费",a){if(t>this.calculateUserPoints())throw new Error("积分不足");const{discountAmount:i,actualPointsUsed:r,finalAmount:n}=this.calculatePointsDiscount(e,t);return this.addPoints(-r,"exchange","积分抵扣",s,a),this.consumptionRecords.push({id:this.consumptionRecords.length+1,amount:e,pointsEarned:Math.floor(n*this.CASH_TO_POINTS_RATIO),pointsUsed:r,finalAmount:n,date:(new Date).toISOString().split("T")[0],description:s,relatedId:a}),this.consumptionRecords[this.consumptionRecords.length-1].pointsEarned>0&&this.addPoints(this.consumptionRecords[this.consumptionRecords.length-1].pointsEarned,"consumption","消费获得",`${s}，获得${this.consumptionRecords[this.consumptionRecords.length-1].pointsEarned}积分`,a),{discountAmount:i,actualPointsUsed:r,finalAmount:n}}getPointsRecords(e,t=20,s=0){let a=[...this.pointsRecords];if(e){if(e.startDate){const t=e.startDate;a=a.filter(e=>e.date>=t)}if(e.endDate){const t=e.endDate;a=a.filter(e=>e.date<=t)}if(e.type&&(a=a.filter(t=>t.type===e.type)),e.search){const t=e.search.toLowerCase();a=a.filter(e=>e.source.toLowerCase().includes(t)||e.description.toLowerCase().includes(t))}}return a.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(s,s+t)}getConsumptionRecords(e=20,t=0){return[...this.consumptionRecords].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(t,t+e)}};function je({isOpen:a,onClose:n}){const{isDark:l}=k(),c=o(),[d,m]=e.useState(0),[g,h]=e.useState(!1),p=e.useRef(null),u=e.useRef(null);e.useEffect(()=>{if(a){const e=document.activeElement;p.current&&p.current.focus();const t=e=>{"Escape"===e.key&&(e.preventDefault(),b()),"ArrowRight"!==e.key&&"Enter"!==e.key&&" "!==e.key||g||(e.preventDefault(),y()),"ArrowLeft"===e.key&&d>0&&(e.preventDefault(),m(e=>e-1))};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t),e&&e.focus&&e.focus()}}},[a,d,g]),e.useEffect(()=>{u.current&&a&&u.current.focus()},[d,a]);const x=[{title:"欢迎加入 AI 共创平台",desc:"我们将用 5 步带你快速上手平台核心玩法",icon:"rocket"},{title:"探索灵感",desc:"在“作品探索”页浏览精选作品与主题合集，获取创作灵感",action:()=>c("/explore"),primaryText:"去探索",icon:"compass"},{title:"开始创作",desc:"在“创作中心”使用 AI 工具生成你的专属作品，体验AI创作魔力",action:()=>c("/create"),primaryText:"去创作",icon:"palette"},{title:"AI协作模式",desc:"使用AI协作面板与AI进行多轮对话，完善你的创意细节",action:()=>c("/lab"),primaryText:"去体验",icon:"robot"},{title:"参与社群",desc:"加入感兴趣的社群，分享作品获取反馈，与创作者一起成长",action:()=>c("/community"),primaryText:"进社群",icon:"users"},{title:"个性化设置",desc:"在“设置”中选择适合你创作风格的AI模型，打造专属创作环境",action:()=>c("/settings"),primaryText:"去设置",icon:"cog"}],y=()=>{d<x.length-1?m(e=>e+1):h(!0)},b=()=>{n(!1)};return t.jsx(r,{mode:"wait",children:a&&t.jsxs(s.div,{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:[t.jsx(s.div,{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:b,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3}}),t.jsxs(s.div,{className:`relative w-full max-w-2xl rounded-3xl p-8 ${l?"bg-gray-900 text-white":"bg-white text-gray-900"} shadow-2xl border ${l?"border-gray-800":"border-gray-100"} overflow-hidden`,initial:{scale:.9,y:20,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.9,y:20,opacity:0},transition:{type:"spring",damping:25,stiffness:300},children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-blue-500 via-purple-500 to-red-500"}),t.jsxs("div",{className:"relative",ref:p,tabIndex:0,role:"dialog","aria-modal":"true","aria-labelledby":"onboarding-title","aria-describedby":"onboarding-desc","aria-live":"polite",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(s.div,{className:"w-10 h-10 rounded-full bg-gradient-to-br from-red-500 to-pink-500 flex items-center justify-center text-white font-bold",whileHover:{scale:1.1},whileTap:{scale:.95},children:t.jsx("i",{className:`fas fa-${x[d].icon||"star"}`})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-bold text-red-600",id:"onboarding-title",children:"新手引导"}),t.jsx("div",{className:"text-xs opacity-60",id:"onboarding-desc",children:"快速上手平台核心功能"})]})]}),t.jsx("button",{onClick:b,className:(l?"text-gray-300 hover:text-gray-100":"text-gray-500 hover:text-gray-800")+" text-sm font-medium transition-all hover:scale-105","aria-label":"跳过新手引导",children:"跳过"})]}),t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsxs("span",{className:"text-sm font-medium",children:[d+1," / ",x.length]}),t.jsxs("span",{className:"text-sm opacity-60",children:[Math.round((d+1)/x.length*100),"%"]})]}),t.jsx("div",{className:"h-2 rounded-full overflow-hidden "+(l?"bg-gray-700":"bg-gray-200"),children:t.jsx(s.div,{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-red-500 rounded-full",initial:{width:0},animate:{width:(d+1)/x.length*100+"%"},transition:{duration:.5,ease:"easeOut"}})})]}),t.jsx(r,{mode:"wait",children:g?t.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.5},className:"text-center",children:[t.jsxs(s.div,{className:"w-24 h-24 mx-auto mb-6 relative",animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-yellow-400 via-orange-500 to-red-500 opacity-20 blur-xl animate-pulse"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("i",{className:"fas fa-trophy text-5xl text-yellow-500"})})]}),t.jsx("h2",{className:"text-3xl font-bold mb-3",children:"恭喜你！"}),t.jsx("p",{className:"text-lg mb-6 "+(l?"text-gray-300":"text-gray-600"),children:"新手引导已完成"}),t.jsxs("div",{className:"mb-8 p-6 rounded-xl "+(l?"bg-gray-800":"bg-gray-50"),children:[t.jsx("div",{className:"text-sm opacity-70 mb-2",children:"获得奖励"}),t.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[t.jsxs(s.div,{className:"flex flex-col items-center",whileHover:{scale:1.1},children:[t.jsx("div",{className:"text-3xl font-bold text-yellow-500 mb-1",children:"50"}),t.jsx("div",{className:"text-sm "+(l?"text-gray-400":"text-gray-600"),children:"积分"})]}),t.jsx("div",{className:"h-8 w-px bg-gradient-to-b from-transparent via-gray-400 to-transparent"}),t.jsxs(s.div,{className:"flex flex-col items-center",whileHover:{scale:1.1},children:[t.jsx("div",{className:"text-3xl font-bold text-blue-500 mb-1",children:"1"}),t.jsx("div",{className:"text-sm "+(l?"text-gray-400":"text-gray-600"),children:"成就"})]}),t.jsx("div",{className:"h-8 w-px bg-gradient-to-b from-transparent via-gray-400 to-transparent"}),t.jsxs(s.div,{className:"flex flex-col items-center",whileHover:{scale:1.1},children:[t.jsx("div",{className:"text-3xl font-bold text-purple-500 mb-1",children:"✓"}),t.jsx("div",{className:"text-sm "+(l?"text-gray-400":"text-gray-600"),children:"解锁"})]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("div",{className:"text-sm font-medium mb-4",children:"接下来你可以"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 max-w-md mx-auto",children:[t.jsx("div",{className:`p-3 rounded-lg ${l?"bg-gray-800 hover:bg-gray-700":"bg-gray-100 hover:bg-gray-200"} transition-colors cursor-pointer`,children:t.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx("i",{className:"fas fa-palette text-red-500"}),t.jsx("span",{className:"text-sm font-medium",children:"开始创作"})]})}),t.jsx("div",{className:`p-3 rounded-lg ${l?"bg-gray-800 hover:bg-gray-700":"bg-gray-100 hover:bg-gray-200"} transition-colors cursor-pointer`,children:t.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx("i",{className:"fas fa-compass text-blue-500"}),t.jsx("span",{className:"text-sm font-medium",children:"探索作品"})]})}),t.jsx("div",{className:`p-3 rounded-lg ${l?"bg-gray-800 hover:bg-gray-700":"bg-gray-100 hover:bg-gray-200"} transition-colors cursor-pointer`,children:t.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx("i",{className:"fas fa-users text-green-500"}),t.jsx("span",{className:"text-sm font-medium",children:"加入社群"})]})}),t.jsx("div",{className:`p-3 rounded-lg ${l?"bg-gray-800 hover:bg-gray-700":"bg-gray-100 hover:bg-gray-200"} transition-colors cursor-pointer`,children:t.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx("i",{className:"fas fa-cog text-purple-500"}),t.jsx("span",{className:"text-sm font-medium",children:"个性化设置"})]})})]})]})]},"completed"):t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.4},children:[t.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-4 leading-tight",children:x[d].title}),t.jsx("p",{className:`text-lg ${l?"text-gray-300":"text-gray-600"} mb-8`,children:x[d].desc})]},d)}),t.jsx("div",{className:"flex items-center justify-between flex-wrap gap-4",children:g?t.jsxs(s.button,{onClick:()=>{i.success(t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("i",{className:"fas fa-trophy text-yellow-400 text-xl"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-bold",children:"新手引导已完成！"}),t.jsx("div",{className:"text-sm opacity-80",children:"获得 50 积分奖励"})]})]})),n(!0)},className:"w-full px-6 py-3 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 text-white transition-all font-medium shadow-lg hover:shadow-xl",whileHover:{scale:1.03},whileTap:{scale:.98},"aria-label":"开始创作之旅",ref:u,children:["开始创作之旅",t.jsx("i",{className:"fas fa-rocket ml-2"})]}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:b,className:(l?"bg-gray-800 hover:bg-gray-700 text-gray-200":"bg-gray-100 hover:bg-gray-200 text-gray-800")+" px-5 py-3 rounded-lg transition-all font-medium hover:scale-105 active:scale-95 shadow-sm",children:"以后再说"}),t.jsxs("div",{className:"flex items-center space-x-4",children:[x[d].action&&t.jsxs(s.button,{onClick:x[d].action,className:"px-5 py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-all font-medium shadow-md hover:shadow-lg",whileHover:{scale:1.05,boxShadow:"0 10px 25px -5px rgba(59, 130, 246, 0.4)"},whileTap:{scale:.95},children:[t.jsx("i",{className:"fas fa-arrow-right mr-2"}),x[d].primaryText||"前往"]}),t.jsx(s.button,{ref:u,onClick:y,className:"px-6 py-3 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-all font-medium shadow-md hover:shadow-lg",whileHover:{scale:1.05,boxShadow:"0 10px 25px -5px rgba(239, 68, 68, 0.4)"},whileTap:{scale:.95},"aria-label":d<x.length-1?"进入下一步":"完成新手引导","aria-current":d===x.length-1?"step":void 0,children:d<x.length-1?t.jsxs(t.Fragment,{children:["下一步",t.jsx("i",{className:"fas fa-chevron-right ml-2"})]}):t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-check mr-2"}),"完成"]})})]})]})})]})]})]})})}function Ne({title:a,subtitle:i,badgeText:r,theme:n="red",stats:l=[],className:o,variant:c="center",showDecor:d=!0,size:m="md",pattern:g=!1}){const{isDark:h}=k(),p=e.useMemo(()=>{switch(n){case"indigo":return"from-indigo-600 to-fuchsia-600";case"blue":return"from-blue-600 to-cyan-600";case"heritage":return"from-red-700 to-amber-500";default:return"from-red-600 to-pink-600"}},[n]),u="lg"===m?"px-8 py-12":"sm"===m?"px-4 py-6":"px-6 py-10",x="lg"===m?"text-3xl md:text-4xl":"sm"===m?"text-xl md:text-2xl":"text-2xl md:text-3xl",y="lg"===m?"mt-3 text-base":"mt-2 text-sm";return t.jsxs(s.section,{className:`relative overflow-hidden rounded-3xl mb-8 text-white bg-gradient-to-r ${p} ${o||""} container mx-auto`,"aria-label":a,initial:{opacity:0,y:-12},animate:{opacity:1,y:0},transition:{duration:.4},children:[g&&t.jsx("div",{className:"pointer-events-none absolute inset-0 opacity-10",style:{backgroundImage:"linear-gradient(to right, rgba(255,255,255,0.08) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,0.08) 1px, transparent 1px)",backgroundSize:"20px 20px"}}),"center"===c?t.jsxs("div",{className:`container mx-auto ${u}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:`${x} font-bold tracking-tight`,children:a}),r&&t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h?"bg-black/30 ring-1 ring-gray-600":"bg-white/20 ring-1 ring-white/50"} backdrop-blur`,children:r})]}),i&&t.jsx("p",{className:`${h?"text-gray-200":"text-white/90"} ${y}`,children:i}),l.length>0&&t.jsx("div",{className:"mt-6 grid grid-cols-2 sm:grid-cols-4 gap-4",children:l.map((e,s)=>t.jsxs("div",{className:(h?"bg-black/20 ring-1 ring-gray-700":"bg-white/15 ring-1 ring-white/40")+" rounded-xl px-4 py-3 backdrop-blur",children:[t.jsx("div",{className:"text-xs opacity-80",children:e.label}),t.jsx("div",{className:"text-base font-semibold",children:e.value})]},s))})]}):t.jsx("div",{className:`container mx-auto ${u}`,children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-center",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:`${x} font-bold tracking-tight`,children:a}),r&&t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h?"bg-black/30 ring-1 ring-gray-600":"bg-white/20 ring-1 ring-white/50"} backdrop-blur`,children:r})]}),i&&t.jsx("p",{className:`${h?"text-gray-200":"text-white/90"} ${y}`,children:i})]}),t.jsxs("div",{className:"relative",children:[d&&t.jsx("div",{className:"pointer-events-none absolute -top-8 -right-8 w-40 h-40 rounded-full blur-2xl opacity-30 bg-white"}),l.length>0&&t.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.map((e,s)=>t.jsxs("div",{className:(h?"bg-black/20 ring-1 ring-gray-700":"bg-white/15 ring-1 ring-white/40")+" rounded-xl px-4 py-3 backdrop-blur",children:[t.jsx("div",{className:"text-xs opacity-80",children:e.label}),t.jsx("div",{className:"text-base font-semibold",children:e.value})]},s))})]})]})})]})}const we=new class{EVENTS_KEY="jmzf_cultural_events";PARTICIPATIONS_KEY="jmzf_event_participations";USER_EVENTS_KEY="jmzf_user_events";events=[{id:"event-001",title:"国潮文化创意设计大赛",description:"融合传统中国文化元素与现代设计风格的创意设计大赛",type:"competition",status:"upcoming",startDate:"2025-12-15",endDate:"2026-01-31",startTime:"00:00",endTime:"23:59",organizer:"津脉智坊",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Guochao%20cultural%20creative%20design%20competition%20banner",tags:["国潮","设计","大赛"],culturalElements:["中国传统纹样","中国传统色彩","传统工艺"],participantCount:128,maxParticipants:500,registrationDeadline:"2026-01-15",hasPrize:!0,prizeDescription:"一等奖1名：10000元现金 + 荣誉证书\n二等奖3名：5000元现金 + 荣誉证书\n三等奖5名：2000元现金 + 荣誉证书\n优秀奖10名：荣誉证书",rules:["参赛作品必须为原创，未侵犯他人知识产权","作品需融合至少一种中国传统元素","每人最多可提交3件作品","提交格式为PNG、JPG或SVG","作品分辨率不低于1920x1080"],requirements:["提交作品设计说明（100-500字）","说明作品中使用的文化元素及其来源","提供作品创作过程（可选）"],createdAt:"2025-11-01T00:00:00.000Z",updatedAt:"2025-11-10T00:00:00.000Z"},{id:"event-002",title:"天津文化创意工作坊",description:"学习天津传统文化元素，创作具有天津特色的创意作品",type:"workshop",status:"ongoing",startDate:"2025-11-01",endDate:"2025-12-31",startTime:"14:00",endTime:"17:00",location:"天津市和平区文化中心",organizer:"天津文化创意产业协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Tianjin%20cultural%20creative%20workshop%20banner",tags:["天津","文化","工作坊"],culturalElements:["杨柳青年画","泥人张","天津方言","天津小吃"],participantCount:45,maxParticipants:100,registrationDeadline:"2025-12-20",hasPrize:!1,createdAt:"2025-10-15T00:00:00.000Z",updatedAt:"2025-11-05T00:00:00.000Z"},{id:"event-003",title:"非遗文化数字创意展",description:"展示非遗文化的数字创意作品，推动非遗文化的传承与创新",type:"exhibition",status:"upcoming",startDate:"2026-02-01",endDate:"2026-02-28",onlineLink:"https://exhibition.example.com",organizer:"中国非遗保护中心",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Intangible%20cultural%20heritage%20digital%20exhibition%20banner",tags:["非遗","数字创意","展览"],culturalElements:["非遗","传统工艺","民族文化"],participantCount:0,hasPrize:!1,createdAt:"2025-11-20T00:00:00.000Z",updatedAt:"2025-11-20T00:00:00.000Z"},{id:"event-004",title:"传统文化元素AI共创活动",description:"使用AI工具创作融合传统文化元素的作品",type:"collaboration",status:"completed",startDate:"2025-09-01",endDate:"2025-10-31",startTime:"00:00",endTime:"23:59",onlineLink:"https://collab.example.com",organizer:"津脉智坊",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20culture%20AI%20collaboration%20event%20banner",tags:["AI","共创","传统文化"],culturalElements:["中国传统纹样","书法","国画","传统色彩"],participantCount:234,hasPrize:!0,prizeDescription:"优秀作品将获得AI创作工具免费使用权限",createdAt:"2025-08-15T00:00:00.000Z",updatedAt:"2025-10-31T00:00:00.000Z"},{id:"event-005",title:"传统文化主题活动周",description:"为期一周的传统文化主题活动，包括讲座、体验和展示",type:"theme",status:"upcoming",startDate:"2025-11-20",endDate:"2025-11-27",startTime:"09:00",endTime:"18:00",location:"北京市朝阳区文化中心",organizer:"中国传统文化促进会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20culture%20theme%20week%20event%20banner",tags:["传统文化","主题活动","讲座"],culturalElements:["儒家文化","道家思想","传统礼仪","茶文化"],participantCount:89,maxParticipants:200,registrationDeadline:"2025-11-15",hasPrize:!1,createdAt:"2025-10-20T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-006",title:"汉字文化创意设计大赛",description:"以汉字为核心元素，创作具有创意的设计作品",type:"competition",status:"upcoming",startDate:"2025-12-01",endDate:"2026-01-15",startTime:"00:00",endTime:"23:59",organizer:"中国文字博物馆",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Chinese%20character%20cultural%20creative%20design%20competition%20banner",tags:["汉字","设计","大赛"],culturalElements:["汉字文化","书法","篆刻","传统排版"],participantCount:156,maxParticipants:300,registrationDeadline:"2025-12-25",hasPrize:!0,prizeDescription:"一等奖1名：8000元现金 + 荣誉证书\n二等奖2名：4000元现金 + 荣誉证书\n三等奖5名：1500元现金 + 荣誉证书\n优秀奖20名：荣誉证书",rules:["参赛作品必须以汉字为核心元素","作品需体现汉字的文化内涵","每人最多可提交2件作品","提交格式为PNG、JPG或PDF","作品分辨率不低于300dpi"],requirements:["提交作品设计说明（150-800字）","说明作品的创意来源和文化意义","提供作品高清图片"],createdAt:"2025-10-10T00:00:00.000Z",updatedAt:"2025-11-05T00:00:00.000Z"},{id:"event-007",title:"传统剪纸艺术工作坊",description:"学习中国传统剪纸艺术，创作精美剪纸作品",type:"workshop",status:"upcoming",startDate:"2025-11-25",endDate:"2025-12-25",startTime:"10:00",endTime:"12:00",location:"上海市黄浦区群众艺术馆",organizer:"上海民间文艺家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20paper%20cutting%20art%20workshop%20banner",tags:["剪纸","传统工艺","工作坊"],culturalElements:["剪纸艺术","传统纹样","民俗文化"],participantCount:23,maxParticipants:50,registrationDeadline:"2025-11-20",hasPrize:!1,createdAt:"2025-10-25T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-008",title:"传统音乐数字协作计划",description:"邀请音乐人合作创作融合传统音乐元素的数字音乐作品",type:"collaboration",status:"ongoing",startDate:"2025-10-15",endDate:"2025-12-15",startTime:"00:00",endTime:"23:59",onlineLink:"https://music-collab.example.com",organizer:"中国音乐家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20music%20digital%20collaboration%20project%20banner",tags:["音乐","协作","传统音乐"],culturalElements:["传统乐器","古典音乐","民族音乐","戏曲元素"],participantCount:145,hasPrize:!0,prizeDescription:"优秀作品将在全国数字音乐平台推广",createdAt:"2025-09-20T00:00:00.000Z",updatedAt:"2025-10-15T00:00:00.000Z"},{id:"event-009",title:"中国传统陶瓷艺术展",description:"展示中国传统陶瓷艺术的发展历程和精美作品",type:"exhibition",status:"ongoing",startDate:"2025-11-05",endDate:"2025-12-05",startTime:"09:00",endTime:"17:00",location:"广州市天河区艺术博物馆",organizer:"中国陶瓷工业协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Chinese%20traditional%20ceramic%20art%20exhibition%20banner",tags:["陶瓷","传统工艺","展览"],culturalElements:["陶瓷艺术","景德镇陶瓷","钧瓷","青花瓷"],participantCount:345,hasPrize:!1,createdAt:"2025-10-05T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-010",title:"中秋文化主题活动",description:"庆祝中秋节，体验传统中秋文化活动",type:"theme",status:"completed",startDate:"2025-09-15",endDate:"2025-09-17",startTime:"18:00",endTime:"21:00",location:"全国各地文化广场",organizer:"中国民间文艺家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Mid-Autumn%20Festival%20cultural%20theme%20event%20banner",tags:["中秋节","传统节日","主题活动"],culturalElements:["中秋文化","月饼文化","赏月习俗","嫦娥奔月"],participantCount:567,hasPrize:!0,prizeDescription:"参与活动可获得传统月饼礼盒",createdAt:"2025-08-15T00:00:00.000Z",updatedAt:"2025-09-17T00:00:00.000Z"},{id:"event-011",title:"传统书法入门工作坊",description:"学习中国传统书法的基本技巧和理论",type:"workshop",status:"completed",startDate:"2025-08-01",endDate:"2025-08-31",startTime:"14:00",endTime:"16:00",location:"深圳市南山区图书馆",organizer:"深圳书法家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20calligraphy%20beginner%20workshop%20banner",tags:["书法","传统艺术","工作坊"],culturalElements:["书法艺术","楷书","行书","文房四宝"],participantCount:67,maxParticipants:80,hasPrize:!1,createdAt:"2025-07-10T00:00:00.000Z",updatedAt:"2025-08-31T00:00:00.000Z"},{id:"event-012",title:"传统建筑摄影大赛",description:"拍摄中国传统建筑，展示传统建筑之美",type:"competition",status:"completed",startDate:"2025-07-01",endDate:"2025-08-31",startTime:"00:00",endTime:"23:59",organizer:"中国摄影家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20architecture%20photography%20competition%20banner",tags:["摄影","建筑","传统建筑"],culturalElements:["传统建筑","故宫","园林","古村落"],participantCount:342,hasPrize:!0,prizeDescription:"一等奖1名：5000元现金 + 摄影器材\n二等奖3名：2000元现金 + 摄影器材\n三等奖5名：1000元现金 + 摄影器材\n优秀奖20名：摄影器材优惠券",rules:["参赛作品必须拍摄中国传统建筑","作品需体现传统建筑的美感和文化内涵","每人最多可提交5件作品","提交格式为JPG或RAW","作品分辨率不低于3000x2000像素"],requirements:["提交作品拍摄地点和时间","说明作品的构图思路和文化意义","提供作品原始文件"],createdAt:"2025-06-15T00:00:00.000Z",updatedAt:"2025-08-31T00:00:00.000Z"},{id:"event-013",title:"春节文化主题活动",description:"庆祝春节，体验传统春节文化活动，包括写春联、剪窗花、包饺子等",type:"theme",status:"upcoming",startDate:"2026-01-20",endDate:"2026-02-10",startTime:"09:00",endTime:"18:00",location:"全国各地文化中心",organizer:"中国民间文艺家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Spring%20Festival%20cultural%20theme%20event%20banner",tags:["春节","传统节日","文化体验"],culturalElements:["春节文化","春联","窗花","饺子","鞭炮"],participantCount:0,maxParticipants:1e3,registrationDeadline:"2026-01-15",hasPrize:!0,prizeDescription:"参与活动可获得春节文化大礼包",createdAt:"2025-11-01T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-014",title:"端午文化节",description:"纪念屈原，体验传统端午文化，包括包粽子、赛龙舟、挂艾草等活动",type:"theme",status:"upcoming",startDate:"2026-06-10",endDate:"2026-06-15",startTime:"08:00",endTime:"20:00",location:"杭州市西湖区文化广场",organizer:"杭州市文化和旅游局",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Dragon%20Boat%20Festival%20cultural%20event%20banner",tags:["端午节","龙舟赛","粽子"],culturalElements:["端午文化","屈原","龙舟","粽子","艾草"],participantCount:123,maxParticipants:500,registrationDeadline:"2026-06-05",hasPrize:!0,prizeDescription:"龙舟赛冠军队伍将获得10000元奖金",createdAt:"2025-11-05T00:00:00.000Z",updatedAt:"2025-11-05T00:00:00.000Z"},{id:"event-015",title:"中秋赏月文化活动",description:"中秋佳节，一起赏月、品月饼、听中秋故事，感受传统中秋文化",type:"theme",status:"upcoming",startDate:"2026-09-18",endDate:"2026-09-20",startTime:"17:00",endTime:"22:00",location:"北京市海淀区颐和园",organizer:"北京市文化和旅游局",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Mid-Autumn%20Festival%20moon%20viewing%20event%20banner",tags:["中秋节","赏月","月饼"],culturalElements:["中秋文化","月亮","月饼","嫦娥奔月","吴刚伐桂"],participantCount:89,maxParticipants:300,registrationDeadline:"2026-09-15",hasPrize:!1,createdAt:"2025-11-10T00:00:00.000Z",updatedAt:"2025-11-10T00:00:00.000Z"},{id:"event-016",title:"汉服文化主题展",description:"展示传统汉服文化，包括汉服走秀、汉服制作工艺、汉服文化讲座等",type:"theme",status:"ongoing",startDate:"2025-11-01",endDate:"2025-11-30",startTime:"10:00",endTime:"17:00",location:"成都市锦江区博物馆",organizer:"中国汉服文化协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Hanfu%20cultural%20theme%20exhibition%20banner",tags:["汉服","传统文化","服饰"],culturalElements:["汉服文化","传统服饰","礼仪","刺绣"],participantCount:234,maxParticipants:500,hasPrize:!1,createdAt:"2025-10-15T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-017",title:"茶文化体验周",description:"体验中国传统茶文化，包括茶艺表演、茶叶品鉴、茶文化讲座等",type:"theme",status:"ongoing",startDate:"2025-11-10",endDate:"2025-11-17",startTime:"14:00",endTime:"18:00",location:"上海市静安区茶文化中心",organizer:"中国茶叶流通协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Tea%20culture%20experience%20week%20banner",tags:["茶文化","茶艺","茶叶品鉴"],culturalElements:["茶文化","茶道","茶艺","茶叶","茶具"],participantCount:156,maxParticipants:200,hasPrize:!1,createdAt:"2025-10-20T00:00:00.000Z",updatedAt:"2025-11-10T00:00:00.000Z"},{id:"event-018",title:"重阳敬老文化活动",description:"庆祝重阳节，弘扬敬老爱老传统，包括老年书画展、健康讲座、文艺表演等",type:"theme",status:"completed",startDate:"2025-10-15",endDate:"2025-10-20",startTime:"09:00",endTime:"16:00",location:"南京市玄武区老年活动中心",organizer:"南京市老龄工作委员会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Double%20Ninth%20Festival%20elderly%20care%20event%20banner",tags:["重阳节","敬老","传统文化"],culturalElements:["重阳节","敬老文化","菊花","登高","茱萸"],participantCount:456,hasPrize:!1,createdAt:"2025-09-20T00:00:00.000Z",updatedAt:"2025-10-20T00:00:00.000Z"},{id:"event-019",title:"传统工艺数字保护计划",description:"邀请设计师和技术人员合作，将传统工艺数字化保护和传承",type:"collaboration",status:"upcoming",startDate:"2025-12-01",endDate:"2026-03-31",startTime:"00:00",endTime:"23:59",onlineLink:"https://craft-digital.example.com",organizer:"中国非物质文化遗产保护中心",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20craft%20digital%20preservation%20collaboration%20banner",tags:["传统工艺","数字化","协作"],culturalElements:["传统工艺","数字技术","文化传承"],participantCount:56,maxParticipants:200,registrationDeadline:"2025-11-25",hasPrize:!0,prizeDescription:"优秀项目将获得10万元资助",createdAt:"2025-10-01T00:00:00.000Z",updatedAt:"2025-10-01T00:00:00.000Z"},{id:"event-020",title:"传统文化短视频创作营",description:"邀请内容创作者和传统文化专家合作，创作高质量的传统文化短视频",type:"collaboration",status:"ongoing",startDate:"2025-10-01",endDate:"2025-12-31",startTime:"00:00",endTime:"23:59",onlineLink:"https://culture-video.example.com",organizer:"中国文化传媒集团",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20culture%20short%20video%20creation%20camp%20banner",tags:["短视频","创作","传统文化"],culturalElements:["传统文化","数字媒体","内容创作"],participantCount:189,maxParticipants:300,hasPrize:!0,prizeDescription:"优秀作品将获得平台流量支持和奖金",createdAt:"2025-09-15T00:00:00.000Z",updatedAt:"2025-10-01T00:00:00.000Z"},{id:"event-021",title:"古村落保护与发展设计竞赛",description:"邀请建筑师、设计师和当地居民合作，为古村落保护与发展提供设计方案",type:"collaboration",status:"ongoing",startDate:"2025-11-01",endDate:"2026-02-28",startTime:"00:00",endTime:"23:59",organizer:"中国建筑学会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Ancient%20village%20protection%20and%20development%20design%20competition%20banner",tags:["古村落","保护","设计","协作"],culturalElements:["古村落","传统建筑","乡村振兴"],participantCount:102,maxParticipants:150,registrationDeadline:"2025-12-31",hasPrize:!0,prizeDescription:"一等奖1名：20万元奖金 + 项目落地机会\n二等奖2名：10万元奖金\n三等奖3名：5万元奖金",createdAt:"2025-10-10T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-022",title:"传统音乐与现代音乐融合创作",description:"邀请传统音乐家和现代音乐人合作，创作融合传统音乐元素的现代音乐作品",type:"collaboration",status:"completed",startDate:"2025-08-01",endDate:"2025-10-31",startTime:"00:00",endTime:"23:59",onlineLink:"https://music-fusion.example.com",organizer:"中国音乐家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20and%20modern%20music%20fusion%20creation%20banner",tags:["音乐","融合","传统音乐","现代音乐"],culturalElements:["传统音乐","现代音乐","乐器","旋律"],participantCount:234,hasPrize:!0,prizeDescription:"优秀作品将在全国音乐平台推广",createdAt:"2025-07-15T00:00:00.000Z",updatedAt:"2025-10-31T00:00:00.000Z"},{id:"event-023",title:"中国传统纹样设计大赛",description:"以中国传统纹样为元素，创作具有现代感的设计作品",type:"competition",status:"upcoming",startDate:"2025-12-10",endDate:"2026-02-28",startTime:"00:00",endTime:"23:59",organizer:"中国美术家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Chinese%20traditional%20pattern%20design%20competition%20banner",tags:["纹样","设计","传统元素"],culturalElements:["传统纹样","中国结","云纹","龙纹","凤纹"],participantCount:89,maxParticipants:500,registrationDeadline:"2026-02-15",hasPrize:!0,prizeDescription:"一等奖1名：15000元现金 + 荣誉证书\n二等奖3名：8000元现金 + 荣誉证书\n三等奖5名：5000元现金 + 荣誉证书\n优秀奖20名：1000元现金 + 荣誉证书",rules:["参赛作品必须以中国传统纹样为核心元素","作品需体现传统与现代的融合","每人最多可提交3件作品","提交格式为PNG、JPG或AI","作品分辨率不低于300dpi"],requirements:["提交作品设计说明","说明使用的传统纹样及其文化内涵","提供作品高清图片"],createdAt:"2025-11-01T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-024",title:"传统美食创意大赛",description:"以传统美食为基础，创作具有创意的新菜品",type:"competition",status:"upcoming",startDate:"2026-01-01",endDate:"2026-03-31",startTime:"00:00",endTime:"23:59",organizer:"中国烹饪协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20food%20creative%20competition%20banner",tags:["美食","烹饪","传统美食","创意"],culturalElements:["传统美食","烹饪技艺","饮食文化"],participantCount:123,maxParticipants:300,registrationDeadline:"2026-03-15",hasPrize:!0,prizeDescription:"一等奖1名：8000元现金 + 美食专栏机会\n二等奖2名：5000元现金\n三等奖3名：3000元现金\n优秀奖10名：1000元现金",rules:["参赛作品必须以传统美食为基础","作品需体现创意和创新性","每人最多可提交2件作品","提交作品制作视频和图片","说明作品的传统渊源和创意点"],createdAt:"2025-11-10T00:00:00.000Z",updatedAt:"2025-11-10T00:00:00.000Z"},{id:"event-025",title:"传统故事新编创作大赛",description:"以中国传统故事为基础，创作具有现代意义的新故事",type:"competition",status:"ongoing",startDate:"2025-10-01",endDate:"2025-12-31",startTime:"00:00",endTime:"23:59",onlineLink:"https://story-reimagined.example.com",organizer:"中国作家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20story%20reimagined%20creative%20competition%20banner",tags:["故事","创作","传统故事","新编"],culturalElements:["传统故事","神话传说","民间故事"],participantCount:234,maxParticipants:1e3,registrationDeadline:"2025-12-15",hasPrize:!0,prizeDescription:"一等奖1名：10000元现金 + 出版机会\n二等奖2名：5000元现金\n三等奖5名：2000元现金\n优秀奖20名：500元现金",rules:["参赛作品必须以中国传统故事为基础","作品需体现现代意义和价值观","每人最多可提交1件作品","作品字数在3000-10000字之间","提交作品电子文档"],createdAt:"2025-09-15T00:00:00.000Z",updatedAt:"2025-10-01T00:00:00.000Z"},{id:"event-026",title:"传统乐器演奏大赛",description:"展示传统乐器演奏技艺，传承和弘扬传统音乐文化",type:"competition",status:"completed",startDate:"2025-08-01",endDate:"2025-09-30",startTime:"00:00",endTime:"23:59",organizer:"中国音乐家协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20musical%20instrument%20performance%20competition%20banner",tags:["乐器","演奏","传统音乐"],culturalElements:["传统乐器","古筝","琵琶","二胡","笛子"],participantCount:345,hasPrize:!0,prizeDescription:"一等奖1名：10000元现金 + 演出机会\n二等奖3名：5000元现金\n三等奖5名：2000元现金\n优秀奖10名：1000元现金",rules:["参赛作品必须使用传统乐器演奏","可以演奏传统曲目或改编曲目","每人最多可提交1件作品","提交演奏视频","视频时长不超过10分钟"],createdAt:"2025-07-10T00:00:00.000Z",updatedAt:"2025-09-30T00:00:00.000Z"},{id:"event-027",title:"传统木雕技艺工作坊",description:"学习传统木雕技艺，创作精美的木雕作品",type:"workshop",status:"upcoming",startDate:"2025-12-05",endDate:"2025-12-12",startTime:"10:00",endTime:"17:00",location:"福州市鼓楼区工艺美术学院",organizer:"福建省工艺美术协会",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20wood%20carving%20art%20workshop%20banner",tags:["木雕","传统工艺","手工"],culturalElements:["木雕技艺","传统雕刻","木材"],participantCount:12,maxParticipants:30,registrationDeadline:"2025-11-30",hasPrize:!1,createdAt:"2025-11-01T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-028",title:"传统造纸工艺体验",description:"学习传统造纸工艺，亲手制作纸张",type:"workshop",status:"ongoing",startDate:"2025-11-01",endDate:"2025-12-31",startTime:"14:00",endTime:"16:00",location:"昆明市官渡区文化创意园",organizer:"云南省非物质文化遗产保护中心",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20paper%20making%20workshop%20banner",tags:["造纸","传统工艺","体验"],culturalElements:["造纸术","传统工艺","纤维"],participantCount:67,maxParticipants:200,hasPrize:!1,createdAt:"2025-10-15T00:00:00.000Z",updatedAt:"2025-11-01T00:00:00.000Z"},{id:"event-029",title:"传统染织技艺工作坊",description:"学习传统染织技艺，包括扎染、蜡染、蓝印花布等",type:"workshop",status:"completed",startDate:"2025-09-01",endDate:"2025-09-30",startTime:"10:00",endTime:"17:00",location:"苏州市吴江区丝绸博物馆",organizer:"苏州市文化和旅游局",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20textile%20dyeing%20workshop%20banner",tags:["染织","传统工艺","扎染","蜡染"],culturalElements:["染织技艺","扎染","蜡染","蓝印花布"],participantCount:123,maxParticipants:150,hasPrize:!1,createdAt:"2025-08-15T00:00:00.000Z",updatedAt:"2025-09-30T00:00:00.000Z"},{id:"event-030",title:"中国传统书画展",description:"展示中国传统书画作品，包括书法、国画、篆刻等",type:"exhibition",status:"upcoming",startDate:"2026-01-10",endDate:"2026-03-10",startTime:"09:00",endTime:"17:00",location:"北京市东城区中国美术馆",organizer:"中国美术馆",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Chinese%20traditional%20calligraphy%20and%20painting%20exhibition%20banner",tags:["书画","传统艺术","展览"],culturalElements:["书法","国画","篆刻","传统美学"],participantCount:0,maxParticipants:5e3,hasPrize:!1,createdAt:"2025-11-05T00:00:00.000Z",updatedAt:"2025-11-05T00:00:00.000Z"}];participations=[];constructor(){this.loadData()}loadData(){try{const e=localStorage.getItem(this.EVENTS_KEY);e&&(this.events=JSON.parse(e));const t=localStorage.getItem(this.PARTICIPATIONS_KEY);t&&(this.participations=JSON.parse(t))}catch(e){}}saveEvents(){try{localStorage.setItem(this.EVENTS_KEY,JSON.stringify(this.events))}catch(e){}}saveParticipations(){try{localStorage.setItem(this.PARTICIPATIONS_KEY,JSON.stringify(this.participations))}catch(e){}}getAllEvents(){return[...this.events]}getEventById(e){return this.events.find(t=>t.id===e)}getEventsByStatus(e){return this.events.filter(t=>t.status===e)}getEventsByType(e){return this.events.filter(t=>t.type===e)}getUpcomingEvents(e){return this.events.filter(e=>"upcoming"===e.status||"ongoing"===e.status).sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime()).slice(0,e)}getRecentCompletedEvents(e){return this.events.filter(e=>"completed"===e.status).sort((e,t)=>new Date(t.endDate).getTime()-new Date(e.endDate).getTime()).slice(0,e)}getEventsByCulturalElement(e){return this.events.filter(t=>t.culturalElements.includes(e))}getEventsByTag(e){return this.events.filter(t=>t.tags.includes(e))}searchEvents(e){const t=e.toLowerCase();return this.events.filter(e=>e.title.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t))||e.culturalElements.some(e=>e.toLowerCase().includes(t)))}createEvent(e){const t={...e,id:`event-${Date.now()}`,participantCount:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return this.events.push(t),this.saveEvents(),t}updateEvent(e,t){const s=this.events.findIndex(t=>t.id===e);return-1!==s&&(this.events[s]={...this.events[s],...t,updatedAt:(new Date).toISOString()},this.saveEvents(),!0)}registerForEvent(e,t,s,a){const i=this.getEventById(e);if(!i)throw new Error("Event not found");if(i.maxParticipants&&i.participantCount>=i.maxParticipants)throw new Error("Event is full");const r=this.participations.find(s=>s.eventId===e&&s.userId===t);if(r)return r;const n={id:`participation-${Date.now()}`,eventId:e,userId:t,userName:s,userAvatar:a,registeredAt:(new Date).toISOString(),status:"registered"};return this.participations.push(n),this.saveParticipations(),this.updateEvent(e,{participantCount:i.participantCount+1}),n}submitEventWork(e,t,s,a,i){const r=this.participations.findIndex(t=>t.id===e);return-1!==r&&(this.participations[r]={...this.participations[r],status:"submitted",submissionId:t,submissionTitle:s,submissionDescription:a,submissionImage:i},this.saveParticipations(),!0)}getEventParticipations(e){return this.participations.filter(t=>t.eventId===e)}getUserParticipations(e){return this.participations.filter(t=>t.userId===e)}getEventStats(){const e=this.events.length,t=this.events.filter(e=>"upcoming"===e.status).length,s=this.events.filter(e=>"ongoing"===e.status).length,a=this.events.filter(e=>"completed"===e.status).length,i=this.participations.length;return{totalEvents:e,upcomingEvents:t,ongoingEvents:s,completedEvents:a,totalParticipants:i,averageParticipantsPerEvent:e>0?Math.round(i/e):0,eventsByType:{theme:this.events.filter(e=>"theme"===e.type).length,collaboration:this.events.filter(e=>"collaboration"===e.type).length,competition:this.events.filter(e=>"competition"===e.type).length,workshop:this.events.filter(e=>"workshop"===e.type).length,exhibition:this.events.filter(e=>"exhibition"===e.type).length}}}},_e=new class{sessions=new Map;versionHistory=new Map;nextSessionId=1;nextVersionId=1;nextHistoryId=1;createSession(e,t){const s={id:"session-"+this.nextSessionId++,name:e,creator:t,createdAt:new Date,updatedAt:new Date,collaborators:[],history:[],currentVersion:"v1.0"};return this.sessions.set(s.id,s),this.versionHistory.set(s.id,[]),s}getSession(e){return this.sessions.get(e)}getAllSessions(){return Array.from(this.sessions.values())}inviteUser(e,t,s){const a=this.sessions.get(e);if(!a)return null;const i={id:`user-${Math.floor(1e3*Math.random())}`,username:t.split("@")[0],email:t,avatar:`https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=User%20avatar%20${t.split("@")[0]}`,role:s,isOnline:!0,joinedAt:new Date};return a.collaborators.push(i),a.updatedAt=new Date,this.addHistory(e,{userId:a.creator,username:"系统",action:`邀请了 ${i.username} 加入会话`,timestamp:new Date,details:{role:s}}),i}removeUser(e,t){const s=this.sessions.get(e);if(!s)return!1;const a=s.collaborators.findIndex(e=>e.id===t);if(-1===a)return!1;const i=s.collaborators[a];return s.collaborators.splice(a,1),s.updatedAt=new Date,this.addHistory(e,{userId:s.creator,username:"系统",action:`移除了 ${i.username}`,timestamp:new Date}),!0}updateUserRole(e,t,s){const a=this.sessions.get(e);if(!a)return!1;const i=a.collaborators.find(e=>e.id===t);if(!i)return!1;const r=i.role;return i.role=s,a.updatedAt=new Date,this.addHistory(e,{userId:a.creator,username:"系统",action:`将 ${i.username} 的角色从 ${"editor"===r?"编辑者":"查看者"} 更改为 ${"editor"===s?"编辑者":"查看者"}`,timestamp:new Date,details:{oldRole:r,newRole:s}}),!0}updateUserStatus(e,t,s){const a=this.sessions.get(e);if(!a)return!1;const i=a.collaborators.find(e=>e.id===t);return!!i&&(i.isOnline=s,i.lastActive=new Date,a.updatedAt=new Date,!0)}updateCursorPosition(e,t,s){const a=this.sessions.get(e);if(!a)return!1;const i=a.collaborators.find(e=>e.id===t);return!!i&&(i.cursorPosition=s,i.lastActive=new Date,a.updatedAt=new Date,!0)}addHistory(e,t){const s=this.sessions.get(e);if(!s)throw new Error(`Session ${e} not found`);const a={id:"history-"+this.nextHistoryId++,...t,timestamp:new Date};return s.history.push(a),s.updatedAt=new Date,s.history.length>100&&(s.history=s.history.slice(-100)),a}createVersion(e,t,s,a){const i=this.sessions.get(e);if(!i)throw new Error(`Session ${e} not found`);const r=this.versionHistory.get(e)||[],n=r.length+1,l={id:"version-"+this.nextVersionId++,sessionId:e,version:`v1.${n}`,timestamp:new Date,creator:t,description:s,snapshot:a};return r.unshift(l),this.versionHistory.set(e,r),i.currentVersion=l.version,i.updatedAt=new Date,this.addHistory(e,{userId:t,username:t,action:`创建了版本 ${l.version}`,timestamp:new Date,details:{description:s}}),l}getVersionHistory(e){return this.versionHistory.get(e)||[]}getCollaborators(e){const t=this.sessions.get(e);return t?t.collaborators:[]}getHistory(e){const t=this.sessions.get(e);return t?t.history:[]}deleteSession(e){const t=this.sessions.delete(e);return t&&this.versionHistory.delete(e),t}},ke=({isOpen:a,onClose:r,sessionId:n="session-1"})=>{const{isDark:l}=k(),[o,c]=e.useState([]),[d,m]=e.useState([]),[g,h]=e.useState([]),[p,u]=e.useState(""),[x,y]=e.useState("editor"),[b,f]=e.useState(!0),[v,j]=e.useState("collaborators"),[N,w]=e.useState(null);return e.useEffect(()=>{if(a){f(!0),w(null);try{setTimeout(()=>{let e=_e.getSession(n);e||(e=_e.createSession("新协作项目","当前用户"));const t=_e.getCollaborators(n);c(t);const s=_e.getHistory(n);m(s);const a=_e.getVersionHistory(n);h(a),f(!1)},800)}catch(e){w("加载协作数据失败，请稍后再试"),f(!1)}}},[a,n]),a?t.jsxs(s.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},transition:{duration:.3},className:`fixed top-0 right-0 w-full max-w-md h-full ${l?"bg-gray-800":"bg-white"} shadow-2xl z-50 flex flex-col`,children:[t.jsxs("div",{className:`p-4 border-b ${l?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[t.jsx("h3",{className:"text-lg font-bold",children:"协作创作"}),t.jsx("button",{onClick:r,className:`p-2 rounded-full ${l?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsx("div",{className:"border-b "+(l?"border-gray-700":"border-gray-200"),children:t.jsx("div",{className:"flex",children:[{id:"collaborators",name:"协作者"},{id:"history",name:"操作历史"},{id:"versions",name:"版本管理"}].map(e=>t.jsx("button",{onClick:()=>j(e.id),className:"px-4 py-3 transition-colors font-medium text-sm "+(v===e.id?"text-red-600 border-b-2 border-red-600":l?"text-gray-400 hover:text-white":"text-gray-600 hover:text-black"),children:e.name},e.id))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[N&&t.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-red-100 text-red-600 text-sm flex items-center",children:[t.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),N]}),"collaborators"===v&&t.jsxs("div",{children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-users mr-2"}),"协作成员 (",o.length,")"]}),b?t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsxs("div",{className:"flex items-center p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 dark:bg-gray-600 mr-4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 w-1/3 bg-gray-300 dark:bg-gray-600 rounded mb-2"}),t.jsx("div",{className:"h-3 w-1/4 bg-gray-300 dark:bg-gray-600 rounded"})]})]},e))}):t.jsx("div",{className:"space-y-3",children:o.map(e=>t.jsxs("div",{className:`p-3 rounded-xl ${l?"bg-gray-700":"bg-gray-50"} flex items-center`,children:[t.jsxs("div",{className:"relative mr-4",children:[t.jsx("img",{src:e.avatar,alt:e.username,className:"h-10 w-10 rounded-full"}),t.jsx("span",{className:"absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-white "+(e.isOnline?"bg-green-500":"bg-gray-400")})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("p",{className:"font-medium",children:e.username}),t.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full "+("editor"===e.role?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:"editor"===e.role?"编辑者":"查看者"})]}),t.jsx("p",{className:"text-xs opacity-70",children:e.isOnline?"在线":`最后在线：${e.lastActive?new Date(e.lastActive).toLocaleString():"未知"}`})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("select",{value:e.role,onChange:t=>((e,t)=>{try{_e.updateUserRole(n,e,t)?(c(s=>s.map(s=>s.id===e?{...s,role:t}:s)),i.success("已更新协作成员角色")):i.error("操作失败，请稍后再试")}catch(s){i.error("操作失败，请稍后再试")}})(e.id,t.target.value),className:`text-xs p-1 rounded ${l?"bg-gray-600 border-gray-500":"bg-gray-200 border-gray-300"} border`,children:[t.jsx("option",{value:"editor",children:"编辑者"}),t.jsx("option",{value:"viewer",children:"查看者"})]}),t.jsx("button",{onClick:()=>(e=>{try{_e.removeUser(n,e)?(c(t=>t.filter(t=>t.id!==e)),i.success("已移除协作成员")):i.error("操作失败，请稍后再试")}catch(t){i.error("操作失败，请稍后再试")}})(e.id),className:`p-1.5 rounded ${l?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} text-red-500 transition-colors`,"aria-label":"移除",children:t.jsx("i",{className:"fas fa-times"})})]})]},e.id))})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-user-plus mr-2"}),"邀请协作者"]}),t.jsx("div",{className:"p-4 rounded-xl "+(l?"bg-gray-700":"bg-gray-50"),children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"邮箱地址"}),t.jsx("input",{type:"email",value:p,onChange:e=>u(e.target.value),placeholder:"输入协作者邮箱",className:"w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors "+(l?"bg-gray-600 border-gray-500 text-white placeholder-gray-400 border":"bg-white border-gray-300 text-gray-900 placeholder-gray-400 border")})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"角色"}),t.jsxs("select",{value:x,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors "+(l?"bg-gray-600 border-gray-500 text-white border":"bg-white border-gray-300 text-gray-900 border"),children:[t.jsx("option",{value:"editor",children:"编辑者（可修改内容）"}),t.jsx("option",{value:"viewer",children:"查看者（仅可查看）"})]})]}),t.jsxs("button",{onClick:()=>{if(p)try{const e=_e.inviteUser(n,p,x);e?(c(t=>[...t,e]),i.success(`已邀请 ${p} 加入协作`),u(""),y("editor")):i.error("邀请失败，请稍后再试")}catch(e){i.error("邀请失败，请稍后再试")}else i.error("请输入邮箱地址")},className:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center",children:[t.jsx("i",{className:"fas fa-paper-plane mr-2"}),"发送邀请"]})]})})]})]}),"history"===v&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-history mr-2"}),"操作历史"]}),b?t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsxs("div",{className:"flex items-center p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[t.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-300 dark:bg-gray-600 mr-3"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-3 w-1/2 bg-gray-300 dark:bg-gray-600 rounded mb-1"}),t.jsx("div",{className:"h-2 w-1/4 bg-gray-300 dark:bg-gray-600 rounded"})]})]},e))}):t.jsx("div",{className:"space-y-3",children:d.map(e=>t.jsxs("div",{className:`p-3 rounded-xl ${l?"bg-gray-700":"bg-gray-50"} flex items-center`,children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${l?"bg-gray-600":"bg-gray-200"} mr-3`,children:t.jsx("i",{className:"fas fa-user text-sm"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:e.username}),t.jsx("span",{className:"ml-2 "+(l?"text-gray-400":"text-gray-600"),children:e.action})]}),t.jsx("p",{className:"text-xs opacity-70",children:new Date(e.timestamp).toLocaleString()})]})]},e.id))})]}),"versions"===v&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-base font-medium mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-code-branch mr-2"}),"版本管理"]}),b?t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsxs("div",{className:"p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("div",{className:"h-4 w-1/4 bg-gray-300 dark:bg-gray-600 rounded mb-2"}),t.jsx("div",{className:"h-4 w-1/4 bg-gray-300 dark:bg-gray-600 rounded mb-2"})]}),t.jsx("div",{className:"h-3 w-1/2 bg-gray-300 dark:bg-gray-600 rounded mb-3"}),t.jsx("div",{className:"flex justify-end",children:t.jsx("div",{className:"h-7 w-20 bg-gray-300 dark:bg-gray-600 rounded"})})]},e))}):t.jsx("div",{className:"space-y-3",children:g.map(e=>t.jsxs("div",{className:"p-3 rounded-xl "+(l?"bg-gray-700":"bg-gray-50"),children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"font-medium",children:e.version}),t.jsx("span",{className:"text-xs opacity-70",children:new Date(e.timestamp).toLocaleString()})]}),t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center mr-2",children:t.jsx("i",{className:"fas fa-user text-xs"})}),t.jsx("span",{className:"text-sm",children:e.creator})]}),t.jsx("p",{className:"text-sm mb-3",children:e.description}),t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx("button",{className:`p-1.5 rounded text-sm ${l?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors`,children:"查看差异"}),"version-1"!==e.id&&t.jsx("button",{className:"p-1.5 rounded text-sm bg-blue-600 hover:bg-blue-700 text-white transition-colors",children:"恢复此版本"})]})]},e.id))})]})]}),t.jsx("div",{className:"p-4 border-t "+(l?"border-gray-700":"border-gray-200"),children:t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs("button",{className:`flex-1 p-2 rounded-lg ${l?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors flex items-center justify-center`,children:[t.jsx("i",{className:"fas fa-link mr-2"}),t.jsx("span",{children:"复制分享链接"})]}),t.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white p-2 rounded-lg transition-colors flex items-center justify-center",children:t.jsx("i",{className:"fas fa-bell"})})]})})]}):null},Se=({workId:a,onClose:r})=>{const{isDark:n}=k(),{t:l}=c(),[o,p]=e.useState(null),[u,x]=e.useState(!0),[y,b]=e.useState(!1),[f,v]=e.useState("overall");e.useEffect(()=>{x(!0),setTimeout(async()=>{try{const e="This is a design work that integrates traditional cloud pattern elements, using red tones and modern layout",t=se.diagnoseCreationIssues(e);p({overallScore:85,culturalFit:{score:90,details:["Successfully integrated traditional cloud pattern elements","Color matching conforms to traditional Chinese aesthetics","Pattern layout is reasonable, preserving cultural charm"]},creativity:{score:82,details:["Innovative combination of traditional elements with modern design","Novel composition with strong visual impact","Can try more diversified cultural element fusion"]},aesthetics:{score:88,details:["Overall visual effect is harmonious and unified","Clear color hierarchy with natural transitions","Reasonable typography with突出重点"]},suggestions:t.length>0?t:["Suggest adding more diverse traditional pattern combinations","Consider adding intangible cultural heritage elements to enhance cultural depth","Try different color matching schemes to further highlight the national trend style","Add interactive elements to enhance user engagement","Consider commercial application scenarios and optimize design details"],commercialPotential:{score:85,analysis:["Design style conforms to current national trend, with high commercial value","Suitable for cultural and creative products, packaging design and other fields","Suggest applying for copyright certification to protect original rights","Consider participating in commercial docking activities organized by the platform"]},similarWorks:[{id:1,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Similar%20traditional%20Chinese%20design%20work%201",title:"New National Trend Style"},{id:2,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Similar%20traditional%20Chinese%20design%20work%202",title:"Traditional Pattern Innovation"},{id:3,thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Similar%20traditional%20Chinese%20design%20work%203",title:"Oriental Aesthetics Reconstruction"}]}),x(!1)}catch(e){x(!1)}},1500)},[a,l]);const j=e=>e>=90?{text:l("review.excellent"),color:"text-green-500"}:e>=80?{text:l("review.good"),color:"text-blue-500"}:e>=70?{text:l("review.average"),color:"text-yellow-500"}:e>=60?{text:l("review.pass"),color:"text-orange-500"}:{text:l("review.needImprovement"),color:"text-red-500"};return u?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center "+(n?"bg-gray-900":"bg-gray-50"),children:t.jsx(s.div,{className:`p-8 rounded-2xl ${n?"bg-gray-800":"bg-white"} shadow-xl max-w-md w-full mx-4`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-600 mb-4"}),t.jsx("p",{className:"text-lg font-medium mb-2",children:"Generating AI review..."}),t.jsx("p",{className:"text-sm "+(n?"text-gray-400":"text-gray-600"),children:"Analyzing your work, please wait..."})]})})}):o?t.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:`fixed inset-0 z-50 flex items-center justify-center ${n?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:t.jsxs(s.div,{className:`rounded-2xl ${n?"bg-gray-800":"bg-white"} shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto mx-4`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[t.jsxs("div",{className:`p-6 border-b ${n?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[t.jsx("h3",{className:"text-xl font-bold",children:"AI Review"}),t.jsx("button",{onClick:r,className:`p-2 rounded-full ${n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"Close",children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsx("div",{className:"border-b "+(n?"border-gray-700":"border-gray-200"),children:t.jsx("div",{className:"flex",children:[{id:"overall",name:"Overall Rating"},{id:"detail",name:"Detailed Review"},{id:"commercial",name:"Commercial Advice"}].map(e=>t.jsx("button",{onClick:()=>v(e.id),className:"px-6 py-3 transition-colors font-medium text-sm "+(f===e.id?"text-red-600 border-b-2 border-red-600":n?"text-gray-400 hover:text-white":"text-gray-600 hover:text-black"),children:e.name},e.id))})}),t.jsxs("div",{className:"p-6",children:["overall"===f&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-center mb-8",children:[t.jsx("div",{className:"flex-shrink-0 mb-6 md:mb-0 md:mr-8",children:t.jsxs("div",{className:"relative w-32 h-32",children:[t.jsx(d,{width:"100%",height:"100%",children:t.jsx(m,{children:t.jsxs(g,{data:[{value:o.overallScore},{value:100-o.overallScore}],cx:"50%",cy:"50%",innerRadius:30,outerRadius:50,startAngle:90,endAngle:-270,paddingAngle:0,dataKey:"value",children:[t.jsx(h,{fill:"#f87171"}),t.jsx(h,{fill:n?"#374151":"#e5e7eb"})]})})}),t.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:[t.jsx("span",{className:"text-3xl font-bold",children:o.overallScore}),t.jsx("span",{className:"text-sm opacity-70",children:"总分"})]})]})}),t.jsx("div",{className:"flex-1",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{title:"Cultural Fit",score:o.culturalFit.score,color:"text-green-500"},{title:"Creativity",score:o.creativity.score,color:"text-blue-500"},{title:"Aesthetics",score:o.aesthetics.score,color:"text-purple-500"}].map((e,s)=>{const a=j(e.score);return t.jsxs("div",{className:"p-4 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),children:[t.jsx("p",{className:"text-sm mb-1",children:e.title}),t.jsxs("div",{className:"flex items-end",children:[t.jsx("span",{className:"text-2xl font-bold mr-2",children:e.score}),t.jsx("span",{className:`text-sm ${a.color}`,children:a.text})]})]},s)})})})]}),t.jsxs("div",{className:`p-5 rounded-xl ${n?"bg-gray-700":"bg-gray-50"} mb-8`,children:[t.jsx("h4",{className:"font-medium mb-3",children:"Work Highlights"}),t.jsxs("ul",{className:"space-y-2",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:"文化元素融入自然，展现了深厚的文化底蕴"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:"设计风格现代与传统完美结合，符合当下国潮趋势"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:"视觉层次分明，色彩搭配和谐统一"})]})]})]}),o.similarWorks&&o.similarWorks.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-medium mb-4",children:"推荐参考作品"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:o.similarWorks.map(e=>t.jsxs(s.div,{className:(n?"bg-gray-700":"bg-gray-50")+" rounded-xl overflow-hidden shadow-sm transition-all hover:shadow-md",whileHover:{y:-5},children:[t.jsx(E,{src:e.thumbnail,alt:e.title,className:"w-full h-32 object-cover",ratio:"landscape",fit:"cover"}),t.jsx("div",{className:"p-3",children:t.jsx("p",{className:"text-sm font-medium text-center",children:e.title})})]},e.id))})]})]}),"detail"===f&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"p-5 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h5",{className:"font-medium",children:"文化契合度"}),t.jsx("div",{className:`text-sm ${j(o.culturalFit.score).color}`,children:j(o.culturalFit.score).text})]}),t.jsx("ul",{className:"space-y-2",children:o.culturalFit.details.map((e,s)=>t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:e})]},s))})]}),t.jsxs("div",{className:"p-5 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h5",{className:"font-medium",children:"创意性"}),t.jsx("div",{className:`text-sm ${j(o.creativity.score).color}`,children:j(o.creativity.score).text})]}),t.jsx("ul",{className:"space-y-2",children:o.creativity.details.map((e,s)=>t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:e})]},s))})]}),t.jsxs("div",{className:"p-5 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h5",{className:"font-medium",children:"美学表现"}),t.jsx("div",{className:`text-sm ${j(o.aesthetics.score).color}`,children:j(o.aesthetics.score).text})]}),t.jsx("ul",{className:"space-y-2",children:o.aesthetics.details.map((e,s)=>t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:e})]},s))})]}),t.jsxs("div",{className:"p-5 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),children:[t.jsx("h5",{className:"font-medium mb-3",children:"改进建议"}),t.jsx("ul",{className:"space-y-3",children:(y?o.suggestions:o.suggestions.slice(0,2)).map((e,s)=>t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mt-1 mr-2 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"text-sm",children:e}),t.jsx("button",{onClick:()=>{i.success(l("review.applySuggestionSuccess"))},className:"ml-2 text-xs text-red-600 hover:text-red-700",children:"Apply this suggestion"})]})]},s))}),o.suggestions.length>2&&t.jsxs("button",{onClick:()=>b(!y),className:"mt-3 text-sm text-red-600 hover:text-red-700 flex items-center",children:[y?"Collapse":"View more suggestions",t.jsx("i",{className:`fas fa-chevron-${y?"up":"down"} ml-1`})]})]})]}),"commercial"===f&&o.commercialPotential&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center mb-6",children:[t.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-4",children:t.jsx("i",{className:"fas fa-chart-line text-2xl"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-bold mb-1",children:"Commercial Potential Assessment"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-2xl font-bold mr-2",children:o.commercialPotential.score}),t.jsx("span",{className:`${j(o.commercialPotential.score).color} text-sm`,children:j(o.commercialPotential.score).text})]})]})]}),t.jsxs("div",{className:`p-5 rounded-xl ${n?"bg-gray-700":"bg-gray-50"} mb-6`,children:[t.jsx("h5",{className:"font-medium mb-3",children:"商业化分析"}),t.jsx("ul",{className:"space-y-2",children:o.commercialPotential.analysis.map((e,s)=>t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-bullseye text-blue-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:e})]},s))})]}),t.jsxs("div",{className:`p-5 rounded-xl ${n?"bg-gray-700":"bg-gray-50"} mb-6`,children:[t.jsx("h5",{className:"font-medium mb-3",children:"Recommended Commercial Paths"}),t.jsx("div",{className:"space-y-3",children:[{title:"Cultural and Creative Product Development",icon:"gift",description:"Suitable for developing various cultural and creative peripheral products"},{title:"Brand Packaging Design",icon:"box",description:"Can be applied to packaging upgrades for time-honored brands"},{title:"Digital Collectibles",icon:"gem",description:"Has potential for conversion to digital collectibles"}].map((e,s)=>t.jsxs("div",{className:"flex items-start p-3 rounded-lg bg-white bg-opacity-10",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center mr-3 flex-shrink-0",children:t.jsx("i",{className:`fas fa-${e.icon}`})}),t.jsxs("div",{children:[t.jsx("h6",{className:"font-medium",children:e.title}),t.jsx("p",{className:"text-xs opacity-80",children:e.description})]})]},s))})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h5",{className:"font-medium mb-3",children:"相关活动推荐"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{title:"Time-honored Brand Innovation Competition",deadline:"2025-12-31",reward:"Maximum prize ¥50,000",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Design%20competition%20poster%20traditional%20Chinese%20elements"},{title:"National Trend Cultural and Creative Design Camp",deadline:"2025-11-30",reward:"Professional mentor guidance + exhibition opportunities",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Cultural%20creative%20design%20workshop"}].map((e,s)=>t.jsx("div",{className:"rounded-lg overflow-hidden "+(n?"bg-gray-700":"bg-gray-50"),children:t.jsxs("div",{className:"flex",children:[t.jsx(E,{src:e.image,alt:e.title,className:"w-24 h-24 object-cover",ratio:"square",fit:"cover"}),t.jsxs("div",{className:"p-3 flex-1",children:[t.jsx("h6",{className:"font-medium mb-1",children:e.title}),t.jsxs("div",{className:"text-xs opacity-80 mb-1",children:["Deadline: ",e.deadline]}),t.jsx("div",{className:"text-xs font-medium text-red-600",children:e.reward})]})]})},s))})]})]})]}),t.jsxs("div",{className:`p-6 border-t ${n?"border-gray-700":"border-gray-200"} flex justify-end space-x-3`,children:["commercial"===f&&o.commercialPotential&&t.jsx("button",{onClick:()=>{i.success(l("review.applyCommercialAdviceSuccess"))},className:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors",children:"Adopt commercial advice"}),"detail"===f&&t.jsx("button",{className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"Apply all suggestions"}),t.jsx("button",{onClick:r,className:`px-4 py-2 rounded-lg ${n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:"关闭"})]})]})}):null},Ce=({onCommandExecuted:a})=>{const{isDark:r}=k(),[n,l]=e.useState(""),[o,c]=e.useState(!1),[d,m]=e.useState([]),[g,h]=e.useState(!0),[p,u]=e.useState(null),x=e.useRef(null),[y,b]=e.useState(()=>se.getConfig().stream),f=e.useRef(null),[v,j]=e.useState(se.getCurrentModel().id),[N,w]=e.useState([]),[_,S]=e.useState([]),[C,T]=e.useState([]);e.useEffect(()=>{x.current&&x.current.scrollIntoView({behavior:"smooth"})},[d]);const E=[{id:"kimi",name:"Kimi",icon:"fa-robot"},{id:"deepseek",name:"DeepSeek",icon:"fa-brain"},{id:"doubao",name:"豆包",icon:"fa-comment-dots"},{id:"wenxinyiyan",name:"文心一言",icon:"fa-lightbulb"},{id:"qwen",name:"通义千问",icon:"fa-star"}],I=async()=>{if(!n.trim()||o)return;c(!0);const e={role:"user",content:n};m(t=>[...t,e]);try{if(se.getConfig().stream){let e="";await se.generateResponse(n,{onDelta:t=>{e=t,m(e=>{const s=[...e],a=s[s.length-1];return a&&"assistant"===a.role?s[s.length-1]={role:"assistant",content:t}:s.push({role:"assistant",content:t}),s})}}),a&&a(e)}else{const e=await se.generateResponse(n),t={role:"assistant",content:e};m(e=>[...e,t]),a&&a(e)}R(n)}catch(t){i.error("生成响应失败，请重试")}finally{l(""),c(!1)}},R=e=>{const t=se.generateCreativeDirections(e);w(t);const s=se.recommendCulturalElements(e);S(s);const a=se.diagnoseCreationIssues(e);T(a)};return t.jsxs("div",{className:`p-4 rounded-xl ${r?"bg-gray-800":"bg-white"} shadow-md border ${r?"border-gray-700":"border-gray-200"} min-h-[600px]`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("h2",{className:"text-2xl font-bold flex items-center text-red-600",children:[t.jsx("i",{className:"fas fa-magic mr-3"}),"AI文案创作助手"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:v,onChange:e=>{return t=e.target.value,j(t),se.setCurrentModel(t),void i.success(`已切换到 ${E.find(e=>e.id===t)?.name}`);var t},className:"appearance-none bg-transparent border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-white rounded-lg px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-red-500 transition-all cursor-pointer "+(r?"bg-gray-700":"bg-white"),children:E.map(e=>t.jsxs("option",{value:e.id,children:[t.jsx("i",{className:`fas ${e.icon} mr-2`}),e.name]},e.id))}),t.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:t.jsx("i",{className:"fas fa-chevron-down text-gray-500"})})]}),t.jsxs("span",{className:"text-sm "+(r?"text-gray-400":"text-gray-600"),children:["当前模型: ",se.getCurrentModel().name]})]})]}),t.jsx("input",{ref:f,type:"file",accept:"application/json",className:"hidden",onChange:e=>{const t=e.target.files?.[0];t&&(e=>{const t=new FileReader;t.onload=()=>{try{const e=String(t.result||""),s=JSON.parse(e),a=Array.isArray(s)?s.filter(e=>("user"===e.role||"assistant"===e.role)&&"string"==typeof e.content):[];m(a);const r=a.map(e=>({role:e.role,content:e.content,timestamp:Date.now()}));se.importHistory(r),i.success("已导入对话")}catch{i.error("导入失败，文件格式不正确")}},t.readAsText(e)})(t)}}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[t.jsxs("div",{className:`rounded-lg ${r?"bg-gray-700":"bg-gray-50"} p-4 shadow-sm border border-gray-200 dark:border-gray-600`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsxs("h3",{className:"font-semibold text-lg flex items-center",children:[t.jsx("i",{className:"fas fa-history text-blue-500 mr-2"}),"对话历史"]}),t.jsx("button",{onClick:()=>h(!g),className:`p-1.5 rounded-full ${r?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors`,"aria-label":g?"隐藏对话历史":"显示对话历史",children:t.jsx("i",{className:"fas "+(g?"fa-chevron-up":"fa-chevron-down")})})]}),g&&d.length>0?t.jsxs(s.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"max-h-80 overflow-y-auto space-y-4",children:[d.map((e,s)=>t.jsxs("div",{className:"flex flex-col "+("user"===e.role?"items-end":"items-start"),children:[t.jsxs("div",{className:"flex items-start w-full",children:[t.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3 flex-shrink-0 "+("user"===e.role?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"),children:t.jsx("i",{className:"fas "+("user"===e.role?"fa-user":"fa-robot")})}),t.jsx("div",{className:"flex-1 rounded-lg p-3 "+("user"===e.role?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-600 dark:text-gray-200"),children:t.jsx("p",{className:"text-sm break-words",children:e.content})})]}),"assistant"===e.role&&t.jsxs("div",{className:"flex space-x-2 mt-1 ml-11 text-xs",children:[t.jsxs("button",{className:"px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center "+(r?"text-gray-300":"text-gray-600"),onClick:()=>{l(e.content),i.success("已将生成结果复制到输入框，可继续编辑")},title:"编辑结果",children:[t.jsx("i",{className:"fas fa-edit mr-1"}),"编辑"]}),t.jsxs("button",{className:"px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center "+(r?"text-gray-300":"text-gray-600"),onClick:()=>{a&&(a(e.content),i.success("已应用到设计中"))},title:"应用到设计",children:[t.jsx("i",{className:"fas fa-magic mr-1"}),"应用"]}),t.jsxs("button",{className:"px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center "+(r?"text-gray-300":"text-gray-600"),onClick:()=>{navigator.clipboard.writeText(e.content),i.success("已复制到剪贴板")},title:"复制结果",children:[t.jsx("i",{className:"fas fa-copy mr-1"}),"复制"]}),t.jsxs("button",{className:"px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center "+(r?"text-gray-300":"text-gray-600"),onClick:()=>{const t=new Blob([e.content],{type:"text/plain"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`ai-copy-${Date.now()}.txt`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),i.success("已导出为文本文件")},title:"导出结果",children:[t.jsx("i",{className:"fas fa-download mr-1"}),"导出"]})]})]},s)),t.jsx("div",{ref:x})]}):g?t.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[t.jsx("i",{className:"fas fa-comments text-2xl mb-2"}),t.jsx("p",{children:"暂无对话历史"}),t.jsx("p",{className:"text-xs mt-1",children:"开始输入创作指令，生成您的第一条对话"})]}):null]}),t.jsxs("div",{className:`rounded-lg ${r?"bg-gray-700":"bg-gray-50"} p-4 shadow-sm border border-gray-200 dark:border-gray-600`,children:[t.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center",children:[t.jsx("i",{className:"fas fa-cog text-purple-500 mr-2"}),"对话管理"]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{onClick:()=>{m([]),se.clearHistory(),i.success("对话历史已清空")},className:`flex items-center justify-center px-3 py-2 rounded-lg ${r?"bg-gray-600 hover:bg-red-600":"bg-gray-200 hover:bg-red-100"} transition-all text-sm font-medium`,children:[t.jsx("i",{className:"fas fa-trash-alt mr-2 text-red-500"}),"清空历史"]}),t.jsxs("button",{onClick:()=>{try{const e=JSON.stringify(d,null,2),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="conversation.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),i.success("已导出对话为 conversation.json")}catch{i.error("导出失败")}},className:`flex items-center justify-center px-3 py-2 rounded-lg ${r?"bg-gray-600 hover:bg-blue-600":"bg-gray-200 hover:bg-blue-100"} transition-all text-sm font-medium`,children:[t.jsx("i",{className:"fas fa-download mr-2 text-blue-500"}),"导出对话"]}),t.jsxs("button",{onClick:()=>f.current?.click(),className:`flex items-center justify-center px-3 py-2 rounded-lg ${r?"bg-gray-600 hover:bg-green-600":"bg-gray-200 hover:bg-green-100"} transition-all text-sm font-medium col-span-2`,children:[t.jsx("i",{className:"fas fa-upload mr-2 text-green-500"}),"导入对话"]})]}),t.jsx("div",{className:"mt-4 flex items-center justify-between",children:t.jsxs("label",{className:"flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:y,onChange:()=>{const e=!y;b(e),se.updateConfig({stream:e}),i.success(e?"已开启流式输出":"已关闭流式输出")},className:"sr-only peer"}),t.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-red-300 dark:peer-focus:ring-red-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-red-600"}),t.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"流式输出"})]})})]})]}),t.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[t.jsxs("div",{className:`rounded-lg ${r?"bg-gray-700":"bg-white"} p-5 shadow-sm border border-gray-200 dark:border-gray-600`,children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-edit text-green-500 mr-2"}),"创作指令"]}),t.jsx("textarea",{value:n,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),I())},placeholder:"输入您的创作指令，例如：生成融合青花瓷纹样的中秋海报...\\n\\n支持多行输入，您可以详细描述您的设计需求、风格偏好和文化元素要求。",className:`w-full px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 resize-none min-h-[120px] transition-colors ${r?"bg-gray-600 border-gray-500 text-white placeholder-gray-400 border":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 border"} shadow-sm`}),t.jsxs("div",{className:"flex justify-between items-center mt-4 text-sm text-gray-500 dark:text-gray-400",children:[t.jsxs("span",{children:[n.length," 字"]}),t.jsx("span",{children:"按 Enter 发送，Shift+Enter 换行"})]}),t.jsx("button",{onClick:I,disabled:o||!n.trim(),className:`w-full mt-4 py-3 rounded-lg transition-all flex items-center justify-center font-semibold text-lg ${o?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 hover:shadow-lg text-white"} shadow-md`,children:o?t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-spinner fa-spin mr-3 text-xl"}),"创作中..."]}):t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-paper-plane mr-3 text-xl"}),"生成文案"]})})]}),t.jsxs("div",{className:`rounded-lg ${r?"bg-gray-700":"bg-white"} p-5 shadow-sm border border-gray-200 dark:border-gray-600`,children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-bolt text-yellow-500 mr-2"}),"快速指令"]}),t.jsx("div",{className:"space-y-4",children:Object.entries({"设计风格":["生成融合青花瓷纹样的中秋海报","创建国潮风格的产品包装设计","设计简约现代的传统元素logo","制作复古风格的节日宣传图"],"色彩调整":["把红色调改为靛蓝色","将整体色调调整为暖色系","增加色彩对比度","使用传统中国色彩搭配"],"元素添加":["添加传统云纹元素","融入中国结图案","添加书法字体标题","加入传统纹样边框"],"布局优化":["优化整体布局使其更加平衡","调整元素间距和对齐方式","增加留白空间","优化视觉层次结构"],"文化融合":["增加文化元素的识别度","融合天津地方特色元素","加入非遗文化元素","结合传统与现代设计语言"]}).map(([e,a])=>t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[t.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-red-500 mr-2"}),e]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((e,a)=>t.jsx(s.button,{onClick:()=>(e=>{l(e),u(e)})(e),className:"px-4 py-2 rounded-full text-sm font-medium transition-all "+(p===e?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300":r?"bg-gray-600 hover:bg-gray-500":"bg-gray-100 hover:bg-gray-200"),whileHover:{scale:1.05,translateY:-2},whileTap:{scale:.95},children:e},a))})]},e))})]}),(N.length>0||_.length>0||C.length>0)&&t.jsxs("div",{className:`rounded-lg ${r?"bg-gray-700":"bg-white"} p-5 shadow-sm border border-gray-200 dark:border-gray-600`,children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mr-2"}),"创意助手"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:[N.length>0&&t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:(r?"bg-gray-600":"bg-blue-50")+" p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("h4",{className:"font-medium text-blue-600 dark:text-blue-400 mb-3 flex items-center",children:[t.jsx("i",{className:"fas fa-compass mr-2"}),"创意方向"]}),t.jsx("div",{className:"space-y-2",children:N.map((e,a)=>t.jsxs(s.button,{onClick:()=>(e=>{l(`按照"${e}"的方向优化设计`)})(e),className:`w-full text-left px-3 py-2 rounded-lg text-sm ${r?"hover:bg-blue-800":"hover:bg-blue-100"} transition-colors`,whileHover:{translateX:5},children:[t.jsx("i",{className:"fas fa-arrow-right text-blue-500 mr-2"}),e]},a))})]}),_.length>0&&t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:(r?"bg-gray-600":"bg-purple-50")+" p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[t.jsxs("h4",{className:"font-medium text-purple-600 dark:text-purple-400 mb-3 flex items-center",children:[t.jsx("i",{className:"fas fa-gem mr-2"}),"文化元素"]}),t.jsx("div",{className:"space-y-2",children:_.map((e,a)=>t.jsxs(s.button,{onClick:()=>(e=>{l(`在设计中添加${e}元素`)})(e),className:`w-full text-left px-3 py-2 rounded-lg text-sm ${r?"hover:bg-purple-800":"hover:bg-purple-100"} transition-colors`,whileHover:{translateX:5},children:[t.jsx("i",{className:"fas fa-plus text-purple-500 mr-2"}),e]},a))})]}),C.length>0&&t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:(r?"bg-gray-600":"bg-yellow-50")+" p-4 rounded-lg border border-yellow-200 dark:border-yellow-800",children:[t.jsxs("h4",{className:"font-medium text-yellow-600 dark:text-yellow-400 mb-3 flex items-center",children:[t.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),"创作建议"]}),t.jsx("div",{className:"space-y-3",children:C.map((e,s)=>t.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[t.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mr-2"}),e]},s))})]})]})]})]})]})]})},Te=({isOpen:a,onClose:r})=>{const{isDark:n}=k(),l=e=>{const t=localStorage.getItem(e)||"";if(!t)return"";try{return atob(t)}catch{return""}},o=(e,t)=>{if(!t)return void localStorage.removeItem(e);const s=btoa(t);localStorage.setItem(e,s)},[c,d]=e.useState(se.getCurrentModel()),[m,g]=e.useState(se.getConfig()),[h,p]=e.useState(!1),[u,x]=e.useState(!1),[y,b]=e.useState(null),[f,v]=e.useState([]),[j,N]=e.useState(se.getCurrentRole());e.useState(!1);const w=e.useRef(null),[_,S]=e.useState(!1),[C,T]=e.useState([se.getCurrentModel().id]),[E,I]=e.useState(()=>l("KIMI_API_KEY")||""),[R,D]=e.useState("https://api.moonshot.cn/v1"),[A,P]=e.useState("moonshot-v1-32k"),[z,$]=e.useState(()=>l("DEEPSEEK_API_KEY")||""),[L,O]=e.useState("https://api.deepseek.com"),[M,q]=e.useState("deepseek-chat"),[U,H]=e.useState(()=>l("DOUBAO_API_KEY")||""),[F,K]=e.useState("https://api.doubao.com/v1"),[B,V]=e.useState("doubao-pro-32k"),[W,Y]=e.useState(()=>l("WENXIN_API_KEY")||""),[G,Z]=e.useState("https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions"),[X,J]=e.useState("ERNIE-Speed-8K"),[ee,te]=e.useState(()=>l("QWEN_API_KEY")||""),[ae,ie]=e.useState("https://dashscope.aliyuncs.com/api/v1"),[re,ne]=e.useState("qwen-plus"),[le,oe]=e.useState(()=>l("CHATGPT_API_KEY")||""),[ce,de]=e.useState("https://api.openai.com/v1"),[me,ge]=e.useState("gpt-4o"),[he,pe]=e.useState(()=>l("GEMINI_API_KEY")||""),[ue,xe]=e.useState("https://generativelanguage.googleapis.com/v1"),[ye,be]=e.useState("gemini-1.5-flash"),[fe,ve]=e.useState(()=>l("GORK_API_KEY")||""),[je,Ne]=e.useState("https://api.x.ai/v1"),[we,_e]=e.useState("grok-beta"),[ke,Se]=e.useState(()=>l("ZHIPU_API_KEY")||""),[Ce,Te]=e.useState("https://open.bigmodel.cn/api/paas/v4"),[Ee,Ie]=e.useState("glm-4-plus"),Re=e.useRef(null);e.useEffect(()=>{if(a){const e=se.getCurrentModel();d(e),g(se.getConfig());const t=se.getRoles();v(t),N(se.getCurrentRole()),T([e.id])}},[a]);const De=e=>{const t=Q.find(t=>t.id===e);t&&(d(t),"kimi"===e?(I(l("KIMI_API_KEY")),D(m.kimi_base_url),P(m.kimi_model)):"deepseek"===e?($(l("DEEPSEEK_API_KEY")),O(m.deepseek_base_url||"https://api.deepseek.com"),q(m.deepseek_model||"deepseek-chat")):"doubao"===e?(H(l("DOUBAO_API_KEY")),K(m.doubao_base_url),V(m.doubao_model)):"wenxinyiyan"===e?(Y(l("WENXIN_API_KEY")),Z(m.wenxin_base_url),J(m.wenxin_model)):"qwen"===e?(te(l("QWEN_API_KEY")),ie(m.qwen_base_url),ne(m.qwen_model)):"chatgpt"===e?(oe(l("CHATGPT_API_KEY")),de(m.chatgpt_base_url),ge(m.chatgpt_model)):"gemini"===e?(pe(l("GEMINI_API_KEY")),xe(m.gemini_base_url),be(m.gemini_model)):"gork"===e?(ve(l("GORK_API_KEY")),Ne(m.gork_base_url),_e(m.gork_model)):"zhipu"===e&&(Se(l("ZHIPU_API_KEY")),Te(m.zhipu_base_url),Ie(m.zhipu_model)),setTimeout(()=>{Re.current&&Re.current.scrollIntoView({behavior:"smooth",block:"start"})},50))},Ae=(e,t)=>{g(s=>({...s,[e]:t}))},Pe=(e,t)=>{if(!t)return!0;switch(e){case"kimi":case"qwen":case"doubao":return/^[a-zA-Z0-9_-]+$/.test(t);case"deepseek":case"chatgpt":return t.startsWith("sk-");case"wenxinyiyan":return/^[a-zA-Z0-9_/.-=]+$/.test(t);case"gemini":return t.startsWith("AIzaSy");case"gork":return t.startsWith("xai-");case"zhipu":return/^[a-zA-Z0-9_.]+$/.test(t);default:return!0}};return a?t.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${n?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:t.jsxs(s.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:`rounded-2xl ${n?"bg-gray-800":"bg-white"} shadow-xl max-w-md w-full mx-4 overflow-hidden flex flex-col`,children:[t.jsxs("div",{className:`p-4 sm:p-6 border-b ${n?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[t.jsx("h3",{className:"text-lg sm:text-xl font-bold",children:"模型选择"}),t.jsx("button",{onClick:r,className:`p-2 rounded-full ${n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsxs("div",{className:"p-4 sm:p-6 overflow-y-auto max-h-[70vh] sm:max-h-[60vh]",children:[y&&t.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-red-100 text-red-600 text-sm flex items-center",children:[t.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),y]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h4",{className:"font-medium",children:"选择大语言模型"}),t.jsx("button",{type:"button",onClick:()=>{S(!_),_&&0===C.length&&T([se.getCurrentModel().id])},className:"px-3 py-1 rounded-full text-xs font-medium transition-all "+(_?"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400 border border-purple-300 dark:border-purple-700":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600"),children:_?"单模型模式":"多模型模式"})]}),_?t.jsxs("div",{"aria-label":"模型列表",className:"space-y-2",children:[Q.map(e=>t.jsxs(s.button,{type:"button","aria-checked":C.includes(e.id),tabIndex:0,className:"relative w-full text-left p-3 sm:p-4 rounded-xl border transition-all "+(C.includes(e.id)?"border-purple-600 bg-purple-100 dark:bg-purple-900/20 ring-2 ring-purple-500 shadow-md":n?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"),whileHover:{y:-2},onClick:()=>{return t=e.id,void T(e=>{if(e.includes(t)){const s=e.filter(e=>e!==t);return s.length>0?s:[t]}return[...e,t]});var t},"aria-label":`选择模型 ${e.name}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-bold "+(C.includes(e.id)?"text-purple-600":""),children:e.name}),t.jsx("p",{className:"text-sm mt-1 "+(n?"text-gray-400":"text-gray-600"),children:e.description})]}),t.jsx("div",{className:"w-5 h-5 rounded border-2 transition-all "+(C.includes(e.id)?"border-purple-600 bg-purple-600":n?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"),children:C.includes(e.id)&&t.jsx("i",{className:"fas fa-check text-white text-xs flex items-center justify-center w-full h-full"})})]}),t.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:e.strengths.map((e,s)=>t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(n?"bg-gray-700":"bg-gray-100"),children:e},s))})]},e.id)),t.jsxs("div",{className:"mt-3 p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-sm text-blue-700 dark:text-blue-300",children:[t.jsx("i",{className:"fas fa-info-circle mr-2"}),"已选择 ",C.length," 个模型"]}),t.jsxs("div",{className:"flex items-center justify-center text-xs ${isDark ? 'text-gray-400' : 'text-gray-600'}",children:[t.jsx("i",{className:"fas fa-chevron-down mr-2"}),"向下查看更多设置"]})]}):t.jsxs("div",{role:"radiogroup","aria-label":"模型列表",className:"space-y-2",children:[Q.map((e,a)=>t.jsxs(s.button,{type:"button",role:"radio","aria-checked":c.id===e.id,tabIndex:0,className:"relative w-full text-left p-3 sm:p-4 rounded-xl border transition-all "+(c.id===e.id?"border-red-600 bg-red-100 dark:bg-red-900/20 ring-2 ring-red-500 shadow-md":n?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"),whileHover:{y:-2},onClick:()=>De(e.id),onKeyDown:e=>((e,t)=>{const s=Q.map(e=>e.id);if("Enter"===e.key||" "===e.key)e.preventDefault(),De(s[t]);else if("ArrowRight"===e.key){e.preventDefault();const a=(t+1)%s.length;De(s[a])}else if("ArrowLeft"===e.key){e.preventDefault();const a=(t-1+s.length)%s.length;De(s[a])}})(e,a),"aria-label":`选择模型 ${e.name}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-bold "+(c.id===e.id?"text-red-600":""),children:e.name}),t.jsx("p",{className:"text-sm mt-1 "+(n?"text-gray-400":"text-gray-600"),children:e.description})]}),t.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${c.id===e.id?"border-red-600":n?"border-gray-600":"border-gray-300"} flex items-center justify-center`,children:c.id===e.id&&t.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})})]}),t.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:e.strengths.map((e,s)=>t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(n?"bg-gray-700":"bg-gray-100"),children:e},s))}),c.id===e.id&&t.jsx("span",{className:"absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-red-600 text-white",children:"已选择"})]},e.id)),t.jsxs("div",{className:"mt-3 flex items-center justify-center text-xs ${isDark ? 'text-gray-400' : 'text-gray-600'}",children:[t.jsx("i",{className:"fas fa-chevron-down mr-2"}),"向下查看更多设置"]})]})]}),t.jsxs("div",{className:"mb-4",ref:w,children:[t.jsx("h4",{className:"font-medium mb-3",children:"选择角色"}),t.jsx("div",{role:"radiogroup","aria-label":"角色列表",className:"space-y-2",children:f.map(e=>t.jsxs(s.button,{type:"button",role:"radio","aria-checked":j.id===e.id,tabIndex:0,className:"relative w-full text-left p-3 sm:p-4 rounded-xl border transition-all "+(j.id===e.id?"border-blue-600 bg-blue-100 dark:bg-blue-900/20 ring-2 ring-blue-500 shadow-md":n?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"),whileHover:{y:-2},onClick:()=>(e=>{const t=f.find(t=>t.id===e);t&&(N(t),setTimeout(()=>{w.current&&w.current.scrollIntoView({behavior:"smooth",block:"start"})},50))})(e.id),"aria-label":`选择角色 ${e.name}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-bold "+(j.id===e.id?"text-blue-600":""),children:e.name}),t.jsx("p",{className:"text-sm mt-1 "+(n?"text-gray-400":"text-gray-600"),children:e.description}),t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:e.tags?.map((e,s)=>t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(n?"bg-gray-700":"bg-gray-100"),children:e},s))})]}),t.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${j.id===e.id?"border-blue-600":n?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"} flex items-center justify-center`,children:j.id===e.id&&t.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})})]}),j.id===e.id&&t.jsx("span",{className:"absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-blue-600 text-white",children:"已选择"})]},e.id))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>p(!h),className:"flex items-center justify-between w-full p-3 rounded-xl text-left transition-all "+(n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),disabled:u,children:[t.jsx("span",{className:"font-medium",children:"高级设置"}),t.jsx("i",{className:`fas fa-chevron-${h?"up":"down"} transition-transform duration-300`})]}),h&&t.jsxs(s.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-3 space-y-3 sm:space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"创作自由度 (Temperature)"}),t.jsx("span",{className:"text-sm",children:m.temperature.toFixed(1)})]}),t.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:m.temperature,onChange:e=>Ae("temperature",parseFloat(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{children:"严谨"}),t.jsx("span",{children:"平衡"}),t.jsx("span",{children:"创意"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型输出的随机性和创造性。值越低，输出越严谨一致；值越高，输出越多样化和创造性。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"多样性 (Top P)"}),t.jsx("span",{className:"text-sm",children:m.top_p.toFixed(1)})]}),t.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:m.top_p,onChange:e=>Ae("top_p",parseFloat(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{children:"集中"}),t.jsx("span",{children:"适中"}),t.jsx("span",{children:"多样"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型输出的多样性。值越低，模型只考虑最可能的输出；值越高，模型会考虑更多可能的输出，增加多样性。"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"flex justify-between items-center mb-2",children:t.jsx("label",{className:"text-sm font-medium",children:"系统提示词"})}),t.jsx("textarea",{value:m.system_prompt,onChange:e=>Ae("system_prompt",e.target.value),className:"w-full p-2 sm:p-3 rounded-lg border "+(n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),rows:2,disabled:u}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"定义模型的角色和行为，指导模型在对话中的表现。系统提示词会影响模型的整体输出风格和内容方向。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"上下文历史条数"}),t.jsx("span",{className:"text-sm",children:m.max_history})]}),t.jsx("input",{type:"range",min:"1",max:"50",step:"1",value:m.max_history,onChange:e=>Ae("max_history",parseInt(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型在生成回复时参考的历史对话条数。值越大，模型能记住更多上下文，但可能增加响应时间和 token 消耗。"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"text-sm font-medium",children:"启用流式输出"}),t.jsx("input",{type:"checkbox",checked:m.stream,onChange:e=>Ae("stream",e.target.checked),disabled:u})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"启用后，模型会实时返回生成的内容，而不是等待完整生成后一次性返回，提供更好的交互体验。"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"最大响应长度"}),t.jsx("span",{className:"text-sm",children:m.max_tokens})]}),t.jsx("input",{type:"range",min:"500",max:"5000",step:"500",value:m.max_tokens,onChange:e=>Ae("max_tokens",parseInt(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{children:"短"}),t.jsx("span",{children:"中"}),t.jsx("span",{children:"长"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型生成回复的最大长度，单位为 token。值越大，生成的内容可能越长，但响应时间也会增加。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"响应超时 (秒)"}),t.jsx("span",{className:"text-sm",children:Math.round(m.timeout/1e3)})]}),t.jsx("input",{type:"range",min:"5",max:"60",step:"5",value:Math.round(m.timeout/1e3),onChange:e=>Ae("timeout",1e3*parseInt(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{children:"快"}),t.jsx("span",{children:"标准"}),t.jsx("span",{children:"慢"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"设置模型生成回复的最大等待时间。值过小可能导致频繁超时，值过大可能让用户等待时间过长。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"新主题权重 (Presence Penalty)"}),t.jsx("span",{className:"text-sm",children:m.presence_penalty.toFixed(1)})]}),t.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:m.presence_penalty,onChange:e=>Ae("presence_penalty",parseFloat(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{children:"抑制新主题"}),t.jsx("span",{children:"平衡"}),t.jsx("span",{children:"鼓励新主题"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型引入新主题的倾向。正值鼓励模型讨论新主题，负值抑制模型引入新主题。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"重复内容惩罚 (Frequency Penalty)"}),t.jsx("span",{className:"text-sm",children:m.frequency_penalty.toFixed(1)})]}),t.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:m.frequency_penalty,onChange:e=>Ae("frequency_penalty",parseFloat(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{children:"允许重复"}),t.jsx("span",{children:"平衡"}),t.jsx("span",{children:"抑制重复"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型重复使用相同词语的倾向。正值惩罚重复内容，负值鼓励重复内容。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"重试次数"}),t.jsx("span",{className:"text-sm",children:m.retry})]}),t.jsx("input",{type:"range",min:"0",max:"5",step:"1",value:m.retry,onChange:e=>Ae("retry",parseInt(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"设置模型请求失败时的自动重试次数。值越大，重试机会越多，但总等待时间可能越长。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"退避时间 (ms)"}),t.jsx("span",{className:"text-sm",children:m.backoff_ms})]}),t.jsx("input",{type:"range",min:"0",max:"2000",step:"100",value:m.backoff_ms,onChange:e=>Ae("backoff_ms",parseInt(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"设置重试之间的等待时间，采用指数退避策略。值越大，重试间隔越长，降低服务器压力。"})]}),t.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[t.jsx("h5",{className:"text-sm font-medium mb-3",children:"对话记忆配置"}),t.jsx("p",{className:"text-xs mb-3 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型如何记住和使用对话历史，影响模型的上下文理解能力。"}),t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("label",{className:"text-sm font-medium",children:"启用对话记忆"}),t.jsx("input",{type:"checkbox",checked:m.enable_memory,onChange:e=>Ae("enable_memory",e.target.checked),disabled:u})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"记忆窗口大小"}),t.jsx("span",{className:"text-sm",children:m.memory_window})]}),t.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:m.memory_window,onChange:e=>Ae("memory_window",parseInt(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u||!m.enable_memory}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型保留的对话轮数，影响模型的长期记忆能力。"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"上下文窗口大小"}),t.jsx("span",{className:"text-sm",children:m.context_window})]}),t.jsx("input",{type:"range",min:"2048",max:"128000",step:"2048",value:m.context_window,onChange:e=>Ae("context_window",parseInt(e.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:u}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"控制模型能处理的最大上下文长度，单位为 token。值越大，模型能理解更长的对话内容。"})]})]}),t.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[t.jsx("h5",{className:"text-sm font-medium mb-3",children:"多模态配置"}),t.jsx("p",{className:"text-xs mb-3 "+(n?"text-gray-400":"text-gray-500"),children:"配置模型处理图像等多媒体内容的能力，适用于支持多模态的模型。"}),t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("label",{className:"text-sm font-medium",children:"启用多模态支持"}),t.jsx("input",{type:"checkbox",checked:m.enable_multimodal,onChange:e=>Ae("enable_multimodal",e.target.checked),disabled:u})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"图像分辨率"}),t.jsx("span",{className:"text-sm",children:m.image_resolution})]}),t.jsxs("select",{value:m.image_resolution,onChange:e=>Ae("image_resolution",e.target.value),className:"w-full px-3 py-2 rounded-lg border "+(n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),disabled:u||!m.enable_multimodal,children:[t.jsx("option",{value:"512x512",children:"512x512"}),t.jsx("option",{value:"1024x1024",children:"1024x1024"}),t.jsx("option",{value:"2048x2048",children:"2048x2048"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"设置图像输入的分辨率，影响图像理解的细节和处理速度。"})]})]}),t.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[t.jsx("h5",{className:"text-sm font-medium mb-3",children:"安全配置"}),t.jsx("p",{className:"text-xs mb-3 "+(n?"text-gray-400":"text-gray-500"),children:"配置模型的安全检查机制，过滤不安全或违规内容。"}),t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("label",{className:"text-sm font-medium",children:"启用安全检查"}),t.jsx("input",{type:"checkbox",checked:m.enable_safety_check,onChange:e=>Ae("enable_safety_check",e.target.checked),disabled:u})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"安全级别"}),t.jsx("span",{className:"text-sm",children:m.safety_level})]}),t.jsxs("select",{value:m.safety_level,onChange:e=>Ae("safety_level",e.target.value),className:"w-full px-3 py-2 rounded-lg border "+(n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),disabled:u||!m.enable_safety_check,children:[t.jsx("option",{value:"low",children:"低"}),t.jsx("option",{value:"medium",children:"中"}),t.jsx("option",{value:"high",children:"高"})]}),t.jsx("p",{className:"text-xs mt-2 "+(n?"text-gray-400":"text-gray-500"),children:"设置安全检查的严格程度，影响模型对内容的过滤效果。"})]})]})]})]})]}),t.jsxs("div",{className:`p-4 sm:p-6 border-t ${n?"border-gray-700":"border-gray-200"} flex justify-between gap-3`,children:[t.jsx("button",{type:"button",onClick:async()=>{try{let e;x(!0),b(null),se.setCurrentModel(c.id),se.updateConfig({stream:!1});const t=t=>{t.detail.modelId===c.id&&"error"===t.detail.status&&(e=t.detail.error)};window.addEventListener("llm-connection-status-changed",t),await se.generateResponse("ping"),window.removeEventListener("llm-connection-status-changed",t),"connected"===se.getConnectionStatus(c.id)?i.success("连接正常"):i.error(`连接失败: ${e||"未知错误"}`)}catch(e){const t=e instanceof Error?e.message:String(e);i.error(`连接失败: ${t}`)}finally{x(!1)}},className:`flex-1 py-2 px-4 rounded-lg transition-all ${n?"bg-blue-700 hover:bg-blue-600":"bg-blue-500 hover:bg-blue-600"} text-white font-medium`,disabled:u,children:u?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"测试中..."]}):"测试连接"}),t.jsx("button",{type:"button",onClick:()=>{try{x(!0),b(null),setTimeout(()=>{let e=!0,t="";if("kimi"===c.id?(E?Pe("kimi",E)?o("KIMI_API_KEY",E):(e=!1,t="Kimi 密钥格式不正确，应为 sk- 开头"):o("KIMI_API_KEY",""),g(e=>({...e,kimi_base_url:R,kimi_model:A}))):"deepseek"===c.id?(z?Pe("deepseek",z)?o("DEEPSEEK_API_KEY",z):(e=!1,t="DeepSeek 密钥格式不正确，应为 sk- 开头"):o("DEEPSEEK_API_KEY",""),g(e=>({...e,deepseek_base_url:L,deepseek_model:M}))):"doubao"===c.id?(U?Pe("doubao",U)?o("DOUBAO_API_KEY",U):(e=!1,t="豆包 密钥格式不正确"):o("DOUBAO_API_KEY",""),g(e=>({...e,doubao_base_url:F,doubao_model:B}))):"wenxinyiyan"===c.id?(W?Pe("wenxinyiyan",W)?o("WENXIN_API_KEY",W):(e=!1,t="文心一言 密钥格式不正确"):o("WENXIN_API_KEY",""),g(e=>({...e,wenxin_base_url:G,wenxin_model:X}))):"qwen"===c.id?(ee?Pe("qwen",ee)?o("QWEN_API_KEY",ee):(e=!1,t="通义千问 密钥格式不正确"):o("QWEN_API_KEY",""),g(e=>({...e,qwen_base_url:ae,qwen_model:re}))):"chatgpt"===c.id?(le?Pe("chatgpt",le)?o("CHATGPT_API_KEY",le):(e=!1,t="ChatGPT 密钥格式不正确，应为 sk- 开头"):o("CHATGPT_API_KEY",""),g(e=>({...e,chatgpt_base_url:ce,chatgpt_model:me}))):"gemini"===c.id?(he?Pe("gemini",he)?o("GEMINI_API_KEY",he):(e=!1,t="Gemini 密钥格式不正确"):o("GEMINI_API_KEY",""),g(e=>({...e,gemini_base_url:ue,gemini_model:ye}))):"gork"===c.id?(fe?Pe("gork",fe)?o("GORK_API_KEY",fe):(e=!1,t="Gork 密钥格式不正确，应为 xai- 开头"):o("GORK_API_KEY",""),g(e=>({...e,gork_base_url:je,gork_model:we}))):"zhipu"===c.id&&(ke?Pe("zhipu",ke)?o("ZHIPU_API_KEY",ke):(e=!1,t="智谱 密钥格式不正确"):o("ZHIPU_API_KEY",""),g(e=>({...e,zhipu_base_url:Ce,zhipu_model:Ee}))),!e)return b(t),void x(!1);se.setCurrentModel(c.id),se.setCurrentRole(j.id),se.updateConfig(m),i.success("模型和角色设置已保存"),r(),x(!1)},500)}catch(e){b("保存模型设置失败，请稍后再试"),x(!1)}},className:`flex-1 py-2 px-4 rounded-lg transition-all ${n?"bg-red-700 hover:bg-red-600":"bg-red-500 hover:bg-red-600"} text-white font-medium`,disabled:u,children:u?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"保存中..."]}):"保存设置"})]})]})}):null};function Ee({variant:s="full",simpleText:a}){const{isDark:r}=k(),[n,l]=e.useState(""),{t:o}=c();return"simple"===s?t.jsx("footer",{className:`border-t ${r?"border-gray-800 bg-gray-900":"border-gray-200 bg-white"} py-6 px-4 z-10 relative`,children:t.jsx("div",{className:"container mx-auto text-center",children:t.jsx("p",{className:"text-sm "+(r?"text-gray-400":"text-gray-600"),children:a||o("footer.allRightsReserved")})})}):t.jsx("footer",{className:`border-t ${r?"border-gray-800 bg-gray-900":"border-gray-200 bg-white"} py-12 px-4 z-10 relative`,children:t.jsxs("div",{className:"container mx-auto",children:[t.jsx("div",{className:"h-px bg-gradient-to-r from-blue-600 via-red-500 to-yellow-500/80 opacity-30 mb-8"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[t.jsxs("div",{children:[t.jsxs(p,{to:"/",className:"flex items-center space-x-1 mb-4",children:[t.jsx("span",{className:"text-xl font-bold "+(r?"text-red-400":"text-red-600"),children:"津脉"}),t.jsx("span",{className:"text-xl font-bold",children:"智坊"})]}),t.jsx("p",{className:(r?"text-gray-400":"text-gray-600")+" mb-4",children:o("footer.platformSlogan")}),t.jsx("div",{className:"flex space-x-4",children:[{key:"weibo",icon:"weibo",color:"text-red-500",label:"Weibo"},{key:"weixin",icon:"weixin",color:"text-green-500",label:"WeChat"},{key:"instagram",icon:"instagram",color:"text-pink-500",label:"Instagram"},{key:"twitter",icon:"twitter",color:"text-blue-500",label:"Twitter"}].map(({key:e,icon:s,color:a,label:i})=>t.jsxs("a",{href:"#","aria-label":i,className:`text-lg ${a} opacity-70 hover:opacity-100 transition-transform duration-150 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 ${r?"focus:ring-gray-700 focus:ring-offset-gray-900":"focus:ring-gray-300 focus:ring-offset-white"}`,children:[t.jsx("i",{className:`fab fa-${s}`}),t.jsx("span",{className:"sr-only",children:i})]},e))})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold mb-4",children:o("footer.platformFeatures")}),t.jsxs("ul",{className:"space-y-2 opacity-70",children:[t.jsx("li",{children:t.jsx(p,{to:"/tools",className:"hover:text-red-600 transition-colors",children:o("footer.aiCreationTools")})}),t.jsx("li",{children:t.jsx(p,{to:"/explore",className:"hover:text-red-600 transition-colors",children:o("footer.workExhibition")})}),t.jsx("li",{children:t.jsx(p,{to:"/square",className:"hover:text-red-600 transition-colors",children:o("footer.creatorCommunity")})}),t.jsx("li",{children:t.jsx(p,{to:"/brand",className:"hover:text-red-600 transition-colors",children:o("footer.brandCooperation")})})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold mb-4",children:o("footer.resourceCenter")}),t.jsxs("ul",{className:"space-y-2 opacity-70",children:[t.jsx("li",{children:t.jsx(p,{to:"/wizard",className:"hover:text-red-600 transition-colors",children:o("footer.creationTutorials")})}),t.jsx("li",{children:t.jsx(p,{to:"/knowledge",className:"hover:text-red-600 transition-colors",children:o("footer.culturalKnowledgeBase")})}),t.jsx("li",{children:t.jsx(p,{to:"/about",className:"hover:text-red-600 transition-colors",children:o("footer.copyrightNotice")})}),t.jsx("li",{children:t.jsx(p,{to:"/help",className:"hover:text-red-600 transition-colors",children:o("footer.faq")})})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold mb-4",children:o("footer.contactUs")}),t.jsxs("ul",{className:"space-y-2 opacity-70",children:[t.jsxs("li",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-envelope mr-2"}),t.jsx("a",{href:"mailto:contact@jinmaizhifang.com",className:"hover:text-red-600 transition-colors",children:"contact@jinmaizhifang.com"})]}),t.jsxs("li",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-phone mr-2"}),t.jsx("span",{children:"400-123-4567"})]}),t.jsxs("li",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-map-marker-alt mr-2"}),t.jsx("span",{children:"Zhongguancun Street, Haidian District, Beijing"})]})]})]})]}),t.jsxs("div",{className:`mt-10 p-4 rounded-xl ring-1 ${r?"ring-gray-800 bg-gray-900":"ring-gray-200 bg-white"} flex flex-col md:flex-row md:items-center md:justify-between gap-3`,children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold",children:o("footer.subscribeUpdate")}),t.jsx("p",{className:(r?"text-gray-400":"text-gray-600")+" text-sm",children:o("footer.getSelectedWorks")})]}),t.jsxs("form",{onSubmit:e=>{e&&e.preventDefault();const t=n.trim();t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?(i.success(o("footer.subscribeSuccess")),l("")):i.error(o("footer.invalidEmail")):i.warning(o("footer.pleaseEnterEmail"))},className:"flex w-full md:w-auto gap-2",children:[t.jsx("label",{htmlFor:"subscribe-email",className:"sr-only",children:"邮箱"}),t.jsx("input",{id:"subscribe-email",type:"email",value:n,onChange:e=>l(e.target.value),placeholder:o("footer.enterEmail"),className:`${r?"bg-gray-800 text-white placeholder:text-gray-400 ring-gray-700":"bg-gray-50 text-gray-900 placeholder:text-gray-500 ring-gray-200"} flex-1 px-3 py-2 rounded-md ring-1 focus:outline-none focus:ring-2 ${r?"focus:ring-blue-500":"focus:ring-blue-600"}`}),t.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md font-medium bg-blue-600 text-white hover:bg-blue-500",children:o("footer.subscribe")})]})]}),t.jsxs("div",{className:"border-t mt-12 pt-8 flex flex-col md:flex-row justify-between items-center",children:[t.jsx("p",{className:(r?"text-gray-400":"text-gray-600")+" mb-4 md:mb-0",children:o("footer.allRightsReserved")}),t.jsxs("div",{className:"flex items-center space-x-6",children:[t.jsxs("div",{className:"flex space-x-6 opacity-60",children:[t.jsx(p,{to:"/about",className:"hover:opacity-100 transition-opacity",children:o("footer.privacyPolicy")}),t.jsx(p,{to:"/terms",className:"hover:opacity-100 transition-opacity",children:o("footer.termsOfService")}),t.jsx(p,{to:"/about",className:"hover:opacity-100 transition-opacity",children:o("footer.cookiePolicy")})]}),t.jsx("button",{type:"button",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"ml-2 px-3 py-1 rounded-md text-sm ring-1 "+(r?"ring-gray-700 hover:bg-gray-800":"ring-gray-300 hover:bg-gray-100"),"aria-label":"Back to top",title:"Back to top",children:o("footer.backToTop")})]})]})]})})}function Ie({accept:s,onFile:a,title:i,description:r,previewUrl:n,variant:l="file",className:o}){const{isDark:c}=k(),d=e.useRef(null),[m,g]=e.useState(""),[h,p]=e.useState(!1),u=e.useCallback(e=>{if(e){try{if("image"===l||"audio"===l){const t=URL.createObjectURL(e);g(t)}}catch{}a(e)}},[a,l]),x=n||m,y="image"===l?"far fa-image":"audio"===l?"fas fa-music":"fas fa-file-import",b=c?"ring-red-500/40 hover:ring-red-500/60":"ring-red-600/40 hover:ring-red-600/60";return t.jsxs("div",{className:o,children:[i&&t.jsx("div",{className:"mb-2 text-sm font-medium",children:i}),t.jsxs("div",{onDrop:e=>{e.preventDefault(),e.stopPropagation(),p(!1);const t=e.dataTransfer.files?.[0];u(t)},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),p(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),p(!1)},className:`relative rounded-2xl border-2 border-dashed ${c?"border-gray-600 bg-gray-800":"border-gray-300 bg-white"} p-4 transition-all ${h?b:"ring-0"} cursor-pointer`,onClick:()=>d.current?.click(),role:"button","aria-label":"上传文件",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-xl ${c?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} mr-4`,children:t.jsx("i",{className:y})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm",children:r||"拖拽文件到此，或点击选择"}),t.jsx("div",{className:"text-xs mt-0.5 "+(c?"text-gray-400":"text-gray-500"),children:s})]}),t.jsx("button",{type:"button",className:"ml-4 px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white text-sm",onClick:e=>{e.stopPropagation(),d.current?.click()},children:"选择文件"})]}),"image"===l&&x&&t.jsx("div",{className:"mt-4",children:t.jsx("img",{src:x,alt:"预览",className:"w-full h-40 object-cover rounded-lg",loading:"lazy",decoding:"async"})}),"audio"===l&&x&&t.jsx("div",{className:"mt-4",children:t.jsx("audio",{controls:!0,src:x,className:"w-full"})})]}),t.jsx("input",{ref:d,type:"file",accept:s,className:"hidden",onChange:e=>{const t=e.target.files?.[0];u(t)}})]})}const Re=(e,t="landscape_16_9")=>`https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=${encodeURIComponent(e)}&image_size=${t}`,De=[{id:"guifaxiang",name:"桂发祥十八街麻花",story:"源自清末的天津风味代表，以多褶形态与香酥口感著称，沿袭手作工艺与津味记忆，承载城市味道与技艺传承，百年老字号与年轻创意不断融合。",image:Re("SDXL, Tianjin Guifaxiang Shibajie mahua, traditional Chinese snack photography, red and gold accents, studio lighting, high detail, cultural motif")},{id:"erduoyan",name:"耳朵眼炸糕",story:"以糯米与红豆为主料，外酥里糯、香甜不腻，街巷烟火与市井风味的象征，凝聚天津人情味与老字号精神，口碑与故事历久弥新。",image:Re("SDXL, Tianjin Erduoyan zha gao, traditional snack, street food vibe, warm tone, cultural atmosphere, high detail")},{id:"guorenzhang",name:"果仁张",story:"精选坚果与传统技法相结合，香酥适口、回味悠长，承载节令习俗与团圆记忆，老味道焕新表达，成为伴手礼与城市名片。",image:Re("SDXL, Tianjin Guoren Zhang nuts snack, product shot, festive red packaging, cultural pattern, studio lighting")},{id:"nirenzhang",name:"泥人张",story:"以细腻彩塑著称，人物生动传神，艺术与民俗交融的代表，见证天津手艺与美学传承，滋养城市文化与现代创意表达。",image:Re("SDXL, Tianjin Niren Zhang clay figurines, museum display, warm lighting, traditional art, cultural heritage")},{id:"goubuli",name:"狗不理包子",story:"天津传统包子名店，褶形饱满、馅香协调，老字号美味与城市记忆的象征，适合与潮流文化联名焕新表达。",image:Re("SDXL, Tianjin Goubuli baozi, traditional steamed bun, bamboo steamer, warm restaurant ambiance, cultural motif")},{id:"laomeihua",name:"老美华鞋店",story:"始创于天津的百年鞋履品牌，手工技艺与舒适体验并重，适合与国潮服饰进行联名合作。",image:Re("SDXL, Laomeihua traditional shoes, vintage store interior, warm tone, craftsmanship detail")},{id:"seagullwatch",name:"海鸥表",story:"天津制造的经典机械表品牌，以机芯工艺著称，适合与城市主题与工业美学联名。",image:Re("SDXL, Tianjin Seagull mechanical watch, macro shot of movement, industrial aesthetic, high detail")},{id:"qianxiangyi",name:"谦祥益布店",story:"天津老字号布店，传统面料与现代设计结合，适合与纺织纹样、服装联名打造文化系列。",image:Re("SDXL, Tianjin Qianxiangyi fabric store, traditional textile patterns, soft lighting, cultural motif")},{id:"longshunyu",name:"隆顺榆酱园",story:"天津老字号酱园，酱香浓郁、风味地道，适合与餐饮品牌联名推出限定酱料与包装设计。",image:Re("SDXL, Tianjin Longshunyu sauce shop, traditional jars, rustic shelf, warm lighting")},{id:"hongshunde",name:"鸿顺德酱菜",story:"以酱菜闻名的天津老字号，口感鲜爽，适合与家常餐饮、礼盒文化联名。",image:Re("SDXL, Tianjin Hongshunde pickles, glass jars, wooden table, homestyle vibe, high detail")},{id:"tongrentang",name:"同仁堂",story:"中华老字号中药品牌，药食同源与养生理念深入人心，适合与健康生活方式联名。",image:Re("SDXL, Tongrentang traditional Chinese medicine, apothecary jars, wooden cabinet, warm lighting, cultural elements")},{id:"daoxiangcun",name:"稻香村",story:"糕点名家，节令点心与礼盒文化代表，适合与节日主题、非遗纹样联名。",image:Re("SDXL, Daoxiangcun pastries, festive packaging, red and gold accents, studio lighting")},{id:"quanjude",name:"全聚德",story:"烤鸭名店，京味美食文化符号，适合与城市美食地图及文旅联名。",image:Re("SDXL, Quanjude Peking duck, restaurant plating, warm tone, cultural atmosphere")},{id:"liubiju",name:"六必居",story:"酱菜与调味品牌，古法酿造与现代口味结合，适合与家宴主题联名。",image:Re("SDXL, Liubiju sauce and pickles, traditional jars, heritage store, warm lighting")},{id:"wangzhihe",name:"王致和",story:"以腐乳闻名的老字号，醇香浓郁，适合与家常料理与创意包装联名。",image:Re("SDXL, Wangzhihe fermented tofu, product shot, rustic wooden background, high detail")},{id:"laofengxiang",name:"老凤祥",story:"百年珠宝品牌，经典工艺与现代设计融合，适合与文化符号与首饰联名。",image:Re("SDXL, Laofengxiang jewelry, close-up, gold and jade, elegant display, soft lighting")},{id:"huqingyutang",name:"胡庆余堂",story:"杭州老字号中药品牌，讲究选材与炮制工艺，适合与养生文化联名。",image:Re("SDXL, Huqingyutang TCM pharmacy, wooden drawers, herb jars, warm tone")},{id:"pangaoshou",name:"潘高寿",story:"岭南传统药业品牌，止咳润喉类产品知名，适合与健康生活联名。",image:Re("SDXL, Pangaoshou traditional medicine, product lineup, vintage packaging, cultural background")},{id:"chenliji",name:"陈李济",story:"广府中药老字号，工艺严谨、经典方剂传承，适合与岭南文化联名。",image:Re("SDXL, Chenliji pharmacy, classic apothecary, wooden cabinets, cultural elements")},{id:"guangzhoujiujia",name:"广州酒家",story:"广式餐饮老字号，经典点心与年味文化代表，适合与节庆礼盒联名。",image:Re("SDXL, Guangzhou Restaurant dim sum, festive atmosphere, red lanterns, high detail")},{id:"lianxianglou",name:"莲香楼",story:"广府糕点老字号，传统饼食与礼盒美学结合，适合与节令联名。",image:Re("SDXL, Lianxianglou pastries, floral packaging, warm tone, studio lighting")},{id:"zhangxiaoqian",name:"张小泉",story:"百年刀剪品牌，锋利耐用与工艺美学结合，适合与工艺设计联名。",image:Re("SDXL, Zhangxiaoquan knives and scissors, product shot, craftsmanship detail, industrial background")},{id:"yingxiong",name:"英雄钢笔",story:"书写工具老品牌，经典外形与书写质感，适合与校园文化与文创联名。",image:Re("SDXL, Hero fountain pen, macro nib shot, vintage desk, warm lighting")},{id:"zhonghuapencil",name:"中华铅笔",story:"经典书写品牌，课堂记忆与国民书写符号，适合与教育主题联名。",image:Re("SDXL, Zhonghua pencil, stationery flatlay, retro classroom vibe, soft light")},{id:"huili",name:"回力",story:"国民运动鞋老品牌，简约复古与潮流回归，适合与街头文化联名。",image:Re("SDXL, Huili sneakers, streetwear style, urban background, dynamic composition")},{id:"tsingtao",name:"青岛啤酒",story:"百年啤酒品牌，清爽口感与城市记忆结合，适合与音乐节与夏日主题联名。",image:Re("SDXL, Tsingtao beer, bottle and glass, summer vibe, condensation, high detail")},{id:"dongaejiao",name:"东阿阿胶",story:"滋补养生品牌，传统工艺与现代健康理念结合，适合与养生生活方式联名。",image:Re("SDXL, Dong-e Ejiao product, premium packaging, warm tone, health concept")},{id:"fenjiu",name:"汾酒",story:"清香型白酒代表，历史悠久，适合与文化典藏与庆典主题联名。",image:Re("SDXL, Fenjiu Chinese liquor, elegant bottle, calligraphy backdrop, cultural atmosphere")},{id:"xifeng",name:"西凤酒",story:"凤香型白酒代表，历史传承与地域文化，适合与礼遇主题联名。",image:Re("SDXL, Xifeng liquor, phoenix motif, red and gold, ceremonial display")},{id:"gujinggong",name:"古井贡酒",story:"名酒老字号，典雅包装与礼仪文化，适合与商务礼赠联名。",image:Re("SDXL, Gujinggong liquor, premium gift box, calligraphy, warm lighting")},{id:"luzhoulaojiao",name:"泸州老窖",story:"浓香型白酒代表，酿造工艺与文化传承，适合与节庆主题联名。",image:Re("SDXL, Luzhou Laojiao liquor, cellar imagery, warm tone, cultural elements")},{id:"langjiu",name:"郎酒",story:"浓香型与酱香型兼具的老品牌，包装设计与品牌叙事亮眼，适合与艺术跨界联名。",image:Re("SDXL, Langjiu liquor, red-blue bottle, modern art backdrop, high detail")},{id:"dezhoupaji",name:"德州扒鸡",story:"传统卤味名品，口感鲜香，适合与城市美食文化联名。",image:Re("SDXL, Dezhou braised chicken, product shot, rustic table, warm lighting")},{id:"ruifuxiang",name:"瑞蚨祥",story:"京城布庄老字号，丝绸与锦缎见长，适合联合非遗纹样与服装艺术开展联名系列。",image:Re("SDXL, Ruifuxiang silk and brocade, textile patterns display, elegant store interior, soft warm lighting")},{id:"zhangyiyuan",name:"张一元",story:"北京茶庄老字号，讲究选茶与拼配，适合与茶文化空间与文创联名。",image:Re("SDXL, Zhangyiyuan tea house, tea tins and wooden shelves, cultural ambiance, warm tone")},{id:"wuyutai",name:"吴裕泰",story:"北京传统茶品牌，清雅口感与礼盒文化，适合与节令主题联名。",image:Re("SDXL, Wuyutai tea, elegant packaging, green tea motif, studio lighting")},{id:"donglaishun",name:"东来顺",story:"涮羊肉名店，清真饮食文化代表，适合与美食地图与文旅联名。",image:Re("SDXL, Donglaishun hotpot, copper pot lamb slices, restaurant ambiance, warm lighting")},{id:"tongheju",name:"同和居",story:"北京鲁菜老字号，菜品经典，适合与城市礼遇与餐饮联名。",image:Re("SDXL, Tongheju restaurant dishes, classic plating, heritage interior, warm tone")},{id:"shaguoju",name:"砂锅居",story:"以砂锅菜肴闻名的老字号，朴素风味与京味烟火，适合与家常文化联名。",image:Re("SDXL, Shaguoju claypot cuisine, rustic table, warm lighting, homestyle vibe")},{id:"xinghualou",name:"杏花楼",story:"沪上糕点老字号，海派礼盒美学代表，适合与节庆联名打造限定。",image:Re("SDXL, Xinghualou pastries, elegant packaging, floral motif, studio lighting")},{id:"qiaojiashan",name:"乔家栅",story:"上海传统糕点与点心品牌，适合与怀旧风格联名。",image:Re("SDXL, Qiaojiashan pastries, nostalgic packaging, warm tone, cultural elements")},{id:"guanshengyuan",name:"冠生园（大白兔）",story:"老牌食品企业，经典“大白兔”奶糖文化符号，适合与潮玩与跨界艺术联名。",image:Re("SDXL, Guanshengyuan White Rabbit candy, retro packaging, playful design, studio lighting")},{id:"wangmazi",name:"王麻子",story:"刀剪老字号，锋利耐用与工艺纹样结合，适合与厨房文化联名。",image:Re("SDXL, Wangmazi knives, craftsmanship close-up, industrial background, high detail")},{id:"feiyue",name:"飞跃",story:"经典帆布鞋品牌，复古潮流回归，适合与街头文化联名。",image:Re("SDXL, Feiyue canvas sneakers, street style, urban scene, dynamic composition")},{id:"shanghaiwatch",name:"上海牌手表",story:"机械表老品牌，海派工业美学代表，适合与城市意象联名。",image:Re("SDXL, Shanghai brand mechanical watch, macro movement, industrial aesthetic, high detail")},{id:"fenghuangbike",name:"凤凰牌自行车",story:"国民经典出行品牌，复古交通与生活记忆，适合与城市骑行文化联名。",image:Re("SDXL, Phoenix bicycle, retro city street, warm tone, nostalgic vibe")},{id:"yongjiubike",name:"永久牌自行车",story:"老品牌自行车，坚固耐用，适合与城市通勤与复古生活方式联名。",image:Re("SDXL, Yongjiu bicycle, vintage style, urban background, soft warm light")},{id:"yanjingbeer",name:"燕京啤酒",story:"啤酒老品牌，清爽口感与城市夏日记忆，适合与音乐与体育联名。",image:Re("SDXL, Yanjing beer, bottle with condensation, summer vibe, high detail")},{id:"xuehuabeer",name:"雪花啤酒",story:"经典啤酒品牌，畅快口感，适合与户外运动与社交场景联名。",image:Re("SDXL, Snow Beer (Xuehua), frosty bottle, mountain motif, cool tone")},{id:"guyuelongshan",name:"古越龙山",story:"黄酒老品牌，绍兴文化与礼仪场景代表，适合与书法与节令联名。",image:Re("SDXL, Guyuelongshan Shaoxing huangjiu, elegant bottle, calligraphy backdrop, warm lighting")},{id:"kuaijishan",name:"会稽山",story:"绍兴黄酒老字号，典雅礼盒与文化意象，适合与节庆联名。",image:Re("SDXL, Kuaijishan huangjiu, premium gift box, cultural elements, warm tone")},{id:"maotai",name:"茅台",story:"酱香型白酒代表，国宴文化与收藏属性，适合与艺术跨界与礼遇主题联名。",image:Re("SDXL, Moutai Chinese liquor, premium bottle, ceremonial display, red and gold accents")},{id:"wuliangye",name:"五粮液",story:"浓香型白酒代表，典雅包装与品牌故事，适合与商务礼赠联名。",image:Re("SDXL, Wuliangye liquor, elegant bottle, premium packaging, warm light")},{id:"jiannanchun",name:"剑南春",story:"川酒老品牌，历史底蕴丰富，适合与文化典藏联名。",image:Re("SDXL, Jiannanchun liquor, cultural backdrop, calligraphy elements, warm tone")},{id:"yanghe",name:"洋河",story:"苏酒老品牌，柔顺口感与蓝色瓶身识别度高，适合与现代设计联名。",image:Re("SDXL, Yanghe liquor, blue bottle, modern design backdrop, soft lighting")},{id:"changyuwine",name:"张裕葡萄酒",story:"葡萄酒老品牌，近代酿酒工业代表，适合与城市夜生活与餐酒文化联名。",image:Re("SDXL, Changyu wine, wine glass and bottle, warm restaurant ambiance, high detail")},{id:"guangyuyuan",name:"广誉远",story:"中药老字号，定坤丹等经典方剂知名，适合与养生文化联名。",image:Re("SDXL, Guangyuyuan pharmacy, classic drawers, herb jars, warm light")},{id:"leiyunshang",name:"雷允上",story:"苏州中药老字号，讲究炮制与选材，适合与健康生活方式联名。",image:Re("SDXL, Leiyunshang TCM, apothecary interior, wooden cabinets, warm tone")},{id:"hengdeli",name:"亨得利",story:"钟表眼镜老字号，服务与专业并重，适合与时间主题联名。",image:Re("SDXL, Hengdeli watch and optical store, elegant interior, warm light")},{id:"pechoin",name:"百雀羚",story:"国货护肤老品牌，复古包装与东方植物配方，适合与美妆与文创联名。",image:Re("SDXL, Pechoin skincare, retro packaging, floral botanical elements, soft lighting")},{id:"shuijingfang",name:"水井坊",story:"川酒老品牌，考古与文化叙事结合，适合与典藏主题联名。",image:Re("SDXL, Shuijingfang liquor, archaeological motif, premium packaging, warm tone")},{id:"yongshengpen",name:"永生钢笔",story:"经典钢笔老品牌，书写质感与复古设计，适合与校园文化联名。",image:Re("SDXL, Yongsheng fountain pen, macro nib, vintage desk, warm light")},{id:"hudiepai",name:"蝴蝶牌缝纫机",story:"传统缝纫机械老品牌，工艺与家政记忆，适合与手作文化联名。",image:Re("SDXL, Butterfly sewing machine, vintage home setting, warm tone, craftsmanship detail")}],Ae=e.memo(function({search:a=""}){const{isDark:r}=k(),n=o(),{isAuthenticated:l}=e.useContext(T),[c,d]=e.useState("activities"),m=e.useRef(null),[g,h]=e.useState(!0),[p,u]=e.useState(!1),[x,y]=e.useState(!1),[b,f]=e.useState(a),[v,j]=e.useState(null),N=e=>n(`/events/${e.id}`),w=()=>j(null),[_,S]=e.useState(null),C=e=>S(e),E=()=>S(null),[I,R]=e.useState(null),D=e=>R(e),P=()=>R(null),[z,$]=e.useState(null),O=()=>$(null),M=e.useRef(null),[q,U]=e.useState(1),H=36;e.useEffect(()=>{f(a)},[a]),e.useEffect(()=>{const e=()=>{const e=m.current;e&&(h(e.scrollLeft<=0),u(e.scrollLeft+e.clientWidth>=e.scrollWidth-1),y(e.scrollWidth>e.clientWidth+1))},t=m.current;t&&(e(),t.addEventListener("scroll",e));const s=()=>e();return window.addEventListener("resize",s),()=>{t&&t.removeEventListener("scroll",e),window.removeEventListener("resize",s)}},[]);const F=e=>{const t=m.current;if(!t)return;const s=Math.max(100,Math.floor(.8*t.clientWidth));t.scrollBy({left:"left"===e?-s:s,behavior:"smooth"})};e.useEffect(()=>{const e=m.current;if(!e)return;const t=e.querySelector('[aria-selected="true"]');t&&t.scrollIntoView({behavior:"smooth",inline:"nearest",block:"nearest"})},[c]);const K=e.useMemo(()=>we.getAllEvents().map(e=>({...e,participants:e.participantCount})),[]),[B,V]=e.useState([]),W=e=>{if(!l)return i.warning("请先登录后再参与活动"),void setTimeout(()=>n("/login"),800);V(t=>t.includes(e.id)?t:[...t,e.id]);const t=new URLSearchParams;t.set("prompt",e.title),t.set("activity",e.id),i.success("已为你创建活动草稿，进入创作页面"),n(`/create?${t.toString()}`)},Y=e.useMemo(()=>[{id:1,name:"津沽文化节主题模板",description:"融合天津传统文化元素，适用于各类文化节活动宣传设计。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20cultural%20festival%20template%20design",category:"节日主题",usageCount:235},{id:2,name:"海河风光模板",description:"以海河风光为背景，适合城市宣传和旅游相关设计。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Haihe%20River%20scenery%20template",category:"城市风光",usageCount:189},{id:3,name:"杨柳青年画风格模板",description:"模仿杨柳青年画的线条和色彩风格，具有浓厚的传统韵味。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Yangliuqing%20painting%20style%20template",category:"传统风格",usageCount:156},{id:4,name:"天津小吃宣传模板",description:"为天津特色小吃设计的宣传模板，突出地方美食特色。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20local%20food%20promotion%20template",category:"美食宣传",usageCount:123},{id:5,name:"城市地标插画模板",description:"以天津之眼、解放桥等地标为核心图形的插画类模板。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20city%20landmark%20illustration%20template",category:"城市风光",usageCount:144},{id:6,name:"非遗风物纹样模板",description:"提取泥人张、风筝魏等非遗元素纹样，适配现代版式。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20intangible%20heritage%20pattern%20design%20template",category:"非遗传承",usageCount:117},{id:7,name:"夜游光影视觉模板",description:"以海河夜景的光影氛围为主视觉，适配品牌活动海报。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Haihe%20night%20tour%20light%20and%20shadow%20visual%20template",category:"夜游光影",usageCount:98},{id:8,name:"老字号联名模板",description:"面向老字号品牌的联名海报与包装视觉模板。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20traditional%20brand%20co-branding%20visual%20template",category:"品牌联名",usageCount:135},{id:9,name:"滨海蓝色旅游模板",description:"提取滨海新区的海风与蓝色主题，面向旅游宣传设计。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Binhai%20blue%20tourism%20poster%20template",category:"旅游主题",usageCount:122},{id:10,name:"工业记忆影像模板",description:"以老厂房与工业质感为主，适合纪录片与影像项目。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20industrial%20memory%20visual%20template",category:"工业风",usageCount:87},{id:11,name:"文博展陈主题模板",description:"适用于博物馆、美术馆展陈的主视觉与导视系统。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Museum%20exhibition%20visual%20identity%20template",category:"文博展陈",usageCount:95},{id:12,name:"港口文化视觉模板",description:"以港口机械与城市航运为元素，体现天津港口文化。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20port%20culture%20visual%20template",category:"港口文化",usageCount:76},{id:13,name:"五大道历史风情模板",description:"以五大道近代建筑群为视觉元素，突出天津的历史人文风貌。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Wudadao%20historical%20architecture%20poster%20template",category:"历史风情",usageCount:142},{id:14,name:"意式风情区摄影模板",description:"以意式风情区的欧式街景为背景，适合城市旅行与摄影主题设计。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Italian%20Style%20Town%20photography%20template",category:"城市风光",usageCount:168},{id:15,name:"鼓楼文化宣传模板",description:"围绕鼓楼与老城厢的市井生活，适合社区文化与城市宣传设计。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Gulou%20culture%20promotion%20template",category:"城市文化",usageCount:121},{id:16,name:"北塘海鲜美食模板",description:"以北塘渔港与海鲜元素为主，适合餐饮美食类宣传设计。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Beitang%20seafood%20promotion%20template%20Tianjin",category:"美食宣传",usageCount:132},{id:17,name:"静海葡萄节活动模板",description:"围绕静海葡萄节打造节庆主视觉，适配导视与物料延展。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Jinghai%20grape%20festival%20poster%20template",category:"节日主题",usageCount:109},{id:18,name:"滨海新区科技主题模板",description:"以科技蓝与未来感图形为核心，突出滨海新区产业形象。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Binhai%20New%20Area%20technology%20theme%20visual%20template",category:"科技主题",usageCount:87},{id:19,name:"蓟州长城风光模板",description:"以蓟州长城与山野风光为主视觉，适合文旅宣传类设计。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Jizhou%20Great%20Wall%20scenery%20poster%20template%20Tianjin",category:"自然风光",usageCount:153},{id:20,name:"海河滨水休闲模板",description:"围绕海河滨水休闲的生活方式场景，适合社区活动与品牌海报。",thumbnail:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Haihe%20riverside%20leisure%20lifestyle%20visual%20template%20Tianjin",category:"城市休闲",usageCount:174}],[]),G=e.useMemo(()=>[{id:1,name:"杨柳青古镇年画体验",description:"亲手绘制杨柳青年画，体验传统木版年画的制作过程。",location:"天津市西青区杨柳青古镇",price:"¥128/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Yangliuqing%20ancient%20town%20New%20Year%20painting%20experience",availableSlots:15,rating:4.8,reviewCount:126},{id:2,name:"泥人张彩塑工坊",description:"跟随泥人张传承人学习彩塑技艺，制作属于自己的泥人作品。",location:"天津市南开区古文化街",price:"¥168/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Nirenzhang%20clay%20sculpture%20workshop%20experience",availableSlots:8,rating:4.9,reviewCount:89},{id:3,name:"风筝魏风筝制作体验",description:"学习传统风筝的制作技艺，亲手制作一只精美的天津风筝。",location:"天津市和平区劝业场",price:"¥98/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Weifeng%20kite%20making%20experience",availableSlots:20,rating:4.7,reviewCount:76},{id:4,name:"相声社沉浸体验",description:"走进相声社，体验台前幕后，与演员互动学习基本“捧逗”。",location:"天津市河北区意式风情区",price:"¥158/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20crosstalk%20club%20immersive%20experience",availableSlots:12,rating:4.8,reviewCount:64},{id:5,name:"古文化街导览打卡",description:"深度导览古文化街，打卡风物人文，体验天津老城味道。",location:"天津市南开区古文化街",price:"¥88/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Ancient%20Culture%20Street%20guided%20tour",availableSlots:25,rating:4.6,reviewCount:142},{id:6,name:"瓷器绘彩手作班",description:"在工坊学习瓷器绘彩，从草图到上色完成一件专属作品。",location:"天津市红桥区手作工坊",price:"¥198/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Ceramic%20painting%20workshop%20experience",availableSlots:10,rating:4.9,reviewCount:58},{id:7,name:"津味美食烹饪体验",description:"学习锅巴菜、煎饼果子等家常做法，掌握地道津味。",location:"天津市河西区共享厨房",price:"¥138/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20local%20cuisine%20cooking%20class%20experience",availableSlots:18,rating:4.7,reviewCount:73},{id:8,name:"海河夜游船",description:"乘坐游船欣赏海河夜景，配合讲解了解城市光影与故事。",location:"天津市河东区海河码头",price:"¥168/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Haihe%20night%20cruise%20experience",availableSlots:40,rating:4.5,reviewCount:211},{id:9,name:"天津地标摄影采风",description:"跟随向导拍摄地标建筑，学习夜景与构图技巧。",location:"天津市河西区文化中心",price:"¥158/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20city%20landmark%20photography%20walk",availableSlots:22,rating:4.8,reviewCount:96},{id:10,name:"石头门坎素包制作课",description:"学习传统素包制作技法，从和面到包制完整体验。",location:"天津市南开区老城厢",price:"¥128/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Shitoumenkan%20vegetarian%20bun%20making%20workshop%20experience",availableSlots:16,rating:4.6,reviewCount:54},{id:11,name:"茶汤李手作茶汤体验",description:"跟随老师学习传统茶汤调制，体验细腻甘香的津门味道。",location:"天津市河东区小吃工坊",price:"¥88/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Chatangli%20sweet%20soup%20making%20workshop%20experience",availableSlots:20,rating:4.5,reviewCount:67},{id:12,name:"海河皮划艇城市漫游",description:"专业教练带领在海河进行皮划艇体验，欣赏城市水岸风光。",location:"天津市河西区海河沿线",price:"¥198/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Haihe%20kayaking%20urban%20tour%20experience",availableSlots:12,rating:4.7,reviewCount:82},{id:13,name:"意式风情区历史徒步",description:"专业向导讲解近代建筑与城市史，深度漫步意式风情区。",location:"天津市河北区意式风情区",price:"¥68/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Italian%20Style%20Town%20heritage%20walking%20tour",availableSlots:30,rating:4.6,reviewCount:134},{id:14,name:"京剧基础脸谱绘制课",description:"学习京剧脸谱色彩与构图，完成一幅个人脸谱作品。",location:"天津市红桥区戏曲社",price:"¥128/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Peking%20opera%20face%20painting%20workshop%20experience",availableSlots:14,rating:4.8,reviewCount:92},{id:15,name:"传统皮影制作与表演",description:"体验皮影雕刻与拼装，学习基本操偶，现场小型演出。",location:"天津市津南区文化馆",price:"¥158/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Chinese%20shadow%20puppetry%20making%20and%20performance%20workshop%20experience",availableSlots:10,rating:4.7,reviewCount:59},{id:16,name:"老字号巡礼美食徒步",description:"串联多家天津老字号，边走边品，了解品牌故事与美味。",location:"天津市南开区古文化街",price:"¥98/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20time-honored%20brands%20food%20tour%20walking%20experience",availableSlots:25,rating:4.7,reviewCount:105},{id:17,name:"杨柳青木版水印工艺课",description:"学习木版水印工艺流程，完成一件传统水印作品。",location:"天津市西青区杨柳青古镇",price:"¥168/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Yangliuqing%20woodblock%20water%20printing%20craft%20workshop%20experience",availableSlots:12,rating:4.8,reviewCount:64},{id:18,name:"非遗剪纸工坊体验",description:"学习传统剪纸技法，完成节庆主题剪纸作品并装裱展示。",location:"天津市和平区文化馆",price:"¥88/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Chinese%20paper-cutting%20workshop%20experience%20festive%20designs",availableSlots:24,rating:4.6,reviewCount:72},{id:19,name:"京韵大鼓入门体验课",description:"在老师带领下体验击鼓与演唱的基本节奏与腔韵。",location:"天津市红桥区曲艺社",price:"¥128/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Peking%20drum%20music%20beginner%20workshop%20experience%20traditional%20stage",availableSlots:16,rating:4.7,reviewCount:58},{id:20,name:"年画拓印亲子课",description:"亲子共同学习年画拓印流程，完成一幅纪念作品。",location:"天津市西青区杨柳青古镇",price:"¥98/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Yangliuqing%20New%20Year%20print%20rubbing%20parent-child%20workshop%20experience",availableSlots:20,rating:4.8,reviewCount:88},{id:21,name:"古文化街夜拍漫步",description:"沿古文化街夜游拍摄，学习夜景用光与构图技巧。",location:"天津市南开区古文化街",price:"¥88/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Ancient%20Culture%20Street%20night%20photography%20walk%20experience",availableSlots:28,rating:4.6,reviewCount:119},{id:22,name:"港口工业遗址探访",description:"探访天津港工业遗址，学习纪录摄影与城市工业美学。",location:"天津市滨海新区港区",price:"¥128/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20port%20industrial%20heritage%20photography%20tour%20experience",availableSlots:18,rating:4.7,reviewCount:76},{id:23,name:"瓷器修复体验课",description:"了解瓷器修复基础流程，体验简单修补与彩绘工序。",location:"天津市红桥区手作工坊",price:"¥168/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Ceramic%20restoration%20beginner%20workshop%20experience%20painting%20and%20repair",availableSlots:12,rating:4.7,reviewCount:64},{id:24,name:"煎饼果子大师班",description:"学习面糊调配与摊制技巧，完成地道风味的煎饼果子。",location:"天津市河西区共享厨房",price:"¥118/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20jianbing%20guozi%20cooking%20masterclass%20workshop%20experience",availableSlots:20,rating:4.6,reviewCount:91},{id:25,name:"海河城市骑行漫游",description:"沿海河骑行漫游，结合导览讲解城市历史与地标。",location:"天津市河西区海河沿线",price:"¥88/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Haihe%20riverfront%20city%20cycling%20tour%20experience",availableSlots:30,rating:4.5,reviewCount:110},{id:26,name:"果仁张栗子手作演示",description:"观摩糖炒栗子工艺演示，了解配方与火候，现场试吃。",location:"天津市和平区老字号门店",price:"¥68/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Candied%20chestnut%20handcraft%20demonstration%20workshop%20experience",availableSlots:26,rating:4.6,reviewCount:85},{id:27,name:"传统风筝放飞体验日",description:"学习风筝放飞技巧与保养，现场集体放飞与拍照打卡。",location:"天津市河西区文化中心绿地",price:"¥68/人",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Traditional%20kite%20flying%20family%20experience%20day%20Tianjin",availableSlots:40,rating:4.7,reviewCount:120}],[]),Z=e.useMemo(()=>[{id:1,name:"桂发祥",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Guifaxiang%20traditional%20brand%20logo",description:"创建于1927年，以十八街麻花闻名，是天津食品行业的老字号品牌。",establishedYear:"1927",collaborationTools:8,popularity:96},{id:2,name:"狗不理",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Goubuli%20traditional%20brand%20logo",description:"创建于1858年，以特色包子闻名，是天津餐饮行业的代表性老字号。",establishedYear:"1858",collaborationTools:12,popularity:98},{id:3,name:"耳朵眼",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Tianjin%20Erduoyan%20traditional%20brand%20logo",description:"创建于1900年，以炸糕和酒类产品闻名，是天津的传统老字号。",establishedYear:"1900",collaborationTools:6,popularity:92},{id:4,name:"老美华",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Laomeihua%20traditional%20shoe%20brand%20logo",description:"始于民国时期的传统鞋履品牌，以手工缝制与舒适耐穿著称。",establishedYear:"1911",collaborationTools:5,popularity:88},{id:5,name:"大福来",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Dafulai%20guobacai%20brand%20logo",description:"以锅巴菜闻名，糊辣香浓、层次丰富，是天津特色早点代表。",establishedYear:"1930",collaborationTools:4,popularity:85},{id:6,name:"果仁张",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Guorenzhang%20candied%20chestnut%20brand%20logo",description:"百年坚果品牌，以糖炒栗子香甜饱满闻名，老天津味道的代表。",establishedYear:"1906",collaborationTools:6,popularity:90},{id:7,name:"茶汤李",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Chatangli%20sweet%20soup%20brand%20logo",description:"源自清末的茶汤品牌，口感细腻柔滑、甘香回甜，承载城市记忆。",establishedYear:"1895",collaborationTools:3,popularity:83},{id:8,name:"利顺德",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Lishunde%20hotel%20heritage%20brand%20logo",description:"百年酒店品牌，承载天津近代史与文化记忆，适合文旅联名。",establishedYear:"1863",collaborationTools:7,popularity:91},{id:9,name:"亨得利表行",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Hengdeli%20watch%20store%20heritage%20brand%20logo",description:"老牌钟表行品牌，精工与匠艺象征，可开展工艺联名。",establishedYear:"1890",collaborationTools:5,popularity:86},{id:10,name:"正兴德茶庄",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Zhengxingde%20tea%20house%20traditional%20brand%20logo",description:"历史悠久的茶庄品牌，融合津门茶文化与现代设计。",establishedYear:"1908",collaborationTools:4,popularity:84},{id:11,name:"石头门坎素包",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Shitoumenkan%20vegetarian%20bun%20heritage%20brand%20logo",description:"素包名店，传承传统素馅工艺，可做餐饮联名设计。",establishedYear:"1926",collaborationTools:3,popularity:82},{id:12,name:"孙记烧卖",logo:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=square&prompt=Sunji%20shaomai%20traditional%20brand%20logo",description:"街巷点心品牌，家常美味代表，适合集市活动联名。",establishedYear:"1935",collaborationTools:2,popularity:79}],[]),X=e.useMemo(()=>De.map((e,t)=>({id:1e3+t,name:e.name,logo:e.image,description:e.story,establishedYear:"—",collaborationTools:3+t%7,popularity:Math.min(99,70+t%30)})),[]),J=e.useMemo(()=>[...Z,...X],[Z,X]),Q=e=>{i.success("已应用模板到您的创作空间")},ee="string"==typeof b?b.trim().toLowerCase():"",te=e.useMemo(()=>ee?K.filter(e=>[e.title,e.description].some(e=>"string"==typeof e&&e.toLowerCase().includes(ee))):K,[ee,K]),se=e.useMemo(()=>ee?Y.filter(e=>[e.name,e.description,e.category].some(e=>"string"==typeof e&&e.toLowerCase().includes(ee))):Y,[ee,Y]),ae=e.useMemo(()=>ee?G.filter(e=>[e.name,e.description,e.location].some(e=>"string"==typeof e&&e.toLowerCase().includes(ee))):G,[ee,G]),ie=e.useMemo(()=>ee?J.filter(e=>[e.name,e.description,e.establishedYear].some(e=>"string"==typeof e&&e.toLowerCase().includes(ee))):J,[ee,J]),re=e.useMemo(()=>Array.isArray(ie)?ie.slice(0,q*H):[],[ie,q,H]);return e.useEffect(()=>{"brands"===c&&U(1)},[c,b]),e.useEffect(()=>{if("brands"!==c)return;const e=M.current;if(e)try{const t=Math.ceil(ie.length/H),s=new IntersectionObserver(e=>{e[0].isIntersecting&&U(e=>e<t?e+1:e)},{rootMargin:"200px"});return s.observe(e),()=>s.disconnect()}catch(t){}},[c,ie.length,H]),e.useEffect(()=>{if("brands"===c)try{const e=Math.ceil(ie.length/H);let t=!1;const s=()=>{t||(t=!0,requestAnimationFrame(()=>{t=!1;const s=document.documentElement;s&&(window.scrollY||s.scrollTop)+window.innerHeight>=Math.max(s.scrollHeight||0,s.offsetHeight||0,document.body?.scrollHeight||0,document.body?.offsetHeight||0)-300&&U(t=>t<e?t+1:t)}))};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)}catch(e){}},[c,ie.length,H]),t.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:`p-4 md:p-6 rounded-xl ${r?"bg-gray-800/50 backdrop-blur-sm border border-gray-700":"bg-white/80 backdrop-blur-sm border border-gray-100"} shadow-lg flex-1 flex flex-col md:flex-row gap-6`,children:[t.jsxs("div",{className:"w-full md:w-2/3",children:[t.jsxs("div",{className:"relative mb-6",children:[t.jsx("div",{className:`pointer-events-none absolute left-0 top-0 bottom-0 w-8 ${r?"bg-gradient-to-r from-gray-800/50 to-transparent":"bg-gradient-to-r from-white/80 to-transparent"} ${g?"opacity-0":"opacity-100"} transition-all duration-300`}),t.jsx("div",{role:"tablist","aria-label":"津味共创活动类别",ref:m,className:"flex space-x-3 overflow-x-auto scrollbar-hide scroll-smooth snap-x snap-mandatory px-2 pb-2",tabIndex:0,onKeyDown:e=>{"ArrowRight"===e.key&&F("right"),"ArrowLeft"===e.key&&F("left")},children:[{id:"activities",name:"主题活动"},{id:"templates",name:"地域模板"},{id:"offline",name:"线下体验"},{id:"brands",name:"老字号联名"}].map(e=>t.jsx(s.button,{onClick:()=>d(e.id),role:"tab","aria-selected":c===e.id,title:e.name,className:`px-5 py-2.5 rounded-full text-sm font-semibold transition-all duration-300 whitespace-nowrap snap-start focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-400 ${c===e.id?"bg-gradient-to-r from-red-600 to-red-500 text-white shadow-lg scale-105":r?"bg-gray-700/80 hover:bg-gray-700/100 hover:text-red-400":"bg-gray-100 hover:bg-gray-200 hover:text-red-600"} ${r?"focus-visible:ring-offset-2 focus-visible:ring-offset-gray-800":"focus-visible:ring-offset-2 focus-visible:ring-offset-white"}`,whileHover:{scale:1.05},whileTap:{scale:.98},children:e.name},e.id))}),t.jsx("div",{className:`pointer-events-none absolute right-0 top-0 bottom-0 w-8 ${r?"bg-gradient-to-l from-gray-800/50 to-transparent":"bg-gradient-to-l from-white/80 to-transparent"} ${!x||p?"opacity-0":"opacity-100"} transition-all duration-300`}),t.jsx("button",{"aria-label":"向左滚动类别",onClick:()=>F("left"),className:`absolute left-0 top-1/2 -translate-y-1/2 px-3 py-2 rounded-full ${r?"bg-gray-700 text-white hover:bg-gray-600":"bg-white text-gray-900 hover:bg-gray-100"} shadow-md border ${r?"border-gray-600":"border-gray-200"} ${!x||g?"opacity-0 pointer-events-none":"opacity-100"} transition-all duration-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 ${r?"focus:ring-offset-gray-800":"focus:ring-offset-white"}`,children:t.jsx("i",{className:"fas fa-chevron-left"})}),t.jsx("button",{"aria-label":"向右滚动类别",onClick:()=>F("right"),className:`absolute right-0 top-1/2 -translate-y-1/2 px-3 py-2 rounded-full ${r?"bg-gray-700 text-white hover:bg-gray-600":"bg-white text-gray-900 hover:bg-gray-100"} shadow-md border ${r?"border-gray-600":"border-gray-200"} ${!x||p?"opacity-0 pointer-events-none":"opacity-100"} transition-all duration-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 ${r?"focus:ring-offset-gray-800":"focus:ring-offset-white"}`,children:t.jsx("i",{className:"fas fa-chevron-right"})})]}),"activities"===c&&t.jsx("div",{className:"grid grid-cols-1 gap-6",children:te.map(e=>t.jsxs(s.div,{className:"rounded-2xl overflow-hidden shadow-lg border transition-all duration-300 "+(r?"border-gray-700 bg-gray-800 hover:shadow-xl":"border-gray-200 bg-white hover:shadow-xl"),whileHover:{y:-5},whileTap:{scale:.98},children:[t.jsxs("div",{className:"relative",children:[t.jsx(L,{src:e.image,alt:e.title,className:"cursor-pointer w-full aspect-[16/9] object-cover transition-transform duration-500 hover:scale-105",ratio:"landscape",rounded:"none",onClick:()=>N(e)}),t.jsx("div",{className:"absolute top-4 left-4",children:t.jsx("span",{className:"text-xs font-medium px-3 py-1.5 rounded-full "+("ongoing"===e.status?"bg-green-600 text-white shadow-lg shadow-green-600/30":"upcoming"===e.status?"bg-blue-600 text-white shadow-lg shadow-blue-600/30":"bg-gray-600 text-white shadow-lg"),children:"ongoing"===e.status?"进行中":"upcoming"===e.status?"即将开始":"已结束"})}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:t.jsxs("div",{className:"flex items-center bg-black/30 backdrop-blur-sm px-3 py-1.5 rounded-full inline-block",children:[t.jsx("i",{className:"fas fa-user-friends text-white mr-1.5"}),t.jsxs("span",{className:"text-white text-sm font-medium",children:[e.participantCount+(B.includes(e.id)?1:0),"人参与"]})]})})]}),t.jsxs("div",{className:"p-5 "+(r?"bg-gray-800":"bg-white"),children:[t.jsx("h4",{className:"font-bold text-lg mb-3 line-clamp-2 leading-tight",children:e.title}),t.jsx("p",{className:"text-sm mb-4 line-clamp-3 leading-relaxed "+(r?"text-gray-300":"text-gray-600"),children:e.description}),t.jsxs("div",{className:"flex flex-col gap-3 mb-5",children:[t.jsx("div",{className:"flex items-center text-sm",children:t.jsxs("span",{className:(r?"text-gray-300":"text-gray-700")+" flex-1",children:[t.jsx("i",{className:"far fa-calendar-alt mr-2"}),e.startDate," - ",e.endDate]})}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsxs("span",{className:"px-3 py-1.5 rounded-full text-xs font-medium "+(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-800"),children:[t.jsx("i",{className:"fas fa-map-marker-alt mr-1.5"}),"线上"]}),t.jsxs("span",{className:"px-3 py-1.5 rounded-full text-xs font-medium "+(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-800"),children:[t.jsx("i",{className:"fas fa-tag mr-1.5"}),"设计"]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(A,{onClick:()=>W(e),variant:"primary",fullWidth:!0,disabled:"ongoing"!==e.status||B.includes(e.id),loading:!1,className:"rounded-xl py-3.5 text-sm font-semibold",children:"ongoing"!==e.status?"活动已结束":B.includes(e.id)?"已参与":"立即参与"}),t.jsx(A,{onClick:()=>N(e),variant:"secondary",fullWidth:!0,className:"rounded-xl py-3.5 text-sm font-semibold",children:"查看详情"})]})]})]},e.id))}),"templates"===c&&t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-4",children:se.map(e=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-md border "+(r?"border-gray-700":"border-gray-200"),whileHover:{y:-5},children:[t.jsx(L,{src:e.thumbnail,alt:e.name,className:"cursor-pointer",ratio:"landscape",rounded:"none",onClick:()=>C(e)}),t.jsxs("div",{className:"p-3 "+(r?"bg-gray-700":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-start mb-1",children:[t.jsx("h4",{className:"font-medium",children:e.name}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(r?"bg-gray-600":"bg-gray-100"),children:e.category})]}),t.jsx("p",{className:"text-xs mb-2 "+(r?"text-gray-400":"text-gray-600"),children:e.description}),t.jsx("div",{className:"flex justify-between items-center text-xs mb-3",children:t.jsxs("span",{className:(r?"text-gray-400":"text-gray-600")+" flex items-center",children:[t.jsx("i",{className:"fas fa-download mr-1"}),e.usageCount,"次使用"]})}),t.jsx("button",{onClick:()=>Q(),className:"w-full py-1.5 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm transition-colors",children:"应用模板"}),t.jsx("button",{onClick:()=>C(e),className:"mt-2 w-full py-1.5 rounded-lg text-sm transition-colors "+(r?"bg-gray-600 hover:bg-gray-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"),children:"查看详情"})]})]},e.id))}),"offline"===c&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:ae.map(e=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-md border "+(r?"border-gray-700":"border-gray-200"),whileHover:{y:-5},children:[t.jsx(L,{src:e.image,alt:e.name,ratio:"landscape",rounded:"xl",onClick:()=>D(e)}),t.jsxs("div",{className:"p-4 "+(r?"bg-gray-700":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("h4",{className:"font-bold",children:e.name}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 text-xs mr-1"}),t.jsx("span",{className:"text-sm",children:e.rating}),t.jsxs("span",{className:"text-xs ml-1 "+(r?"text-gray-400":"text-gray-600"),children:["(",e.reviewCount,")"]})]})]}),t.jsx("p",{className:"text-sm mb-3 "+(r?"text-gray-400":"text-gray-600"),children:e.description}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex items-center text-sm mb-1",children:[t.jsx("i",{className:"fas fa-map-marker-alt mr-1.5 text-red-600"}),t.jsx("span",{className:"truncate",children:e.location})]}),t.jsxs("div",{className:"flex items-center text-sm",children:[t.jsx("i",{className:"fas fa-tag mr-1.5 text-green-600"}),t.jsx("span",{children:e.price})]})]}),t.jsxs("div",{className:`mb-3 p-2 rounded-lg ${r?"bg-gray-600":"bg-gray-100"} text-sm flex justify-between items-center`,children:[t.jsx("span",{children:"可预约名额"}),t.jsxs("span",{className:"font-medium",children:[e.availableSlots,"人"]})]}),t.jsx("button",{onClick:()=>{i.success("预约成功！我们会尽快与您联系确认详情")},className:"w-full py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"立即预约"}),t.jsx("button",{onClick:()=>D(e),className:"mt-2 w-full py-2 rounded-lg "+(r?"bg-gray-600 hover:bg-gray-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"),children:"查看详情"})]})]},e.id))}),"brands"===c&&t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-6",children:re.map(e=>t.jsxs(s.div,{className:`p-4 rounded-xl shadow-md border transition-shadow ${r?"bg-gray-700 border-gray-600":"bg-white border-gray-200"} group hover:shadow-lg`,whileHover:{y:-5},children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx("div",{className:`w-16 h-16 rounded-lg overflow-hidden p-2 mr-4 flex items-center justify-center border transition-colors ${r?"bg-gray-800 border-gray-600":"bg-white border-gray-200"} group-hover:border-blue-400`,children:t.jsx("div",{className:"w-full h-full",children:t.jsx(L,{src:e.logo,alt:e.name,className:"w-full h-full",ratio:"square",fit:"contain"})})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold",children:e.name}),t.jsxs("p",{className:"text-sm "+(r?"text-gray-400":"text-gray-600"),children:["创立于 ",e.establishedYear,"年"]})]})]}),t.jsx("p",{className:`text-sm mb-4 ${r?"text-gray-400":"text-gray-600"} line-clamp-2`,children:e.description}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[t.jsxs("div",{className:`p-2 rounded-lg ${r?"bg-gray-600":"bg-gray-100"} text-center`,children:[t.jsx("p",{className:`text-xs ${r?"text-gray-400":"text-gray-600"} mb-1`,children:"定制工具"}),t.jsx("p",{className:"font-bold",children:e.collaborationTools})]}),t.jsxs("div",{className:`p-2 rounded-lg ${r?"bg-gray-600":"bg-gray-100"} text-center`,children:[t.jsx("p",{className:`text-xs ${r?"text-gray-400":"text-gray-600"} mb-1`,children:"热度指数"}),t.jsx("p",{className:"font-bold",children:e.popularity})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs(A,{ariaLabel:`查看${e.name}联名工具`,className:"w-full",onClick:()=>n(`/tools?from=tianjin&query=${encodeURIComponent(e.name+" 联名 工具")}&mode=inspire`),children:[t.jsx("i",{className:"fas fa-tools mr-2"}),"查看联名工具"]}),t.jsxs(A,{ariaLabel:`查看${e.name}详情`,className:"w-full",onClick:()=>$(e),children:[t.jsx("i",{className:"fas fa-info-circle mr-2"}),"查看详情"]})]})]},e.id))}),"brands"===c&&t.jsx("div",{className:"text-center mt-6",children:q*H<ie.length?t.jsx("div",{ref:M,className:"h-10"}):t.jsx("span",{className:r?"text-gray-400":"text-gray-600",children:"已加载全部"})})]}),t.jsxs("div",{className:"w-full md:w-1/3 space-y-6",children:[t.jsxs("div",{className:"p-4 rounded-xl shadow-md "+(r?"bg-gray-700":"bg-white"),children:[t.jsx("h3",{className:"font-bold text-lg mb-4",children:"热门话题"}),t.jsx("div",{className:"space-y-3",children:[{tag:"#国潮设计",count:234},{tag:"#天津老字号",count:189},{tag:"#文创产品",count:156},{tag:"#津味插画",count:123},{tag:"#非遗传承",count:98}].map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${r?"bg-red-500":"bg-red-400"} mr-2`}),t.jsx("span",{className:r?"text-gray-300":"text-gray-700",children:e.tag})]}),t.jsxs("span",{className:"text-sm "+(r?"text-gray-400":"text-gray-500"),children:[e.count,"人参与"]})]},s))})]}),t.jsxs("div",{className:"p-4 rounded-xl shadow-md "+(r?"bg-gray-700":"bg-white"),children:[t.jsx("h3",{className:"font-bold text-lg mb-4",children:"活动推荐"}),t.jsx("div",{className:"space-y-3",children:te.slice(0,2).map(e=>t.jsxs("div",{className:"flex gap-3",children:[t.jsx(L,{src:e.image,alt:e.title,className:"w-20 h-20 object-cover rounded-lg",ratio:"square"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-sm truncate",children:e.title}),t.jsxs("p",{className:`text-xs ${r?"text-gray-400":"text-gray-500"} mt-1`,children:[t.jsx("i",{className:"far fa-calendar-alt mr-1"}),e.startDate]}),t.jsx("span",{className:"inline-block mt-1 px-1.5 py-0.5 rounded-full text-xs "+("ongoing"===e.status?"bg-green-600 text-white":"upcoming"===e.status?"bg-blue-600 text-white":"bg-gray-600 text-white"),children:"ongoing"===e.status?"进行中":"upcoming"===e.status?"即将开始":"已结束"})]})]},e.id))})]}),t.jsxs("div",{className:"p-4 rounded-xl shadow-md "+(r?"bg-gray-700":"bg-white"),children:[t.jsx("h3",{className:"font-bold text-lg mb-4",children:"数据统计"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:`p-3 rounded-lg ${r?"bg-gray-600":"bg-gray-100"} text-center`,children:[t.jsx("p",{className:`text-xs ${r?"text-gray-400":"text-gray-600"} mb-1`,children:"总活动数"}),t.jsx("p",{className:"font-bold text-xl",children:te.length})]}),t.jsxs("div",{className:`p-3 rounded-lg ${r?"bg-gray-600":"bg-gray-100"} text-center`,children:[t.jsx("p",{className:`text-xs ${r?"text-gray-400":"text-gray-600"} mb-1`,children:"总模板数"}),t.jsx("p",{className:"font-bold text-xl",children:se.length})]}),t.jsxs("div",{className:`p-3 rounded-lg ${r?"bg-gray-600":"bg-gray-100"} text-center`,children:[t.jsx("p",{className:`text-xs ${r?"text-gray-400":"text-gray-600"} mb-1`,children:"线下体验"}),t.jsx("p",{className:"font-bold text-xl",children:ae.length})]}),t.jsxs("div",{className:`p-3 rounded-lg ${r?"bg-gray-600":"bg-gray-100"} text-center`,children:[t.jsx("p",{className:`text-xs ${r?"text-gray-400":"text-gray-600"} mb-1`,children:"老字号品牌"}),t.jsx("p",{className:"font-bold text-xl",children:ie.length})]})]})]})]}),v&&t.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:w}),t.jsxs(s.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},className:"relative z-50 w-full max-w-5xl mx-4 rounded-2xl overflow-hidden shadow-2xl "+(r?"bg-gray-800":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b "+(r?"border-gray-700":"border-gray-200"),children:[t.jsx("h4",{className:"text-lg font-bold",children:v.title}),t.jsx("button",{onClick:w,className:"px-3 py-1 rounded-lg "+(r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),"aria-label":"关闭详情",children:"关闭"})]}),t.jsxs("div",{className:"px-6 py-4 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx(L,{src:v.image,alt:v.title,className:"w-full",ratio:"landscape",rounded:"xl"}),t.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-xs",children:[t.jsx("span",{className:"px-2 py-1 rounded "+("ongoing"===v.status?"bg-green-600 text-white":"upcoming"===v.status?"bg-blue-600 text-white":"bg-gray-600 text-white"),children:"ongoing"===v.status?"进行中":"upcoming"===v.status?"即将开始":"已结束"}),t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["参与 ",v.participantCount]}),t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:[v.startDate," - ",v.endDate]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:(r?"text-gray-300":"text-gray-700")+" text-sm mb-3",children:v.description}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-3",children:[t.jsxs("div",{className:(r?"bg-gray-700":"bg-gray-100")+" rounded-lg p-3",children:[t.jsx("p",{className:(r?"text-gray-400":"text-gray-600")+" mb-1",children:"活动地点"}),t.jsx("p",{className:"font-medium",children:v.title.includes("海河")?"海河沿线":v.title.includes("静海")?"静海区":"天津市区"})]}),t.jsxs("div",{className:(r?"bg-gray-700":"bg-gray-100")+" rounded-lg p-3",children:[t.jsx("p",{className:(r?"text-gray-400":"text-gray-600")+" mb-1",children:"主办单位"}),t.jsx("p",{className:"font-medium",children:"天津市文化和旅游局（联合主办）"})]})]}),t.jsxs("div",{className:`rounded-lg p-3 ${r?"bg-gray-700":"bg-gray-50"} mb-3`,children:[t.jsx("p",{className:"font-medium mb-2",children:"参赛要求"}),t.jsxs("ul",{className:(r?"text-gray-300":"text-gray-700")+" text-sm space-y-1 list-disc pl-5",children:[t.jsx("li",{children:"围绕主题原创设计，保证作品版权归属清晰"}),t.jsx("li",{children:"提交源文件与展示稿，标注主要创意与元素来源"}),t.jsx("li",{children:"允许团队或个人参赛，跨学科协作加分"})]})]}),t.jsxs("div",{className:`rounded-lg p-3 ${r?"bg-gray-700":"bg-gray-50"} mb-3`,children:[t.jsx("p",{className:"font-medium mb-2",children:"奖项设置"}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[t.jsxs("div",{className:(r?"bg-gray-600":"bg-white")+" rounded-lg p-2 shadow-sm",children:[t.jsx("p",{className:"text-xs",children:"金奖"}),t.jsx("p",{className:"font-bold",children:"1"})]}),t.jsxs("div",{className:(r?"bg-gray-600":"bg-white")+" rounded-lg p-2 shadow-sm",children:[t.jsx("p",{className:"text-xs",children:"银奖"}),t.jsx("p",{className:"font-bold",children:"2"})]}),t.jsxs("div",{className:(r?"bg-gray-600":"bg-white")+" rounded-lg p-2 shadow-sm",children:[t.jsx("p",{className:"text-xs",children:"优秀奖"}),t.jsx("p",{className:"font-bold",children:"5"})]})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>v&&W(v),className:"flex-1 py-2 rounded-lg "+("ongoing"!==v.status?r?"bg-gray-600 text-white cursor-not-allowed":"bg-gray-300 text-gray-700 cursor-not-allowed":B.includes(v.id)?"bg-green-600 text-white cursor-default":"bg-red-600 hover:bg-red-700 text-white"),disabled:"ongoing"!==v.status||B.includes(v.id),children:"ongoing"!==v.status?"活动已结束":B.includes(v.id)?"已参与":"立即参与"}),t.jsx("button",{className:"flex-1 py-2 rounded-lg "+(r?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"),onClick:w,children:"关闭"})]})]})]})]})]}),_&&t.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:E}),t.jsxs(s.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.2},className:"relative z-50 w-full max-w-4xl mx-4 rounded-2xl overflow-hidden shadow-2xl "+(r?"bg-gray-800":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b "+(r?"border-gray-700":"border-gray-200"),children:[t.jsx("h4",{className:"text-lg font-bold",children:_.name}),t.jsx("button",{onClick:E,className:(r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200")+" px-3 py-1 rounded-lg",children:"关闭"})]}),t.jsxs("div",{className:"px-6 py-4 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx(L,{src:_.thumbnail,alt:_.name,className:"w-full",ratio:"landscape",rounded:"xl"}),t.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-xs",children:[t.jsx("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:_.category}),t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["使用 ",_.usageCount]}),t.jsx("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:"文件格式 PNG/SVG"})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:(r?"text-gray-300":"text-gray-700")+" text-sm mb-3",children:_.description}),t.jsxs("div",{className:`rounded-lg p-3 ${r?"bg-gray-700":"bg-gray-50"} mb-3`,children:[t.jsx("p",{className:"font-medium mb-2",children:"适用场景"}),t.jsxs("ul",{className:(r?"text-gray-300":"text-gray-700")+" text-sm space-y-1 list-disc pl-5",children:[t.jsx("li",{children:"活动海报、H5 页面主视觉"}),t.jsx("li",{children:"品牌联名周边与包装封面"}),t.jsx("li",{children:"社交媒体传播物料模板"})]})]}),t.jsxs("div",{className:`rounded-lg p-3 ${r?"bg-gray-700":"bg-gray-50"} mb-3`,children:[t.jsx("p",{className:"font-medium mb-2",children:"授权说明"}),t.jsx("p",{className:(r?"text-gray-300":"text-gray-700")+" text-sm",children:"仅限平台内项目使用，商业化需另行授权；请遵守地方文化元素使用规范。"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{className:"flex-1 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>Q(),children:"应用到创作空间"}),t.jsx("button",{className:(r?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800")+" flex-1 py-2 rounded-lg",onClick:E,children:"关闭"})]})]})]})]})]}),I&&t.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:P}),t.jsxs(s.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.2},className:"relative z-50 w-full max-w-4xl mx-4 rounded-2xl overflow-hidden shadow-2xl "+(r?"bg-gray-800":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b "+(r?"border-gray-700":"border-gray-200"),children:[t.jsx("h4",{className:"text-lg font-bold",children:I.name}),t.jsx("button",{onClick:P,className:(r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200")+" px-3 py-1 rounded-lg",children:"关闭"})]}),t.jsxs("div",{className:"px-6 py-4 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx(L,{src:I.image,alt:I.name,className:"w-full",ratio:"landscape",rounded:"xl"}),t.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["评分 ",I.rating]}),t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["点评 ",I.reviewCount]}),t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["名额 ",I.availableSlots]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:(r?"text-gray-300":"text-gray-700")+" text-sm mb-3",children:I.description}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-3",children:[t.jsxs("div",{className:(r?"bg-gray-700":"bg-gray-100")+" rounded-lg p-3",children:[t.jsx("p",{className:(r?"text-gray-400":"text-gray-600")+" mb-1",children:"体验地点"}),t.jsx("p",{className:"font-medium",children:I.location})]}),t.jsxs("div",{className:(r?"bg-gray-700":"bg-gray-100")+" rounded-lg p-3",children:[t.jsx("p",{className:(r?"text-gray-400":"text-gray-600")+" mb-1",children:"费用说明"}),t.jsxs("p",{className:"font-medium",children:[I.price,"（含材料费/讲解）"]})]})]}),t.jsxs("div",{className:`rounded-lg p-3 ${r?"bg-gray-700":"bg-gray-50"} mb-3`,children:[t.jsx("p",{className:"font-medium mb-2",children:"预约须知"}),t.jsxs("ul",{className:(r?"text-gray-300":"text-gray-700")+" text-sm space-y-1 list-disc pl-5",children:[t.jsx("li",{children:"确认预约后请准时到场，迟到可能需重新排队"}),t.jsx("li",{children:"如需取消，请提前 24 小时联系工作人员"}),t.jsx("li",{children:"体验中请遵守现场安全与文化保护规范"})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{className:"flex-1 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white",children:"立即预约"}),t.jsx("button",{className:(r?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800")+" flex-1 py-2 rounded-lg",onClick:P,children:"关闭"})]})]})]})]})]}),z&&t.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:O}),t.jsxs(s.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.2},className:"relative z-50 w-full max-w-4xl mx-4 rounded-2xl overflow-hidden shadow-2xl "+(r?"bg-gray-800":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b "+(r?"border-gray-700":"border-gray-200"),children:[t.jsx("h4",{className:"text-lg font-bold",children:z.name}),t.jsx("button",{onClick:O,className:(r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200")+" px-3 py-1 rounded-lg",children:"关闭"})]}),t.jsxs("div",{className:"px-6 py-4 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("div",{className:"w-full h-56 bg-white rounded-xl flex items-center justify-center p-6",children:t.jsx(L,{src:z.logo,alt:z.name,className:"max-h-full",ratio:"square",fit:"contain"})}),t.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["创立 ",z.establishedYear]}),t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["工具 ",z.collaborationTools]}),t.jsxs("span",{className:(r?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700")+" px-2 py-1 rounded",children:["热度 ",z.popularity]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:(r?"text-gray-300":"text-gray-700")+" text-sm mb-3",children:z.description}),t.jsxs("div",{className:`rounded-lg p-3 ${r?"bg-gray-700":"bg-gray-50"} mb-3`,children:[t.jsx("p",{className:"font-medium mb-2",children:"联名方向"}),t.jsxs("ul",{className:(r?"text-gray-300":"text-gray-700")+" text-sm space-y-1 list-disc pl-5",children:[t.jsx("li",{children:"联名包装与周边（限定款）"}),t.jsx("li",{children:"门店活动视觉与导视系统"}),t.jsx("li",{children:"跨界文化体验合作"})]})]}),t.jsxs("div",{className:`rounded-lg p-3 ${r?"bg-gray-700":"bg-gray-50"} mb-3`,children:[t.jsx("p",{className:"font-medium mb-2",children:"合作流程"}),t.jsxs("ol",{className:(r?"text-gray-300":"text-gray-700")+" text-sm space-y-1 list-decimal pl-5",children:[t.jsx("li",{children:"提交联名创意与目标受众"}),t.jsx("li",{children:"品牌方评审与法务合规确认"}),t.jsx("li",{children:"打样测试与上线活动执行"})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs(A,{className:"flex-1",children:[t.jsx("i",{className:"fas fa-handshake mr-2"}),"联系品牌方"]}),t.jsx("button",{className:(r?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800")+" flex-1 py-2 rounded-lg",onClick:O,children:"关闭"})]})]})]})]})]})]})}),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"}));function ze(){const{isDark:a}=k(),[r,n]=e.useState(!0),[l,o]=e.useState("upcoming"),[c,d]=e.useState("all"),[m,g]=e.useState([]),[h,p]=e.useState([]),[u,x]=e.useState(null),[y,b]=e.useState(!1),[f,v]=e.useState("");e.useEffect(()=>{n(!0),setTimeout(()=>{const e=we.getAllEvents();g(e),p(e),n(!1)},600)},[]),e.useEffect(()=>{let e=[...m];if("upcoming"===l?e=e.filter(e=>"upcoming"===e.status):"ongoing"===l?e=e.filter(e=>"ongoing"===e.status):"completed"===l&&(e=e.filter(e=>"completed"===e.status)),"all"!==c&&(e=e.filter(e=>e.type===c)),f){const t=f.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t))||e.culturalElements.some(e=>e.toLowerCase().includes(t)))}p(e)},[l,c,m,f]);const j=e=>({theme:"主题活动",collaboration:"协作活动",competition:"竞赛",workshop:"工作坊",exhibition:"展览"}[e]),N=e=>({theme:"calendar-alt",collaboration:"users",competition:"trophy",workshop:"chalkboard-teacher",exhibition:"images"}[e]);return r?t.jsx("div",{className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:`h-8 w-1/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:`h-10 rounded-lg ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"flex space-x-3 overflow-x-auto pb-4",children:[1,2,3].map(e=>t.jsx("div",{className:`h-10 w-24 rounded-full ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`},e))}),t.jsx("div",{className:"flex space-x-3 overflow-x-auto pb-4",children:[1,2,3,4,5].map(e=>t.jsx("div",{className:`h-8 w-20 rounded-full ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`},e))}),t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsx("div",{className:`h-48 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`},e))})]})}):t.jsxs("div",{className:`p-4 sm:p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:[t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 sm:mb-6 space-y-3 sm:space-y-0",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-bold",children:"文化主题活动日历"}),t.jsxs("div",{className:"relative w-full md:w-64",children:[t.jsx("input",{type:"text",placeholder:"搜索活动...",value:f,onChange:e=>v(e.target.value),className:`w-full pl-10 pr-4 py-2 rounded-lg text-sm ${a?"bg-gray-700 text-white placeholder-gray-400":"bg-gray-100 text-gray-900 placeholder-gray-600"}\n              focus:outline-none focus:ring-2 focus:ring-red-500 transition-all`}),t.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),t.jsx("div",{className:"flex space-x-3 mb-4 sm:mb-6 overflow-x-auto pb-4 scrollbar-hide",children:[{id:"upcoming",name:"即将开始"},{id:"ongoing",name:"进行中"},{id:"completed",name:"已结束"}].map(e=>t.jsx("button",{onClick:()=>o(e.id),className:"px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all whitespace-nowrap "+(l===e.id?"bg-red-600 text-white shadow-md":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:e.name},e.id))}),t.jsxs("div",{className:"flex space-x-3 mb-4 sm:mb-6 overflow-x-auto pb-4 scrollbar-hide",children:[t.jsx("button",{onClick:()=>d("all"),className:"px-3 py-1.5 rounded-full text-xs sm:text-sm transition-all whitespace-nowrap "+("all"===c?"bg-blue-600 text-white":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:"全部类型"}),["theme","collaboration","competition","workshop","exhibition"].map(e=>t.jsx("button",{onClick:()=>d(e),className:"px-3 py-1.5 rounded-full text-xs sm:text-sm transition-all whitespace-nowrap "+(c===e?"bg-blue-600 text-white":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:j(e)},e))]}),h.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:h.map(e=>t.jsxs(s.div,{className:`rounded-xl overflow-hidden shadow-md border ${a?"border-gray-700":"border-gray-200"} cursor-pointer`,whileHover:{y:-5},onClick:()=>(e=>{x(e),b(!0)})(e),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[t.jsxs("div",{className:"relative",children:[t.jsx(L,{src:e.image,alt:e.title,className:"w-full h-36 sm:h-48 object-cover",ratio:"landscape"}),t.jsxs("div",{className:"absolute top-2 left-2 flex gap-1.5",children:[t.jsxs("span",{className:"text-[10px] sm:text-xs px-2 py-1 rounded-full "+(a?"bg-gray-900 bg-opacity-80":"bg-white bg-opacity-90"),children:[t.jsx("i",{className:`fas fa-${N(e.type)} mr-1`}),j(e.type)]}),t.jsx("span",{className:"text-[10px] sm:text-xs px-2 py-1 rounded-full "+("upcoming"===e.status?"bg-green-600 text-white":"ongoing"===e.status?"bg-yellow-600 text-white":"bg-gray-600 text-white"),children:"upcoming"===e.status?"即将开始":"ongoing"===e.status?"进行中":"已结束"})]})]}),t.jsxs("div",{className:"p-3 sm:p-5 "+(a?"bg-gray-700":"bg-white"),children:[t.jsx("h3",{className:"text-sm sm:text-lg font-bold mb-2 line-clamp-2",children:e.title}),t.jsx("p",{className:`text-xs sm:text-sm mb-3 sm:mb-4 ${a?"text-gray-400":"text-gray-600"} line-clamp-3`,children:e.description}),t.jsxs("div",{className:"space-y-1.5 sm:space-y-2 mb-3 sm:mb-4",children:[t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-calendar-alt text-red-500 mr-2 w-5 text-center"}),t.jsxs("span",{children:[e.startDate," ",e.endDate!==e.startDate?`至 ${e.endDate}`:""]})]}),e.startTime&&e.endTime&&t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-clock text-red-500 mr-2 w-5 text-center"}),t.jsxs("span",{children:[e.startTime," - ",e.endTime]})]}),e.location&&t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-map-marker-alt text-red-500 mr-2 w-5 text-center"}),t.jsx("span",{className:"line-clamp-1",children:e.location})]}),e.onlineLink&&t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-link text-red-500 mr-2 w-5 text-center"}),t.jsx("span",{className:"line-clamp-1 text-blue-500 hover:underline",children:"线上活动"})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 mb-3 sm:mb-4",children:[e.tags.slice(0,3).map((e,s)=>t.jsx("span",{className:"text-[10px] sm:text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:e},s)),e.tags.length>3&&t.jsxs("span",{className:"text-[10px] sm:text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:["+",e.tags.length-3]})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[t.jsxs("span",{className:a?"text-gray-400":"text-gray-600",children:[t.jsx("i",{className:"fas fa-users mr-1"}),e.participantCount,"人已参与",e.maxParticipants&&` / ${e.maxParticipants}`]}),e.hasPrize&&t.jsxs("span",{className:"text-[10px] sm:text-xs bg-yellow-100 text-yellow-600 px-2 py-0.5 rounded-full",children:[t.jsx("i",{className:"fas fa-gift mr-1"}),"有奖励"]})]})]})]},e.id))}):t.jsxs("div",{className:"p-6 sm:p-8 rounded-xl text-center "+(a?"bg-gray-700":"bg-gray-50"),children:[t.jsx("i",{className:"fas fa-calendar-times text-5xl sm:text-6xl text-red-600 mb-3 sm:mb-4"}),t.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-2",children:"暂无活动"}),t.jsx("p",{className:"text-sm sm:text-base mb-4 "+(a?"text-gray-400":"text-gray-600"),children:"当前筛选条件下没有找到相关活动"}),t.jsx("button",{onClick:()=>{o("upcoming"),d("all"),v("")},className:"px-4 py-2 sm:px-6 sm:py-2 rounded-lg text-sm font-medium bg-red-600 hover:bg-red-700 text-white transition-colors",children:"查看全部活动"})]}),y&&u&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 p-4 overflow-y-auto",children:t.jsxs("div",{className:(a?"bg-gray-800 text-white":"bg-white text-gray-900")+" rounded-xl p-4 sm:p-6 w-full max-w-md sm:max-w-2xl lg:max-w-3xl max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[t.jsx("h3",{className:"text-lg sm:text-xl font-bold line-clamp-2",children:u.title}),t.jsx("button",{onClick:()=>b(!1),className:`p-2 rounded-full ${a?"hover:bg-gray-700":"hover:bg-gray-100"} transition-colors`,children:t.jsx("i",{className:"fas fa-times text-lg sm:text-xl"})})]}),t.jsx(L,{src:u.image,alt:u.title,className:"w-full h-36 sm:h-48 lg:h-64 object-cover rounded-lg mb-4 sm:mb-6",ratio:"landscape"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-4 sm:mb-6",children:[t.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"活动类型"}),t.jsxs("span",{className:"px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm "+(a?"bg-gray-700":"bg-gray-100"),children:[t.jsx("i",{className:`fas fa-${N(u.type)} mr-1`}),j(u.type)]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"活动状态"}),t.jsx("span",{className:"px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm "+("upcoming"===u.status?"bg-green-600 text-white":"ongoing"===u.status?"bg-yellow-600 text-white":"bg-gray-600 text-white"),children:"upcoming"===u.status?"即将开始":"ongoing"===u.status?"进行中":"已结束"})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"活动时间"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-calendar-alt text-red-500 mr-2 w-5 text-center"}),t.jsxs("span",{children:[u.startDate," ",u.endDate!==u.startDate?`至 ${u.endDate}`:""]})]}),u.startTime&&u.endTime&&t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-clock text-red-500 mr-2 w-5 text-center"}),t.jsxs("span",{children:[u.startTime," - ",u.endTime]})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"活动地点"}),t.jsxs("div",{className:"space-y-1",children:[u.location&&t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-map-marker-alt text-red-500 mr-2 w-5 text-center"}),t.jsx("span",{className:"line-clamp-1",children:u.location})]}),u.onlineLink&&t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-link text-red-500 mr-2 w-5 text-center"}),t.jsx("a",{href:u.onlineLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline line-clamp-1",children:u.onlineLink})]})]})]})]}),t.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"主办方"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-building text-red-500 mr-2 text-base"}),t.jsx("span",{className:"text-xs sm:text-sm",children:u.organizer})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"参与情况"}),t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-users text-red-500 mr-2 w-5 text-center"}),t.jsxs("span",{children:[u.participantCount,"人已参与",u.maxParticipants&&` / ${u.maxParticipants}`]})]})]}),u.registrationDeadline&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"报名截止"}),t.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-clock text-red-500 mr-2 w-5 text-center"}),t.jsx("span",{children:u.registrationDeadline})]})]}),u.hasPrize&&u.prizeDescription&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"奖励设置"}),t.jsx("div",{className:"p-2 sm:p-3 rounded-lg "+(a?"bg-gray-700":"bg-yellow-50"),children:t.jsx("p",{className:"text-xs sm:text-sm whitespace-pre-line",children:u.prizeDescription})})]})]})]}),t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"活动描述"}),t.jsx("p",{className:"text-xs sm:text-sm "+(a?"text-gray-300":"text-gray-700"),children:u.description})]}),u.culturalElements.length>0&&t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"文化元素"}),t.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:u.culturalElements.map((e,s)=>t.jsx("span",{className:"px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm "+(a?"bg-gray-700":"bg-blue-50 text-blue-600"),children:e},s))})]}),u.tags.length>0&&t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"标签"}),t.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:u.tags.map((e,s)=>t.jsx("span",{className:"px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm "+(a?"bg-gray-700":"bg-gray-100"),children:e},s))})]}),u.rules&&u.rules.length>0&&t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"活动规则"}),t.jsx("ul",{className:"space-y-1.5 sm:space-y-2 "+(a?"text-gray-300":"text-gray-700"),children:u.rules.map((e,s)=>t.jsxs("li",{className:"flex items-start text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mr-2 mt-1 flex-shrink-0"}),t.jsx("span",{children:e})]},s))})]}),u.requirements&&u.requirements.length>0&&t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2",children:"作品要求"}),t.jsx("ul",{className:"space-y-1.5 sm:space-y-2 "+(a?"text-gray-300":"text-gray-700"),children:u.requirements.map((e,s)=>t.jsxs("li",{className:"flex items-start text-xs sm:text-sm",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mr-2 mt-1 flex-shrink-0"}),t.jsx("span",{children:e})]},s))})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>b(!1),className:`px-4 py-2 sm:px-6 sm:py-2 rounded-lg text-sm font-medium transition-colors ${a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} w-full sm:w-auto`,children:"关闭"}),"upcoming"===u.status&&t.jsx("button",{onClick:()=>{i.success("活动注册成功！"),b(!1)},className:"px-4 py-2 sm:px-6 sm:py-2 rounded-lg text-sm font-medium bg-green-600 hover:bg-green-700 text-white transition-colors w-full sm:w-auto",children:"立即报名"}),"ongoing"===u.status&&t.jsx("button",{onClick:()=>{i.success("作品提交成功！"),b(!1)},className:"px-4 py-2 sm:px-6 sm:py-2 rounded-lg text-sm font-medium bg-blue-600 hover:bg-blue-700 text-white transition-colors w-full sm:w-auto",children:"提交作品"})]})]})})]})}const $e=e.memo(({news:e,isDark:s,navigate:a})=>t.jsxs("div",{className:(s?"bg-gray-800":"bg-white")+" rounded-xl overflow-hidden shadow-md transition-all duration-300 hover:shadow-2xl cursor-pointer group hover:-translate-y-1",onClick:()=>a(`/news/${e.id}`),children:[t.jsxs("div",{className:"relative overflow-hidden rounded-t-xl",children:[t.jsx(L,{src:e.image,alt:e.title,ratio:"landscape",fit:"cover",className:"w-full h-36 sm:h-40 transition-transform duration-500 group-hover:scale-105",loading:"lazy"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),t.jsxs("div",{className:"p-4 sm:p-5",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2 sm:mb-3",children:[t.jsx("span",{className:"text-xs px-2.5 py-1 rounded-full font-medium transition-all "+(s?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:e.category}),t.jsx("span",{className:`text-xs ${s?"text-gray-400":"text-gray-500"} font-medium`,children:e.date})]}),t.jsx("h3",{className:"font-bold text-base sm:text-lg mb-2 sm:mb-3 line-clamp-2 transition-colors duration-300 group-hover:text-red-500",children:e.title}),t.jsx("p",{className:"text-sm mb-3 sm:mb-4 line-clamp-3 "+(s?"text-gray-400":"text-gray-600"),children:e.description}),t.jsxs("div",{className:"flex justify-between items-center text-xs sm:text-sm pt-2 sm:pt-3 border-t border-gray-700/30",children:[t.jsx("span",{className:(s?"text-gray-400":"text-gray-500")+" font-medium",children:e.source}),t.jsxs("span",{className:(s?"text-gray-400":"text-gray-500")+" flex items-center font-medium",children:[t.jsx("i",{className:"far fa-eye mr-1"}),e.views.toLocaleString()]})]})]})]},e.id));function Le(){const{isDark:s}=k(),a=o(),[i,r]=e.useState("all"),[n,l]=e.useState(!0),[c,d]=e.useState(!1),[m,g]=e.useState(12),h=e.useRef(null);e.useEffect(()=>{l(!1)},[]);const p=[{id:1,title:"全国非物质文化遗产保护工作会议在京召开",description:"会议总结了近年来非遗保护工作成果，部署了下一阶段重点任务，强调要加强非遗的活态传承和创新发展。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=National%20intangible%20cultural%20heritage%20protection%20work%20conference%20Beijing",date:"2025-12-03",category:"政策动态",source:"文化和旅游部",views:12563},{id:2,title:"《中国传统工艺振兴计划》实施成效显著",description:"五年来，该计划推动了1500余项传统工艺项目的保护和发展，带动了200多万从业人员就业增收。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=China%20traditional%20craft%20revitalization%20plan%20implementation%20achievements",date:"2025-11-28",category:"政策动态",source:"光明日报",views:15678},{id:3,title:"中国传统音乐保护与传承工程启动",description:"工程将通过录制、整理、研究等方式，对中国传统音乐进行系统保护和传承，预计历时五年完成。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=China%20traditional%20music%20protection%20and%20transmission%20project%20launch",date:"2025-11-15",category:"政策动态",source:"中国音乐家协会",views:10345},{id:4,title:"《文化产业数字化战略实施方案》正式发布",description:"方案提出到2035年，实现文化产业数字化转型全面完成，数字文化产业成为国民经济支柱性产业。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Cultural%20industry%20digitalization%20strategy%20implementation%20plan%20release",date:"2025-11-08",category:"政策动态",source:"新华社",views:18923},{id:5,title:"国家文物局发布《文物数字化保护导则》",description:"导则明确了文物数字化保护的技术标准和工作流程，为全国文物数字化工作提供了指导。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=National%20cultural%20heritage%20administration%20digital%20protection%20guidelines",date:"2025-10-25",category:"政策动态",source:"国家文物局",views:14567},{id:6,title:"首批国家级文化产业示范园区复核结果公布",description:"全国共有20个园区通过复核，10个园区被取消称号，进一步规范了文化产业示范园区建设。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=National%20level%20cultural%20industry%20demonstration%20park%20review%20results",date:"2025-10-18",category:"政策动态",source:"文化和旅游部",views:11234},{id:7,title:"2025中国传统文化创意设计大赛启动",description:'本次大赛以"传统与现代融合"为主题，面向全球设计师征集优秀作品，推动传统文化的创造性转化和创新性发展。',image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=2025%20China%20traditional%20culture%20creative%20design%20competition%20launch",date:"2025-12-01",category:"赛事活动",source:"中国文化产业协会",views:8921},{id:8,title:"2025国际非遗博览会在济南开幕",description:"博览会吸引了来自全球40多个国家和地区的非遗项目参展，展示了丰富的人类非物质文化遗产。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=2025%20International%20intangible%20cultural%20heritage%20expo%20Jinan",date:"2025-11-20",category:"赛事活动",source:"中国非物质文化遗产保护中心",views:12345},{id:9,title:"全国青少年文化创意大赛总决赛在深圳举行",description:"来自全国30个省市自治区的1000名青少年参加了总决赛，展示了新一代对传统文化的创新理解。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=National%20youth%20cultural%20creative%20competition%20final%20Shenzhen",date:"2025-11-15",category:"赛事活动",source:"中国青少年发展基金会",views:9876},{id:10,title:"2025中国传统工艺技能大赛即将举行",description:"大赛将设置木雕、陶瓷、刺绣等10个传统工艺项目，来自全国各地的能工巧匠将展开技艺比拼。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=2025%20China%20traditional%20craft%20skills%20competition",date:"2025-12-10",category:"赛事活动",source:"中国工艺美术协会",views:7654},{id:11,title:'第一届"国潮之星"设计大赛启动报名',description:"大赛面向全球设计师征集具有中国传统文化元素的时尚设计作品，奖金总额达100万元。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=First%20Guochao%20Star%20design%20competition%20registration%20launch",date:"2025-11-30",category:"赛事活动",source:"中国时尚协会",views:8921},{id:12,title:"2025中国数字文化创意大赛结果揭晓",description:"大赛共收到来自全国的2万余件作品，最终评选出金奖10名、银奖20名、铜奖30名。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=2025%20China%20digital%20cultural%20creative%20competition%20results",date:"2025-11-25",category:"赛事活动",source:"中国数字文化产业协会",views:10345},{id:13,title:"首届中国传统色彩艺术展在上海开幕",description:"展览汇集了来自全国各地的传统色彩艺术作品，包括绘画、纺织、陶瓷等多个门类，展现了中国传统色彩的独特魅力。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=First%20China%20traditional%20color%20art%20exhibition%20Shanghai%20opening",date:"2025-11-25",category:"展览展示",source:"上海文化艺术报",views:9876},{id:14,title:'"丝路华章"古代丝绸艺术展在国家博物馆展出',description:"展览展示了从西汉到明清时期的丝绸文物，展现了丝绸之路的繁荣和中国古代丝绸工艺的高超水平。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Silk%20Road%20splendor%20ancient%20silk%20art%20exhibition%20National%20Museum",date:"2025-12-01",category:"展览展示",source:"中国国家博物馆",views:14567},{id:15,title:"中国传统家具艺术展在故宫博物院开展",description:"展览精选了故宫博物院藏的明清家具珍品，展示了中国传统家具的精湛工艺和独特魅力。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=China%20traditional%20furniture%20art%20exhibition%20Forbidden%20City",date:"2025-11-15",category:"展览展示",source:"故宫博物院",views:16789},{id:16,title:'"墨韵中华"当代书法艺术展在北京举行',description:"展览汇集了当代百位著名书法家的作品，展示了中国书法艺术的传承与创新。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Ink%20charm%20of%20China%20contemporary%20calligraphy%20art%20exhibition%20Beijing",date:"2025-11-10",category:"展览展示",source:"中国书法家协会",views:8921},{id:17,title:"中国传统陶瓷艺术展在景德镇开幕",description:"展览展示了从唐宋到明清时期的陶瓷珍品，以及当代陶瓷艺术家的创新作品。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=China%20traditional%20ceramic%20art%20exhibition%20Jingdezhen",date:"2025-10-28",category:"展览展示",source:"景德镇陶瓷大学",views:11234},{id:18,title:'"民间瑰宝"中国传统玩具展在广州开展',description:"展览展示了中国各地的传统玩具，包括泥人、风筝、皮影等，唤起了人们的童年记忆。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=China%20traditional%20toys%20exhibition%20Guangzhou",date:"2025-10-20",category:"展览展示",source:"广东省博物馆",views:7654},{id:19,title:"数字化技术助力非遗传承新发展",description:"通过VR、AR、AI等技术，非遗项目得以更生动地呈现给观众，同时也为非遗传承提供了新的手段和途径。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Digital%20technology%20aiding%20intangible%20cultural%20heritage%20transmission",date:"2025-11-20",category:"技术应用",source:"科技日报",views:11234},{id:20,title:"AI技术赋能传统绘画创作",description:"通过AI技术，可以辅助艺术家进行传统绘画创作，提高创作效率和作品质量。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=AI%20technology%20empowering%20traditional%20painting%20creation",date:"2025-11-15",category:"技术应用",source:"中国艺术研究院",views:9876},{id:21,title:"区块链技术在文物保护中的应用",description:"区块链技术可以实现文物的数字化存证和溯源，有效防止文物造假和非法交易。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Blockchain%20technology%20application%20in%20cultural%20heritage%20protection",date:"2025-11-10",category:"技术应用",source:"中国文物保护技术协会",views:13456},{id:22,title:"5G+AR技术打造沉浸式文化体验",description:"通过5G+AR技术，可以为观众提供沉浸式的文化体验，让传统文化更加生动有趣。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=5G%20AR%20technology%20creating%20immersive%20cultural%20experience",date:"2025-10-28",category:"技术应用",source:"中国文化报",views:15678},{id:23,title:"数字孪生技术在古建筑保护中的应用",description:"通过数字孪生技术，可以创建古建筑的精确数字模型，为古建筑保护和修复提供科学依据。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Digital%20twin%20technology%20application%20in%20ancient%20architecture%20protection",date:"2025-10-20",category:"技术应用",source:"中国建筑学会",views:10345},{id:24,title:"大数据技术在文化产业中的应用",description:"通过大数据技术，可以分析文化消费趋势，为文化产业发展提供决策支持。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Big%20data%20technology%20application%20in%20cultural%20industry",date:"2025-10-15",category:"技术应用",source:"中国信息协会",views:12345},{id:25,title:"老字号品牌创新发展论坛成功举办",description:"论坛聚焦老字号品牌的数字化转型和创新发展，来自全国各地的老字号企业代表分享了各自的经验和做法。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Time-honored%20brand%20innovation%20development%20forum%20successfully%20held",date:"2025-11-18",category:"品牌动态",source:"中国品牌网",views:7654},{id:26,title:'故宫文创推出"故宫猫"系列新品',description:"故宫文创推出了以故宫猫为主题的系列文创产品，包括文具、饰品、家居用品等，受到了年轻人的喜爱。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Forbidden%20City%20cultural%20and%20creative%20Cat%20series%20new%20products",date:"2025-12-01",category:"品牌动态",source:"故宫博物院",views:14567},{id:27,title:'"中国李宁"2026春夏系列发布',description:"系列设计融入了中国传统元素，包括青花瓷、中国结等，展现了国潮设计的新高度。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=China%20Li-Ning%202026%20spring%20summer%20collection%20release",date:"2025-11-25",category:"品牌动态",source:"李宁官方",views:18923},{id:28,title:"稻香村推出非遗技艺系列糕点",description:"糕点制作过程中运用了多种非遗技艺，包括传统发酵、手工成型等，让消费者品尝到正宗的传统味道。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Daoxiangcun%20intangible%20cultural%20heritage%20skill%20series%20pastries",date:"2025-11-20",category:"品牌动态",source:"稻香村官方",views:9876},{id:29,title:'茅台推出"文化茅台"系列酒品',description:"系列酒品包装设计融入了中国传统文化元素，包括书法、绘画等，展现了茅台的文化底蕴。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Moutai%20Cultural%20Moutai%20series%20alcohol%20products",date:"2025-11-15",category:"品牌动态",source:"茅台集团",views:16789},{id:30,title:'"张小泉"发布全新品牌形象',description:"新形象融合了传统与现代元素，展现了老字号品牌的创新活力。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Zhang%20Xiaoquan%20new%20brand%20image%20release",date:"2025-11-10",category:"品牌动态",source:"张小泉官方",views:8921},{id:31,title:"国潮设计成为年轻人消费新宠",description:"随着国潮文化的兴起，越来越多的年轻人开始关注和购买具有中国传统文化元素的设计产品。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Guochao%20design%20becoming%20new%20favorite%20among%20young%20consumers",date:"2025-11-10",category:"市场动态",source:"消费日报",views:13456},{id:32,title:"2025年前三季度文化产业增加值同比增长8.5%",description:"文化产业增加值占GDP的比重达到4.5%，继续保持较快增长态势。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=2025%20first%20three%20quarters%20cultural%20industry%20added%20value%20growth",date:"2025-10-28",category:"市场动态",source:"国家统计局",views:15678},{id:33,title:"数字文化产业规模突破5万亿元",description:"数字文化产业成为文化产业增长的主要动力，占文化产业总量的比重超过40%。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Digital%20cultural%20industry%20scale%20exceeds%205%20trillion%20yuan",date:"2025-10-20",category:"市场动态",source:"中国数字文化产业协会",views:17892},{id:34,title:"传统文化主题景区游客量同比增长20%",description:"越来越多的游客选择参观传统文化主题景区，体验传统文化的魅力。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Traditional%20culture%20theme%20scenic%20spots%20visitor%20volume%20growth",date:"2025-10-15",category:"市场动态",source:"中国旅游协会",views:11234},{id:35,title:"文创产品市场规模持续扩大",description:"2025年文创产品市场规模预计达到1.5万亿元，同比增长15%。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Cultural%20and%20creative%20products%20market%20scale%20continues%20to%20expand",date:"2025-10-10",category:"市场动态",source:"中国文化创意产业研究会",views:9876},{id:36,title:"传统文化类图书销售同比增长30%",description:"传统文化类图书受到读者青睐，销售同比增长30%，其中少儿类传统文化图书增长最为明显。",image:"/api/proxy/trae-api/api/ide/v1/text_to_image?image_size=landscape_4_3&prompt=Traditional%20culture%20books%20sales%20growth",date:"2025-09-28",category:"市场动态",source:"中国出版协会",views:8921}],u=e.useMemo(()=>"all"===i?p:p.filter(e=>e.category===i),[i,p]),x=e.useMemo(()=>u.slice(0,m),[u,m]),y=m<u.length,b=()=>{y&&!c&&(d(!0),g(e=>Math.min(e+8,u.length)),d(!1))};return e.useEffect(()=>{const e=new IntersectionObserver(e=>{e[0].isIntersecting&&y&&!c&&b()},{threshold:.1});return h.current&&e.observe(h.current),()=>{h.current&&e.unobserve(h.current)}},[y,c,u.length]),e.useEffect(()=>{g(12)},[i]),t.jsxs("div",{className:(s?"bg-gray-900":"bg-gray-50")+" rounded-2xl p-4 sm:p-6 shadow-md",children:[t.jsx("div",{className:"flex overflow-x-auto space-x-2 sm:space-x-3 mb-4 sm:mb-6 pb-2 scrollbar-hide",children:n?t.jsx("div",{className:"flex space-x-2 sm:space-x-3",children:[...Array(7)].map((e,s)=>t.jsx("div",{className:"px-4 py-2 sm:px-5 sm:py-2.5 rounded-full bg-gray-700 animate-pulse h-9 sm:h-10 min-w-[70px] sm:min-w-[80px]"},s))}):[{id:"all",name:"全部"},{id:"政策动态",name:"政策动态"},{id:"赛事活动",name:"赛事活动"},{id:"展览展示",name:"展览展示"},{id:"技术应用",name:"技术应用"},{id:"品牌动态",name:"品牌动态"},{id:"市场动态",name:"市场动态"}].map(e=>t.jsx("button",{onClick:()=>r(e.id),className:"px-4 py-2 sm:px-5 sm:py-2.5 rounded-full text-xs sm:text-sm font-medium whitespace-nowrap transition-all touch-manipulation "+(i===e.id?"bg-red-600 text-white shadow-lg transform scale-105":s?"bg-gray-800 hover:bg-gray-700 text-gray-300 hover:shadow-md":"bg-white hover:bg-gray-200 text-gray-700 hover:shadow-md"),children:e.name},e.id))}),n?t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[...Array(8)].map((e,a)=>t.jsxs("div",{className:(s?"bg-gray-800":"bg-white")+" rounded-xl overflow-hidden shadow-md transition-all duration-300",children:[t.jsx("div",{className:"w-full h-36 sm:h-40 bg-gray-700 rounded-t-xl animate-pulse"}),t.jsxs("div",{className:"p-4 sm:p-5",children:[t.jsx("div",{className:"h-3 bg-gray-700 rounded w-24 mb-3 animate-pulse"}),t.jsx("div",{className:"h-4 bg-gray-700 rounded w-3/4 mb-2 animate-pulse"}),t.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/2 mb-2 animate-pulse"}),t.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/3 mb-4 animate-pulse"}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/4 animate-pulse"}),t.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/4 animate-pulse"})]})]})]},a))}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:x.map(e=>t.jsx($e,{news:e,isDark:s,navigate:a},e.id))}),y&&t.jsx("div",{className:"mt-8 text-center",ref:h,children:c?t.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[t.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full animate-bounce [animation-delay:-0.3s]"}),t.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full animate-bounce [animation-delay:-0.15s]"}),t.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full animate-bounce"}),t.jsx("span",{className:"ml-2 text-sm font-medium "+(s?"text-gray-400":"text-gray-600"),children:"加载中..."})]}):t.jsx("button",{onClick:b,className:`px-8 py-3.5 rounded-full text-sm font-medium transition-all ${s?"bg-gray-800 hover:bg-gray-700 text-white":"bg-white hover:bg-gray-200 text-gray-800"} shadow-md hover:shadow-xl`,children:"加载更多资讯"})}),!y&&u.length>0&&t.jsx("div",{className:"mt-8 text-center",children:t.jsx("p",{className:"text-sm "+(s?"text-gray-400":"text-gray-600"),children:"已显示全部资讯"})})]})]})}const Oe=["#f87171","#60a5fa","#34d399","#f59e0b","#a78bfa"],Me=Object.freeze(Object.defineProperty({__proto__:null,default:({refreshInterval:a=3e4,recentCount:i=100})=>{const{isDark:n}=k(),[l,o]=e.useState(me.getErrorStats(i)),[c,p]=e.useState(!1),[j]=e.useState(null),[N,w]=e.useState(null),[_,S]=e.useState(!1);e.useEffect(()=>{const e=setInterval(()=>{C()},a);return()=>clearInterval(e)},[a]);const C=()=>{p(!0),setTimeout(()=>{o(me.getErrorStats(i)),p(!1)},500)},T=Object.keys(l.byType).map(e=>({name:e,value:l.byType[e]})),E=Object.keys(l.byType).map((e,t)=>({name:e.length>15?e.substring(0,15)+"...":e,count:l.byType[e],fullName:e,color:Oe[t%Oe.length]}));return t.jsxs("div",{className:`p-6 rounded-2xl ${n?"bg-gray-800":"bg-white"} shadow-md`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("h3",{className:"text-xl font-bold flex items-center",children:[t.jsx("i",{className:"fas fa-chart-line text-red-600 mr-2"}),"错误监控仪表盘"]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:C,disabled:c,className:`px-3 py-1.5 rounded-lg text-sm flex items-center ${n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:c?t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"刷新中"]}):t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-sync-alt mr-1"}),"刷新"]})}),t.jsxs("button",{onClick:()=>{window.confirm("确定要清除所有错误日志吗？")&&(me.clearErrors(),o(me.getErrorStats()))},className:`px-3 py-1.5 rounded-lg text-sm text-red-600 flex items-center ${n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:[t.jsx("i",{className:"fas fa-trash-alt mr-1"}),"清除日志"]})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[{title:"总错误数",value:l.total,icon:"exclamation-circle",color:"red"},{title:"错误类型",value:Object.keys(l.byType).length,icon:"bug",color:"blue"},{title:"今日新增",value:Math.floor(Math.random()*l.total)+1,icon:"plus-circle",color:"green"},{title:"活跃用户影响",value:Math.floor(100*Math.random())+1,icon:"users",color:"purple"}].map((e,a)=>t.jsx(s.div,{className:"p-4 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*a},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm mb-1 "+(n?"text-gray-400":"text-gray-600"),children:e.title}),t.jsx("h3",{className:"text-xl font-bold",children:e.value})]}),t.jsx("div",{className:`p-2 rounded-full bg-${e.color}-100 text-${e.color}-600`,children:t.jsx("i",{className:`fas fa-${e.icon} text-lg`})})]})},a))}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[t.jsxs(s.div,{className:"p-6 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[t.jsx("h4",{className:"font-medium mb-4",children:"错误类型分布"}),t.jsx("div",{className:"h-64",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(m,{children:[t.jsx(g,{data:T,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:e,percent:t})=>`${e} ${(100*t).toFixed(0)}%`,children:T.map((e,s)=>t.jsx(h,{fill:Oe[s%Oe.length]},`cell-${s}`))}),t.jsx(u,{formatter:(e,t)=>[`${e} 次`,oe[t]||t],contentStyle:{backgroundColor:n?"#1f2937":"#ffffff",borderColor:n?"#374151":"#e5e7eb",borderRadius:"0.5rem",color:n?"#ffffff":"#000000"}})]})})})]}),t.jsxs(s.div,{className:"lg:col-span-2 p-6 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:[t.jsx("h4",{className:"font-medium mb-4",children:"错误类型统计"}),t.jsx("div",{className:"h-64",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(x,{data:E,margin:{top:20,right:30,left:20,bottom:60},children:[t.jsx(y,{strokeDasharray:"3 3",stroke:n?"#374151":"#e5e7eb"}),t.jsx(b,{dataKey:"name",tick:{fill:n?"#9ca3af":"#4b5563"},axisLine:{stroke:n?"#374151":"#e5e7eb"},angle:-45,textAnchor:"end",height:80}),t.jsx(f,{tick:{fill:n?"#9ca3af":"#4b5563"},axisLine:{stroke:n?"#374151":"#e5e7eb"}}),t.jsx(u,{formatter:(e,t,s)=>[`${e} 次`,oe[s.payload.fullName]||s.payload.fullName],contentStyle:{backgroundColor:n?"#1f2937":"#ffffff",borderColor:n?"#374151":"#e5e7eb",borderRadius:"0.5rem",color:n?"#ffffff":"#000000"}}),t.jsx(v,{dataKey:"count",name:"错误次数",radius:[4,4,0,0],children:E.map((e,s)=>t.jsx(h,{fill:e.color},`cell-${s}`))})]})})})]})]}),t.jsxs(s.div,{className:"p-6 rounded-xl "+(n?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[t.jsxs("h4",{className:"font-medium mb-4",children:["最近错误记录（共 ",l.total," 条）"]}),t.jsx("div",{className:"overflow-x-auto rounded-xl border "+(n?"border-gray-600":"border-gray-200"),children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:n?"bg-gray-600":"bg-gray-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"错误ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"类型"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"消息"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"时间"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"浏览器"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"URL"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-600",children:l.recent.map(e=>t.jsxs("tr",{className:"hover:bg-gray-600/50 cursor-pointer "+(j===e.errorType?"bg-blue-900/20":""),onClick:()=>{w(e),S(!0)},children:[t.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.errorId.substring(0,8),"..."]}),t.jsx("td",{className:"px-4 py-3 text-sm",children:t.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(e.errorType.includes("NETWORK")?"bg-red-100 text-red-600":e.errorType.includes("PERMISSION")?"bg-yellow-100 text-yellow-600":e.errorType.includes("MODEL")?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:e.errorType})}),t.jsx("td",{className:"px-4 py-3 text-sm max-w-xs truncate",children:e.message}),t.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(e.timestamp).toLocaleString()}),t.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.deviceInfo.browser," v",e.deviceInfo.browserVersion]}),t.jsx("td",{className:"px-4 py-3 text-sm max-w-xs truncate",children:e.url})]},e.errorId))})]})}),0===l.recent.length&&t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 text-2xl mb-2"}),t.jsx("p",{children:"暂无错误记录"})]})]}),t.jsx(r,{children:_&&N&&t.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>S(!1),children:t.jsxs(s.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},className:`w-full max-w-4xl rounded-2xl overflow-y-auto max-h-[90vh] ${n?"bg-gray-800":"bg-white"} shadow-2xl`,onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-700 bg-gradient-to-r from-gray-800 to-gray-750",children:[t.jsx("h4",{className:"text-xl font-bold",children:"错误详情"}),t.jsx("button",{onClick:()=>S(!1),className:"p-2 rounded-full hover:bg-gray-700 transition-colors",children:t.jsx("i",{className:"fas fa-times text-gray-400 hover:text-white"})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"错误ID:"}),t.jsx("span",{className:"text-sm font-mono",children:N.errorId})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"错误类型:"}),t.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(N.errorType.includes("NETWORK")?"bg-red-100 text-red-600":N.errorType.includes("PERMISSION")?"bg-yellow-100 text-yellow-600":N.errorType.includes("MODEL")?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:N.errorType})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"发生时间:"}),t.jsx("span",{className:"text-sm",children:new Date(N.timestamp).toLocaleString()})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"URL:"}),t.jsx("span",{className:"text-sm truncate max-w-xs",children:N.url})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"浏览器:"}),t.jsxs("span",{className:"text-sm",children:[N.deviceInfo.browser," v",N.deviceInfo.browserVersion]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"操作系统:"}),t.jsx("span",{className:"text-sm",children:N.deviceInfo.os})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"设备类型:"}),t.jsx("span",{className:"text-sm",children:N.deviceInfo.device})]})]})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-medium text-gray-500 mb-2",children:"错误消息:"}),t.jsx("div",{className:"p-3 rounded-lg bg-gray-700 text-sm",children:N.message})]}),N.stackTrace&&t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-medium text-gray-500 mb-2",children:"堆栈跟踪:"}),t.jsx("div",{className:"p-3 rounded-lg bg-gray-900 font-mono text-xs text-gray-300 overflow-x-auto max-h-48",children:t.jsx("pre",{children:N.stackTrace})})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-medium text-gray-500 mb-2",children:"用户代理:"}),t.jsx("div",{className:"p-3 rounded-lg bg-gray-700 text-xs overflow-x-auto",children:N.userAgent})]}),N.context&&Object.keys(N.context).length>0&&t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-medium text-gray-500 mb-2",children:"上下文信息:"}),t.jsx("div",{className:"p-3 rounded-lg bg-gray-700 text-sm font-mono overflow-x-auto",children:t.jsx("pre",{children:JSON.stringify(N.context,null,2)})})]})]})]})})})]})}},Symbol.toStringTag,{value:"Module"})),qe=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isDark:a}=k(),r=(()=>{const e=localStorage.getItem("dailyCheckin");if(e)try{return JSON.parse(e)}catch(t){}return{currentStreak:3,lastCheckinDate:"2025-11-28",rewards:[{day:1,name:"基础素材包",description:"解锁10个基础文化素材",icon:"gift",isClaimed:!0,isAvailable:!0},{day:3,name:"高级滤镜",description:"解锁5个AI高级滤镜",icon:"image",isClaimed:!0,isAvailable:!0},{day:7,name:"泥人张彩塑工具",description:"解锁泥人张风格专用工具",icon:"magic",isClaimed:!1,isAvailable:!0},{day:15,name:"专属AI模型",description:"获得7天专属AI模型使用权",icon:"robot",isClaimed:!1,isAvailable:!1},{day:30,name:"老字号联名认证",description:"获得老字号联名创作者认证",icon:"certificate",isClaimed:!1,isAvailable:!1}]}})(),[n,l]=e.useState(r.currentStreak),[o,c]=e.useState(r.lastCheckinDate),[d,m]=e.useState(r.rewards),[g,h]=e.useState(!1),p=(e,t,s)=>{const a={currentStreak:e,lastCheckinDate:t,rewards:s};localStorage.setItem("dailyCheckin",JSON.stringify(a))};e.useEffect(()=>{const e=(new Date).toISOString().split("T")[0];h(e!==o)},[o]);const u=n/30*100;return t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-xl font-bold",children:"每日打卡"}),t.jsxs("div",{className:"flex items-center px-3 py-1 rounded-full text-sm "+(a?"bg-gray-700":"bg-gray-100"),children:[t.jsx("i",{className:"fas fa-fire text-yellow-500 mr-1"}),t.jsxs("span",{children:["连续 ",n," 天"]})]})]}),t.jsx("div",{className:"flex justify-center mb-8",children:t.jsxs(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{if(!g)return;const e=n+1,t=(new Date).toISOString().split("T")[0],s=d.map(t=>t.day===e?{...t,isAvailable:!0}:t);l(e),c(t),h(!1),m(s),p(e,t,s),i.success(`打卡成功！连续打卡 ${e} 天`)},disabled:!g,className:"px-6 py-3 rounded-full flex items-center transition-colors "+(g?"bg-red-600 hover:bg-red-700 text-white":a?"bg-gray-700 cursor-not-allowed":"bg-gray-300 cursor-not-allowed"),children:[t.jsx("i",{className:"fas fa-calendar-check mr-2"}),g?"立即打卡":"今日已打卡"]})}),t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[t.jsx("span",{children:"当前进度"}),t.jsxs("span",{children:[n," / 30 天"]})]}),t.jsx("div",{className:`h-3 rounded-full ${a?"bg-gray-700":"bg-gray-200"} overflow-hidden`,children:t.jsx(s.div,{initial:{width:"0%"},animate:{width:`${u}%`},transition:{duration:.5},className:"h-full bg-gradient-to-r from-red-500 to-yellow-500"})})]}),t.jsx("h4",{className:"font-medium mb-4",children:"打卡奖励"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:d.map(e=>t.jsxs(s.div,{className:"p-4 rounded-xl border flex flex-col items-center text-center transition-all "+(e.isClaimed?a?"border-gray-700 bg-gray-700 opacity-70":"border-gray-200 bg-gray-50 opacity-70":e.isAvailable?a?"border-red-500 bg-red-500 bg-opacity-10":"border-red-200 bg-red-50":a?"border-gray-700":"border-gray-200"),whileHover:e.isAvailable&&!e.isClaimed?{scale:1.05}:{},children:[t.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mb-3 "+(e.isClaimed?"bg-gray-600 text-gray-400":e.isAvailable?"bg-red-100 text-red-600":a?"bg-gray-700 text-gray-400":"bg-gray-100 text-gray-600"),children:t.jsx("i",{className:`fas fa-${e.icon} text-xl`})}),t.jsx("h5",{className:"font-medium mb-1",children:e.name}),t.jsxs("p",{className:"text-xs mb-3 "+(a?"text-gray-400":"text-gray-600"),children:[e.day," 天"]}),e.isAvailable&&!e.isClaimed&&t.jsx(s.button,{whileTap:{scale:.9},onClick:()=>(e=>{const t=d.map(t=>t.day===e&&t.isAvailable&&!t.isClaimed?{...t,isClaimed:!0}:t);m(t),p(n,o,t);const s=d.find(t=>t.day===e);s&&i.success(`恭喜获得：${s.name}`)})(e.day),className:"px-3 py-1 rounded-full bg-red-600 text-white text-xs w-full",children:"领取奖励"}),e.isClaimed&&t.jsx("span",{className:`px-3 py-1 rounded-full text-xs ${a?"bg-gray-600 text-gray-400":"bg-gray-200 text-gray-600"} w-full`,children:"已领取"})]},e.day))})]})}},Symbol.toStringTag,{value:"Module"}));class Ue extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?t.jsx("div",{className:"p-6 rounded-2xl bg-white shadow-md",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-12",children:[t.jsx("i",{className:"fas fa-exclamation-circle text-4xl text-red-500 mb-4"}),t.jsx("h3",{className:"text-xl font-bold mb-2",children:"页面加载出错"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"很抱歉，创作搭档匹配功能暂时无法使用，请稍后重试。"}),t.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white text-sm transition-colors",children:"重新加载页面"})]})}):this.props.children}}function He(){const{isDark:a}=k(),[r,n]=e.useState([]),[l,o]=e.useState([]),[c,m]=e.useState(!0),[g,h]=e.useState(null),[p,j]=e.useState({}),[N,w]=e.useState([]),_=()=>{m(!0),setTimeout(()=>{const{partners:e,compatibility:t}=(()=>{const e=()=>Math.floor(1e4*Math.random())+1;return{partners:[{id:e(),name:"创意总监小李",avatar:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=User%20avatar%20xiaoli",level:"资深创作者",style:["现代国潮","插画设计","品牌设计"],matchScore:Math.floor(10*Math.random())+85,worksCount:Math.floor(100*Math.random())+30,followers:Math.floor(2e3*Math.random())+500,isOnline:Math.random()>.3,bio:"专注于现代国潮设计，擅长将传统元素与现代设计相结合，创造出具有独特风格的作品。",location:"北京",joinDate:"2023-01-15",specialties:["国潮设计","品牌视觉","插画创作"],avgResponseTime:"1小时内"},{id:e(),name:"插画师小陈",avatar:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=User%20avatar%20xiaochen",level:"资深创作者",style:["传统插画","水墨风格","人物设计"],matchScore:Math.floor(10*Math.random())+80,worksCount:Math.floor(150*Math.random())+50,followers:Math.floor(1500*Math.random())+300,isOnline:Math.random()>.3,bio:"擅长传统水墨风格插画，作品富有诗意和文化内涵，多次获得国内外插画奖项。",location:"上海",joinDate:"2022-08-20",specialties:["水墨插画","传统纹样","人物设计"],avgResponseTime:"2小时内"},{id:e(),name:"品牌设计师老王",avatar:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=User%20avatar%20laowang",level:"大师级创作者",style:["品牌设计","包装设计","视觉识别"],matchScore:Math.floor(10*Math.random())+82,worksCount:Math.floor(200*Math.random())+80,followers:Math.floor(3e3*Math.random())+1e3,isOnline:Math.random()>.3,bio:"拥有15年品牌设计经验，服务过众多知名企业，擅长打造具有市场影响力的品牌形象。",location:"广州",joinDate:"2021-03-10",specialties:["品牌设计","包装设计","VI设计"],avgResponseTime:"30分钟内"},{id:e(),name:"数字艺术家小张",avatar:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=User%20avatar%20xiaozhang",level:"新锐创作者",style:["数字艺术","3D建模","互动媒体"],matchScore:Math.floor(10*Math.random())+78,worksCount:Math.floor(80*Math.random())+10,followers:Math.floor(1e3*Math.random())+200,isOnline:Math.random()>.3,bio:"年轻的数字艺术家，擅长使用前沿技术创作沉浸式数字艺术作品，风格独特前卫。",location:"深圳",joinDate:"2023-06-05",specialties:["数字艺术","3D建模","互动媒体"],avgResponseTime:"3小时内"}],compatibility:[{name:"国潮设计",compatibility:Math.floor(20*Math.random())+80},{name:"传统纹样",compatibility:Math.floor(25*Math.random())+75},{name:"现代插画",compatibility:Math.floor(15*Math.random())+85},{name:"品牌设计",compatibility:Math.floor(20*Math.random())+75},{name:"数字艺术",compatibility:Math.floor(25*Math.random())+70}]}})();n(e),o(t),m(!1)},800)};e.useEffect(()=>{_()},[]);const S=e=>{h(e)},C=()=>{h(null)},T=e=>{const t=r.find(t=>t.id===e);if(!t)return;const s=Math.floor(1e4*Math.random())+1;j(t=>({...t,[e]:"sent"}));const a={id:s,creatorId:e,creatorName:t.name,status:"sent",sentAt:new Date};w(e=>[...e,a]),i.success("合作邀请已发送！"),setTimeout(()=>{const t=Math.random()>.5?"accepted":"rejected";j(s=>({...s,[e]:t})),w(s=>s.map(s=>s.creatorId===e?{...s,status:t}:s)),"accepted"===t?i.success("合作邀请已被接受！"):i.info("合作邀请已被拒绝")},2e3)};return c?t.jsx("div",{className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:`h-8 w-1/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:`h-64 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(e=>t.jsxs("div",{className:"flex items-center p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[t.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-300 dark:bg-gray-600 mr-4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 w-1/3 bg-gray-300 dark:bg-gray-600 rounded mb-2"}),t.jsx("div",{className:"h-3 w-1/4 bg-gray-300 dark:bg-gray-600 rounded"})]})]},e))})]})}):t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-xl font-bold",children:"创作搭档匹配"}),t.jsxs("button",{onClick:()=>{_(),j({}),h(null),i.info("正在寻找新的创作搭档...")},className:`px-4 py-2 rounded-lg text-sm flex items-center justify-center transition-all duration-300 ${a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} ${c?"opacity-70 cursor-not-allowed":""}`,disabled:c,children:[t.jsx("i",{className:"fas fa-sync-alt mr-1 "+(c?"animate-spin":"")}),"重新匹配"]})]}),t.jsxs("div",{className:"p-4 rounded-xl mb-6 "+(a?"bg-gray-700":"bg-gray-50"),children:[t.jsx("h4",{className:"font-medium mb-4",children:"风格兼容性分析"}),t.jsx("div",{className:"h-64 sm:h-80 md:h-96",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(x,{data:l,layout:"vertical",margin:{top:5,right:20,left:50,bottom:5},children:[t.jsx(y,{strokeDasharray:"3 3",stroke:a?"#374151":"#e5e7eb"}),t.jsx(b,{type:"number",domain:[0,100],tick:{fill:a?"#9ca3af":"#4b5563",fontSize:"12px"},axisLine:{stroke:a?"#374151":"#e5e7eb"}}),t.jsx(f,{dataKey:"name",type:"category",tick:{fill:a?"#9ca3af":"#4b5563",fontSize:"12px"},axisLine:{stroke:a?"#374151":"#e5e7eb"},width:50}),t.jsx(u,{formatter:e=>[`${e}%`,"兼容性"],contentStyle:{backgroundColor:a?"#1f2937":"#ffffff",borderColor:a?"#374151":"#e5e7eb",borderRadius:"0.5rem",color:a?"#ffffff":"#000000",fontSize:"12px"}}),t.jsx(v,{dataKey:"compatibility",name:"兼容性",fill:"#ef4444",radius:[0,4,4,0],barSize:16})]})})})]}),t.jsx("h4",{className:"font-medium mb-4",children:"潜在创作搭档"}),t.jsx("div",{className:"space-y-4",children:r.map(e=>t.jsx(s.div,{className:`p-4 rounded-xl ${a?"bg-gray-700":"bg-gray-50"} border ${a?"border-gray-600":"border-gray-200"} transition-all hover:shadow-md`,whileHover:{y:-2},children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:"relative mr-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden",children:t.jsx(L,{src:e.avatar,alt:e.name,ratio:"square",fit:"cover",className:"w-full h-full"})}),t.jsx("span",{className:"absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-white "+(e.isOnline?"bg-green-500":"bg-gray-400")})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex flex-wrap items-center mb-1 gap-2",children:[t.jsx("h5",{className:"font-medium truncate",children:e.name}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+("大师级创作者"===e.level?"bg-yellow-100 text-yellow-600":"资深创作者"===e.level?"bg-purple-100 text-purple-600":"bg-blue-100 text-blue-600"),children:e.level}),t.jsxs("span",{className:"text-sm "+(e.matchScore>90?"text-green-500":e.matchScore>80?"text-blue-500":"text-yellow-500"),children:[e.matchScore,"% 匹配度"]})]}),t.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:e.style.map((e,s)=>t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-600":"bg-gray-200"),children:e},s))}),t.jsxs("div",{className:"flex flex-wrap gap-3 text-xs opacity-70",children:[t.jsxs("span",{children:[e.worksCount," 作品"]}),t.jsxs("span",{children:[e.followers," 粉丝"]})]})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[t.jsx("button",{onClick:()=>S(e),className:`flex-1 sm:flex-none px-3 py-1.5 rounded-lg text-sm ${a?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors`,children:"查看资料"}),"sent"===p[e.id]&&t.jsx("button",{className:"flex-1 sm:flex-none px-3 py-1.5 rounded-lg bg-yellow-600 hover:bg-yellow-700 text-white text-sm transition-colors cursor-not-allowed",disabled:!0,children:"邀请已发送"}),"accepted"===p[e.id]&&t.jsx("button",{className:"flex-1 sm:flex-none px-3 py-1.5 rounded-lg bg-green-600 hover:bg-green-700 text-white text-sm transition-colors cursor-not-allowed",disabled:!0,children:"邀请已接受"}),"rejected"===p[e.id]&&t.jsx("button",{className:"flex-1 sm:flex-none px-3 py-1.5 rounded-lg bg-gray-600 hover:bg-gray-700 text-white text-sm transition-colors cursor-not-allowed",disabled:!0,children:"邀请已拒绝"}),!p[e.id]&&t.jsx("button",{onClick:()=>T(e.id),className:"flex-1 sm:flex-none px-3 py-1.5 rounded-lg bg-red-600 hover:bg-red-700 text-white text-sm transition-colors",children:"邀请合作"})]})]})},e.id))}),N.length>0&&t.jsxs("div",{className:"mt-8",children:[t.jsx("h4",{className:"font-medium mb-4",children:"邀请历史记录"}),t.jsx("div",{className:`rounded-xl ${a?"bg-gray-700":"bg-gray-50"} overflow-hidden border ${a?"border-gray-600":"border-gray-200"}`,children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full min-w-[600px] sm:min-w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:a?"bg-gray-800":"bg-gray-100",children:[t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-4",children:"创作者"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-4",children:"邀请时间"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-4",children:"状态"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-4",children:"操作"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:N.map(e=>t.jsxs("tr",{className:(a?"bg-gray-700 hover:bg-gray-600":"bg-gray-50 hover:bg-gray-100")+" transition-colors",children:[t.jsx("td",{className:"px-3 py-4 whitespace-nowrap sm:px-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden mr-2",children:t.jsx(L,{src:r.find(t=>t.id===e.creatorId)?.avatar||"https://via.placeholder.com/32",alt:e.creatorName,ratio:"square",fit:"cover",className:"w-full h-full"})}),t.jsx("div",{className:"text-sm font-medium truncate",children:e.creatorName})]})}),t.jsx("td",{className:"px-3 py-4 whitespace-nowrap sm:px-4",children:t.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:e.sentAt.toLocaleString("zh-CN")})}),t.jsx("td",{className:"px-3 py-4 whitespace-nowrap sm:px-4",children:t.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+("accepted"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"rejected"===e.status?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"),children:"accepted"===e.status?"已接受":"rejected"===e.status?"已拒绝":"已发送"})}),t.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-xs sm:text-sm font-medium sm:px-4",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("button",{onClick:()=>{const t=r.find(t=>t.id===e.creatorId);t&&S(t)},className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:"查看资料"}),"rejected"===e.status&&t.jsx("button",{onClick:()=>T(e.creatorId),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"重新邀请"})]})})]},e.id))})]})})})]}),g&&t.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${a?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:t.jsxs(s.div,{className:`rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[t.jsxs("div",{className:`p-4 sm:p-6 border-b ${a?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[t.jsxs("h3",{className:"text-lg sm:text-xl font-bold truncate",children:[g.name," - 个人资料"]}),t.jsx("button",{onClick:C,className:`p-2 rounded-full ${a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsxs("div",{className:"p-4 sm:p-6",children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start mb-6 gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full overflow-hidden",children:t.jsx(L,{src:g.avatar,alt:g.name,ratio:"square",fit:"cover",className:"w-full h-full"})}),t.jsx("span",{className:"absolute bottom-0 right-0 h-4 w-4 rounded-full border-2 border-white "+(g.isOnline?"bg-green-500":"bg-gray-400")})]}),t.jsxs("div",{className:"text-center md:text-left",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-2 mb-2",children:[t.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:g.name}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+("大师级创作者"===g.level?"bg-yellow-100 text-yellow-600":"资深创作者"===g.level?"bg-purple-100 text-purple-600":"bg-blue-100 text-blue-600"),children:g.level})]}),t.jsx("div",{className:"flex flex-wrap justify-center md:justify-start gap-2 mb-3",children:g.style.map((e,s)=>t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-700":"bg-gray-100"),children:e},s))}),t.jsxs("div",{className:"flex flex-wrap justify-center md:justify-start gap-4 sm:gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-bold",children:g.worksCount}),t.jsx("p",{className:"text-xs sm:text-sm opacity-70",children:"作品"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-bold",children:g.followers}),t.jsx("p",{className:"text-xs sm:text-sm opacity-70",children:"粉丝"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-bold",children:g.matchScore}),t.jsx("p",{className:"text-xs sm:text-sm opacity-70",children:"匹配度"})]})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h4",{className:"font-medium mb-3 sm:mb-4",children:"个人简介"}),t.jsx("p",{className:"text-sm "+(a?"text-gray-300":"text-gray-700"),children:g.bio})]}),t.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-3 sm:mb-4",children:"基本信息"}),t.jsxs("div",{className:"space-y-2 "+(a?"text-gray-300":"text-gray-700"),children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-map-marker-alt mr-2 text-gray-500"}),t.jsx("span",{className:"text-sm",children:g.location})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-calendar-alt mr-2 text-gray-500"}),t.jsxs("span",{className:"text-sm",children:["加入时间: ",g.joinDate]})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-clock mr-2 text-gray-500"}),t.jsxs("span",{className:"text-sm",children:["平均响应时间: ",g.avgResponseTime]})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-3 sm:mb-4",children:"擅长领域"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:g.specialties.map((e,s)=>t.jsx("span",{className:"px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-xs sm:text-sm "+(a?"bg-gray-700":"bg-gray-100"),children:e},s))})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h4",{className:"font-medium mb-3 sm:mb-4",children:"代表作品"}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:[1,2,3].map(e=>t.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-gray-200",children:t.jsx(L,{src:`https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Creative%20work%20example%20${e}`,alt:`作品 ${e}`,ratio:"square",fit:"cover",rounded:"lg",className:"w-full h-full"})},e))})]}),t.jsxs("div",{className:"flex flex-wrap justify-end gap-2 sm:gap-3",children:[t.jsx("button",{onClick:C,className:"flex-1 sm:flex-none px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg transition-colors "+(a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:"关闭"}),"sent"===p[g.id]&&t.jsx("button",{className:"flex-1 sm:flex-none px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg bg-yellow-600 hover:bg-yellow-700 text-white transition-colors cursor-not-allowed",disabled:!0,children:"邀请已发送"}),"accepted"===p[g.id]&&t.jsx("button",{className:"flex-1 sm:flex-none px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg bg-green-600 hover:bg-green-700 text-white transition-colors cursor-not-allowed",disabled:!0,children:"已接受邀请"}),"rejected"===p[g.id]&&t.jsx("button",{className:"flex-1 sm:flex-none px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg bg-gray-600 hover:bg-gray-700 text-white transition-colors cursor-not-allowed",disabled:!0,children:"已拒绝邀请"}),!p[g.id]&&t.jsx("button",{onClick:()=>T(g.id),className:"flex-1 sm:flex-none px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",children:"邀请合作"})]})]})]})})]})}const Fe=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return t.jsx(Ue,{children:t.jsx(He,{})})}},Symbol.toStringTag,{value:"Module"})),Ke=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isDark:a}=k(),[r,n]=e.useState([]),[l,o]=e.useState([]),[c,m]=e.useState(null),[g,h]=e.useState("achievements"),[p,j]=e.useState(!0);e.useState(null),e.useState(!1),e.useState(["copy","twitter","facebook","linkedin"]),e.useState("image"),e.useEffect(()=>{j(!0),setTimeout(()=>{const e=ve.getAllAchievements();n(e);const t=ve.getAchievementStats();m(t),o([{id:1,name:"国潮插画系列",description:"结合传统中国元素与现代设计风格的插画作品",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Achievement%20exhibit%20example%201%203D%20model",year:2025,category:"插画设计"},{id:2,name:"传统纹样创新",description:"基于传统纹样进行创新设计的图案集合",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Achievement%20exhibit%20example%202%203D%20model",year:2025,category:"纹样设计"},{id:3,name:"老字号品牌焕新",description:"为老字号品牌设计的现代化视觉识别系统",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Achievement%20exhibit%20example%203%203D%20model",year:2025,category:"品牌设计"}]),j(!1)},800)},[]);const N=e=>{switch(e){case"common":default:return"bg-gray-100 text-gray-600";case"rare":return"bg-blue-100 text-blue-600";case"epic":return"bg-purple-100 text-purple-600";case"legendary":return"bg-yellow-100 text-yellow-600"}};return p?t.jsx("div",{className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:`h-8 w-1/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"flex space-x-3 overflow-x-auto pb-4",children:[1,2,3].map(e=>t.jsx("div",{className:`h-10 w-24 rounded-full ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`},e))}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsx("div",{className:`h-40 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsx("div",{className:"h-10 rounded-lg bg-gray-100 dark:bg-gray-700 animate-pulse"},e))})]}),t.jsx("div",{className:`h-8 w-1/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(e=>t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:`h-40 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:`h-4 w-3/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`})]},e))})]})}):t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-xl font-bold",children:"创作成就博物馆"}),t.jsxs("div",{className:"flex items-center px-3 py-1 rounded-full text-sm "+(a?"bg-gray-700":"bg-gray-100"),children:[t.jsx("i",{className:"fas fa-trophy text-yellow-500 mr-1"}),t.jsxs("span",{children:[c.completionRate,"% 完成度"]})]})]}),t.jsx("div",{className:"flex space-x-3 mb-6 overflow-x-auto pb-4 scrollbar-hide",children:[{id:"achievements",name:"成就列表"},{id:"exhibits",name:"3D展品"},{id:"vr",name:"VR参观"}].map(e=>t.jsx("button",{onClick:()=>h(e.id),className:"px-5 py-2.5 rounded-full text-sm font-medium transition-all whitespace-nowrap "+(g===e.id?"bg-red-600 text-white shadow-md":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:e.name},e.id))}),"achievements"===g&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[t.jsxs(s.div,{className:"p-6 rounded-xl "+(a?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[t.jsx("h4",{className:"font-medium mb-4",children:"成就统计"}),t.jsx("div",{className:"h-48",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(x,{data:[{name:"已解锁",value:c.unlocked},{name:"未解锁",value:c.locked}],margin:{top:20,right:30,left:20,bottom:5},children:[t.jsx(y,{strokeDasharray:"3 3",stroke:a?"#374151":"#e5e7eb"}),t.jsx(b,{dataKey:"name",tick:{fill:a?"#9ca3af":"#4b5563"},axisLine:{stroke:a?"#374151":"#e5e7eb"}}),t.jsx(f,{tick:{fill:a?"#9ca3af":"#4b5563"},axisLine:{stroke:a?"#374151":"#e5e7eb"}}),t.jsx(u,{contentStyle:{backgroundColor:a?"#1f2937":"#ffffff",borderColor:a?"#374151":"#e5e7eb",borderRadius:"0.5rem",color:a?"#ffffff":"#000000"}}),t.jsx(v,{dataKey:"value",name:"数量",fill:"#ef4444",radius:[4,4,0,0]})]})})}),t.jsx("div",{className:"mt-4 text-center",children:t.jsxs("p",{className:"text-sm opacity-70",children:["总成就: ",c.total]})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(s.div,{className:`p-4 rounded-xl ${a?"bg-gray-700":"bg-gray-50"} border ${a?"border-gray-600":"border-gray-200"}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:[t.jsx("h4",{className:"font-medium mb-3",children:"最近解锁"}),c.recentUnlocks.length>0?t.jsx("div",{className:"space-y-3",children:c.recentUnlocks.map(e=>t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:`w-8 h-8 rounded-full ${N(e.rarity)} flex items-center justify-center mr-3`,children:t.jsx("i",{className:`fas fa-${e.icon}`})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium",children:e.name}),t.jsx("p",{className:"text-xs "+(a?"text-gray-400":"text-gray-600"),children:e.unlockedAt})]})]},e.id))}):t.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} text-center py-2`,children:"暂无解锁记录"})]}),t.jsxs(s.div,{className:`p-4 rounded-xl ${a?"bg-gray-700":"bg-gray-50"} border ${a?"border-gray-600":"border-gray-200"}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[t.jsx("h4",{className:"font-medium mb-3",children:"稀有度分布"}),t.jsx("div",{className:"space-y-3",children:[{rarity:"common",label:"普通",count:2},{rarity:"rare",label:"稀有",count:3},{rarity:"epic",label:"史诗",count:1},{rarity:"legendary",label:"传说",count:1}].map((e,s)=>t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${N(e.rarity.replace(" ","-"))} mr-2`}),t.jsx("span",{className:"w-12",children:e.label}),t.jsx("div",{className:"flex-1 h-2 rounded-full bg-gray-200 dark:bg-gray-600",children:t.jsx("div",{className:`h-full rounded-full ${N(e.rarity.replace(" ","-")).split(" ")[0]}`,style:{width:e.count/c.total*100+"%"}})}),t.jsx("span",{className:"w-8 text-right",children:e.count})]},s))})]})]})]}),t.jsx("h4",{className:"font-medium mb-4",children:"全部成就"}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(e=>t.jsx(s.div,{className:`p-4 rounded-xl border ${e.isUnlocked?a?"border-gray-700 bg-gray-700":"border-gray-200 bg-white":(a?"border-gray-700 bg-gray-700/50":"border-gray-200 bg-gray-50")+" opacity-70"} transition-all hover:shadow-md`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*e.id},whileHover:{y:-2},children:t.jsxs("div",{className:"flex items-start",children:[t.jsx("div",{className:`w-10 h-10 rounded-full ${N(e.rarity)} flex items-center justify-center mr-3 flex-shrink-0`,children:t.jsx("i",{className:`fas fa-${e.icon} text-lg`})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between items-start mb-1",children:[t.jsx("h5",{className:"font-medium",children:e.name}),e.isUnlocked&&t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(a?"bg-green-900/30 text-green-300":"bg-green-100 text-green-600"),children:"已解锁"})]}),t.jsx("p",{className:"text-sm mb-3 "+(a?"text-gray-400":"text-gray-600"),children:e.description}),t.jsxs("div",{className:"mb-2",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{children:e.criteria}),t.jsxs("span",{children:[e.progress,"%"]})]}),t.jsx("div",{className:"h-1.5 rounded-full "+(a?"bg-gray-600":"bg-gray-200"),children:t.jsx("div",{className:`h-full rounded-full ${N(e.rarity).split(" ")[0]}`,style:{width:`${e.progress}%`}})})]}),e.isUnlocked&&e.unlockedAt&&t.jsxs("p",{className:"text-xs "+(a?"text-gray-400":"text-gray-600"),children:["解锁时间: ",e.unlockedAt]}),e.isUnlocked&&t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsxs("button",{className:`text-xs px-2 py-1 rounded ${a?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors flex items-center gap-1`,onClick:()=>(async e=>{const t=`${window.location.origin}/achievement/${e.id}`;e.name;try{await navigator.clipboard.writeText(t),i.success("成就链接已复制到剪贴板")}catch(s){i.error("分享失败，请重试")}})(e),children:[t.jsx("i",{className:"fas fa-share-alt"}),"分享"]}),t.jsxs("button",{className:`text-xs px-2 py-1 rounded ${a?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors flex items-center gap-1`,onClick:()=>(i.info("正在生成成就图片..."),void setTimeout(()=>{i.success("成就图片已导出")},1500)),children:[t.jsx("i",{className:"fas fa-download"}),"导出"]})]})]})]})},e.id))})]}),"exhibits"===g&&t.jsx("div",{children:t.jsx("div",{className:"grid grid-cols-1 gap-8",children:l.map(e=>t.jsx(s.div,{className:"rounded-xl overflow-hidden shadow-md border "+(a?"border-gray-700":"border-gray-200"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*e.id},children:t.jsxs("div",{className:"flex flex-col md:flex-row",children:[t.jsxs("div",{className:"md:w-1/2 relative",children:[t.jsx(L,{src:e.image,alt:e.name,className:"w-full h-full object-cover min-h-[300px]"}),t.jsx("div",{className:"absolute top-3 right-3",children:t.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-black bg-opacity-70 text-white",children:"3D模型"})}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-4",children:t.jsx("h4",{className:"text-white font-bold text-xl",children:e.name})})]}),t.jsxs("div",{className:"md:w-1/2 p-6 "+(a?"bg-gray-700":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:e.category}),t.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:e.year})]}),t.jsx("p",{className:"text-sm mb-6 "+(a?"text-gray-400":"text-gray-600"),children:e.description}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:`p-3 rounded-lg ${a?"bg-gray-600":"bg-gray-50"} flex items-center`,children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center mr-3",children:t.jsx("i",{className:"fas fa-eye"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm opacity-70",children:"3D预览"}),t.jsx("p",{className:"font-medium",children:"在线查看3D模型"})]})]}),t.jsxs("div",{className:`p-3 rounded-lg ${a?"bg-gray-600":"bg-gray-50"} flex items-center`,children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-3",children:t.jsx("i",{className:"fas fa-download"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm opacity-70",children:"下载模型"}),t.jsx("p",{className:"font-medium",children:"获取STL/OBJ格式文件"})]})]}),t.jsxs("div",{className:`p-3 rounded-lg ${a?"bg-gray-600":"bg-gray-50"} flex items-center`,children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center mr-3",children:t.jsx("i",{className:"fas fa-share-alt"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm opacity-70",children:"分享展品"}),t.jsx("p",{className:"font-medium",children:"生成分享链接"})]})]})]}),t.jsx("button",{className:"w-full mt-6 py-3 rounded-lg bg-red-600 hover:bg-red-700 text-white font-medium transition-colors",children:"进入3D展示"})]})]})},e.id))})}),"vr"===g&&t.jsx("div",{className:"text-center py-12",children:t.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"max-w-2xl mx-auto",children:[t.jsx("div",{className:"mb-6 text-6xl text-blue-500",children:t.jsx("i",{className:"fas fa-vr-cardboard"})}),t.jsx("h4",{className:"text-xl font-bold mb-4",children:"VR虚拟博物馆"}),t.jsx("p",{className:"text-sm mb-8 "+(a?"text-gray-400":"text-gray-600"),children:"通过VR技术，您可以身临其境地参观自己的创作成就博物馆。佩戴VR设备， 自由浏览您的3D作品展品，体验沉浸式的创作成果展示。"}),t.jsx("div",{className:"mb-8",children:t.jsx(L,{src:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=landscape_16_9&prompt=VR%20virtual%20museum%20experience%20of%20art%20exhibition",alt:"VR博物馆体验",className:"rounded-xl w-full max-h-96 object-cover mx-auto"})}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[t.jsxs("button",{className:"px-6 py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-medium transition-colors flex items-center justify-center",children:[t.jsx("i",{className:"fas fa-vr-cardboard mr-2"}),"开始VR参观"]}),t.jsxs("button",{className:`px-6 py-3 rounded-lg transition-colors ${a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} flex items-center justify-center`,children:[t.jsx("i",{className:"fas fa-video mr-2"}),"观看演示视频"]})]})]})})]})}},Symbol.toStringTag,{value:"Module"})),Be=e.forwardRef(({children:s,variant:a="primary",size:i="medium",fullWidth:r=!1,loading:n=!1,icon:l,iconPosition:o="left",rippleEffect:c=!0,className:d,disabled:m,onClick:g,...h},p)=>{const[u,x]=e.useState({display:"none",left:"0px",top:"0px",width:"0px",height:"0px"}),y=D("inline-flex items-center justify-center rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",{primary:"bg-[var(--color-primary)] text-white hover:bg-[var(--color-primary)]/90 border-transparent shadow-md hover:shadow-lg",secondary:"bg-secondary text-primary hover:bg-secondary/80 border-transparent",danger:"bg-danger text-white hover:bg-danger/90 border-transparent shadow-md hover:shadow-lg",success:"bg-success text-white hover:bg-success/90 border-transparent shadow-md hover:shadow-lg",ghost:"bg-transparent text-primary hover:bg-gray-100 dark:hover:bg-gray-800 border-transparent",outline:"bg-transparent border border-primary text-primary hover:bg-primary/10"}[a],{small:"text-sm px-3 py-1.5 h-8",medium:"text-base px-4 py-2 h-10",large:"text-lg px-6 py-3 h-12"}[i],r&&"w-full",n&&"opacity-70 cursor-not-allowed",m&&"opacity-50 cursor-not-allowed",d);return t.jsxs("button",{ref:p,className:y,disabled:m||n,onClick:e=>{if(c){const t=e.currentTarget.getBoundingClientRect(),s=Math.max(t.width,t.height),a=e.clientX-t.left-s/2,i=e.clientY-t.top-s/2;x({display:"block",left:`${a}px`,top:`${i}px`,width:`${s}px`,height:`${s}px`}),setTimeout(()=>{x({display:"none",left:"0px",top:"0px",width:"0px",height:"0px"})},600)}g&&g(e)},...h,children:[c&&t.jsx("span",{className:"absolute rounded-full bg-white/30 pointer-events-none transform scale-0 animate-ripple",style:u}),n&&t.jsx("i",{className:"fas fa-spinner animate-spin mr-2"}),!n&&l&&"left"===o&&t.jsx("span",{className:"mr-2",children:l}),t.jsx("span",{children:s}),!n&&l&&"right"===o&&t.jsx("span",{className:"ml-2",children:l})]})});Be.displayName="Button";const Ve=({children:e,className:s,variant:a="default",padding:i="medium"})=>t.jsx("div",{className:D({default:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",elevated:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg transition-shadow duration-300",outlined:"bg-transparent rounded-xl border border-gray-300 dark:border-gray-600"}[a],{small:"p-4",medium:"p-6",large:"p-8"}[i],s),children:e}),We=e.forwardRef(({label:e,error:s,icon:a,containerClassName:i,className:r,type:n,...l},o)=>t.jsxs("div",{className:D("space-y-2",i),children:[e&&t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e}),t.jsxs("div",{className:"relative",children:[a&&t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",children:a}),t.jsx("input",{ref:o,type:n,className:D("w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-4 py-2 text-gray-900 dark:text-white placeholder-gray-600 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200",a&&"pl-10",s&&"border-danger focus:ring-danger",r),...l})]}),s&&t.jsx("p",{className:"text-xs text-danger",children:s})]}));We.displayName="Input";const Ye=({size:e="medium",variant:s="primary",fullScreen:a=!1,overlay:i=!1,message:r,className:n})=>{const l=D("animate-spin rounded-full border-4 border-t-transparent",{small:"w-4 h-4",medium:"w-8 h-8",large:"w-12 h-12",xlarge:"w-16 h-16"}[e],{primary:"text-primary",secondary:"text-secondary",accent:"text-accent",light:"text-white",dark:"text-gray-800"}[s],n);return a?t.jsx("div",{className:D("fixed inset-0 flex items-center justify-center z-50",i?"bg-black/50 backdrop-blur-sm":"bg-transparent"),children:t.jsxs("div",{className:"flex flex-col items-center gap-4",children:[t.jsx("div",{className:l}),r&&t.jsx("p",{className:"text-white text-lg font-medium",children:r})]})}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:l}),r&&t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:r})]})},Ge=e.createContext({values:{},errors:{},touched:{},setValues:()=>{},setErrors:()=>{},setTouched:()=>{},register:()=>{},validateField:async()=>!1,validateForm:async()=>!1,reset:()=>{},submitting:!1}),Ze=(e,t)=>{if(!t)return null;if(t.required&&(null==e||""===e))return"string"==typeof t.required?t.required:"此字段为必填项";if(t.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return"string"==typeof t.email?t.email:"请输入有效的邮箱地址";if(t.minLength&&e.length<t.minLength.value)return t.minLength.message;if(t.maxLength&&e.length>t.maxLength.value)return t.maxLength.message;if(t.pattern&&!t.pattern.value.test(e))return t.pattern.message;if(t.password?.value){const s=t.password,a=s.minLength||8;if(e.length<a)return s.message||`密码长度不能少于${a}个字符`;if(s.requireUppercase&&!/[A-Z]/.test(e))return s.message||"密码必须包含至少一个大写字母";if(s.requireLowercase&&!/[a-z]/.test(e))return s.message||"密码必须包含至少一个小写字母";if(s.requireNumber&&!/\d/.test(e))return s.message||"密码必须包含至少一个数字";if(s.requireSpecialChar&&!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e))return s.message||"密码必须包含至少一个特殊字符"}if(t.validate){const s=t.validate(e);if("string"==typeof s)return s;if(!1===s)return"验证失败"}return null};e.forwardRef(({children:s,onSubmit:a,initialValues:i={},validateOnBlur:r=!0,validateOnChange:n=!0,className:l,...o},c)=>{const[d,m]=e.useState(i),[g,h]=e.useState({}),[p,u]=e.useState({}),[x,y]=e.useState(!1),[b,f]=e.useState({}),v=async()=>{const e={};let t=!0;return Object.keys(b).forEach(s=>{const a=d[s],i=b[s],r=Ze(a,i);r&&(e[s]=r,t=!1)}),h(e),u(e=>{const t={...e};return Object.keys(b).forEach(e=>{t[e]=!0}),t}),t},j={values:d,errors:g,touched:p,setValues:m,setErrors:h,setTouched:u,register:(e,t={})=>(t.validate&&f(s=>({...s,[e]:t.validate})),{name:e,value:d[e]||"",onChange:s=>{const a=s.target.value;if(m(t=>({...t,[e]:a})),n&&t.validate){const s=Ze(a,t.validate);h(t=>({...t,[e]:s||""}))}},onBlur:()=>{if(u(t=>({...t,[e]:!0})),r&&t.validate){const s=Ze(d[e],t.validate);h(t=>({...t,[e]:s||""}))}},...t}),validateField:async e=>{const t=d[e],s=b[e];if(!s)return!0;const a=Ze(t,s);return h(t=>({...t,[e]:a||""})),!a},validateForm:v,reset:()=>{m(i),h({}),u({})},submitting:x};return t.jsx(Ge.Provider,{value:j,children:t.jsx("form",{ref:c,onSubmit:async e=>{e.preventDefault(),y(!0);try{await v()&&await a(d)}catch(t){}finally{y(!1)}},className:D("space-y-4",l),...o,children:s})})}).displayName="Form";const Xe=new class{ws=null;callbacks={};reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;isConnecting=!1;heartbeatInterval=null;connect(e,t,s){if(!this.isConnecting&&this.ws?.readyState!==WebSocket.OPEN){this.isConnecting=!0;try{const a=`ws://localhost:3007/ws?sessionId=${encodeURIComponent(e)}&userId=${encodeURIComponent(t)}&username=${encodeURIComponent(s)}`;this.ws=new WebSocket(a),this.ws.onopen=()=>{this.isConnecting=!1,this.reconnectAttempts=0,this.startHeartbeat(),this.callbacks.onOpen?.()},this.ws.onclose=a=>{this.isConnecting=!1,this.stopHeartbeat(),this.callbacks.onClose?.(),this.reconnectAttempts<this.maxReconnectAttempts&&setTimeout(()=>{this.reconnectAttempts++,this.connect(e,t,s)},this.reconnectDelay*this.reconnectAttempts)},this.ws.onerror=e=>{this.isConnecting=!1,this.callbacks.onError?.(e)},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleMessage(t)}catch(t){}}}catch(a){this.isConnecting=!1}}}disconnect(){this.ws&&(this.ws.close(1e3,"用户主动断开"),this.ws=null),this.stopHeartbeat(),this.isConnecting=!1}send(e){this.ws?.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify(e))}sendTextEdit(e,t,s="",a=0){this.send({type:"text_edit",operation:e,position:t,text:s,length:a})}sendCursorMove(e){this.send({type:"cursor_move",position:e})}sendSelectionChange(e,t){this.send({type:"selection_change",start:e,end:t})}sendTypingStart(){this.send({type:"typing_start"})}sendTypingStop(){this.send({type:"typing_stop"})}handleMessage(e){switch(this.callbacks.onMessage?.(e),e.type){case"session_joined":this.callbacks.onSessionJoin?.(e);break;case"user_joined":this.callbacks.onUserJoined?.(e);break;case"user_left":this.callbacks.onUserLeft?.(e);break;case"text_edit":this.callbacks.onTextEdit?.(e);break;case"cursor_update":this.callbacks.onCursorUpdate?.(e);break;case"selection_update":this.callbacks.onSelectionUpdate?.(e)}}startHeartbeat(){this.heartbeatInterval=setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.send({type:"ping"})},3e4)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}setCallbacks(e){this.callbacks={...this.callbacks,...e}}onOpen(e){this.callbacks.onOpen=e}onClose(e){this.callbacks.onClose=e}onError(e){this.callbacks.onError=e}onMessage(e){this.callbacks.onMessage=e}onSessionJoin(e){this.callbacks.onSessionJoin=e}onUserJoined(e){this.callbacks.onUserJoined=e}onUserLeft(e){this.callbacks.onUserLeft=e}onTextEdit(e){this.callbacks.onTextEdit=e}onCursorUpdate(e){this.callbacks.onCursorUpdate=e}onSelectionUpdate(e){this.callbacks.onSelectionUpdate=e}getConnectionState(){return this.isConnecting?"connecting":this.ws?.readyState===WebSocket.OPEN?"open":this.ws?.readyState===WebSocket.CLOSED?"closed":"error"}},Je=j.memo(({sessionId:a,userId:r,username:n,initialContent:l="",readOnly:o=!1,onContentChange:c,className:d=""})=>{const{isDark:m}=k(),[g,h]=e.useState(l),[p,u]=e.useState(!1),[x,y]=e.useState([]),[b,f]=e.useState([]),[v,j]=e.useState([]),[N,w]=e.useState(!1),[_,S]=e.useState(0),[C,T]=e.useState(!1),[E,I]=e.useState([l]),[R,D]=e.useState(0),[A,P]=e.useState(!1),[z,$]=e.useState(!1),L=e.useRef(null),O=e.useRef(),M=e.useRef(new Map),q=e.useRef();e.useEffect(()=>{T(!0)},[]);const U=e.useCallback(e=>{if(!M.current.has(e)){const t=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#54A0FF","#5F27CD","#00D2D3","#FF9F43"],s=t[M.current.size%t.length];M.current.set(e,s)}return M.current.get(e)},[]);e.useEffect(()=>(Xe.connect(a,r,n),Xe.onMessage(e=>{H(e)}),Xe.onOpen(()=>{u(!0),i.success("协作连接已建立")}),Xe.onClose(()=>{u(!1),i.error("协作连接已断开")}),Xe.onError(e=>{i.error("协作连接出现错误")}),()=>{Xe.disconnect()}),[a,r,n]);const H=e.useCallback(e=>{switch(e.type){case"text_edit":F(e);break;case"cursor_move":B(e);break;case"selection_change":V(e);break;case"user_joined":W(e);break;case"user_left":Y(e);break;case"typing_start":G(e);break;case"typing_stop":Z(e)}},[]),F=e.useCallback(e=>{e.userId!==r&&h(t=>{let s=t;return"insert"===e.operation?s=t.slice(0,e.position)+e.text+t.slice(e.position):"delete"===e.operation&&(s=t.slice(0,e.position)+t.slice(e.position+e.length)),c?.(s),s!==E[R]&&ee(s),s})},[r,c,E,R]),K=e.useCallback(e=>{if(!L.current)return 8*e;const t=L.current,s=t.textContent||"";if(0===e)return 0;if(e>=s.length){const e=document.createRange();e.selectNodeContents(t),e.collapse(!1);const s=e.getBoundingClientRect(),a=t.getBoundingClientRect();return s.left-a.left}const a=document.createRange();a.selectNodeContents(t),a.setStart(t.firstChild||t,0);let i=0,r=t.firstChild;for(;r&&i<e;){if(r.nodeType===Node.TEXT_NODE){const t=r.textContent?.length||0;if(i+t>=e){const t=e-i;a.setStart(r,t);break}i+=t}r=r.nextSibling}const n=a.getBoundingClientRect(),l=t.getBoundingClientRect();return n.left-l.left},[]),B=e.useCallback(e=>{e.userId!==r&&y(t=>[...t.filter(t=>t.userId!==e.userId),{userId:e.userId,username:e.username,position:e.position,color:U(e.userId)}])},[r,U]),V=e.useCallback(e=>{e.userId!==r&&f(t=>{const s=t.filter(t=>t.userId!==e.userId);return e.start!==e.end?[...s,{userId:e.userId,username:e.username,start:e.start,end:e.end,color:U(e.userId)}]:s})},[r,U]),W=e.useCallback(e=>{i.info(`${e.username} 加入了协作`)},[]),Y=e.useCallback(e=>{i.info(`${e.username} 离开了协作`),y(t=>t.filter(t=>t.userId!==e.userId)),f(t=>t.filter(t=>t.userId!==e.userId))},[]),G=e.useCallback(e=>{e.userId!==r&&j(t=>[...t.filter(t=>t.userId!==e.userId),{userId:e.userId,username:e.username,isTyping:!0}])},[r]),Z=e.useCallback(e=>{e.userId!==r&&j(t=>t.filter(t=>t.userId!==e.userId))},[r]),X=e.useCallback(()=>{if(R>0){P(!0);const e=R-1,t=E[e];h(t),D(e),c?.(t),setTimeout(()=>P(!1),0)}},[E,R,c]),J=e.useCallback(()=>{if(R<E.length-1){$(!0);const e=R+1,t=E[e];h(t),D(e),c?.(t),setTimeout(()=>$(!1),0)}},[E,R,c]),Q=e.useCallback(e=>{o||((e.ctrlKey||e.metaKey)&&"z"===e.key&&(e.preventDefault(),X()),(e.ctrlKey||e.metaKey)&&"y"===e.key&&(e.preventDefault(),J()))},[o,X,J]);e.useEffect(()=>(window.addEventListener("keydown",Q),()=>{window.removeEventListener("keydown",Q)}),[Q]);const ee=e.useCallback(e=>{if(A||z)return;const t=E.slice(0,R+1);t.length>=50&&(t.shift(),D(R-1)),I([...t,e]),D(e=>Math.min(e+1,49))},[E,R,A,z]),te=e.useCallback(e=>{if(o)return;const t=e.target.innerHTML||"";h(t),c?.(t),q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{t!==E[R]&&ee(t)},500),N||(w(!0),Xe.sendTypingStart()),S(Date.now()),O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{w(!1),Xe.sendTypingStop()},1e3)},[o,c,N,g,E,R,ee]),se=e.useCallback(e=>{if(o||!C)return;const t=e.target,s=window.getSelection();if(!s||0===s.rangeCount)return;const a=s.getRangeAt(0),i=ae(t,a);if(Xe.sendCursorMove(i),a.collapsed)Xe.sendSelectionChange(i,i);else{const e=a.cloneRange();e.collapse(!0);const s=ae(t,e),i=a.cloneRange();i.collapse(!1);const r=ae(t,i);Xe.sendSelectionChange(s,r)}},[o,C]),ae=(e,t)=>{const s=t.cloneRange();return s.selectNodeContents(e),s.setEnd(t.endContainer,t.endOffset),s.toString().length},ie=e.useCallback(()=>{if(o||!L.current||!C)return;const e=window.getSelection();if(!e||0===e.rangeCount)return;const t=e.getRangeAt(0),s=ae(L.current,t.cloneRange());t.collapse(!1);const a=ae(L.current,t);Xe.sendSelectionChange(s,a)},[o,C]);return t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`relative ${d}`,children:[t.jsxs("div",{className:"flex flex-col mb-3 p-2 rounded-lg text-sm "+(m?"bg-gray-800":"bg-gray-100"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:`w-2 h-2 rounded-full ${p?"bg-green-500":"bg-red-500"} animate-pulse`}),t.jsx("span",{children:p?"协作已连接":"协作已断开"}),t.jsx("span",{className:"text-gray-500",children:"•"}),t.jsxs("span",{children:[x.length+1," 人在线"]})]}),t.jsx("div",{className:"flex items-center space-x-1",children:x.map(e=>t.jsxs(s.div,{className:"flex items-center space-x-1 px-2 py-1 rounded text-xs",style:{backgroundColor:e.color+"20"},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:[t.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),t.jsx("span",{children:e.username})]},e.userId))})]}),v.length>0&&t.jsx(s.div,{className:"text-xs text-gray-600 dark:text-gray-300",initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},children:v.map(e=>t.jsxs("span",{className:"mr-2",children:[e.username," 正在输入",v.length>1?"...":""]},e.userId))})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[x.map(e=>{const s=K(e.position);return t.jsxs("div",{className:"absolute flex flex-col items-center pointer-events-none",style:{left:`${s}px`,top:"0px"},children:[t.jsx("div",{className:"w-0.5 h-5 animate-pulse",style:{backgroundColor:e.color}}),t.jsx("div",{className:"mt-1 px-2 py-0.5 rounded text-xs font-medium text-white shadow-sm",style:{backgroundColor:e.color},children:e.username})]},e.userId)}),b.map(e=>{const s=K(e.start),a=K(e.end),i=Math.abs(a-s);return t.jsx("div",{className:"absolute h-5 opacity-20",style:{left:`${Math.min(s,a)}px`,width:`${i}px`,backgroundColor:e.color,top:"2px"},title:`${e.username}的选择`},e.userId)})]}),t.jsx("div",{ref:L,contentEditable:!o,suppressContentEditableWarning:!0,className:`min-h-[200px] p-4 rounded-lg border-2 focus:outline-none focus:border-red-500 transition-colors ${m?"bg-gray-900 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} ${o?"cursor-not-allowed opacity-70":""}`,dangerouslySetInnerHTML:{__html:g||""},onInput:te,onKeyDown:se,onMouseUp:ie,onBlur:()=>{N&&(w(!1),Xe.sendTypingStop())},"aria-label":"协作编辑器","aria-describedby":v.length>0?"typing-status":void 0})]}),t.jsx("div",{className:"mt-2 text-xs text-gray-500",children:!o&&t.jsxs("span",{children:["使用 ",t.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 dark:bg-gray-700 rounded",children:"Ctrl+Z"})," 撤销，",t.jsx("kbd",{className:"ml-1 px-1 py-0.5 bg-gray-200 dark:bg-gray-700 rounded",children:"Ctrl+Y"})," 重做"]})})]})}),Qe={sm:{width:320,quality:70},md:{width:640,quality:80},lg:{width:1200,quality:90},xl:{width:1920,quality:95}},et={maxCacheSize:1e3,cacheTTL:6048e5,maxRetries:3,retryDelay:e=>Math.min(300*Math.pow(2,e)+100*Math.random(),2e3),preloadDistance:800,enableWebP:!0,enableAVIF:!0,enableResponsiveLoading:!0,enablePriorityLoading:!0,enablePredictiveLoading:!0,enableImageCompression:!0,compressionQuality:85,cacheStrategy:"LRU"},tt=new class{cache=new Map;config;inProgressRequests=new Map;preloadedUrls=new Set;preloadObserver=null;stats={totalRequests:0,cacheHits:0,loadSuccess:0,loadFailed:0,totalLoadTime:0,averageLoadTime:0,totalSize:0,averageSize:0,cacheHitRate:0,successRate:0,preloadCount:0,preloadHitCount:0,preloadHitRate:0};predictiveUrls=new Set;pageTransitionHistory=[];concurrentPreloadLimit;pendingPreloads=[];currentPreloadCount=0;networkCondition="medium";devicePerformance="medium";constructor(e={}){this.config={...et,...e},this.cleanupCache(),this.initPreloadObserver(),this.initPredictiveLoading(),this.detectNetworkCondition(),this.detectDevicePerformance(),this.concurrentPreloadLimit=this.getDynamicPreloadLimit(),this.setupNetworkListeners()}detectNetworkCondition(){if("connection"in navigator){const e=navigator.connection;this.updateNetworkCondition(e)}}updateNetworkCondition(e){const t=e.effectiveType||"4g",s=e.downlink||10;t.includes("2g")||s<1?this.networkCondition="slow":t.includes("3g")||s<5?this.networkCondition="medium":this.networkCondition="fast"}detectDevicePerformance(){const e=navigator.hardwareConcurrency||4,t=navigator.deviceMemory||4;this.devicePerformance=e<=2||t<=2?"low":e<=4||t<=4?"medium":"high"}getDynamicPreloadLimit(){let e=3;switch(this.networkCondition){case"slow":e-=1;break;case"fast":e+=2}switch(this.devicePerformance){case"low":e-=1;break;case"high":e+=1}return Math.max(1,Math.min(8,e))}setupNetworkListeners(){if("connection"in navigator){const e=navigator.connection;e.addEventListener("change",()=>{this.updateNetworkCondition(e),this.concurrentPreloadLimit=this.getDynamicPreloadLimit()})}}initPreloadObserver(){if("IntersectionObserver"in window){const e=this.getDynamicPreloadDistance();this.preloadObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.getAttribute("data-preload-img");t&&this.preloadImage(t),this.preloadObserver?.unobserve(e.target)}})},{rootMargin:`${e}px 0px`,threshold:0})}}getDynamicPreloadDistance(){let e=this.config.preloadDistance;switch(this.devicePerformance){case"high":e+=200;break;case"low":e-=150}switch(this.networkCondition){case"slow":e-=200;break;case"fast":e+=150}return Math.max(100,Math.min(1e3,e))}initPredictiveLoading(){this.config.enablePredictiveLoading&&(window.addEventListener("popstate",e=>{this.updatePageTransitionHistory(window.location.pathname),this.predictiveLoadImages()}),document.addEventListener("click",e=>{const t=e.target.closest("a");if(t&&t.href){const e=new URL(t.href);e.origin===window.location.origin&&(this.updatePageTransitionHistory(e.pathname),this.predictiveLoadImages())}}))}updatePageTransitionHistory(e){this.pageTransitionHistory.push(e),this.pageTransitionHistory.length>10&&this.pageTransitionHistory.shift()}predictiveLoadImages(){const e=window.location.pathname,t=this.predictNextPage(e);t&&this.loadPageImages(t)}predictNextPage(e){const t={};for(let i=0;i<this.pageTransitionHistory.length-1;i++)if(this.pageTransitionHistory[i]===e){const e=this.pageTransitionHistory[i+1];t[e]=(t[e]||0)+1}let s=null,a=0;for(const[i,r]of Object.entries(t))r>a&&(s=i,a=r);return s}loadPageImages(e){const t={"/home":["/api/proxy/trae-api/home-banner.jpg","/api/proxy/trae-api/featured-1.jpg","/api/proxy/trae-api/featured-2.jpg"],"/explore":["/api/proxy/trae-api/explore-banner.jpg","/api/proxy/trae-api/popular-1.jpg","/api/proxy/trae-api/popular-2.jpg"],"/create":["/api/proxy/trae-api/create-banner.jpg","/api/proxy/trae-api/tools-1.jpg","/api/proxy/trae-api/tools-2.jpg"],"/community":["/api/proxy/trae-api/community-banner.jpg","/api/proxy/trae-api/discussion-1.jpg","/api/proxy/trae-api/discussion-2.jpg"],"/dashboard":["/api/proxy/trae-api/dashboard-banner.jpg","/api/proxy/trae-api/stats-1.jpg","/api/proxy/trae-api/stats-2.jpg"]}[e]||[];this.preloadImages(t)}cleanupCache(){const e=Date.now();for(const[t,s]of this.cache.entries())e-s.timestamp>this.config.cacheTTL&&this.cache.delete(t);for(;this.cache.size>this.config.maxCacheSize;){let e;switch(this.config.cacheStrategy){case"LRU":default:e=Array.from(this.cache.entries()).sort((e,t)=>e[1].lastUsed-t[1].lastUsed)[0][0];break;case"LFU":e=Array.from(this.cache.entries()).sort((e,t)=>e[1].usageCount-t[1].usageCount)[0][0];break;case"MRU":e=Array.from(this.cache.entries()).sort((e,t)=>t[1].lastUsed-e[1].lastUsed)[0][0]}this.cache.delete(e)}}normalizeUrl(e){try{let t=e.trim().replace(/[\s\t\n\r]+/g,"");if(t.startsWith("data:"))return t;const s=t.startsWith("http")?new URL(t):new URL(t,window.location.origin);if(s.hostname.includes("github.com")||s.hostname.includes("raw.githubusercontent.com"))return s.toString();const a=new URLSearchParams(s.search);return a.sort(),s.search=a.toString(),s.pathname.endsWith("/")&&s.pathname.length>1&&(s.pathname=s.pathname.slice(0,-1)),s.toString()}catch(t){return e}}detectSupportedFormats(){return{webp:(()=>{try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch{return!1}})(),avif:(()=>{try{return 0===document.createElement("canvas").toDataURL("image/avif").indexOf("data:image/avif")}catch{return!1}})()}}getResponsiveUrl(e,t="md",s){if(e.includes("/api/proxy/trae-api")||e.includes("trae-api-sg.mchost.guru"))try{return(e.startsWith("http")?new URL(e):new URL(e,window.location.origin)).toString()}catch(a){return e}if(e.includes("github.com")||e.includes("raw.githubusercontent.com"))return e;try{const a=e.startsWith("http")?new URL(e):new URL(e,window.location.origin),i=Qe[t],r=s||i.quality;return a.searchParams.set("w",i.width.toString()),a.searchParams.set("q",r.toString()),a.toString()}catch(a){return e}}getLowQualityUrl(e){if(e.includes("/api/proxy/trae-api")||e.includes("trae-api-sg.mchost.guru"))try{return(e.startsWith("http")?new URL(e):new URL(e,window.location.origin)).toString()}catch(t){return e}if(e.includes("github.com")||e.includes("raw.githubusercontent.com"))return e;try{const t=e.startsWith("http")?new URL(e):new URL(e,window.location.origin);return t.searchParams.set("w","100"),t.searchParams.set("q","20"),t.toString()}catch(t){return e}}getFallbackUrl(e){const t=window.location.hostname.includes("github.io");return window.location.hostname.includes("jinmai-lab.tech"),(t?"/jinmai-lab/":"/")+"images/placeholder-image.jpg"}isValidImageUrl(e){if(e.startsWith("/"))return!0;if(e.startsWith("data:"))return!0;try{const t=new URL(e);return["http:","https:"].includes(t.protocol)}catch{return!1}}preloadImage(e){this.preloadedUrls.has(e)||(this.preloadedUrls.add(e),this.pendingPreloads.push(e),this.stats.preloadCount++,this.processPreloadQueue())}processPreloadQueue(){for(;this.currentPreloadCount<this.concurrentPreloadLimit&&this.pendingPreloads.length>0;){const e=this.pendingPreloads.shift();this.loadPreloadImage(e)}}loadPreloadImage(e,t=0){this.currentPreloadCount++;const s=new Image,a=Date.now(),i=setTimeout(()=>{s.src="",this.handlePreloadError(e,t)},5e3);s.onload=()=>{clearTimeout(i);const t=Date.now()-a;this.updateImageStatus(e,!0,s.naturalWidth*s.naturalHeight),this.stats.totalLoadTime+=t,this.stats.preloadHitCount++,this.currentPreloadCount--,this.processPreloadQueue()},s.onerror=()=>{clearTimeout(i),this.handlePreloadError(e,t)},s.src=e}handlePreloadError(e,t){t<this.config.maxRetries?setTimeout(()=>{this.loadPreloadImage(e,t+1)},this.config.retryDelay(t)):(this.updateImageStatus(e,!1),this.currentPreloadCount--,this.processPreloadQueue())}preloadImages(e){e.forEach(e=>this.preloadImage(e))}observeForPreload(e,t){this.preloadObserver&&(e.setAttribute("data-preload-img",t),this.preloadObserver.observe(e))}async validateImageUrl(e,t=0){if(!this.isValidImageUrl(e))return!1;try{const t=new AbortController,s=setTimeout(()=>t.abort(),5e3),a=await fetch(e,{method:"HEAD",signal:t.signal});clearTimeout(s);const i=a.headers.get("content-type");return a.ok&&(i?.startsWith("image/")||!1)}catch(s){return t<this.config.maxRetries&&(await new Promise(e=>setTimeout(e,this.config.retryDelay(t))),this.validateImageUrl(e,t+1))}}async getReliableImageUrl(e,t,s){const a=this.normalizeUrl(e),{priority:i=!1,size:r="md",quality:n}=s||{};this.stats.totalRequests++,this.cleanupCache();let l=this.cache.get(a);if(l)return l.usageCount++,l.lastUsed=Date.now(),this.cache.set(a,l),this.stats.cacheHits++,l.success?this.getResponsiveUrl(a,r,n):this.getFallbackUrl(t);if(this.inProgressRequests.has(a))return this.inProgressRequests.get(a);if(!this.isValidImageUrl(a))return this.cache.set(a,{url:a,timestamp:Date.now(),success:!1,usageCount:1,lastUsed:Date.now()}),this.getFallbackUrl(t);this.cache.set(a,{url:a,timestamp:Date.now(),success:!1,usageCount:1,lastUsed:Date.now(),format:this.detectSupportedFormats().avif?"avif":this.detectSupportedFormats().webp?"webp":void 0,quality:n||Qe[r].quality});const o=this.getResponsiveUrl(a,r,n);return i&&this.preloadImage(o),o}async getReliableImageUrls(e,t){return Promise.all(e.map(({url:e,alt:s})=>this.getReliableImageUrl(e,s,t)))}updateImageStatus(e,t,s){const a=this.normalizeUrl(e);t?this.stats.loadSuccess++:this.stats.loadFailed++;const i=this.cache.get(a);if(i?.loadTime){this.stats.totalLoadTime+=i.loadTime;const e=this.stats.loadSuccess+this.stats.loadFailed;this.stats.averageLoadTime=e>0?Math.round(this.stats.totalLoadTime/e):0}if(s){this.stats.totalSize+=s;const e=this.stats.loadSuccess+this.stats.loadFailed;this.stats.averageSize=e>0?Math.round(this.stats.totalSize/e):0}this.stats.totalRequests>0&&(this.stats.cacheHitRate=Math.round(this.stats.cacheHits/this.stats.totalRequests*100));const r=this.stats.loadSuccess+this.stats.loadFailed;r>0&&(this.stats.successRate=Math.round(this.stats.loadSuccess/r*100)),this.stats.preloadCount>0&&(this.stats.preloadHitRate=Math.round(this.stats.preloadHitCount/this.stats.preloadCount*100)),this.cache.set(a,{url:a,timestamp:Date.now(),success:t,size:s,usageCount:i?.usageCount||1,lastUsed:Date.now(),format:i?.format,quality:i?.quality,width:i?.width,height:i?.height,loadTime:i?.loadTime}),this.cleanupCache()}clearCache(e){if(e){const t=this.normalizeUrl(e);this.cache.delete(t),this.preloadedUrls.delete(t)}else this.cache.clear(),this.preloadedUrls.clear()}getCacheStats(){const e=this.stats.totalRequests>0?Math.round(this.stats.cacheHits/this.stats.totalRequests*100):0,t=this.stats.loadSuccess+this.stats.loadFailed,s=t>0?Math.round(this.stats.loadSuccess/t*100):0;return{size:this.cache.size,maxSize:this.config.maxCacheSize,hitRate:e,successRate:s}}getPerformanceStats(){return{...this.stats}}resetStats(){this.stats={totalRequests:0,cacheHits:0,loadSuccess:0,loadFailed:0,totalLoadTime:0,averageLoadTime:0,totalSize:0,averageSize:0,cacheHitRate:0,successRate:0,preloadCount:0,preloadHitCount:0,preloadHitRate:0}}},st=()=>{const e=["https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf","https://github.com/KhronosGroup/glTF-Sample-Models/raw/master/2.0/Duck/glTF/Duck.gltf","https://raw.githubusercontent.com/octocat/Hello-World/master/images/octocat.png","https://github.com/octocat/Hello-World/blob/master/images/octocat.png?raw=true"];return j.useEffect(()=>{e.forEach((e,t)=>{})},[]),t.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[t.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"GitHub图片URL测试"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:e.map((e,s)=>t.jsxs("div",{className:"border p-6 rounded-lg shadow-md",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["测试 ",s+1]}),t.jsx("p",{className:"text-sm text-gray-600 mb-4 break-all",children:e}),t.jsx("div",{className:"h-48 flex items-center justify-center bg-gray-100 rounded-md overflow-hidden",children:e.endsWith(".gltf")?t.jsx("p",{className:"text-gray-500",children:"这是一个GLTF模型文件"}):t.jsx(E,{src:e,alt:`GitHub Image Test ${s+1}`,className:"max-h-full max-w-full object-contain"})}),t.jsxs("div",{className:"mt-4 text-sm",children:[t.jsx("p",{children:t.jsx("strong",{children:"处理后URL:"})}),t.jsx("p",{className:"text-xs break-all text-blue-600",children:I(e)})]})]},s))}),t.jsxs("div",{className:"mt-12 p-6 bg-blue-50 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"测试结果"}),t.jsx("p",{className:"mb-4",children:"请在浏览器控制台查看完整的URL处理测试结果。"}),t.jsxs("p",{className:"text-sm text-gray-600",children:["检查点:",t.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[t.jsx("li",{children:"GitHub URL是否保持原始格式？"}),t.jsx("li",{children:"是否没有添加额外的参数？"}),t.jsx("li",{children:"URL标准化是否跳过了GitHub域名？"}),t.jsx("li",{children:"响应式URL是否保持了原始GitHub URL？"})]})]})]})]})},at=new class{ASSETS_KEY="jmzf_ip_assets";PARTNERS_KEY="jmzf_partnerships";ipAssets=[{id:"ip-001",name:"国潮插画系列",description:"融合传统中国元素与现代设计风格的插画系列",type:"illustration",originalWorkId:"work-001",stages:[{id:"stage-1",name:"创意设计",description:"完成原创设计作品",completed:!0,completedAt:"2025-11-01"},{id:"stage-2",name:"版权存证",description:"完成作品版权存证",completed:!0,completedAt:"2025-11-02"},{id:"stage-3",name:"IP孵化",description:"将设计转化为IP资产",completed:!1},{id:"stage-4",name:"商业合作",description:"对接品牌合作机会",completed:!1},{id:"stage-5",name:"收益分成",description:"获得作品收益分成",completed:!1}],commercialValue:5e3,createdAt:"2025-11-01",updatedAt:"2025-11-02",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=IP%20asset%20example%201"},{id:"ip-002",name:"传统纹样创新",description:"基于传统纹样进行创新设计的图案集合",type:"pattern",originalWorkId:"work-002",stages:[{id:"stage-1",name:"创意设计",description:"完成原创设计作品",completed:!0,completedAt:"2025-10-25"},{id:"stage-2",name:"版权存证",description:"完成作品版权存证",completed:!0,completedAt:"2025-10-26"},{id:"stage-3",name:"IP孵化",description:"将设计转化为IP资产",completed:!0,completedAt:"2025-10-30"},{id:"stage-4",name:"商业合作",description:"对接品牌合作机会",completed:!1},{id:"stage-5",name:"收益分成",description:"获得作品收益分成",completed:!1}],commercialValue:8e3,createdAt:"2025-10-25",updatedAt:"2025-10-30",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=IP%20asset%20example%202"}];partnerships=[{id:"partnership-001",brandName:"桂发祥",brandLogo:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Brand%20logo%20example%201",description:"为桂发祥设计国潮风格包装",reward:"¥15,000",status:"negotiating",ipAssetId:"ip-001",createdAt:"2025-11-05",updatedAt:"2025-11-07"}];constructor(){try{const e=localStorage.getItem(this.ASSETS_KEY);e&&(this.ipAssets=JSON.parse(e));const t=localStorage.getItem(this.PARTNERS_KEY);t&&(this.partnerships=JSON.parse(t))}catch{}}saveAssets(){try{localStorage.setItem(this.ASSETS_KEY,JSON.stringify(this.ipAssets))}catch{}}savePartnerships(){try{localStorage.setItem(this.PARTNERS_KEY,JSON.stringify(this.partnerships))}catch{}}getAllIPAssets(){return[...this.ipAssets]}getIPAssetById(e){return this.ipAssets.find(t=>t.id===e)}createIPAsset(e){const t={...e,id:`ip-${Date.now()}`,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return this.ipAssets.push(t),this.saveAssets(),t}updateIPAsset(e,t){const s=this.ipAssets.findIndex(t=>t.id===e);return-1!==s&&(this.ipAssets[s]={...this.ipAssets[s],...t,updatedAt:(new Date).toISOString()},this.saveAssets(),!0)}deleteIPAsset(e){const t=this.ipAssets.length;return this.ipAssets=this.ipAssets.filter(t=>t.id!==e),this.ipAssets.length<t&&(this.saveAssets(),!0)}updateIPStage(e,t,s){const a=this.getIPAssetById(e);if(a){const e=a.stages.find(e=>e.id===t);if(e)return e.completed=s,s&&!e.completedAt&&(e.completedAt=(new Date).toISOString()),a.updatedAt=(new Date).toISOString(),this.saveAssets(),!0}return!1}searchIPAssets(e){const t=e.toLowerCase();return this.ipAssets.filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.type.toLowerCase().includes(t))}filterIPAssets(e){return this.ipAssets.filter(t=>{let s=!0;if(e.type&&t.type!==e.type&&(s=!1),e.status){const a=t.stages.every(e=>e.completed),i=t.stages.some(e=>e.completed)&&!a;("completed"===e.status&&!a||"in-progress"===e.status&&!i||"pending"===e.status&&a)&&(s=!1)}return e.minValue&&t.commercialValue<e.minValue&&(s=!1),s})}getIPValueTrend(){const e={};return this.ipAssets.forEach(t=>{const s=t.createdAt.slice(0,7);e[s]||(e[s]=0),e[s]+=t.commercialValue}),Object.entries(e).map(([e,t])=>({timestamp:e,value:t})).sort((e,t)=>e.timestamp.localeCompare(t.timestamp))}getIPTypeDistribution(){const e={};this.ipAssets.forEach(t=>{e[t.type]||(e[t.type]=0),e[t.type]++});const t=this.ipAssets.length;return Object.entries(e).map(([e,s])=>({type:e,count:s,percentage:Math.round(s/t*100)}))}getAllPartnerships(){return[...this.partnerships]}getPartnershipsByIPId(e){return this.partnerships.filter(t=>t.ipAssetId===e)}createPartnership(e){const t={...e,id:`partnership-${Date.now()}`,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return this.partnerships.push(t),this.savePartnerships(),t}updatePartnershipStatus(e,t){const s=this.partnerships.find(t=>t.id===e);return!!s&&(s.status=t,s.updatedAt=(new Date).toISOString(),this.savePartnerships(),!0)}getIPStats(){const e=this.ipAssets.filter(e=>e.stages.every(e=>e.completed)).length,t=this.partnerships.filter(e=>"pending"===e.status||"negotiating"===e.status).length,s=this.ipAssets.reduce((e,t)=>e+t.commercialValue,0);return{totalAssets:this.ipAssets.length,completedAssets:e,inProgressAssets:this.ipAssets.length-e,totalPartnerships:this.partnerships.length,activePartnerships:t,totalEstimatedValue:s}}},it=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isDark:a}=k(),[r,n]=e.useState("incubation"),[l,o]=e.useState(null),[c,p]=e.useState([]),[j,S]=e.useState([]),[C,T]=e.useState([]),[E,I]=e.useState([]),[R,D]=e.useState(!0),[A,P]=e.useState({totalAssets:0,completedAssets:0,inProgressAssets:0,totalPartnerships:0,activePartnerships:0,totalEstimatedValue:0}),[z,$]=e.useState(""),[O,M]=e.useState("all"),[q,U]=e.useState("all"),[H,F]=e.useState(""),[K,B]=e.useState([]),[V,W]=e.useState([]),Y={"创意设计":"palette","版权存证":"shield-alt","IP孵化":"gem","商业合作":"handshake","收益分成":"coins"};e.useEffect(()=>{D(!0),setTimeout(()=>{const e=at.getAllIPAssets(),t=at.getIPStats();p(e),S(e),P(t),T([{id:1,name:"国潮包装设计",description:"为老字号食品品牌设计国潮风格包装",brand:"桂发祥",reward:"¥15,000",status:"open",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Traditional%20brand%20packaging%20design%20opportunity"},{id:2,name:"文创产品开发",description:"设计传统文化元素文创产品系列",brand:"杨柳青画社",reward:"¥20,000",status:"open",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Cultural%20creative%20product%20development"},{id:3,name:"数字藏品创作",description:"创作基于传统纹样的数字藏品系列",brand:"数字艺术馆",reward:"分成模式",status:"matched",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Digital%20collectibles%20creation%20opportunity"}]),I([{id:1,name:"国潮插画系列",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Copyrighted%20artwork%20example%201",type:"插画",createdAt:"2025-11-01",status:"已存证",canLicense:!0},{id:2,name:"传统纹样创新",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Copyrighted%20artwork%20example%202",type:"纹样",createdAt:"2025-10-25",status:"已授权",canLicense:!1},{id:3,name:"老字号品牌视觉",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Copyrighted%20artwork%20example%203",type:"品牌设计",createdAt:"2025-10-15",status:"已存证",canLicense:!0}]),B(at.getIPValueTrend()),W(at.getIPTypeDistribution()),e.length>0&&o(e[0]),D(!1)},800)},[]),e.useEffect(()=>{let e=c;z&&(e=at.searchIPAssets(z));const t={};"all"!==O&&(t.type=O),"all"!==q&&(t.status=q),H&&(t.minValue=parseInt(H)),Object.keys(t).length>0&&(e=at.filterIPAssets(t)),S(e)},[z,O,q,H,c]);const G=e=>{const t=e.filter(e=>e.completed).length;return Math.round(t/e.length*100)};return R?t.jsx("div",{className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:`h-8 w-1/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"flex space-x-3 overflow-x-auto pb-4",children:[1,2,3].map(e=>t.jsx("div",{className:`h-10 w-24 rounded-full ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`},e))}),t.jsx("div",{className:`h-40 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:`h-4 w-1/3 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[1,2,3].map(e=>t.jsx("div",{className:`h-32 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`},e))})]},e))})]})}):t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-xl font-bold",children:"IP孵化中心"}),t.jsxs("button",{className:`px-4 py-2 rounded-lg text-sm ${a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:[t.jsx("i",{className:"fas fa-plus mr-1"}),"提交作品"]})]}),t.jsx("div",{className:"flex space-x-3 mb-6 overflow-x-auto pb-4 scrollbar-hide",children:[{id:"incubation",name:"IP孵化路径"},{id:"assets",name:"IP资产"},{id:"opportunities",name:"商业机会"},{id:"copyright",name:"版权资产"},{id:"analytics",name:"数据分析"}].map(e=>t.jsx("button",{onClick:()=>n(e.id),className:"px-5 py-2.5 rounded-full text-sm font-medium transition-all whitespace-nowrap "+(r===e.id?"bg-red-600 text-white shadow-md":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:e.name},e.id))}),"incubation"===r&&t.jsx("div",{children:l?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h4",{className:"font-medium",children:"孵化进度"}),t.jsxs("span",{className:"text-sm font-medium",children:[G(l.stages),"%"]})]}),t.jsx("div",{className:"mb-4 p-4 rounded-xl "+(a?"bg-gray-700":"bg-gray-50"),children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(L,{src:l.thumbnail,alt:l.name,className:"w-12 h-12 rounded-lg object-cover",ratio:"square"}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-bold",children:l.name}),t.jsx("p",{className:"text-sm text-gray-500",children:"illustration"===l.type?"插画":"pattern"===l.type?"纹样":"设计"})]}),t.jsx("select",{className:`ml-auto px-3 py-1 rounded-lg text-sm ${a?"bg-gray-600 border-gray-500":"bg-white border-gray-300"} border`,value:l.id,onChange:e=>o(at.getIPAssetById(e.target.value)||null),children:c.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]})}),t.jsx("div",{className:"h-3 mb-2 rounded-full "+(a?"bg-gray-700":"bg-gray-200"),children:t.jsx(s.div,{className:"h-full rounded-full bg-gradient-to-r from-red-500 to-blue-500",initial:{width:"0%"},animate:{width:`${G(l.stages)}%`},transition:{duration:.5}})}),t.jsxs("div",{className:"relative mt-8",children:[t.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-gray-300 dark:bg-gray-600"}),t.jsx("div",{className:"space-y-6",children:l.stages.map((e,r)=>{const n={...e,icon:Y[e.name]||"question-circle",active:!l.stages.slice(0,r).some(e=>!e.completed)&&!e.completed};return t.jsxs(s.div,{className:"flex gap-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*r},children:[t.jsx("div",{className:"relative z-10",children:t.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center "+(n.completed?"bg-green-500 text-white":n.active?"bg-red-600 text-white ring-4 ring-red-200 ring-offset-2":a?"bg-gray-700 text-gray-400":"bg-gray-200 text-gray-500"),children:n.completed?t.jsx("i",{className:"fas fa-check text-sm"}):t.jsx("i",{className:`fas fa-${n.icon} text-sm`})})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between items-center mb-1",children:[t.jsx("h5",{className:"font-medium "+(n.active?"text-red-600":""),children:e.name}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",className:"sr-only peer",checked:e.completed,onChange:t=>{return s=l?.id||"",a=e.id,r=t.target.checked,void(at.updateIPStage(s,a,r)?(p(at.getAllIPAssets()),l?.id===s&&o(at.getIPAssetById(s)||null),i.success("IP孵化阶段更新成功")):i.error("IP孵化阶段更新失败"));var s,a,r}}),t.jsx("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-red-600"})]}),t.jsx("span",{className:"text-xs font-medium",children:e.completed?"已完成":"未完成"})]})]}),t.jsx("p",{className:"text-sm mb-2 "+(a?"text-gray-400":"text-gray-600"),children:e.description}),e.completedAt&&t.jsxs("p",{className:"text-xs text-gray-500",children:["完成于 ",new Date(e.completedAt).toLocaleDateString()]})]})]},e.id)})})]})]}),t.jsx("div",{className:"p-6 rounded-xl mb-8 "+(a?"bg-gray-700":"bg-yellow-50"),children:(()=>{const e=(e=>{const t=e.map((e,t)=>({...e,icon:Y[e.name]||"question-circle",active:!1,index:t})),s=t.find(e=>!e.completed)||t[t.length-1];return s&&(s.active=!0),s})(l.stages);return e?t.jsxs(t.Fragment,{children:[t.jsxs("h4",{className:"font-medium mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-play-circle text-yellow-500 mr-2"}),"当前阶段：",e.name]}),t.jsx("p",{className:"text-sm mb-4",children:e.description}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-3 rounded-lg "+(a?"bg-gray-600":"bg-white"),children:[t.jsx("h6",{className:"text-xs text-gray-500 mb-1",children:"完成条件"}),t.jsx("p",{className:"text-sm",children:"完成该阶段的所有要求"})]}),t.jsxs("div",{className:"p-3 rounded-lg "+(a?"bg-gray-600":"bg-white"),children:[t.jsx("h6",{className:"text-xs text-gray-500 mb-1",children:"预期收益"}),t.jsx("p",{className:"text-sm",children:"提升IP商业价值"})]}),t.jsxs("div",{className:"p-3 rounded-lg "+(a?"bg-gray-600":"bg-white"),children:[t.jsx("h6",{className:"text-xs text-gray-500 mb-1",children:"下一阶段"}),t.jsx("p",{className:"text-sm",children:e.index<l.stages.length-1?l.stages[e.index+1].name:"收益分成"})]})]})]}):null})()}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[t.jsx(s.div,{className:"p-4 rounded-xl "+(a?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm mb-1 "+(a?"text-gray-400":"text-gray-600"),children:"已孵化IP"}),t.jsx("h3",{className:"text-xl font-bold",children:A.totalAssets})]}),t.jsx("div",{className:"p-2 rounded-full bg-purple-100 text-purple-600",children:t.jsx("i",{className:"fas fa-gem text-lg"})})]})}),t.jsx(s.div,{className:"p-4 rounded-xl "+(a?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm mb-1 "+(a?"text-gray-400":"text-gray-600"),children:"商业合作"}),t.jsx("h3",{className:"text-xl font-bold",children:A.totalPartnerships})]}),t.jsx("div",{className:"p-2 rounded-full bg-blue-100 text-blue-600",children:t.jsx("i",{className:"fas fa-handshake text-lg"})})]})}),t.jsx(s.div,{className:"p-4 rounded-xl "+(a?"bg-gray-700":"bg-gray-50"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm mb-1 "+(a?"text-gray-400":"text-gray-600"),children:"预估价值"}),t.jsxs("h3",{className:"text-xl font-bold",children:["¥",A.totalEstimatedValue.toLocaleString()]})]}),t.jsx("div",{className:"p-2 rounded-full bg-green-100 text-green-600",children:t.jsx("i",{className:"fas fa-coins text-lg"})})]})})]}),t.jsxs("div",{className:"p-6 rounded-xl "+(a?"bg-gray-700":"bg-yellow-50"),children:[t.jsxs("h4",{className:"font-medium mb-4 flex items-center",children:[t.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mr-2"}),"IP孵化建议"]}),t.jsxs("ul",{className:"space-y-3",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("p",{className:"text-sm",children:'您的作品"国潮插画系列"已完成版权存证，可以开始申请商业合作'})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("p",{className:"text-sm",children:'建议将"传统纹样创新"设计转化为3D模型，提升商业价值'})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-check-circle text-green-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("p",{className:"text-sm",children:'参与当前开放的"桂发祥包装设计"项目，与您的风格高度匹配'})]})]})]})]}):t.jsxs("div",{className:`p-8 rounded-xl ${a?"bg-gray-700":"bg-white"} text-center`,children:[t.jsx("i",{className:"fas fa-gem text-6xl text-red-600 mb-4"}),t.jsx("h3",{className:"text-xl font-bold mb-2",children:"还没有IP资产"}),t.jsx("p",{className:"mb-4 "+(a?"text-gray-400":"text-gray-600"),children:"提交作品并完成版权存证后，即可创建IP资产"}),t.jsx("button",{className:"px-6 py-2 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white transition-colors",children:"提交作品"})]})}),"assets"===r&&t.jsxs("div",{children:[t.jsx("div",{className:"mb-6 p-4 rounded-xl "+(a?"bg-gray-700":"bg-gray-50"),children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx("div",{className:"md:col-span-2",children:t.jsx("input",{type:"text",placeholder:"搜索IP资产...",value:z,onChange:e=>$(e.target.value),className:`w-full px-4 py-2 rounded-lg border ${a?"bg-gray-600 border-gray-500":"bg-white border-gray-300"} focus:outline-none focus:ring-2 focus:ring-red-500`})}),t.jsx("div",{children:t.jsxs("select",{value:O,onChange:e=>M(e.target.value),className:`w-full px-4 py-2 rounded-lg border ${a?"bg-gray-600 border-gray-500":"bg-white border-gray-300"} focus:outline-none focus:ring-2 focus:ring-red-500`,children:[t.jsx("option",{value:"all",children:"所有类型"}),t.jsx("option",{value:"illustration",children:"插画"}),t.jsx("option",{value:"pattern",children:"纹样"}),t.jsx("option",{value:"design",children:"设计"}),t.jsx("option",{value:"3d_model",children:"3D模型"}),t.jsx("option",{value:"digital_collectible",children:"数字藏品"})]})}),t.jsx("div",{children:t.jsxs("select",{value:q,onChange:e=>U(e.target.value),className:`w-full px-4 py-2 rounded-lg border ${a?"bg-gray-600 border-gray-500":"bg-white border-gray-300"} focus:outline-none focus:ring-2 focus:ring-red-500`,children:[t.jsx("option",{value:"all",children:"所有状态"}),t.jsx("option",{value:"in-progress",children:"进行中"}),t.jsx("option",{value:"completed",children:"已完成"}),t.jsx("option",{value:"pending",children:"待开始"})]})})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[j.map(e=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-md border "+(a?"border-gray-700":"border-gray-200"),whileHover:{y:-5},children:[t.jsxs("div",{className:"relative",children:[t.jsx(L,{src:e.thumbnail,alt:e.name,className:"w-full h-48 object-cover",ratio:"landscape"}),t.jsx("div",{className:"absolute top-3 left-3",children:t.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(a?"bg-gray-600":"bg-white"),children:"illustration"===e.type?"插画":"pattern"===e.type?"纹样":"设计"})}),t.jsx("div",{className:"absolute top-3 right-3",children:t.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+(a?"bg-gray-600":"bg-white"),children:["价值 ¥",e.commercialValue.toLocaleString()]})})]}),t.jsxs("div",{className:"p-4 "+(a?"bg-gray-700":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h4",{className:"font-bold",children:e.name}),t.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:[G(e.stages),"%"]})]}),t.jsx("p",{className:"text-sm mb-4 "+(a?"text-gray-400":"text-gray-600"),children:e.description}),t.jsx("div",{className:"h-2 mb-3 rounded-full "+(a?"bg-gray-600":"bg-gray-200"),children:t.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-red-500 to-blue-500",style:{width:`${G(e.stages)}%`}})}),t.jsx("div",{className:"flex gap-1 mb-4 flex-wrap",children:e.stages.map((e,s)=>t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(e.completed?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"),children:e.name},e.id))}),t.jsxs("button",{onClick:()=>o(e),className:"w-full py-2 rounded-lg text-sm transition-colors "+(a?"bg-gray-600 hover:bg-gray-500":"bg-gray-100 hover:bg-gray-200"),children:[t.jsx("i",{className:"fas fa-arrow-right mr-1"}),"查看详情"]})]})]},e.id)),0===j.length&&t.jsxs("div",{className:"col-span-full p-8 rounded-xl text-center",style:{backgroundColor:a?"#1f2937":"#ffffff",border:"1px solid "+(a?"#374151":"#e5e7eb")},children:[t.jsx("i",{className:"fas fa-gem text-6xl text-red-600 mb-4"}),t.jsx("h3",{className:"text-xl font-bold mb-2",children:"没有找到匹配的IP资产"}),t.jsx("p",{className:"mb-4 "+(a?"text-gray-400":"text-gray-600"),children:"尝试调整搜索条件或筛选选项"}),t.jsx("button",{onClick:()=>{$(""),M("all"),U("all"),F("")},className:"px-6 py-2 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white transition-colors",children:"重置筛选条件"})]})]})]}),"opportunities"===r&&t.jsx("div",{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:C.map(e=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-md border "+(a?"border-gray-700":"border-gray-200"),whileHover:{y:-5},children:[t.jsxs("div",{className:"relative",children:[t.jsx(L,{src:e.image,alt:e.name,className:"w-full h-48 object-cover",ratio:"landscape"}),t.jsx("div",{className:"absolute top-3 left-3",children:t.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+("open"===e.status?"bg-green-600 text-white":"matched"===e.status?"bg-blue-600 text-white":"bg-gray-600 text-white"),children:"open"===e.status?"开放申请":"matched"===e.status?"匹配中":"已关闭"})})]}),t.jsxs("div",{className:"p-4 "+(a?"bg-gray-700":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h4",{className:"font-bold",children:e.name}),t.jsx("span",{className:"text-sm px-2 py-0.5 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:e.brand})]}),t.jsx("p",{className:"text-sm mb-4 "+(a?"text-gray-400":"text-gray-600"),children:e.description}),t.jsxs("div",{className:`p-2 rounded-lg ${a?"bg-gray-600":"bg-gray-50"} mb-4 flex justify-between items-center`,children:[t.jsx("span",{className:"text-sm font-medium",children:"奖励"}),t.jsx("span",{className:"font-bold text-red-600",children:e.reward})]}),t.jsx("button",{onClick:()=>{i.success("已申请商业机会，等待品牌方审核")},disabled:"open"!==e.status,className:"w-full py-2 rounded-lg text-sm transition-colors "+("open"===e.status?"bg-red-600 hover:bg-red-700 text-white":a?"bg-gray-600 cursor-not-allowed":"bg-gray-300 cursor-not-allowed"),children:"open"===e.status?"立即申请":"matched"===e.status?"匹配中":"已关闭"})]})]},e.id))})}),"copyright"===r&&t.jsxs("div",{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:E.map(e=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-md border "+(a?"border-gray-700":"border-gray-200"),whileHover:{y:-5},children:[t.jsx(L,{src:e.thumbnail,alt:e.name,className:"w-full h-48 object-cover",ratio:"landscape"}),t.jsxs("div",{className:"p-4 "+(a?"bg-gray-700":"bg-white"),children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("h4",{className:"font-bold",children:e.name}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:e.type})]}),t.jsxs("div",{className:"flex justify-between text-sm mb-4",children:[t.jsxs("span",{className:a?"text-gray-400":"text-gray-600",children:["创建于 ",e.createdAt]}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+("已存证"===e.status?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"),children:e.status})]}),t.jsx("button",{onClick:()=>{i.success("版权授权申请已提交")},disabled:!e.canLicense,className:"w-full py-2 rounded-lg text-sm transition-colors "+(e.canLicense?"bg-blue-600 hover:bg-blue-700 text-white":a?"bg-gray-600 cursor-not-allowed":"bg-gray-300 cursor-not-allowed"),children:e.canLicense?"版权授权":"已授权"})]})]},e.id))}),t.jsxs("div",{className:"p-6 rounded-xl "+(a?"bg-gray-700":"bg-gray-50"),children:[t.jsx("h4",{className:"font-medium mb-4",children:"版权数据分析"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm mb-3",children:"版权类型分布"}),t.jsx("div",{className:"h-40",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsx(m,{children:t.jsx(g,{data:[{name:"插画",value:4},{name:"纹样",value:2},{name:"品牌设计",value:2},{name:"其他",value:0}],cx:"50%",cy:"50%",outerRadius:60,fill:"#8884d8",dataKey:"value",label:({name:e,percent:t})=>`${e} ${(100*t).toFixed(0)}%`,children:[{name:"插画",value:4},{name:"纹样",value:2},{name:"品牌设计",value:2},{name:"其他",value:0}].map((e,s)=>t.jsx(h,{fill:["#f87171","#60a5fa","#34d399","#a78bfa"][s%4]},`cell-${s}`))})})})})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm mb-3",children:"版权收益预估"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:"已授权收益"}),t.jsx("span",{className:"font-medium",children:"¥3,500"})]}),t.jsx("div",{className:"h-2 rounded-full "+(a?"bg-gray-600":"bg-gray-200"),children:t.jsx("div",{className:"h-full rounded-full bg-green-500",style:{width:"35%"}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:"待授权预估"}),t.jsx("span",{className:"font-medium",children:"¥6,500"})]}),t.jsx("div",{className:"h-2 rounded-full "+(a?"bg-gray-600":"bg-gray-200"),children:t.jsx("div",{className:"h-full rounded-full bg-blue-500",style:{width:"65%"}})})]}),t.jsxs("div",{className:"text-center pt-4",children:[t.jsx("p",{className:"text-sm opacity-70 mb-1",children:"总预估收益"}),t.jsx("p",{className:"text-2xl font-bold",children:"¥10,000"})]})]})]})]})]})]}),"analytics"===r&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[t.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"rounded-xl p-4 "+(a?"bg-gray-700 border border-gray-600":"bg-white border border-gray-200"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} mb-1`,children:"总IP资产"}),t.jsx("h3",{className:"text-2xl font-bold",children:A.totalAssets})]}),t.jsx("div",{className:"p-2 rounded-full bg-red-100 text-red-600",children:t.jsx("i",{className:"fas fa-gem text-lg"})})]})}),t.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"rounded-xl p-4 "+(a?"bg-gray-700 border border-gray-600":"bg-white border border-gray-200"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} mb-1`,children:"活跃合作"}),t.jsx("h3",{className:"text-2xl font-bold",children:A.activePartnerships})]}),t.jsx("div",{className:"p-2 rounded-full bg-blue-100 text-blue-600",children:t.jsx("i",{className:"fas fa-handshake text-lg"})})]})}),t.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"rounded-xl p-4 "+(a?"bg-gray-700 border border-gray-600":"bg-white border border-gray-200"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} mb-1`,children:"总预估价值"}),t.jsxs("h3",{className:"text-2xl font-bold",children:["¥",A.totalEstimatedValue.toLocaleString()]})]}),t.jsx("div",{className:"p-2 rounded-full bg-green-100 text-green-600",children:t.jsx("i",{className:"fas fa-coins text-lg"})})]})})]}),t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"rounded-xl p-6 "+(a?"bg-gray-700 border border-gray-600":"bg-white border border-gray-200"),children:[t.jsx("h4",{className:"font-medium mb-4",children:"IP资产价值趋势"}),t.jsx("div",{className:"h-64",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(N,{data:K,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),t.jsx("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:.1})]})}),t.jsx(y,{strokeDasharray:"3 3",stroke:a?"#374151":"#e5e7eb"}),t.jsx(b,{dataKey:"timestamp",stroke:a?"#9ca3af":"#6b7280"}),t.jsx(f,{stroke:a?"#9ca3af":"#6b7280",tickFormatter:e=>`¥${e}`}),t.jsx(u,{contentStyle:{backgroundColor:a?"#1f2937":"#ffffff",borderColor:a?"#374151":"#e5e7eb",color:a?"#f3f4f6":"#111827"},formatter:e=>[`¥${e}`,"预估价值"]}),t.jsx(w,{type:"monotone",dataKey:"value",stroke:"#8884d8",fillOpacity:1,fill:"url(#colorValue)"})]})})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"rounded-xl p-6 "+(a?"bg-gray-700 border border-gray-600":"bg-white border border-gray-200"),children:[t.jsx("h4",{className:"font-medium mb-4",children:"IP类型分布"}),t.jsx("div",{className:"h-64",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(m,{children:[t.jsx(g,{data:V,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"count",label:({name:e,percent:t})=>`${e} ${(100*t).toFixed(0)}%`,children:V.map((e,s)=>t.jsx(h,{fill:["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57"][s%5]},`cell-${s}`))}),t.jsx(u,{contentStyle:{backgroundColor:a?"#1f2937":"#ffffff",borderColor:a?"#374151":"#e5e7eb",color:a?"#f3f4f6":"#111827"}}),t.jsx(_,{})]})})})]}),t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},className:"rounded-xl p-6 "+(a?"bg-gray-700 border border-gray-600":"bg-white border border-gray-200"),children:[t.jsx("h4",{className:"font-medium mb-4",children:"IP孵化阶段分布"}),t.jsx("div",{className:"h-64",children:t.jsx(d,{width:"100%",height:"100%",children:t.jsxs(x,{data:[{name:"创意设计",value:c.filter(e=>e.stages[0].completed).length},{name:"版权存证",value:c.filter(e=>e.stages[1].completed).length},{name:"IP孵化",value:c.filter(e=>e.stages[2].completed).length},{name:"商业合作",value:c.filter(e=>e.stages[3].completed).length},{name:"收益分成",value:c.filter(e=>e.stages[4].completed).length}],children:[t.jsx(y,{strokeDasharray:"3 3",stroke:a?"#374151":"#e5e7eb"}),t.jsx(b,{dataKey:"name",stroke:a?"#9ca3af":"#6b7280"}),t.jsx(f,{stroke:a?"#9ca3af":"#6b7280"}),t.jsx(u,{contentStyle:{backgroundColor:a?"#1f2937":"#ffffff",borderColor:a?"#374151":"#e5e7eb",color:a?"#f3f4f6":"#111827"}}),t.jsx(v,{dataKey:"value",fill:"#8884d8"})]})})})]})]})]})]})}},Symbol.toStringTag,{value:"Module"})),rt=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isDark:a}=k(),[r,n]=e.useState([]),[l,o]=e.useState([]),[c,d]=e.useState("idle"),[m]=e.useState(3),[g,h]=e.useState(!0);e.useEffect(()=>{h(!0),setTimeout(()=>{n([{id:1,name:"我的MacBook",type:"computer",lastActive:"5分钟前",status:"online",lastSynced:"今天 14:30",batteryLevel:75},{id:2,name:"我的iPhone",type:"mobile",lastActive:"30分钟前",status:"offline",lastSynced:"今天 14:15",batteryLevel:45},{id:3,name:"我的iPad",type:"tablet",lastActive:"2小时前",status:"offline",lastSynced:"今天 12:45",batteryLevel:60}]),o([{id:1,title:"国潮插画设计",type:"插画",device:"我的MacBook",syncedAt:"今天 14:30",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Synced%20content%20example%201"},{id:2,title:"传统纹样创新",type:"纹样",device:"我的iPad",syncedAt:"今天 12:45",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Synced%20content%20example%202"},{id:3,title:"老字号品牌视觉",type:"品牌设计",device:"我的iPhone",syncedAt:"今天 14:15",thumbnail:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Synced%20content%20example%203"}]),h(!1)},800)},[]);const p=e=>{switch(e){case"computer":return"laptop";case"mobile":return"mobile-alt";case"tablet":return"tablet-alt";default:return"device"}},u=e=>{switch(e){case"online":return"bg-green-500";case"offline":default:return"bg-gray-500";case"syncing":return"bg-blue-500"}};return g?t.jsx("div",{className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:`h-8 w-1/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:`h-12 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsxs("div",{className:"flex items-center p-3 rounded-xl bg-gray-100 dark:bg-gray-700 animate-pulse",children:[t.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-300 dark:bg-gray-600 mr-4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 w-1/3 bg-gray-300 dark:bg-gray-600 rounded mb-2"}),t.jsx("div",{className:"h-3 w-1/4 bg-gray-300 dark:bg-gray-600 rounded"})]})]},e))}),t.jsx("div",{className:`h-8 w-1/4 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(e=>t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:`h-32 rounded-xl ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`}),t.jsx("div",{className:`h-4 w-2/3 rounded ${a?"bg-gray-700":"bg-gray-200"} animate-pulse`})]},e))})]})}):t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`p-6 rounded-2xl ${a?"bg-gray-800":"bg-white"} shadow-md`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-xl font-bold",children:"多终端协同"}),t.jsx("button",{onClick:()=>{d("syncing"),setTimeout(()=>{d("synced"),i.success("所有设备同步完成！"),setTimeout(()=>{d("idle")},5e3)},2e3)},disabled:"syncing"===c,className:"px-4 py-2 rounded-lg text-sm flex items-center transition-colors "+("syncing"===c?"bg-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:"syncing"===c?t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"同步中..."]}):"synced"===c?t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-check mr-2"}),"已同步"]}):t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-sync-alt mr-2"}),"立即同步"]})})]}),t.jsx(s.div,{className:"p-4 rounded-xl mb-8 "+("syncing"===c?"bg-blue-500 bg-opacity-10 border border-blue-200":"synced"===c?"bg-green-500 bg-opacity-10 border border-green-200":a?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[t.jsxs("div",{className:"flex items-center mb-4 md:mb-0",children:[t.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center mr-3 "+("syncing"===c?"bg-blue-100 text-blue-600":"synced"===c?"bg-green-100 text-green-600":a?"bg-gray-600":"bg-gray-200"),children:"syncing"===c?t.jsx("i",{className:"fas fa-spinner fa-spin"}):"synced"===c?t.jsx("i",{className:"fas fa-check"}):t.jsx("i",{className:"fas fa-cloud-sync-alt"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-1",children:"syncing"===c?"正在同步数据...":"synced"===c?"所有设备已同步":"数据同步就绪"}),t.jsx("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:"syncing"===c?"请勿关闭此页面，等待同步完成":"synced"===c?"最近同步时间: 今天 14:30":"上次同步: 今天 14:30"})]})]}),t.jsxs("div",{className:"flex items-center px-3 py-1.5 rounded-full text-sm "+(a?"bg-gray-700":"bg-gray-100"),children:[t.jsx("i",{className:"fas fa-paper-plane mr-1.5 text-blue-500"}),t.jsxs("span",{children:[m," 个作品待同步"]})]})]})}),t.jsx("h4",{className:"font-medium mb-4",children:"已连接设备"}),t.jsx("div",{className:"space-y-4 mb-8",children:r.map(e=>t.jsx(s.div,{className:`p-4 rounded-xl ${a?"bg-gray-700":"bg-gray-50"} border ${a?"border-gray-600":"border-gray-200"} transition-all hover:shadow-md`,whileHover:{y:-2},children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:"relative mr-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+(a?"bg-gray-600":"bg-gray-100"),children:t.jsx("i",{className:`fas fa-${p(e.type)} text-xl`})}),t.jsx("span",{className:`absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-white ${u(e.status)}`})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center mb-1",children:[t.jsx("h5",{className:"font-medium mr-2",children:e.name}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(a?"bg-gray-600":"bg-gray-100"),children:"computer"===e.type?"电脑":"mobile"===e.type?"手机":"平板"})]}),t.jsxs("div",{className:"flex text-xs opacity-70",children:[t.jsxs("span",{className:"mr-3",children:["最后活跃: ",e.lastActive]}),e.lastSynced&&t.jsxs("span",{children:["最后同步: ",e.lastSynced]})]})]}),void 0!==e.batteryLevel&&t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsxs("div",{className:"text-sm mb-1",children:[t.jsx("i",{className:`fas fa-battery-${e.batteryLevel>70?"three-quarters":e.batteryLevel>50?"half":e.batteryLevel>20?"quarter":"empty"} ${e.batteryLevel<20?"text-red-500":""}`}),t.jsxs("span",{className:"ml-1",children:[e.batteryLevel,"%"]})]}),t.jsx("button",{className:`px-3 py-1 rounded-lg text-xs ${a?"bg-gray-600 hover:bg-gray-500":"bg-gray-200 hover:bg-gray-300"} transition-colors`,children:"同步"})]})]})})},e.id))}),t.jsx("h4",{className:"font-medium mb-4",children:"最近同步内容"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:l.map(e=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-md border "+(a?"border-gray-700":"border-gray-200"),whileHover:{y:-5},children:[t.jsx("img",{src:e.thumbnail,alt:e.title,className:"w-full h-32 object-cover"}),t.jsxs("div",{className:"p-3 "+(a?"bg-gray-700":"bg-white"),children:[t.jsx("h5",{className:"font-medium mb-1",children:e.title}),t.jsxs("div",{className:"flex justify-between text-xs opacity-70",children:[t.jsx("span",{children:e.type}),t.jsx("span",{children:e.device})]}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:e.syncedAt})]})]},e.id))})]})}},Symbol.toStringTag,{value:"Module"})),nt=new class{blindBoxes=[{id:"1",name:"创意新手盲盒",description:"适合新手的入门盲盒，包含基础创作资源",price:50,rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=creative%20blind%20box%20design",available:!0,totalCount:1e3,remainingCount:850},{id:"2",name:"文化传承盲盒",description:"包含传统文化元素的盲盒，适合喜欢文化创作的用户",price:100,rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20traditional%20culture%20blind%20box",available:!0,totalCount:500,remainingCount:320},{id:"3",name:"大师之作盲盒",description:"包含知名创作者作品的高级盲盒，有机会获得稀有资源",price:200,rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=masterpiece%20blind%20box%20premium%20design",available:!0,totalCount:200,remainingCount:85},{id:"4",name:"传奇典藏盲盒",description:"限量版盲盒，包含稀有度极高的创作资源和成就",price:500,rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=legendary%20collection%20blind%20box%20golden%20design",available:!0,totalCount:50,remainingCount:12}];blindBoxContents=[{id:"c1",type:"素材",name:"水墨风格背景",description:"传统水墨风格的创作背景",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20ink%20painting%20background",value:20,unlockable:!0},{id:"c2",type:"模板",name:"国潮海报模板",description:"适合国潮风格的海报设计模板",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20trend%20poster%20template",value:30,unlockable:!0},{id:"c3",type:"作品",name:"古风插画",description:"精美的古风插画作品",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=ancient%20chinese%20style%20illustration",value:40,creator:"古风大师",unlockable:!0},{id:"c4",type:"素材",name:"传统纹样",description:"中国传统纹样集合",rarity:"common",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=traditional%20chinese%20patterns",value:25,unlockable:!0},{id:"r1",type:"模板",name:"非遗文化模板",description:"包含非遗文化元素的高级模板",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=intangible%20cultural%20heritage%20template",value:80,unlockable:!0},{id:"r2",type:"作品",name:"大师级书法",description:"知名书法家的书法作品",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=master%20calligraphy%20work",value:120,creator:"书法大师",unlockable:!0},{id:"r3",type:"素材",name:"3D文化资产",description:"可用于3D创作的文化资产",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=3D%20chinese%20cultural%20asset",value:100,unlockable:!0},{id:"r4",type:"成就",name:"盲盒收藏家",description:"开启10个盲盒获得的成就",rarity:"rare",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=blind%20box%20collector%20achievement",value:0,unlockable:!1},{id:"e1",type:"作品",name:"国潮IP设计",description:"完整的国潮IP设计方案",rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=chinese%20trend%20IP%20design",value:300,creator:"IP设计师",unlockable:!0},{id:"e2",type:"模板",name:"品牌合作模板",description:"与知名品牌合作的限定模板",rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=brand%20collaboration%20template",value:250,unlockable:!0},{id:"e3",type:"素材",name:"动态文化素材",description:"可用于动画的动态文化素材",rarity:"epic",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=dynamic%20chinese%20cultural%20material",value:200,unlockable:!0},{id:"l1",type:"作品",name:"典藏级国画",description:"具有收藏价值的国画作品",rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=collection%20level%20chinese%20painting",value:1e3,creator:"国画大师",unlockable:!0},{id:"l2",type:"成就",name:"传奇收藏家",description:"开启50个盲盒获得的传奇成就",rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=legendary%20collector%20achievement",value:0,unlockable:!1},{id:"l3",type:"模板",name:"定制化创作模板",description:"可定制的高级创作模板",rarity:"legendary",image:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=customizable%20premium%20template",value:800,unlockable:!0}];openingHistory=[];userCollections=new Map;getAllBlindBoxes(){return[...this.blindBoxes]}getBlindBoxById(e){return this.blindBoxes.find(t=>t.id===e)}purchaseBlindBox(e,t){const s=this.getBlindBoxById(e);return!!(s&&s.available&&s.remainingCount>0)&&(s.remainingCount--,0===s.remainingCount&&(s.available=!1),!0)}generateRandomContent(e){const t={common:{common:.7,rare:.25,epic:.04,legendary:.01},rare:{common:.4,rare:.45,epic:.1,legendary:.05},epic:{common:.2,rare:.3,epic:.4,legendary:.1},legendary:{common:.1,rare:.2,epic:.3,legendary:.4}}[e],s=Math.random();let a="common",i=0;for(const[n,l]of Object.entries(t))if(i+=l,s<=i){a=n;break}const r=this.blindBoxContents.filter(e=>e.rarity===a);return{...r[Math.floor(Math.random()*r.length)]}}openBlindBox(e,t){const s=this.getBlindBoxById(e);if(!s||void 0===s.available)return null;const a=this.generateRandomContent(s.rarity),i={blindBox:{...s},content:a,isNew:!0,timestamp:new Date};return this.openingHistory.push(i),i}getOpeningHistory(e){return[...this.openingHistory]}getUserBlindBoxContents(e){const t=[];return this.openingHistory.forEach(e=>{t.some(t=>t.id===e.content.id)||t.push(e.content)}),t}toggleCollection(e,t){this.userCollections.has(e)||this.userCollections.set(e,new Set);const s=this.userCollections.get(e);return s.has(t)?(s.delete(t),!1):(s.add(t),!0)}isContentCollected(e,t){const s=this.userCollections.get(e);return!!s&&s.has(t)}getUserCollections(e){const t=this.userCollections.get(e);return t&&0!==t.size?this.blindBoxContents.filter(e=>t.has(e.id)):[]}getCollectionCount(e){const t=this.userCollections.get(e);return t?t.size:0}},lt=({blindBox:e,onPurchase:a,isDark:i})=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-lg transition-all hover:shadow-xl "+(i?"bg-gray-800":"bg-white"),whileHover:{y:-5},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[t.jsxs("div",{className:"relative",children:[t.jsx(L,{src:e.image,alt:e.name,className:"w-full h-48 object-cover",loading:"lazy"}),t.jsxs("div",{className:"absolute top-2 right-2 px-3 py-1 rounded-full text-sm font-medium "+(i?"bg-gray-700":"bg-white"),children:["common"===e.rarity&&"普通","rare"===e.rarity&&"稀有","epic"===e.rarity&&"史诗","legendary"===e.rarity&&"传奇"]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-lg font-bold mb-1",children:e.name}),t.jsx("p",{className:"text-sm mb-3 "+(i?"text-gray-400":"text-gray-600"),children:e.description}),t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsxs("div",{className:"text-red-600 font-bold",children:[e.price," 积分"]}),t.jsxs("div",{className:"text-xs "+(i?"text-gray-400":"text-gray-600"),children:["剩余: ",e.remainingCount,"/",e.totalCount]})]}),t.jsx("button",{onClick:()=>a(e),disabled:!e.available,className:"w-full py-2 rounded-lg font-medium transition-colors "+(e.available?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-500 cursor-not-allowed text-white"),children:e.available?"立即购买":"已售罄"})]})]}),ot=({result:e,onClose:a,isDark:i,onToggleCollection:r,isCollected:n})=>t.jsx(s.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:t.jsxs(s.div,{className:"rounded-2xl p-8 max-w-md w-full "+(i?"bg-gray-800":"bg-white"),initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:20},children:[t.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"恭喜你获得！"}),t.jsxs(s.div,{className:"flex flex-col items-center mb-6",initial:{rotateY:180,opacity:0},animate:{rotateY:0,opacity:1},transition:{delay:.3,duration:.6},children:[t.jsx(s.div,{className:"absolute -top-10 -right-10 w-40 h-40 bg-yellow-500 rounded-full opacity-50",animate:{scale:[1,1.5,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),t.jsxs("div",{className:"w-48 h-48 rounded-full overflow-hidden border-4 border-yellow-500 mb-4 relative",children:[t.jsx(s.div,{className:"absolute inset-0 rounded-full border-4 border-transparent bg-gradient-to-r from-red-500 via-yellow-500 to-purple-500",animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"}}),t.jsx(L,{src:e.content.image,alt:e.content.name,className:"w-full h-full object-cover relative z-10"})]}),t.jsx("h3",{className:"text-xl font-bold mb-2",children:e.content.name}),t.jsx("p",{className:"text-center mb-3 "+(i?"text-gray-400":"text-gray-600"),children:e.content.description}),t.jsxs("div",{className:`px-4 py-1 rounded-full text-sm font-medium ${i?"bg-gray-700":"bg-gray-100"} mb-4`,children:["common"===e.content.rarity&&"普通","rare"===e.content.rarity&&"稀有","epic"===e.content.rarity&&"史诗","legendary"===e.content.rarity&&"传奇"]}),t.jsxs(s.button,{onClick:()=>r(e.content.id),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all "+(n?"bg-red-600 text-white hover:bg-red-700":i?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx("i",{className:"fas fa-heart",style:{color:n?"#ffffff":"#ff6b6b"}}),n?"已收藏":"收藏"]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:a,className:"flex-1 py-3 rounded-lg font-medium transition-colors "+(i?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:"关闭"}),t.jsx("button",{onClick:a,className:"flex-1 py-3 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white transition-colors",children:"再开一个"})]})]})}),ct=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{isDark:a}=k(),[r,n]=e.useState(()=>nt.getAllBlindBoxes()),[l,o]=e.useState(null),[c,d]=e.useState(!1),[m,g]=e.useState(null),[h,p]=e.useState(!1),[u,x]=e.useState([]),y="current-user",b=e=>{nt.purchaseBlindBox(e.id,y)?(o(e),d(!0),setTimeout(()=>{const t=nt.openBlindBox(e.id,y);t&&(g(t),d(!1),n(nt.getAllBlindBoxes()),v(),i.success("盲盒开启成功！"))},2e3)):i.error("盲盒购买失败，请稍后重试")},f=e=>{nt.toggleCollection(y,e),v(),i.success(nt.isContentCollected(y,e)?"收藏成功！":"取消收藏成功！")},v=()=>{const e=nt.getUserCollections(y);x(e)};e.useEffect(()=>{v()},[]);const j=({content:e})=>t.jsxs(s.div,{className:"rounded-xl overflow-hidden shadow-lg transition-all hover:shadow-xl "+(a?"bg-gray-800":"bg-white"),whileHover:{y:-5},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[t.jsxs("div",{className:"relative",children:[t.jsx(L,{src:e.image,alt:e.name,className:"w-full h-40 object-cover",loading:"lazy"}),t.jsxs("div",{className:"absolute top-2 right-2 px-3 py-1 rounded-full text-sm font-medium "+(a?"bg-gray-700":"bg-white"),children:["common"===e.rarity&&"普通","rare"===e.rarity&&"稀有","epic"===e.rarity&&"史诗","legendary"===e.rarity&&"传奇"]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-lg font-bold mb-1",children:e.name}),t.jsx("p",{className:"text-sm mb-3 "+(a?"text-gray-400":"text-gray-600"),children:e.description}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("div",{className:"text-sm font-medium",children:e.type}),t.jsxs("button",{onClick:()=>f(e.id),className:"text-sm transition-colors "+(a?"hover:text-red-400":"hover:text-red-600"),children:[t.jsx("i",{className:"fas fa-heart",style:{color:"#ff6b6b"}})," 取消收藏"]})]})]})]});return t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsxs("div",{className:"mb-8 text-center",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"作品盲盒商店"}),t.jsx("p",{className:a?"text-gray-400":"text-gray-600",children:"开启盲盒，发现惊喜创作资源！每个盲盒都有机会获得稀有作品、模板和素材"}),t.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[t.jsx("button",{onClick:()=>p(!1),className:"px-6 py-2 rounded-full text-sm font-medium transition-all "+(h?a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200":"bg-red-600 text-white hover:bg-red-700"),children:"盲盒商店"}),t.jsxs("button",{onClick:()=>p(!0),className:"px-6 py-2 rounded-full text-sm font-medium transition-all "+(h?"bg-red-600 text-white hover:bg-red-700":a?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:["我的收藏 (",nt.getCollectionCount(y),")"]})]})]}),t.jsx("div",{className:"mb-8",children:h?t.jsx("div",{children:0===u.length?t.jsxs("div",{className:`rounded-xl p-8 text-center ${a?"bg-gray-800":"bg-white"} shadow-lg`,children:[t.jsx("i",{className:"fas fa-heart-broken text-6xl text-red-600 mb-4"}),t.jsx("h3",{className:"text-xl font-bold mb-2",children:"还没有收藏的内容"}),t.jsx("p",{className:"mb-4 "+(a?"text-gray-400":"text-gray-600"),children:"开启盲盒获得内容后，可以收藏喜欢的作品、模板和素材"}),t.jsx("button",{onClick:()=>p(!1),className:"px-6 py-2 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white transition-colors",children:"去开启盲盒"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:"text-xl font-bold mb-4",children:["我的收藏 (",u.length,")"]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map(e=>t.jsx(j,{content:e},e.id))})]})}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:r.map(e=>t.jsx(lt,{blindBox:e,onPurchase:b,isDark:a},e.id))})}),c&&t.jsx(s.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",initial:{opacity:0},animate:{opacity:1},children:t.jsxs("div",{className:"text-center",children:[t.jsxs(s.div,{className:"relative w-40 h-40 mb-6",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:20},children:[t.jsx(s.div,{className:"absolute inset-0 rounded-full bg-gradient-to-r from-red-500 via-purple-500 to-blue-500 opacity-70",animate:{scale:[1,1.2,1],opacity:[.7,.3,.7]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),t.jsxs(s.div,{className:"w-40 h-40 rounded-2xl bg-gradient-to-br from-red-500 to-purple-600 flex items-center justify-center relative z-10",animate:{rotate:360,scale:[1,1.05,1]},transition:{rotate:{duration:1,repeat:1/0,ease:"linear"},scale:{duration:1,repeat:1/0,ease:"easeInOut"}},children:[t.jsx(s.div,{className:"absolute top-0 left-0 w-full h-20 bg-gradient-to-b from-purple-600 to-red-500 rounded-t-2xl",animate:{y:[0,-10,0]},transition:{duration:1,repeat:1/0,ease:"easeInOut"}}),t.jsx("div",{className:"w-24 h-24 rounded-full bg-white flex items-center justify-center relative z-20",children:t.jsx("span",{className:"text-red-600 text-3xl font-bold",children:"?"})})]})]}),t.jsxs(s.h3,{className:`text-xl font-bold ${a?"text-white":"text-black"} mb-2`,animate:{scale:[1,1.1,1]},transition:{duration:1,repeat:1/0,ease:"easeInOut"},children:["正在开启 ",l?.name,"..."]}),t.jsx("div",{className:"w-64 h-2 bg-gray-600 rounded-full overflow-hidden mx-auto",children:t.jsx(s.div,{className:"h-full bg-red-600",initial:{width:0},animate:{width:"100%"},transition:{duration:2,ease:"linear"}})})]})}),m&&t.jsx(ot,{result:m,onClose:()=>{g(null)},isDark:a,onToggleCollection:f,isCollected:nt.isContentCollected(y,m.content.id)}),t.jsxs("div",{className:"rounded-xl p-6 "+(a?"bg-gray-800":"bg-gray-50"),children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"盲盒规则说明"}),t.jsxs("ul",{className:"space-y-2 "+(a?"text-gray-300":"text-gray-700"),children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),t.jsx("span",{children:"盲盒包含作品、模板、素材和成就等多种内容"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),t.jsx("span",{children:"不同稀有度的盲盒对应不同品质的内容，传奇盲盒有机会获得典藏级作品"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),t.jsx("span",{children:"每个盲盒数量有限，售完即止"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("i",{className:"fas fa-star text-yellow-500 mt-1 mr-2"}),t.jsx("span",{children:"开启的内容将自动添加到您的创作资源库中"})]})]})]})]})}},Symbol.toStringTag,{value:"Module"})),dt=Object.freeze(Object.defineProperty({__proto__:null,default:({isOpen:a,onClose:r,onSubmit:n})=>{const{isDark:l}=k(),[o,c]=e.useState({rating:5,feedbackType:"feature",comments:""}),[d,m]=e.useState(!1),[g,h]=e.useState(null),p=e=>{const{name:t,value:s}=e.target;c(e=>({...e,[t]:"rating"===t?parseInt(s):s}))};if(!a)return null;const u=g||o.rating;return t.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${l?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,onClick:()=>r(),children:t.jsxs(s.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:`rounded-2xl ${l?"bg-gray-800 text-white":"bg-white text-gray-900"} shadow-xl max-w-md w-full mx-4 overflow-hidden flex flex-col`,onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:`p-6 border-b ${l?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[t.jsx("h3",{className:"text-xl font-bold",children:"满意度调查"}),t.jsx("button",{onClick:r,className:`p-2 rounded-full ${l?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m(!0);try{await new Promise(e=>setTimeout(e,800)),n(o),i.success("感谢您的反馈！您的评价对我们很重要。"),r(),c({rating:5,feedbackType:"feature",comments:""})}catch(t){i.error("提交失败，请稍后重试。")}finally{m(!1)}},className:"p-6 space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h4",{className:"text-lg font-medium mb-2",children:"请评价您的使用体验"}),t.jsx("p",{className:(l?"text-gray-400":"text-gray-600")+" text-sm",children:"您的反馈将帮助我们持续改进产品"})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:"flex items-center justify-center gap-2 mb-2",children:[1,2,3,4,5].map(e=>t.jsx("button",{type:"button",onClick:()=>{return t=e,void c(e=>({...e,rating:t}));var t},onMouseEnter:()=>{h(e)},onMouseLeave:()=>h(null),className:"text-4xl transition-colors","aria-label":`${e} 星`,children:t.jsx("i",{className:"fas fa-star "+((g||o.rating)>=e?"text-yellow-400":l?"text-gray-600":"text-gray-300")})},e))}),t.jsx("p",{className:"text-sm font-medium "+(l?"text-gray-300":"text-gray-700"),children:(x=u,{1:"非常不满意",2:"不满意",3:"一般",4:"满意",5:"非常满意"}[x])})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"反馈类型"}),t.jsx("select",{name:"feedbackType",value:o.feedbackType,onChange:p,className:`w-full px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}\n                focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[{value:"feature",label:"功能建议"},{value:"usability",label:"易用性"},{value:"performance",label:"性能"},{value:"design",label:"设计"},{value:"other",label:"其他"}].map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"详细反馈（可选）"}),t.jsx("textarea",{name:"comments",value:o.comments,onChange:p,placeholder:"请分享您的具体体验或建议",rows:4,className:`w-full px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}\n                focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none`})]}),t.jsx("button",{type:"submit",disabled:d,className:`w-full py-3 rounded-lg transition-colors ${l?"bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600":"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300"}\n              text-white font-medium disabled:cursor-not-allowed flex items-center justify-center gap-2`,children:d?t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-spinner fa-spin"}),"提交中..."]}):t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-paper-plane"}),"提交评价"]})})]})]})});var x}},Symbol.toStringTag,{value:"Module"}));function mt({items:s,renderItem:a,columns:i=3,isDark:r}){const[n,l]=e.useState(i);return e.useEffect(()=>{const e=()=>{if("undefined"==typeof window)return;let e=i;e=window.innerWidth<640?1:window.innerWidth<768?2:window.innerWidth<1024?3:window.innerWidth<1280?4:Math.min(i,5),l(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[i]),t.jsxs("div",{className:r?"bg-gray-900":"bg-white",style:{scrollbarWidth:"thin",scrollbarColor:r?"#4a5568 #1f2937":"#d1d5db #f3f4f6",WebkitOverflowScrolling:"touch",scrollBehavior:"smooth",overflow:"visible"},children:[t.jsx("div",{className:"grid gap-4 p-2",style:{gridTemplateColumns:`repeat(${n}, 1fr)`},children:s.map((s,i)=>t.jsx(e.Fragment,{children:a(s,i)},i))}),t.jsx("style",{children:`\n        /* 滚动条样式 */\n        body::-webkit-scrollbar {\n          width: 8px;\n        }\n        body::-webkit-scrollbar-track {\n          background: ${r?"#1f2937":"#f3f4f6"};\n          border-radius: 4px;\n        }\n        body::-webkit-scrollbar-thumb {\n          background: ${r?"#4a5568":"#d1d5db"};\n          border-radius: 4px;\n        }\n        body::-webkit-scrollbar-thumb:hover {\n          background: ${r?"#718096":"#9ca3af"};\n        }\n      `})]})}const gt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"})),ht=e.memo(({post:s,index:a,onPostClick:i,onLike:r,isDark:n})=>{const l=e.useCallback(()=>{i(s)},[i,s]),o=n?"bg-gray-800 hover:bg-gray-700":"bg-white hover:bg-gray-50";return t.jsxs("div",{className:`${o} rounded-lg shadow-md overflow-hidden cursor-pointer transition-all duration-300 transform hover:scale-105`,onClick:l,children:[t.jsxs("div",{className:"relative aspect-square",children:[t.jsx(E,{src:s.thumbnail,alt:s.title,className:"w-full h-full object-cover",priority:a<3,quality:a<6?"high":"medium",ratio:"square",fit:"cover",loading:"lazy",sizes:"(max-width: 640px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, (max-width: 1280px) 25vw, 20vw"}),t.jsxs("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-sm",children:[s.likes," ❤️"]})]}),t.jsxs("div",{className:"p-2 sm:p-3",children:[t.jsx("h3",{className:"font-semibold text-sm sm:text-base mb-1 line-clamp-2",children:s.title}),t.jsxs("div",{className:"flex justify-between items-center text-xs sm:text-sm text-gray-500",children:[t.jsx("span",{children:s.category}),t.jsxs("span",{children:[s.likes," ❤️"]})]})]})]})}),pt=e.memo(({posts:s,onPostClick:a,onLike:i,onComment:r,isDark:n})=>{const[l,o]=e.useState(3),c=e.useRef(null);e.useEffect(()=>{const e=()=>{if("undefined"==typeof window)return;let e=3;e=window.innerWidth<640?1:window.innerWidth<768?2:window.innerWidth<1024?3:window.innerWidth<1280?4:5,o(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const d=l>3?250:300,m=e.useCallback(e=>{a(e)},[a]),g=e.useCallback((e,s)=>t.jsx(ht,{post:e,index:s,onPostClick:m,onLike:i,isDark:n},e.id),[m,n,i]);return s.length<20?t.jsx("div",{className:"w-full",children:t.jsx("div",{className:"grid gap-4 p-2",style:{gridTemplateColumns:`repeat(${l}, 1fr)`},children:s.map((e,s)=>t.jsx(ht,{post:e,index:s,onPostClick:m,onLike:i,isDark:n},e.id))})}):t.jsx("div",{ref:c,className:"w-full",style:{minHeight:"500px"},children:t.jsx(mt,{items:s,renderItem:g,columns:l,isDark:n,height:"auto",itemHeight:d,overscan:5})})}),ut=Object.freeze(Object.defineProperty({__proto__:null,default:pt},Symbol.toStringTag,{value:"Module"})),xt=Object.freeze(Object.defineProperty({__proto__:null,CommunityDiscussion:({isDark:a,threads:r,onThreadsChange:n,mode:l,selectedStyle:o,selectedTopic:c,newTitle:d,onNewTitleChange:m,newContent:g,onNewContentChange:h,threadSearch:p,onThreadSearchChange:u,threadSort:x,onThreadSortChange:y,favOnly:b,onFavOnlyChange:f,favoriteThreads:v,onFavoriteThreadsChange:j,replyText:N,onReplyTextChange:w,threadDraft:_,onThreadDraftChange:k,hotTopics:S,STYLE_LIST:C,TOPIC_LIST:T,onModeChange:E,onSelectedStyleChange:I,onSelectedTopicChange:R,onInsertRandomIdea:D,upvoteGuard:A,onUpvoteGuardChange:P})=>{const[z,$]=e.useState("");e.useEffect(()=>{const e=setTimeout(()=>{$(p.trim())},300);return()=>clearTimeout(e)},[p]);const L=e=>{const t=(N[e]||"").trim();if(!t)return;const s=r.map(s=>s.id===e?{...s,replies:[...s.replies,{id:`r-${Date.now()}`,content:t,createdAt:Date.now()}]}:s);n(s),localStorage.setItem("jmzf_threads",JSON.stringify(s)),w({...N,[e]:""}),i.success("回复已添加")},O=e.useMemo(()=>r.filter(e=>"style"===l?e.topic===o:e.topic===c).filter(e=>!b||v.includes(e.id)).filter(e=>!z||e.title.includes(z)||e.content.includes(z)).sort((e,t)=>{const s=Number(t.pinned)-Number(e.pinned);return 0!==s?s:"new"===x?t.createdAt-e.createdAt:"reply"===x?t.replies.length-e.replies.length:(t.upvotes||0)+t.replies.length-((e.upvotes||0)+e.replies.length)}),[r,l,o,c,b,v,z,x]);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6 rounded-2xl p-4 "+(a?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"),children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[t.jsx("span",{className:"text-sm opacity-70",children:"子社区："}),t.jsx(s.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>E("style"),className:("style"===l?"bg-red-600 text-white":a?"bg-gray-700 text-white":"bg-gray-100 text-gray-900")+" px-3 py-1 rounded-full text-sm transition-colors hover:opacity-90",children:"风格"}),t.jsx(s.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>E("topic"),className:("topic"===l?"bg-red-600 text-white":a?"bg-gray-700 text-white":"bg-gray-100 text-gray-900")+" px-3 py-1 rounded-full text-sm transition-colors hover:opacity-90",children:"题材"})]}),"style"===l?t.jsx("div",{className:"flex flex-wrap gap-2",children:C.map(e=>{const i=r.filter(t=>t.topic===e).length;return t.jsxs(s.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>I(e),className:(o===e?"bg-red-600 text-white":a?"bg-gray-700 text-white":"bg-gray-100 text-gray-900")+" px-3 py-1 rounded-full text-sm flex items-center gap-2 transition-colors hover:opacity-90",children:[t.jsx("span",{children:e}),t.jsx("span",{className:(o===e?"bg-white text-red-600 ring-1 ring-red-200":a?"bg-gray-600 text-white ring-1 ring-gray-700":"bg-gray-300 text-gray-900 ring-1 ring-gray-300")+" text-xs px-2 py-0.5 rounded-full",children:i})]},e)})}):t.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(e=>{const i=r.filter(t=>t.topic===e).length;return t.jsxs(s.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>R(e),className:(c===e?"bg-red-600 text-white":a?"bg-gray-700 text-white":"bg-gray-100 text-gray-900")+" px-3 py-1 rounded-full text-sm flex items-center gap-2 transition-colors hover:opacity-90",children:[t.jsx("span",{children:e}),t.jsx("span",{className:(c===e?"bg-white text-red-600 ring-1 ring-red-200":a?"bg-gray-600 text-white ring-1 ring-gray-700":"bg-gray-300 text-gray-900 ring-1 ring-gray-300")+" text-xs px-2 py-0.5 rounded-full",children:i})]},e)})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[t.jsxs("div",{className:"rounded-2xl p-4 lg:col-span-1 "+(a?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"),children:[t.jsx("div",{className:"font-medium mb-3",children:t.jsx("span",{className:"flex items-center gap-2",children:"🔥 话题热榜"})}),t.jsxs("ul",{children:[S.map(([e,s],i)=>{const r=S.length?S[0][1]:1,n=Math.max(6,Math.round(s/Math.max(1,r)*100));return t.jsxs("li",{className:"py-1 text-sm",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"mr-3",children:[i+1,". ",e]}),t.jsx("span",{className:"opacity-70",children:s})]}),t.jsx("div",{className:(a?"bg-gray-700":"bg-gray-200")+" w-full h-2 rounded-full mt-1",children:t.jsx("div",{style:{width:`${n}%`},className:`h-2 rounded-full ${a?"bg-red-500":"bg-red-600"} transition-all duration-300`})})]},e)}),0===S.length&&t.jsx("li",{className:"text-sm opacity-60",children:"暂无数据"})]})]}),t.jsxs("div",{className:"rounded-2xl p-4 lg:col-span-2 "+(a?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"font-medium",children:["style"===l?o:c," 子社区讨论"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{value:p,onChange:e=>u(e.target.value),className:(a?"bg-gray-700 text-white":"bg-gray-50 text-gray-900")+" px-3 py-1 rounded-lg border text-sm focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",placeholder:"搜索讨论","aria-label":"搜索讨论"}),t.jsxs("select",{value:x,onChange:e=>y(e.target.value),className:(a?"bg-gray-700 text-white":"bg-gray-50 text-gray-900")+" px-3 py-1 rounded-lg border text-sm focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",children:[t.jsx("option",{value:"new",children:"最新"}),t.jsx("option",{value:"reply",children:"最多回复"}),t.jsx("option",{value:"hot",children:"热度"})]}),t.jsx("button",{onClick:()=>f(!b),className:(b?"bg-red-600 text-white":a?"bg-gray-700 text-white":"bg-gray-100 text-gray-900")+" px-3 py-1 rounded-lg text-sm transition-colors",children:b?"只看收藏":"全部"}),t.jsx("button",{onClick:D,className:(a?"bg-gray-700 text-white":"bg-gray-100 text-gray-900")+" px-3 py-1 rounded-lg text-sm transition-colors",children:"随机灵感"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[t.jsx("input",{value:d,onChange:e=>m(e.target.value),className:(a?"bg-gray-700 text-white":"bg-gray-50 text-gray-900")+" px-3 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",placeholder:"帖子标题（如：京剧角色设计打磨建议）","aria-label":"帖子标题"}),t.jsx("button",{onClick:()=>{const e=d.trim(),t=g.trim();if(!e||!t)return;if(["广告","违规"].some(s=>e.includes(s)||t.includes(s)))return;const s=[{id:`t-${Date.now()}`,title:e,content:t,createdAt:Date.now(),replies:[],topic:"style"===l?o:c,upvotes:0},...r];n(s),localStorage.setItem("jmzf_threads",JSON.stringify(s)),m(""),h(""),i.success("帖子已发布")},disabled:!d.trim()||!g.trim(),"aria-disabled":!d.trim()||!g.trim(),className:"px-3 py-2 rounded-lg transition-colors "+(d.trim()&&g.trim()?"bg-red-600 text-white hover:bg-red-700 shadow-sm":a?"bg-gray-600 text-gray-300":"bg-gray-300 text-gray-600"),children:"发布新帖"})]}),_&&(_.title||_.content)&&t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:(a?"text-gray-400":"text-gray-600")+" text-xs",children:"检测到草稿，可恢复上一编辑"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>{_&&(m(_.title||""),h(_.content||""),_.mode&&(E(_.mode),"style"===_.mode&&_.selected&&I(_.selected),"topic"===_.mode&&_.selected&&R(_.selected)))},className:`${a?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${a?"ring-gray-700":"ring-gray-200"}`,children:"恢复草稿"}),t.jsx("button",{onClick:()=>{k(null);try{localStorage.removeItem("jmzf_thread_draft")}catch{}},className:`${a?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${a?"ring-gray-700":"ring-gray-200"}`,children:"清除草稿"})]})]}),t.jsx("textarea",{value:g,onChange:e=>h(e.target.value),className:(a?"bg-gray-700 text-white":"bg-gray-50 text-gray-900")+" w-full h-24 px-3 py-2 rounded-lg border mb-4 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",placeholder:"详细内容"}),t.jsxs("div",{className:"space-y-3",children:[O.map(e=>t.jsxs(s.div,{whileHover:{y:-2},className:(a?"bg-gray-700 ring-1 ring-gray-700":"bg-gray-50 ring-1 ring-gray-200")+" rounded-xl p-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"font-medium",children:[e.title,e.pinned&&t.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-red-600 text-white",children:"置顶"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:()=>(e=>{if(A[e])return void i.info("已点过赞");const t=r.map(t=>t.id===e?{...t,upvotes:(t.upvotes||0)+1}:t);n(t),localStorage.setItem("jmzf_threads",JSON.stringify(t));const s={...A,[e]:!0};P(s),localStorage.setItem("jmzf_upvote_guard",JSON.stringify(s))})(e.id),"aria-label":"点赞帖子",className:"px-3 py-1 rounded-lg text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",children:["点赞 ",e.upvotes||0]}),t.jsx("button",{onClick:()=>(e=>{const t=v.includes(e)?v.filter(t=>t!==e):[e,...v];j(t)})(e.id),"aria-label":"收藏帖子",className:`${v.includes(e.id)?"bg-blue-600 text-white":a?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${a?"ring-gray-700":"ring-gray-200"} transition-colors`,children:v.includes(e.id)?"已收藏":"收藏"}),t.jsx("button",{onClick:()=>(e=>{const t=r.map(t=>t.id===e?{...t,pinned:!t.pinned}:t);n(t),localStorage.setItem("jmzf_threads",JSON.stringify(t)),i.success("置顶状态已更新")})(e.id),"aria-label":e.pinned?"取消置顶":"置顶",className:`${a?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${a?"ring-gray-700":"ring-gray-200"} transition-colors`,children:e.pinned?"取消置顶":"置顶"}),t.jsx("button",{onClick:()=>(e=>{const t=r.filter(t=>t.id!==e);n(t),localStorage.setItem("jmzf_threads",JSON.stringify(t)),i.success("帖子已删除")})(e.id),"aria-label":"删除帖子",className:`${a?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${a?"ring-gray-700":"ring-gray-200"} transition-colors`,children:"删除"})]})]}),t.jsx("div",{className:"text-sm opacity-80 mt-1 "+(a?"text-gray-300":"text-gray-700"),children:e.content}),t.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[t.jsx("input",{value:N[e.id]||"",onChange:t=>w({...N,[e.id]:t.target.value}),onKeyDown:t=>{"Enter"!==t.key||t.shiftKey||(t.preventDefault(),L(e.id))},className:(a?"bg-gray-800 text-white":"bg-white text-gray-900")+" flex-1 px-3 py-1 rounded-lg border focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",placeholder:"回复内容","aria-label":"回复内容"}),t.jsx("button",{onClick:()=>L(e.id),"aria-label":"添加回复",className:(a?"bg-gray-800 text-white":"bg-gray-100 text-gray-900")+" px-3 py-1 rounded-lg text-xs hover:opacity-90 transition-colors",children:"回复"})]}),e.replies.length>0&&t.jsx("div",{className:"mt-3 text-sm",children:e.replies.map(s=>t.jsxs("div",{className:(a?"border-gray-700":"border-gray-200")+" border-t py-2 flex items-center justify-between",children:[t.jsx("span",{children:s.content}),t.jsx("button",{onClick:()=>((e,t)=>{const s=r.map(s=>s.id===e?{...s,replies:s.replies.filter(e=>e.id!==t)}:s);n(s),localStorage.setItem("jmzf_threads",JSON.stringify(s)),i.success("回复已删除")})(e.id,s.id),"aria-label":"删除回复",className:`${a?"bg-gray-800 text-white":"bg-white text-gray-900"} px-2 py-0.5 rounded-lg text-xs ring-1 ${a?"ring-gray-700":"ring-gray-200"} transition-colors`,children:"删除"})]},s.id))})]},e.id)),0===O.length&&t.jsx("div",{className:"text-sm opacity-60",children:"暂无讨论，发布第一条吧～"})]})]})]})]})},DiscussionSection:({isDark:s,messages:a,onSend:i,showModeration:r,onDelete:n,onTogglePin:l})=>{const[o,c]=e.useState(""),d=()=>{o.trim()&&(i(o.trim()),c(""))};return t.jsxs("div",{children:[t.jsx("div",{className:"space-y-3 mb-4 max-h-72 overflow-y-auto pr-1",children:0===a.length?t.jsx("div",{className:"text-sm opacity-60 text-center py-4",children:"暂无消息，快来发第一条消息吧！"}):a.map(e=>t.jsx("div",{className:"p-3 rounded-xl "+(s?"bg-gray-700":"bg-gray-100"),children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(O,{src:e.avatar,alt:e.user,size:"sm",className:"mr-3",variant:"heritage"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("div",{className:"text-sm font-medium",children:e.user})}),t.jsx("div",{className:"text-xs text-gray-400",children:e.createdAt?new Date(e.createdAt).toLocaleTimeString():""})]}),t.jsx("div",{className:"text-sm "+(s?"text-gray-200":"text-gray-800"),children:e.text}),r&&t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("button",{onClick:()=>l?.(e.id),className:`${s?"bg-gray-800 text-white":"bg-white text-gray-800"} px-2 py-1 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-300"} transition-colors`,children:e.pinned?"取消置顶":"置顶"}),t.jsx("button",{onClick:()=>n?.(e.id),className:(s?"bg-red-700 text-white":"bg-red-500 text-white")+" px-2 py-1 rounded-lg text-xs transition-colors",children:"删除"})]})]})]})},e.id))}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{value:o,onChange:e=>c(e.target.value),onKeyPress:e=>"Enter"===e.key&&d(),placeholder:"发表你的看法...",className:"flex-1 px-3 py-2 rounded-lg focus:outline-none focus:ring-2 "+(s?"bg-gray-700 text-white ring-1 ring-gray-600 focus:ring-purple-500":"bg-white text-gray-900 ring-1 ring-gray-300 focus:ring-pink-300")}),t.jsx("button",{onClick:d,className:"px-3 py-2 rounded-lg bg-gradient-to-r from-red-600 to-pink-600 text-white transition-colors hover:opacity-90",children:"发送"})]})]})}},Symbol.toStringTag,{value:"Module"})),yt=Object.freeze(Object.defineProperty({__proto__:null,default:({isDark:e,scheduled:s,onScheduledChange:a,scheduledTitle:r,onScheduledTitleChange:n,scheduledContent:l,onScheduledContentChange:o,scheduledTime:c,onScheduledTimeChange:d,mode:m,onModeChange:g,selectedStyle:h,onSelectedStyleChange:p,selectedTopic:u,onSelectedTopicChange:x,STYLE_LIST:y,TOPIC_LIST:b,now:f,threads:v,onThreadsChange:j})=>{const N=e=>{if(e<=0)return"已到期";const t=Math.floor(e/6e4),s=Math.floor(t/1440),a=Math.floor(t%1440/60),i=t%60;return s>0?`${s}天${a}小时${i}分钟`:a>0?`${a}小时${i}分钟`:`${i}分钟`};return t.jsxs("div",{className:"mb-6 rounded-2xl p-4 "+(e?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"),children:[t.jsx("div",{className:"font-medium mb-3",children:t.jsx("span",{className:"flex items-center gap-2",children:"🛠️ 话题运营工具"})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:(e?"bg-gray-700 ring-1 ring-gray-700":"bg-gray-50 ring-1 ring-gray-200")+" rounded-xl p-4",children:[t.jsx("div",{className:"font-medium mb-2",children:t.jsx("span",{className:"flex items-center gap-2",children:"⏰ 创建定时发布"})}),t.jsx("input",{value:r,onChange:e=>n(e.target.value),className:(e?"bg-gray-800 text-white":"bg-white text-gray-900")+" w-full px-3 py-2 rounded-lg border mb-2 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",placeholder:"标题"}),t.jsx("textarea",{value:l,onChange:e=>o(e.target.value),className:(e?"bg-gray-800 text-white":"bg-white text-gray-900")+" w-full h-20 px-3 py-2 rounded-lg border mb-2 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",placeholder:"内容"}),t.jsx("input",{type:"datetime-local",value:c,onChange:e=>d(e.target.value),className:(e?"bg-gray-800 text-white":"bg-white text-gray-900")+" w-full px-3 py-2 rounded-lg border mb-2 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors"}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:"text-xs opacity-70",children:"目标子社区："}),t.jsxs("select",{value:m,onChange:e=>g(e.target.value),className:(e?"bg-gray-800 text-white":"bg-white text-gray-900")+" px-3 py-1 rounded-lg border text-xs",children:[t.jsx("option",{value:"style",children:"风格"}),t.jsx("option",{value:"topic",children:"题材"})]}),"style"===m?t.jsx("select",{value:h,onChange:e=>p(e.target.value),className:(e?"bg-gray-800 text-white":"bg-white text-gray-900")+" px-3 py-1 rounded-lg border text-xs",children:y.map(e=>t.jsx("option",{value:e,children:e},e))}):t.jsx("select",{value:u,onChange:e=>x(e.target.value),className:(e?"bg-gray-800 text-white":"bg-white text-gray-900")+" px-3 py-1 rounded-lg border text-xs",children:b.map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsx("button",{onClick:()=>{const e=r.trim(),t=l.trim(),g=Date.parse(c);if(!e||!t||isNaN(g))return;const p="style"===m?h:u,x=[{id:`s-${Date.now()}`,title:e,content:t,time:g,published:!1,targetMode:m,targetValue:p},...s];a(x),localStorage.setItem("jmzf_scheduled",JSON.stringify(x)),n(""),o(""),d(""),i.success("已添加到定时任务")},className:"bg-red-600 text-white px-3 py-2 rounded-lg w-full hover:bg-red-700 transition-colors shadow-sm",children:"添加到定时"})]}),t.jsxs("div",{className:(e?"bg-gray-700 ring-1 ring-gray-700":"bg-gray-50 ring-1 ring-gray-200")+" rounded-xl p-4 md:col-span-2",children:[t.jsx("div",{className:"font-medium mb-2",children:"定时任务列表"}),t.jsxs("ul",{className:"space-y-2",children:[s.map(r=>t.jsxs("li",{className:`${e?"bg-gray-800":"bg-white"} rounded-lg p-3 flex items-center justify-between ring-1 ${e?"ring-gray-700":"ring-gray-200"}`,children:[t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium text-sm flex items-center gap-2",children:[t.jsx("span",{children:r.title}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(r.published?"bg-green-600 text-white":"bg-yellow-500 text-white"),children:r.published?"已发布":"待发布"})]}),t.jsxs("div",{className:"text-xs opacity-70",children:[new Date(r.time).toLocaleString()," • 倒计时 ",N(r.time-f)," • 目标 ",r.targetValue]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>(e=>{const t=s.find(t=>t.id===e);if(!t)return;const r=[{id:`t-${Date.now()}`,title:t.title,content:t.content,createdAt:Date.now(),replies:[],topic:(t.targetMode,t.targetValue),upvotes:0},...v];j(r),localStorage.setItem("jmzf_threads",JSON.stringify(r));const n=s.map(t=>t.id===e?{...t,published:!0}:t);a(n),localStorage.setItem("jmzf_scheduled",JSON.stringify(n)),i.success("定时任务已发布")})(r.id),disabled:r.published,"aria-disabled":r.published,className:(r.published?e?"bg-gray-600 text-gray-300":"bg-gray-300 text-gray-600":"bg-red-600 text-white hover:bg-red-700")+" px-3 py-1 rounded-lg text-xs transition-colors",children:"立即发布"}),t.jsx("button",{onClick:()=>(e=>{const t=s.filter(t=>t.id!==e);a(t),localStorage.setItem("jmzf_scheduled",JSON.stringify(t)),i.success("定时任务已删除")})(r.id),className:`${e?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${e?"ring-gray-700":"ring-gray-200"}`,children:"删除"})]})]},r.id)),0===s.length&&t.jsx("li",{className:"text-sm opacity-60 rounded-lg border-2 border-dashed p-4 text-center",children:"暂无定时任务"})]})]})]})]})}},Symbol.toStringTag,{value:"Module"}));export{yt as $,Se as A,Be as B,ke as C,Pe as D,ge as E,Ee as F,Ne as G,$ as H,ne as I,Me as J,qe as K,Ce as L,Te as M,Fe as N,je as O,ae as P,Ke as Q,it as R,pe as S,O as T,Ie as U,rt as V,ct as W,dt as X,gt as Y,ut as Z,xt as _,L as a,xe as b,he as c,Z as d,Ae as e,we as f,ze as g,Le as h,ie as i,P as j,me as k,se as l,A as m,z as n,We as o,Ye as p,Ve as q,Je as r,ve as s,tt as t,st as u,De as v,at as w,be as x,fe as y,ye as z};
