const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/components-community-DK7LACku.js","chunks/vendor-react-7rlDZYVK.js","chunks/i18n-CPi6PAmy.js","chunks/vendor-other-CRhi5s5X.js","chunks/charts-recharts-D0ssCqK6.js","chunks/three-core-DHZMy_Lk.js","chunks/three-stdlib-C_4-sCbx.js","chunks/components-other-CUE0A1-z.js","chunks/components-analytics-D0Glag6r.js","chunks/components-admin-u5o8ISLL.js","chunks/db-libs-D0Hh-v_I.js","chunks/components-media-BNdY5qC-.js","chunks/components-layout-Bz7ZwRP6.js","chunks/components-core-Ca0f-3GT.js","chunks/components-auxiliary-DpPURHF4.js","chunks/components-game-D5a9jAIU.js"])))=>i.map(i=>d[i]);
import{r as e,u as t,j as i,m as a,t as s}from"./vendor-react-7rlDZYVK.js";import{G as r,a as n,T as o}from"./components-other-CUE0A1-z.js";import{u as c}from"./components-analytics-D0Glag6r.js";import{m as l}from"./components-layout-Bz7ZwRP6.js";import{A as m}from"./components-admin-u5o8ISLL.js";const d=function(){const e="undefined"!=typeof document&&document.createElement("link").relList;return e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}(),g={},u=function(e,t,i){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),s=i?.nonce||i?.getAttribute("nonce");a=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in g)return;g[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${i}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":d,t||(a.as="script"),a.crossOrigin="",a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),t?new Promise((t,i)=>{a.addEventListener("load",t),a.addEventListener("error",()=>i(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},p="jmzf_posts",x="jmzf_user_bookmarks",h="jmzf_user_likes",y=new Map,b=new Map,f=new Map,v=new Map,j=new Map;let _=new Map,N=null;function w(e,t){return function(e,t){const i=e.get(t);return!!i&&Date.now()-i.timestamp<3e5}(e,t)?e.get(t).data:null}function S(e,t,i){e.set(t,{data:i,timestamp:Date.now()})}function C(e){e.clear()}function k(e){try{return localStorage.getItem(e)}catch(t){return null}}function I(e,t){_.set(e,t),N&&clearTimeout(N),N=setTimeout(()=>{z()},100)}function z(){_.forEach((e,t)=>{!function(e,t){try{localStorage.setItem(e,t)}catch(i){}}(t,JSON.stringify(e))}),_.clear(),N=null}function $(){const e=w(y,"all");if(e)return e;const t=k(p),i=t?JSON.parse(t):[];return S(y,"all",i),i}function D(){const e=w(b,"user");if(e)return e;const t=k(x),i=t?JSON.parse(t):[];return S(b,"user",i),i}function P(){const e=w(f,"user");if(e)return e;const t=k(h),i=t?JSON.parse(t):[];return S(f,"user",i),i}function T(e,t){for(let i=0;i<e.length;i++){if(e[i].id===t)return{comment:e[i],index:i};const a=T(e[i].replies,t);if(a)return a.parent?a:{...a,parent:e[i]}}return null}const O={getPosts:$,addPost:function(e){const t={id:`p-${Date.now()}`,likes:0,comments:[],date:(new Date).toISOString().slice(0,10),isLiked:!1,isBookmarked:!1,views:0,shares:0,isFeatured:!1,isDraft:!1,completionStatus:"completed",...e},i=$();return i.unshift(t),I(p,i),S(y,"all",i),t},likePost:function(e){const t=P();t.includes(e)||(t.push(e),I(h,t),S(f,"user",t));const i=l.find(t=>t.id.toString()===e);if(i)return{id:i.id.toString(),title:i.title,thumbnail:i.thumbnail,likes:i.likes+1,comments:[],date:(new Date).toISOString().slice(0,10),isLiked:!0,isBookmarked:!1,category:"design",tags:i.tags,description:i.description||"",views:i.views,shares:0,isFeatured:i.featured,isDraft:!1,completionStatus:"published",creativeDirection:"",culturalElements:[],colorScheme:[],toolsUsed:[],downloadCount:0}},unlikePost:function(e){const t=P().filter(t=>t!==e);I(h,t),S(f,"user",t);const i=l.find(t=>t.id.toString()===e);if(i)return{id:i.id.toString(),title:i.title,thumbnail:i.thumbnail,likes:Math.max(0,i.likes-1),comments:[],date:(new Date).toISOString().slice(0,10),isLiked:!1,isBookmarked:!1,category:"design",tags:i.tags,description:i.description||"",views:i.views,shares:0,isFeatured:i.featured,isDraft:!1,completionStatus:"published",creativeDirection:"",culturalElements:[],colorScheme:[],toolsUsed:[],downloadCount:0}},bookmarkPost:function(e){const t=D();t.includes(e)||(t.push(e),I(x,t),S(b,"user",t));const i=l.find(t=>t.id.toString()===e);if(i)return{id:i.id.toString(),title:i.title,thumbnail:i.thumbnail,likes:i.likes,comments:[],date:(new Date).toISOString().slice(0,10),isLiked:!1,isBookmarked:!0,category:"design",tags:i.tags,description:i.description||"",views:i.views,shares:0,isFeatured:i.featured,isDraft:!1,completionStatus:"published",creativeDirection:"",culturalElements:[],colorScheme:[],toolsUsed:[],downloadCount:0}},unbookmarkPost:function(e){const t=D().filter(t=>t!==e);I(x,t),S(b,"user",t);const i=l.find(t=>t.id.toString()===e);if(i)return{id:i.id.toString(),title:i.title,thumbnail:i.thumbnail,likes:i.likes,comments:[],date:(new Date).toISOString().slice(0,10),isLiked:!1,isBookmarked:!1,category:"design",tags:i.tags,description:i.description||"",views:i.views,shares:0,isFeatured:i.featured,isDraft:!1,completionStatus:"published",creativeDirection:"",culturalElements:[],colorScheme:[],toolsUsed:[],downloadCount:0}},getUserBookmarks:D,getUserLikes:P,getBookmarkedPosts:function(){const e=w(v,"all");if(e)return e;const t=D(),i=l.filter(e=>t.includes(e.id.toString())).map(e=>({id:e.id.toString(),title:e.title,thumbnail:e.thumbnail,likes:e.likes,comments:[],date:(new Date).toISOString().slice(0,10),isLiked:!1,isBookmarked:!0,category:"design",tags:e.tags,description:e.description||"",views:e.views,shares:0,isFeatured:e.featured,isDraft:!1,completionStatus:"published",creativeDirection:"",culturalElements:[],colorScheme:[],toolsUsed:[],downloadCount:0}));return S(v,"all",i),i},getLikedPosts:function(){const e=w(j,"all");if(e)return e;const t=P(),i=l.filter(e=>t.includes(e.id.toString())).map(e=>({id:e.id.toString(),title:e.title,thumbnail:e.thumbnail,likes:e.likes,comments:[],date:(new Date).toISOString().slice(0,10),isLiked:!0,isBookmarked:!1,category:"design",tags:e.tags,description:e.description||"",views:e.views,shares:0,isFeatured:e.featured,isDraft:!1,completionStatus:"published",creativeDirection:"",culturalElements:[],colorScheme:[],toolsUsed:[],downloadCount:0}));return S(j,"all",i),i},addComment:function(e,t,i){const a=$(),s=a.findIndex(t=>t.id===e);if(s>=0){const e={id:`c-${Date.now()}`,content:t,date:(new Date).toISOString(),likes:0,reactions:{like:0,love:0,laugh:0,surprise:0,sad:0,angry:0},replies:[],userReactions:[]};if(i){const t=T(a[s].comments,i);t&&t.comment.replies.push(e)}else a[s].comments.push(e);return I(p,a),S(y,"all",a),a[s]}},likeComment:function(e,t){const i=$(),a=i.findIndex(t=>t.id===e);if(a>=0){const e=T(i[a].comments,t);if(e)return e.comment.likes+=1,e.comment.isLiked=!0,I(p,i),S(y,"all",i),i[a]}},unlikeComment:function(e,t){const i=$(),a=i.findIndex(t=>t.id===e);if(a>=0){const e=T(i[a].comments,t);if(e&&e.comment.likes>0)return e.comment.likes-=1,e.comment.isLiked=!1,I(p,i),S(y,"all",i),i[a]}},addCommentReaction:function(e,t,i){const a=$(),s=a.findIndex(t=>t.id===e);if(s>=0){const e=T(a[s].comments,t);if(e){const t=e.comment.userReactions.indexOf(i);return t>-1?(e.comment.userReactions.splice(t,1),e.comment.reactions[i]-=1):(e.comment.userReactions.push(i),e.comment.reactions[i]+=1),I(p,a),S(y,"all",a),a[s]}}},deleteComment:function(e,t){const i=$(),a=i.findIndex(t=>t.id===e);if(a>=0){const e=i=>{for(let a=0;a<i.length;a++){if(i[a].id===t)return i.splice(a,1),!0;if(e(i[a].replies))return!0}return!1};if(e(i[a].comments))return I(p,i),S(y,"all",i),i[a]}},clearAllCaches:function(){C(y),C(b),C(f),C(v),C(j)},flushPendingUpdates:z},M=e.lazy(()=>u(()=>import("./components-community-DK7LACku.js").then(e=>e.C),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),E=e.lazy(()=>u(()=>import("./components-community-DK7LACku.js").then(e=>e.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),A=e.lazy(()=>u(()=>import("./components-other-CUE0A1-z.js").then(e=>e._),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13,14])).then(e=>({default:e.CommunityDiscussion}))),L=e.lazy(()=>u(()=>import("./components-other-CUE0A1-z.js").then(e=>e._),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13,14])).then(e=>({default:e.DiscussionSection}))),J=e.lazy(()=>u(()=>import("./components-other-CUE0A1-z.js").then(e=>e.$),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13,14]))),R=e.lazy(()=>u(()=>import("./components-other-CUE0A1-z.js").then(e=>e.Y),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13,14]))),U=e.lazy(()=>u(()=>import("./components-game-D5a9jAIU.js").then(e=>e.j),__vite__mapDeps([15,1,2,3,4,5,6,8,9,10,11]))),B="jmzf_threads",V="jmzf_scheduled",F="jmzf_thread_draft",K="jmzf_followed_creators",Z="jmzf_joined_communities",G="jmzf_thread_favorites",H="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2ZmZiI+PC9yZWN0PjxjaXJjbGUgY3g9IjUwIiBjeT0iNTUiIHI9IjI1IiBmaWxsPSIjN2E4NTg1Ii8+PHN2ZyB3aWR0aD0iNTAlIiBoZWlnaHQ9IjUwJSIgeD0iMjUlIiB5PSIyNSI+PGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjUiIGZpbGw9IiNmN2Y3ZjciLz48L3N2Zz48L3N2Zz4=",W=[{name:"设计师小明",role:"视觉设计",avatar:H,online:!0},{name:"插画师小陈",role:"插画设计",avatar:H,online:!0},{name:"品牌设计师老王",role:"品牌策略",avatar:H,online:!1},{name:"数字艺术家小张",role:"数字艺术",avatar:H,online:!0}],Y={"设计师小明":[{id:"pro",name:"专业认证",color:"bg-blue-600"},{id:"mentor",name:"导师",color:"bg-green-600"}],"插画师小陈":[{id:"featured",name:"精选作者",color:"bg-purple-600"}],"品牌设计师老王":[{id:"brand",name:"品牌策略",color:"bg-red-600"}]},X=[{id:"c-guochao",name:"国潮设计社群",description:"讨论国潮视觉、品牌联名与配色体系",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Guochao%20design%20community%20banner",tags:["国潮","联名","品牌"],members:1286},{id:"c-heritage",name:"非遗数字化社群",description:"分享非遗数字化案例与教育传播",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Intangible%20heritage%20digital%20community%20banner",tags:["非遗","教育","海报"],members:986},{id:"c-ip",name:"IP联名与授权",description:"围绕IP设计与商业授权的合作讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=IP%20collaboration%20and%20licensing%20community%20banner",tags:["IP","联名","授权"],members:742},{id:"c-peking-opera",name:"京剧视觉社群",description:"京剧元素的现代视觉化与海报设计讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Peking%20opera%20visual%20community%20banner%2C%20bold%20graphics",tags:["京剧","戏曲","海报"],members:812},{id:"c-jingdezhen",name:"景德镇陶瓷文创社群",description:"蓝白瓷与陶瓷文创的设计分享与交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Jingdezhen%20ceramics%20community%20banner%2C%20blue%20and%20white",tags:["景德镇","陶瓷","文创"],members:654},{id:"c-laozihao",name:"老字号品牌策略社群",description:"围绕老字号品牌现代化策略与视觉系统建设",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Time-honored%20brand%20strategy%20community%20banner",tags:["老字号","品牌","策略"],members:932},{id:"c-college-club",name:"高校社团联名社群",description:"高校社团与品牌联名的企划与视觉讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=College%20club%20collaboration%20community%20banner",tags:["高校","社团","联名"],members:1014},{id:"c-color-palette",name:"东方配色研究社群",description:"传统色体系与东方配色的应用研究",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Oriental%20color%20palette%20community%20banner",tags:["传统色","配色","指南"],members:723},{id:"c-ip-ops",name:"IP运营与授权社群",description:"IP商业授权、联名运营与案例拆解",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=IP%20operations%20and%20licensing%20community%20banner",tags:["IP","授权","运营"],members:845},{id:"c-illustration",name:"插画手绘与线稿社群",description:"手绘插画、线稿风格与数字化处理交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Hand-drawn%20illustration%20community%20banner%2C%20flat%20style",tags:["插画","手绘","线稿"],members:689},{id:"c-craft-innovation",name:"工艺创新与再设计社群",description:"传统工艺现代创新与再设计实践分享",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Craft%20innovation%20community%20banner",tags:["工艺","创新","再设计"],members:571},{id:"c-heritage-edu",name:"非遗教育传播社群",description:"非遗文化的教学传播与活动策划讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Intangible%20heritage%20education%20community%20banner",tags:["非遗","教育","传播"],members:800},{id:"c-minimal-brand",name:"极简品牌视觉社群",description:"极简风格的品牌视觉系统与落地应用讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Minimalist%20brand%20visual%20community%20banner",tags:["极简","品牌","视觉"],members:705},{id:"c-retro-poster",name:"复古海报设计社群",description:"复古风格的海报设计、字体与排版研究",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Retro%20poster%20design%20community%20banner",tags:["复古","海报","字体"],members:790},{id:"c-cyberpunk",name:"赛博朋克视觉社群",description:"赛博朋克风格的霓虹视觉与未来题材创作",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Cyberpunk%20visual%20community%20banner%2C%20neon",tags:["赛博朋克","霓虹","未来"],members:668},{id:"c-lineart",name:"黑白线稿插画社群",description:"线稿风格的创作分享与数字化处理技巧",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Lineart%20black%20and%20white%20illustration%20community%20banner",tags:["线稿","黑白","插画"],members:612},{id:"c-pattern-lab",name:"传统纹样研究社群",description:"传统纹样的图案提取、延展与现代应用",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20pattern%20research%20community%20banner",tags:["纹样","图案","延展"],members:874},{id:"c-typeface",name:"字体设计与应用社群",description:"中文字体设计、版式排版与品牌应用案例",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Chinese%20typeface%20design%20community%20banner",tags:["字体","排版","视觉"],members:839},{id:"c-merch",name:"国潮周边产品社群",description:"国潮礼品、周边开发与供应链协作交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Guochao%20merch%20community%20banner",tags:["国潮","周边","礼品"],members:921},{id:"c-education-kv",name:"教育KV与信息图社群",description:"教育主题KV设计与信息图表现方法交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Education%20KV%20and%20infographic%20community%20banner",tags:["教育","KV","信息图"],members:702},{id:"c-oldbrand-campaign",name:"老字号联名企划社群",description:"老字号品牌的联名企划与商业合作讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Time-honored%20brand%20collaboration%20community%20banner",tags:["老字号","联名","企划"],members:965},{id:"c-ip-family",name:"IP亲子活动社群",description:"亲子向IP活动的视觉与互动设计分享",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=IP%20family%20event%20community%20banner",tags:["IP","亲子","活动"],members:731},{id:"c-wayfinding",name:"导视系统与空间视觉社群",description:"空间导视系统、环境图形与人群动线设计",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Wayfinding%20system%20community%20banner",tags:["导视","空间","品牌"],members:644},{id:"c-packaging",name:"文创包装设计社群",description:"文创产品包装结构、材质与视觉系统交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Cultural%20product%20packaging%20design%20community%20banner",tags:["包装","文创","纸品"],members:858},{id:"c-festival",name:"节日主题视觉社群",description:"节日活动KV与主题视觉的创意与执行",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Festival%20theme%20visual%20community%20banner",tags:["节日","KV","海报"],members:796},{id:"c-color-chinese-red",name:"中国红品牌KV社群",description:"中国红主题的品牌KV与整套物料表现",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Chinese%20red%20brand%20KV%20community%20banner",tags:["中国红","KV","品牌"],members:882},{id:"c-ip-campus",name:"校园社团IP联名社群",description:"校园社团IP与品牌的跨界联名合作交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Campus%20club%20IP%20collaboration%20community%20banner",tags:["校园","IP","联名"],members:1002},{id:"c-bluewhite",name:"青花瓷图形再设计社群",description:"青花瓷元素的现代图形再设计与视觉化",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Blue%20and%20white%20porcelain%20graphic%20redesign%20community%20banner",tags:["青花瓷","图形","再设计"],members:648},{id:"c-heritage-process",name:"非遗技艺流程社群",description:"非遗技艺流程梳理、信息图与教学素材",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Intangible%20heritage%20process%20community%20banner",tags:["非遗","技艺","流程"],members:774},{id:"c-illustration-street",name:"国潮街头插画社群",description:"街头风格的国潮插画创作与风格研究",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Guochao%20street%20illustration%20community%20banner",tags:["国潮","插画","街头"],members:867},{id:"c-graphic-system",name:"视觉系统与延展社群",description:"品牌视觉系统化设计与多场景延展规范",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Brand%20visual%20system%20community%20banner",tags:["视觉系统","延展","规范"],members:733},{id:"c-colorsystem",name:"传统色与色彩系统社群",description:"传统色彩体系、配色方法与设计落地分享",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Traditional%20colors%20and%20palette%20community%20banner",tags:["传统色","配色","系统"],members:711},{id:"c-ai-art",name:"AI艺术生成社群",description:"分享AI生成艺术的提示词、风格与实战案例",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=AI%20art%20generation%20community%20banner%2C%20modern%20style",tags:["AI","提示词","艺术"],members:978},{id:"c-photography",name:"摄影与后期社群",description:"摄影构图、色彩校正与后期调色技巧交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Photography%20and%20post%20processing%20community%20banner",tags:["摄影","后期","调色"],members:812},{id:"c-3d-modeling",name:"3D建模与渲染社群",description:"3D建模、材质贴图与渲染表现方法讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=3D%20modeling%20and%20rendering%20community%20banner",tags:["3D","建模","渲染"],members:895},{id:"c-game-art",name:"游戏美术社群",description:"游戏角色、场景与UI的美术风格与规范",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Game%20art%20community%20banner",tags:["游戏","角色","场景"],members:936},{id:"c-anime",name:"二次元插画社群",description:"动漫风插画的线稿、上色与风格化技巧",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Anime%20illustration%20community%20banner",tags:["二次元","插画","上色"],members:884},{id:"c-calligraphy",name:"书法与字形社群",description:"书法临摹、字形结构与现代化应用分享",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Calligraphy%20and%20letterform%20community%20banner",tags:["书法","字形","应用"],members:721},{id:"c-streetwear",name:"潮流服饰视觉社群",description:"潮流服饰图形、面料工艺与视觉企划交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Streetwear%20visual%20community%20banner",tags:["潮流","服饰","企划"],members:803},{id:"c-travel-culture",name:"旅行地文化视觉社群",description:"地方文化IP、旅游海报与城市品牌研究",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Travel%20culture%20visual%20community%20banner",tags:["旅游","城市","文化"],members:768},{id:"c-folk-music",name:"国风音乐视觉社群",description:"国风音乐的封面、舞台视觉与周边设计",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Chinese%20folk%20music%20visual%20community%20banner",tags:["国风","音乐","视觉"],members:746},{id:"c-motion-graphics",name:"动效与视频包装社群",description:"MG动效、片头包装与剪辑节奏方法交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Motion%20graphics%20community%20banner",tags:["动效","包装","剪辑"],members:829},{id:"c-ui-ux",name:"UI/UX设计社群",description:"产品界面、交互策略与设计系统规范讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=UI%20UX%20design%20community%20banner",tags:["界面","交互","系统"],members:914},{id:"c-data-viz",name:"数据可视化社群",description:"信息图、可视化叙事与数据图形表达方法",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Data%20visualization%20community%20banner",tags:["信息图","数据","可视化"],members:777},{id:"c-arch-visual",name:"建筑与空间视觉社群",description:"建筑摄影、空间导视与环境图形设计交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Architectural%20visual%20community%20banner",tags:["建筑","空间","导视"],members:732},{id:"c-product-design",name:"工业产品外观设计社群",description:"产品外观、结构细节与量产落地经验交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Industrial%20product%20design%20community%20banner",tags:["工业","外观","量产"],members:756},{id:"c-printmaking",name:"版画与手工印刷社群",description:"丝网印刷、油印木刻与手工印刷工艺交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Printmaking%20community%20banner",tags:["版画","手工","印刷"],members:669},{id:"c-ar-vr",name:"AR/VR互动设计社群",description:"增强现实与虚拟现实的交互体验与视觉表达",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=AR%20VR%20interaction%20design%20community%20banner",tags:["AR","VR","交互"],members:802},{id:"c-metaverse",name:"元宇宙活动视觉社群",description:"虚拟活动与沉浸式场景的视觉企划与执行",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Metaverse%20event%20visual%20community%20banner",tags:["元宇宙","活动","沉浸"],members:735},{id:"c-creative-coding",name:"创意编程与生成设计社群",description:"p5.js、Processing与生成式图形的美学探索",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Creative%20coding%20and%20generative%20design%20community%20banner",tags:["编程","生成","图形"],members:889},{id:"c-data-story",name:"数据叙事与信息架构社群",description:"数据故事、信息架构与可读性设计的实践方法",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Data%20storytelling%20and%20information%20architecture%20community%20banner",tags:["数据","叙事","信息架构"],members:718},{id:"c-product-photo",name:"产品摄影与布光社群",description:"电商产品摄影、布光与修图流程经验分享",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Product%20photography%20lighting%20community%20banner",tags:["摄影","布光","修图"],members:786},{id:"c-cosplay-design",name:"Cosplay服饰与造型社群",description:"服饰打版、材质工艺与角色造型视觉表达",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Cosplay%20costume%20design%20community%20banner",tags:["Cosplay","服饰","造型"],members:741},{id:"c-exhibition",name:"博物馆与展陈设计社群",description:"展陈策展、展板信息与空间动线的视觉设计",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Museum%20exhibition%20design%20community%20banner",tags:["展陈","策展","空间"],members:728},{id:"c-children-book",name:"儿童绘本插画社群",description:"儿童向绘本的角色塑造与叙事图像表达",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Children%20book%20illustration%20community%20banner",tags:["绘本","儿童","插画"],members:764},{id:"c-indie-brand",name:"独立品牌孵化社群",description:"小众品牌定位、风格系统与启动物料实战",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Indie%20brand%20incubation%20community%20banner",tags:["品牌","定位","物料"],members:915},{id:"c-tea-ceremony-brand",name:"茶文化与仪式品牌社群",description:"茶文化视觉、礼仪器具与仪式体验品牌设计",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Tea%20culture%20brand%20community%20banner",tags:["茶文化","品牌","仪式"],members:679},{id:"c-festival-stage",name:"节庆舞台与灯光视觉社群",description:"舞台美术、灯光设计与活动视觉系统化落地",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Festival%20stage%20lighting%20visual%20community%20banner",tags:["舞台","灯光","活动"],members:801},{id:"c-nft-collectibles",name:"数字藏品与NFT视觉社群",description:"数字藏品的视觉风格、发行策略与合规讨论",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=NFT%20digital%20collectibles%20community%20banner",tags:["数字藏品","NFT","合规"],members:688},{id:"c-retro-pixel",name:"像素复古艺术社群",description:"像素风图形创作与复古游戏视觉研究交流",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Retro%20pixel%20art%20community%20banner",tags:["像素","复古","游戏"],members:744},{id:"c-sci-fi-concept",name:"科幻概念设计社群",description:"硬核科幻风格的概念场景与载具设定分享",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Sci-fi%20concept%20design%20community%20banner",tags:["科幻","概念","设定"],members:873},{id:"c-storyboard-comic",name:"漫画分镜与叙事社群",description:"镜头语言、节奏把控与叙事分镜的实战技巧",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Storyboard%20comic%20community%20banner",tags:["分镜","叙事","漫画"],members:792},{id:"c-motion-capture",name:"动作捕捉与角色表现社群",description:"动作捕捉流程、绑定与角色表现的技术美术",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Motion%20capture%20and%20character%20performance%20community%20banner",tags:["动捕","绑定","角色"],members:709},{id:"c-wearable-design",name:"可穿戴与交互设备设计社群",description:"智能穿戴产品的交互体验与外观风格探索",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Wearable%20device%20design%20community%20banner",tags:["穿戴","交互","产品"],members:737},{id:"c-sustainable-packaging",name:"可持续包装与环保材质社群",description:"低碳包装结构、环保材质与循环设计方法",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Sustainable%20packaging%20community%20banner",tags:["可持续","环保","包装"],members:755},{id:"c-hackathon",name:"创意黑客松与协作社群",description:"跨学科协作、快速原型与创意竞赛活动分享",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Hackathon%20creative%20collaboration%20community%20banner",tags:["协作","原型","竞赛"],members:803},{id:"c-hand-lettering",name:"手写字与品牌字系社群",description:"手写字风格化、变体设计与品牌字系包装",cover:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1920x1080&prompt=Hand%20lettering%20brand%20typeface%20community%20banner",tags:["手写字","字系","品牌"],members:786}];function q({isDark:t,messages:s,onSend:r,canSend:n=!0,onDelete:o,onTogglePin:c,showModeration:l=!1}){const[m,d]=e.useState("");return i.jsxs("div",{children:[i.jsx("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto pr-1",children:[...s].sort((e,t)=>Number(t.pinned)-Number(e.pinned)||(t.createdAt??0)-(e.createdAt??0)).map((e,s)=>i.jsx(a.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},className:`${t?"bg-gray-700":"bg-white"} p-4 rounded-lg ring-1 ${t?"ring-gray-600":"ring-gray-200"}`,children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("img",{src:e.avatar,alt:e.user,className:"w-10 h-10 rounded-full mr-3 object-cover",loading:"lazy",decoding:"async"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("div",{className:"text-sm font-medium",children:e.user})}),i.jsx("div",{className:"text-xs "+(t?"text-gray-400":"text-gray-600"),children:(()=>{const t=Math.max(0,Date.now()-(e.createdAt||Date.now())),i=Math.floor(t/6e4);if(i<1)return"刚刚";if(i<60)return`${i} 分钟前`;const a=Math.floor(i/60);return a<24?`${a} 小时前`:`${Math.floor(a/24)} 天前`})()})]}),i.jsx("div",{className:"text-sm "+(t?"text-gray-200":"text-gray-800"),children:e.text}),l&&i.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[i.jsx("button",{onClick:()=>c&&e.id&&c(e.id),className:`${t?"bg-gray-800 text-white":"bg-white text-gray-900"} px-2 py-1 rounded-lg text-xs ring-1 ${t?"ring-gray-700":"ring-gray-200"}`,children:e.pinned?"取消置顶":"置顶"}),i.jsx("button",{onClick:()=>o&&e.id&&o(e.id),className:(t?"bg-red-700 text-white":"bg-red-100 text-red-700")+" px-2 py-1 rounded-lg text-xs",children:"删除"})]})]})]})},e.id||s))}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{value:m,onChange:e=>d(e.target.value),placeholder:"发表你的看法...",onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey){e.preventDefault();const t=m.trim();if(!t||!n)return;r(t),d("")}},disabled:!n,className:`flex-1 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 ${t?"bg-gray-700 text-white ring-1 ring-gray-600 focus:ring-purple-500":"bg-white text-gray-900 ring-1 ring-gray-300 focus:ring-pink-300"} ${n?"":"opacity-60 cursor-not-allowed"}`}),i.jsx("button",{onClick:()=>{const e=m.trim();e&&n&&(r(e),d(""))},disabled:!n,className:"px-4 py-3 rounded-lg bg-red-600 text-white transition-colors hover:bg-red-700",children:"发送"})]})]})}const Q=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{isDark:l}=c(),[d,g]=e.useState([]),[u,p]=e.useState("style"),x=["国潮","极简","复古","赛博朋克","手绘插画","黑白线稿","蓝白瓷"],h=["老字号","非遗","京剧","景德镇","校园社团"],[y,b]=e.useState("国潮"),[f,v]=e.useState("老字号"),[j,_]=e.useState([]),[N,w]=e.useState(""),[S,C]=e.useState(""),[k,I]=e.useState(null),[z,$]=e.useState(""),[D,P]=e.useState(""),[T,H]=e.useState("new"),[Q,ee]=e.useState(!1),[te,ie]=e.useState([]),[ae,se]=e.useState({}),[re,ne]=e.useState(""),[oe,ce]=e.useState(!0),[le,me]=e.useState(""),[de,ge]=e.useState(""),[ue,pe]=e.useState(""),[xe,he]=e.useState([]),[ye,be]=e.useState(Date.now()),[fe,ve]=e.useState({}),[je,_e]=e.useState([]),[Ne,we]=e.useState(!1),[Se,Ce]=e.useState(null),[ke,Ie]=e.useState([{id:"m-1",user:"设计师小明",text:"欢迎加入国潮社群，分享你的配色方案！",avatar:W[0].avatar,createdAt:Date.now()-6e4},{id:"m-2",user:"插画师小陈",text:"杨柳青年画数字化插画风格讨论，欢迎交流～",avatar:W[1].avatar,createdAt:Date.now()-12e4}]),[ze,$e]=e.useState({}),De="jmzf_community_messages",[Pe,Te]=e.useState("recommended"),[Oe,Me]=e.useState([]),[Ee,Ae]=e.useState([]);e.useState(""),e.useState(""),e.useState("");const Le="jmzf_pinned_joined",Je="jmzf_muted_communities",[Re,Ue]=e.useState([]),[Be,Ve]=e.useState([]),[Fe,Ke]=e.useState(!1),[Ze,Ge]=e.useState(""),[He,We]=e.useState(!0),[Ye,Xe]=e.useState(!1),[qe,Qe]=e.useState(null),[et]=e.useState("");e.useState(null);const tt="jmzf_community_members",it="jmzf_community_announce",at="jmzf_community_privacy",st="jmzf_community_admins",[rt,nt]=e.useState(null),[ot,ct]=e.useState({}),[lt,mt]=e.useState({}),[dt,gt]=e.useState({}),[ut,pt]=e.useState({}),[xt,ht]=e.useState(""),[yt,bt]=e.useState(null),{user:ft}=e.useContext(m),vt=ft?.email||"",jt=t(),_t=e.useMemo(()=>new URLSearchParams(jt.search),[jt.search]),Nt=_t.get("context")||"creator";e.useEffect(()=>{const e=_t.get("tab");Te("creator"===Nt?"recommended":"joined"===e?"joined":"user")},[Nt,_t]),e.useEffect(()=>{const e=_t.get("join");e&&(Ae(t=>t.includes(e)?t:[...t,e]),Qe(e))},[_t]);const[wt,St]=e.useState(""),[Ct,kt]=e.useState("members"),[It,zt]=e.useState(!1),[$t,Dt]=e.useState(null);e.useEffect(()=>{const e=O.getPosts();g(e),setTimeout(()=>{try{const e=localStorage.getItem(B);_(e?JSON.parse(e):[])}catch{_([])}try{const e=localStorage.getItem(it);if(e){const t=JSON.parse(e);ne("string"==typeof t?t:"")}else ne("")}catch{ne("")}try{const e=localStorage.getItem(V);he(e?JSON.parse(e):[])}catch{}try{const e=localStorage.getItem("jmzf_upvote_guard");ve(e?JSON.parse(e):{})}catch{}try{const e=localStorage.getItem(K);_e(e?JSON.parse(e):[])}catch{}try{const e=localStorage.getItem(Z);Ae(e?JSON.parse(e):[])}catch{}try{const e=localStorage.getItem(F);I(e?JSON.parse(e):null)}catch{}try{const e=localStorage.getItem(G);ie(e?JSON.parse(e):[])}catch{}try{const e=localStorage.getItem(De),t=e?JSON.parse(e):{};X.forEach(e=>{t[e.id]||(t[e.id]=[{id:`sys-${e.id}`,user:"系统提示",text:`欢迎加入「${e.name}」`,avatar:W[0].avatar,createdAt:Date.now()}])}),$e(t),localStorage.setItem(De,JSON.stringify(t))}catch{}try{const e=localStorage.getItem(Le);Ue(e?JSON.parse(e):[])}catch{}try{const e=localStorage.getItem(Je);Ve(e?JSON.parse(e):[])}catch{}try{const e=localStorage.getItem(tt);ct(e?JSON.parse(e):{})}catch{}try{const e=localStorage.getItem(it);mt(e?JSON.parse(e):{})}catch{}try{const e=localStorage.getItem(at);gt(e?JSON.parse(e):{})}catch{}try{const e=localStorage.getItem(st);pt(e?JSON.parse(e):{})}catch{}},0)},[]),e.useEffect(()=>{const e=setTimeout(()=>{try{localStorage.setItem(Le,JSON.stringify(Re)),localStorage.setItem(Je,JSON.stringify(Be)),localStorage.setItem(tt,JSON.stringify(ot)),localStorage.setItem(it,JSON.stringify(lt)),localStorage.setItem(at,JSON.stringify(dt)),localStorage.setItem(st,JSON.stringify(ut)),localStorage.setItem(K,JSON.stringify(je)),localStorage.setItem(Z,JSON.stringify(Ee))}catch(e){}},500);return()=>clearTimeout(e)},[Re,Be,ot,lt,dt,ut,je,Ee]),e.useEffect(()=>{if(!Ee.length)return void Qe(null);if(qe&&Ee.includes(qe))return;const e=Re.find(e=>Ee.includes(e));Qe(e||Ee[0]||null)},[Ee,Re]),e.useEffect(()=>{const e={title:N.trim(),content:S.trim(),mode:u,selected:"style"===u?y:f};try{localStorage.setItem(F,JSON.stringify(e))}catch{}},[N,S,u,y,f]),e.useEffect(()=>{try{localStorage.setItem(G,JSON.stringify(te))}catch{}},[te]);const Pt=e=>{Ue(t=>t.includes(e)?t.filter(t=>t!==e):[e,...t])},Tt=e=>{Ve(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},Ot=(e,t)=>(ut[e]||[]).includes(t);e.useEffect(()=>{const e=setTimeout(()=>{P(z.trim())},300);return()=>clearTimeout(e)},[z]),e.useEffect(()=>{const e=setInterval(()=>{he(e=>{const t=Date.now();let i=!1;const a=e.map(e=>{if(e.time<=t&&!e.published){i=!0;const t=[{id:`t-${Date.now()}`,title:e.title,content:e.content,createdAt:Date.now(),replies:[],topic:(e.targetMode,e.targetValue),upvotes:0},...j];return _(t),localStorage.setItem(B,JSON.stringify(t)),{...e,published:!0}}return e});return i&&localStorage.setItem(V,JSON.stringify(a)),a})},3e4);return()=>clearInterval(e)},[]),e.useEffect(()=>{const e=setInterval(()=>be(Date.now()),6e4);return()=>clearInterval(e)},[]);const Mt=e.useMemo(()=>d.length?d.filter(e=>{return"style"===u?(e=>{const t=e.toLowerCase();return/[国潮]/.test(e)?"国潮":t.includes("cyberpunk")||/赛博/.test(e)?"赛博朋克":/复古|vintage/i.test(e)?"复古":/手绘|插画/.test(e)?"手绘插画":/线稿|黑白/.test(e)?"黑白线稿":/景德镇|青花瓷|蓝白/.test(e)?"蓝白瓷":/极简|minimal/i.test(e)?"极简":"国潮"})(e.title)===y:(t=e.title,(/同仁堂|老字号/.test(t)?"老字号":/非遗|技艺/.test(t)?"非遗":/京剧|戏/.test(t)?"京剧":/景德镇|瓷/.test(t)?"景德镇":/高校|社团|校园/.test(t)?"校园社团":"老字号")===f);var t}):[],[d,u,y,f]),Et=e.useMemo(()=>{if(!d.length)return[];const e=["国潮","非遗","京剧","景德镇","老字号","校园"],t={};for(const i of d){const a=i.title.toLowerCase();for(const s of e)a.includes(s)&&(t[s]=(t[s]||0)+(i.likes||0)+(i.comments?.length||0))}return Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,6)},[d]),At=()=>{localStorage.setItem(it,JSON.stringify(re||"")),ce(!0),s.success("公告已保存")},Lt=e=>{_e(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},Jt=e=>{Ae(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},Rt=e=>{Dt(e),zt(!0)},Ut=e.useMemo(()=>{const e=wt.trim().toLowerCase();let t=X.filter(t=>{const i=`${t.name} ${t.description} ${t.tags.join(" ")}`.toLowerCase();return!e||i.includes(e)});return t="members"===Ct?t.slice().sort((e,t)=>t.members-e.members):t.slice().sort((e,t)=>e.name.localeCompare(t.name,"zh-Hans")),t},[wt,Ct]),Bt=e.useMemo(()=>[...X,...Oe].filter(e=>Ee.includes(e.id)),[Ee,Oe]);e.useMemo(()=>{const e=et.trim().toLowerCase(),t=Bt.filter(t=>!e||`${t.name} ${t.description} ${t.tags.join(" ")}`.toLowerCase().includes(e));return[...t.filter(e=>Re.includes(e.id)),...t.filter(e=>!Re.includes(e.id))]},[Bt,et,Re]);const Vt=e.useMemo(()=>{const e=Ze.trim().toLowerCase();let t=Bt.filter(t=>!e||`${t.name} ${t.description} ${t.tags.join(" ")}`.toLowerCase().includes(e));return Ye&&(t=t.filter(e=>!Be.includes(e.id))),He?[...t.filter(e=>Re.includes(e.id)),...t.filter(e=>!Re.includes(e.id))]:t},[Bt,Ze,Re,He,Ye,Be]);return i.jsxs("main",{className:"container mx-auto px-4 py-10",children:[i.jsx(r,{title:"cocreation"===Nt?"共创社群":"创作者社区",subtitle:"cocreation"===Nt?"管理我创建的社群，查看我加入的社群，一起共创。":"发现国潮与非遗的高质内容，结识优秀创作者，参与共创。",badgeText:"Beta",theme:"cocreation"===Nt?"indigo":"blue",variant:"split",size:"md",pattern:"cocreation"===Nt,stats:[{label:"在看",value:"热度"},{label:"精选",value:"优选"},{label:"创作者",value:"社区"},{label:"话题",value:"标签"}]}),"cocreation"===Nt&&"joined"===Pe&&i.jsxs("div",{className:`sticky top-16 z-40 mb-4 ${l?"bg-gray-800/95":"bg-white/95"} backdrop-blur-md rounded-2xl p-3 ring-1 ${l?"ring-gray-700":"ring-gray-200"} shadow-sm`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-sm font-medium",children:"我加入的社群"}),i.jsxs("div",{className:"text-xs "+(l?"text-gray-400":"text-gray-600"),children:[Bt.length," 个"]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsx("div",{className:"flex items-center gap-2 min-w-full",children:0===Bt.length?i.jsx("div",{className:"text-sm opacity-60 px-2 py-1",children:"暂无已加入社群"}):Bt.map(e=>i.jsxs("button",{onClick:()=>Qe(e.id),className:"flex items-center gap-2 px-3 py-1 rounded-full text-xs whitespace-nowrap ring-1 transition-colors "+(qe===e.id?"bg-indigo-600 text-white ring-indigo-600":l?"bg-gray-700 text-gray-200 ring-gray-700 hover:bg-gray-600":"bg-gray-100 text-gray-700 ring-gray-200 hover:bg-gray-200"),children:[i.jsx("span",{className:"font-medium",children:e.name}),Re.includes(e.id)&&i.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full ${l?"bg-gray-700 text-gray-300":"bg-indigo-100 text-indigo-700"} ring-1 ${l?"ring-gray-700":"ring-indigo-200"}`,children:"置顶"}),Be.includes(e.id)&&i.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full ${l?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"} ring-1 ${l?"ring-gray-700":"ring-gray-200"}`,children:"静音"})]},`strip-${e.id}`))})})]}),"cocreation"===Nt&&"joined"===Pe&&i.jsx(M,{isDark:l,joinedCommunities:Ee,recommendedCommunities:X,userCommunities:Oe,activeChatCommunityId:qe,onActiveChatCommunityChange:Qe,pinnedJoined:Re,onTogglePinJoined:Pt,mutedCommunities:Be,onToggleMuteCommunity:Tt,communityMessages:ze,onCommunityMessagesChange:$e,mockCreators:W}),i.jsxs(a.section,{className:"mb-6 rounded-2xl shadow-md p-4 "+("cocreation"===Nt?l?"bg-gray-800":"bg-gradient-to-br from-rose-50 to-pink-50":l?"bg-gray-800":"bg-white"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"font-medium",children:"社群"}),"creator"===Nt?i.jsx("div",{className:"flex gap-2",children:i.jsx("button",{onClick:()=>Te("recommended"),className:"text-xs px-3 py-1 rounded-full ring-1 "+("recommended"===Pe?"bg-purple-600 text-white ring-purple-600":l?"bg-gray-800 text-gray-300 ring-gray-700":"bg-white text-gray-700 ring-gray-200"),children:"推荐社群"})}):i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>Te("user"),className:"text-xs px-3 py-1 rounded-full ring-1 "+("user"===Pe?"bg-purple-600 text-white ring-purple-600":l?"bg-gray-800 text-gray-300 ring-gray-700":"bg-white text-gray-700 ring-gray-200"),children:"我创建的社群"}),i.jsx("button",{onClick:()=>Te("joined"),className:"text-xs px-3 py-1 rounded-full ring-1 "+("joined"===Pe?"bg-purple-600 text-white ring-purple-600":l?"bg-gray-800 text-gray-300 ring-gray-700":"bg-white text-gray-700 ring-gray-200"),children:"进入的社群"})]})]}),"recommended"===Pe&&"creator"===Nt&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[i.jsx("input",{value:wt,onChange:e=>St(e.target.value),placeholder:"搜索社群关键词...",className:`${l?"bg-gray-800 text-white ring-1 ring-gray-700":"bg-white text-gray-900 ring-1 ring-gray-300"} px-3 py-2 rounded-lg flex-1 focus:outline-none focus:ring-2 ${l?"focus:ring-purple-500":"focus:ring-pink-300"}`}),i.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[i.jsx("button",{onClick:()=>kt("members"),className:"text-xs px-3 py-2 rounded-lg ring-1 "+("members"===Ct?"bg-purple-600 text-white ring-purple-600":l?"bg-gray-800 text-gray-300 ring-gray-700":"bg-white text-gray-700 ring-gray-200"),children:"按人数"}),i.jsx("button",{onClick:()=>kt("alphabet"),className:"text-xs px-3 py-2 rounded-lg ring-1 "+("alphabet"===Ct?"bg-purple-600 text-white ring-purple-600":l?"bg-gray-800 text-gray-300 ring-gray-700":"bg-white text-gray-700 ring-gray-200"),children:"按名称"})]})]}),i.jsx("div",{className:"rounded-xl overflow-hidden shadow-md",children:i.jsx(R,{items:Ut,renderItem:(e,t)=>{const a=e;return i.jsxs("div",{className:`${l?"bg-gray-800":"bg-white"} ring-1 ${l?"ring-gray-700":"ring-gray-200"} rounded-xl overflow-hidden shadow-sm transition-all duration-300 hover:-translate-y-2 hover:shadow-lg cursor-pointer`,onClick:()=>Rt(a),children:[i.jsxs("div",{className:"relative",children:[i.jsx(n,{src:a.cover,alt:a.name,className:"w-full object-cover transition-transform duration-500 hover:scale-105",ratio:"landscape"}),i.jsx("div",{className:"absolute top-3 right-3",children:i.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${l?"bg-black/40 text-gray-200":"bg-white/70 text-gray-700"} ring-1 ${l?"ring-gray-700":"ring-gray-200"}`,children:"官方"})})]}),i.jsxs("div",{className:"p-4",children:[i.jsx("div",{className:"font-medium mb-1 line-clamp-1",children:a.name}),i.jsx("div",{className:`text-sm mb-2 ${l?"text-gray-300":"text-gray-700"} line-clamp-2`,children:a.description}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:a.tags.map((e,t)=>i.jsxs("button",{onClick:t=>{t.stopPropagation(),b(e)},className:`text-xs px-2 py-1 rounded-full ${l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"} transition-colors hover:opacity-80`,children:["#",e]},t))}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs "+(l?"text-gray-400":"text-gray-600"),children:[a.members+(Ee.includes(a.id)?1:0)," 人加入"]}),i.jsx("button",{onClick:e=>{e.stopPropagation(),Jt(a.id)},className:"text-xs px-3 py-1 rounded-full transition-all "+(Ee.includes(a.id)?"bg-blue-600 text-white hover:bg-blue-700":l?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:Ee.includes(a.id)?"已加入":"加入"})]}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{onClick:e=>{e.stopPropagation(),Rt(a)},className:(l?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-gray-100 text-gray-800 hover:bg-gray-200")+" text-xs px-3 py-1 rounded-lg transition-colors",children:"查看详情"})})]})]},a.id)},columns:3,isDark:l})})]}),"user"===Pe&&i.jsx(E,{isDark:l,userCommunities:Oe,onUserCommunitiesChange:Me,joinedCommunities:Ee,onJoinedCommunitiesChange:Ae,adminStore:ut,onAdminStoreChange:pt,memberStore:ot,onMemberStoreChange:ct,announceStore:lt,onAnnounceStoreChange:mt,privacyStore:dt,onPrivacyStoreChange:gt,currentEmail:vt,communityTab:Pe,onCommunityTabChange:Te}),"joined"===Pe&&"cocreation"===Nt&&i.jsxs("div",{children:[i.jsx("div",{className:"text-sm opacity-70 mb-2",children:"我已加入的社群"}),i.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[i.jsx("input",{value:Ze,onChange:e=>Ge(e.target.value),placeholder:"搜索我加入的社群...",className:`${l?"bg-gray-800 text-white ring-1 ring-gray-700":"bg-white text-gray-900 ring-1 ring-gray-300"} px-3 py-2 rounded-lg flex-1 focus:outline-none focus:ring-2 ${l?"focus:ring-purple-500":"focus:ring-pink-300"}`}),i.jsx("button",{onClick:()=>We(e=>!e),className:"text-xs px-2 py-0.5 rounded-full "+(He?"bg-indigo-600 text-white ring-1 ring-indigo-600":l?"bg-gray-700 text-white ring-1 ring-gray-700":"bg-gray-100 text-gray-900 ring-1 ring-gray-200"),children:He?"置顶优先":"默认排序"}),i.jsx("button",{onClick:()=>Xe(e=>!e),className:"text-xs px-2 py-0.5 rounded-full "+(l?"bg-gray-700 text-white ring-1 ring-gray-700":"bg-gray-100 text-gray-900 ring-1 ring-gray-200"),children:Ye?"隐藏静音: 开":"隐藏静音: 关"})]}),0===Bt.length?i.jsx("div",{className:"text-sm "+(l?"text-gray-400":"text-gray-600"),children:"暂无已加入社群，先在推荐社群里点击“加入”。"}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Vt.map(e=>i.jsxs("div",{className:`${l?"bg-gray-800":"bg-white/80"} ring-1 ${l?"ring-gray-700":"ring-indigo-200"} rounded-xl overflow-hidden shadow-sm transition-all duration-300 hover:-translate-y-4 hover:shadow-lg cursor-pointer`,onClick:()=>Rt(e),children:[i.jsx(n,{src:e.cover,alt:e.name,className:"w-full object-cover",ratio:"landscape"}),i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"font-medium mb-1 flex items-center gap-2",children:[e.name,i.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full ${l?"bg-gray-700 text-gray-300":"bg-indigo-100 text-indigo-700"} ring-1 ${l?"ring-gray-700":"ring-indigo-200"}`,children:"已加入"}),Re.includes(e.id)&&i.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full ${l?"bg-gray-700 text-gray-300":"bg-indigo-100 text-indigo-700"} ring-1 ${l?"ring-gray-700":"ring-indigo-200"}`,children:"置顶"}),Be.includes(e.id)&&i.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full ${l?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"} ring-1 ${l?"ring-gray-700":"ring-gray-200"}`,children:"静音"})]}),i.jsx("div",{className:"text-sm mb-2 "+(l?"text-gray-300":"text-gray-700"),children:e.description}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:e.tags.map((e,t)=>i.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+(l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:["#",e]},t))}),i.jsxs("div",{className:"text-xs opacity-70 mb-2 flex items-center gap-3 "+(l?"text-gray-300":"text-gray-700"),children:[i.jsxs("button",{onClick:t=>{t.stopPropagation(),bt(yt===e.id?null:e.id)},className:(l?"hover:text-white":"hover:text-gray-900")+" flex items-center gap-1",children:[i.jsxs("span",{children:["成员 ",e.id.startsWith("uc-")?(ot[e.id]?.length||0)+1:e.members+(Ee.includes(e.id)?1:0)]}),i.jsx("span",{className:"inline-block w-4 h-4 rounded-full "+(l?"bg-gray-700":"bg-gray-200")})]}),i.jsxs("span",{children:["公告 ",lt[e.id]&&lt[e.id].slice(0,18)||"暂无公告"]}),dt[e.id]&&i.jsx("span",{className:"px-2 py-0.5 rounded-full "+(l?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"),children:"private"===(dt[e.id]||"public")?"私密":"公开"})]}),yt===e.id&&i.jsxs("div",{className:(l?"bg-gray-800":"bg-gray-50")+" rounded-lg p-2 mb-2",children:[i.jsx("div",{className:"text-xs opacity-70 mb-1",children:"成员列表（只读）"}),(()=>{const t=e.id.startsWith("uc-")?[vt,...ot[e.id]||[]]:[vt].filter(Boolean);return t.length?i.jsx("ul",{className:"text-xs space-y-1",children:t.map((t,a)=>i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full "+(l?"bg-gray-500":"bg-gray-400")}),i.jsx("span",{children:t}),0===a&&e.id.startsWith("uc-")&&i.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full "+(l?"bg-gray-700 text-gray-300":"bg-rose-100 text-rose-700"),children:"创建者"}),ut[e.id]?.includes(t)&&i.jsx("span",{className:`ml-1 px-2 py-0.5 rounded-full ${l?"bg-gray-800 text-white":"bg-purple-100 text-purple-700"} ring-1 ${l?"ring-gray-700":"ring-purple-200"}`,children:"管理员"})]},`${e.id}-m-${a}`))}):i.jsx("div",{className:(l?"text-gray-400":"text-gray-600")+" text-xs",children:"暂无成员可显示"})})(),i.jsx("div",{className:"mt-2 flex justify-end",children:i.jsx("button",{onClick:e=>{e.stopPropagation(),bt(null)},className:(l?"bg-gray-800 text-white":"bg-gray-100 text-gray-900")+" text-xs px-2 py-1 rounded",children:"收起"})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs "+(l?"text-gray-400":"text-gray-600"),children:[e.members+(Ee.includes(e.id)?1:0)," 人加入"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:t=>{t.stopPropagation(),Pt(e.id)},className:"text-xs px-3 py-1 rounded-full "+(l?"bg-gray-700 text-white":"bg-indigo-100 text-indigo-700"),children:Re.includes(e.id)?"取消置顶":"置顶"}),i.jsx("button",{onClick:t=>{t.stopPropagation(),Tt(e.id)},className:"text-xs px-3 py-1 rounded-full "+(l?"bg-gray-700 text-white":"bg-gray-100 text-gray-700"),children:Be.includes(e.id)?"取消静音":"静音"}),i.jsx("button",{onClick:t=>{t.stopPropagation(),Jt(e.id)},className:"text-xs px-3 py-1 rounded-full "+(Ee.includes(e.id)?"bg-red-600 text-white":l?"bg-gray-700 text-white":"bg-gray-100 text-gray-700"),children:Ee.includes(e.id)?"退出":"加入"})]})]}),i.jsxs("div",{className:"mt-3 flex justify-end",children:[i.jsx("button",{onClick:t=>{t.stopPropagation(),Rt(e)},className:(l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-800")+" text-xs px-3 py-1 rounded-lg",children:"查看详情"}),i.jsx("button",{onClick:t=>{var i;t.stopPropagation(),i=e.id,nt(i)},className:"ml-2 text-xs px-3 py-1 rounded-lg "+(l?"bg-gray-700 text-white":"bg-indigo-100 text-indigo-700"),children:"成员/公告"})]})]})]},e.id))})]})]}),rt&&i.jsx("div",{className:"fixed inset-y-0 right-0 w-full max-w-md z-40",children:i.jsxs("div",{className:`${l?"bg-gray-900":"bg-white"} h-full ring-1 ${l?"ring-gray-700":"ring-gray-200"} shadow-xl p-4 flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("div",{className:"font-medium",children:"社群管理"}),i.jsx("button",{onClick:()=>{nt(null),ht("")},className:(l?"bg-gray-800 text-white":"bg-gray-100 text-gray-900")+" text-xs px-3 py-1 rounded-lg",children:"关闭"})]}),i.jsxs("div",{className:"text-xs mb-3",children:[i.jsx("span",{className:"px-2 py-0.5 rounded-full "+(l?"bg-gray-800 text-white":"bg-rose-100 text-rose-700"),children:"我创建的社群"}),i.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full "+(l?"bg-gray-800 text-white":"bg-indigo-100 text-indigo-700"),children:"private"===dt[rt]?"私密":"公开"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"font-medium mb-2",children:"成员管理"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{value:xt,onChange:e=>ht(e.target.value),placeholder:"成员邮箱",className:`${l?"bg-gray-800 text-white ring-1 ring-gray-700":"bg-white text-gray-900 ring-1 ring-gray-300"} px-3 py-2 rounded-lg flex-1 focus:outline-none focus:ring-2 ${l?"focus:ring-purple-500":"focus:ring-pink-300"}`,disabled:!Ot(rt,vt)}),i.jsx("button",{onClick:()=>{if(!Ot(rt,vt))return void s.warning("仅管理员可添加成员");const e=xt.trim().toLowerCase();e&&e.includes("@")?(ct(t=>({...t,[rt]:Array.from(new Set([...t[rt]||[],e]))})),ht(""),s.success("已添加成员")):s.warning("请输入有效邮箱")},className:"text-xs px-3 py-2 rounded-lg "+(l?"bg-purple-700 text-white":"bg-purple-600 text-white"),disabled:!Ot(rt,vt),children:"添加"})]}),i.jsx("ul",{className:"space-y-2 max-h-36 overflow-y-auto",children:0===(ot[rt]||[]).length?i.jsx("li",{className:(l?"text-gray-400":"text-gray-600")+" text-sm",children:"暂无成员"}):(ot[rt]||[]).map(e=>i.jsxs("li",{className:"flex items-center justify-between text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{children:e}),Ot(rt,e)&&i.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full ${l?"bg-gray-800 text-white":"bg-purple-100 text-purple-700"} ring-1 ${l?"ring-gray-700":"ring-purple-200"}`,children:"管理员"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>(e=>{rt&&(Ot(rt,vt)?pt(t=>{const i=t[rt]||[],a=i.includes(e)?i.filter(t=>t!==e):[...i,e];return{...t,[rt]:a}}):s.warning("仅管理员可更改角色"))})(e),className:"text-xs px-2 py-1 rounded "+(Ot(rt,e)?l?"bg-gray-800 text-white":"bg-gray-100 text-gray-900":l?"bg-purple-700 text-white":"bg-purple-600 text-white"),children:Ot(rt,e)?"取消管理员":"设为管理员"}),i.jsx("button",{onClick:()=>(e=>{Ot(rt,vt)?ct(t=>({...t,[rt]:(t[rt]||[]).filter(t=>t!==e)})):s.warning("仅管理员可移除成员")})(e),className:"text-xs px-2 py-1 rounded "+(l?"bg-red-700 text-white":"bg-red-100 text-red-700"),children:"移除"})]})]},e))})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"font-medium mb-2",children:"公告设置"}),i.jsx("textarea",{value:lt[rt]||"",onChange:e=>{return t=e.target.value,void(rt&&(Ot(rt,vt)?mt(e=>({...e,[rt]:t})):s.warning("仅管理员可设置公告")));var t},className:(l?"bg-gray-800 text-white":"bg-white text-gray-900")+" w-full h-24 px-3 py-2 rounded-lg border",placeholder:"输入公告内容",disabled:!Ot(rt,vt)})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"font-medium mb-2",children:"隐私设置"}),i.jsx("button",{onClick:()=>{if(!rt)return;if(!Ot(rt,vt))return void s.warning("仅管理员可切换隐私");const e=dt[rt]||"public";gt(t=>({...t,[rt]:"public"===e?"private":"public"}))},className:"text-xs px-3 py-2 rounded-lg "+(l?"bg-gray-800 text-white":"bg-gray-100 text-gray-900"),disabled:!Ot(rt,vt),children:"private"===dt[rt]?"改为公开":"改为私密"})]}),i.jsx("div",{className:"mt-auto text-xs opacity-70",children:"设置将自动保存到本地，不影响其他用户；非管理员仅可查看"})]})}),"cocreation"===Nt&&i.jsxs(a.section,{className:`mb-6 ${l?"bg-gray-800":"bg-white"} rounded-2xl shadow-md p-4`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"font-medium",children:"活跃创作者"}),i.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:"实时"})]}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:W.map((e,t)=>i.jsxs("div",{className:"flex items-center p-2 rounded-xl",children:[i.jsx(o,{src:e.avatar,alt:e.name,size:"md",online:e.online,onClick:()=>(Ce(e),void we(!0)),variant:t%2==0?"heritage":"gradient"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-sm font-medium",children:e.name}),i.jsx("div",{className:"text-xs "+(l?"text-gray-400":"text-gray-600"),children:e.role})]}),i.jsx("button",{onClick:()=>Lt(e.name),className:"text-xs px-3 py-1 rounded-full transition-colors "+(je.includes(e.name)?"bg-blue-600 text-white":l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:je.includes(e.name)?"已关注":"关注"})]},e.name))})]}),"cocreation"===Nt&&i.jsxs(a.section,{className:`mb-6 ${l?"bg-gray-800":"bg-white"} rounded-2xl shadow-md p-4`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[i.jsx("h3",{className:"font-medium mb-3",children:"社群讨论区"}),i.jsx(L,{isDark:l,messages:ke,onSend:e=>{const t=W.find(e=>e.online)||W[0],i={id:`m-${Date.now()}`,user:t.name,text:e,avatar:t.avatar,createdAt:Date.now(),pinned:!1};Ie(e=>[i,...e]),s.success("已发送到社群")},showModeration:!0,onDelete:e=>{e&&Ie(t=>t.filter(t=>t.id!==e))},onTogglePin:e=>{e&&Ie(t=>t.map(t=>t.id===e?{...t,pinned:!t.pinned}:t))}})]}),"cocreation"===Nt&&i.jsxs("div",{className:"mb-6 rounded-2xl p-4 "+(l?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"),children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"font-medium flex items-center gap-2",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("i",{className:"fas fa-bullhorn text-red-600"}),"社区公告"]}),i.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(oe?l?"bg-gray-700 text-white":"bg-gray-100 text-gray-900":"bg-yellow-500 text-white"),children:oe?"已保存":"未保存"})]}),i.jsx(a.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:At,"aria-label":"保存公告",className:"text-sm px-3 py-1 rounded-full bg-red-600 text-white hover:bg-red-700 transition-colors shadow-sm",children:"保存公告"})]}),i.jsx("textarea",{value:re,onChange:e=>{ne(e.target.value),ce(!1)},onKeyDown:e=>{(e.ctrlKey||e.metaKey)&&"s"===e.key.toLowerCase()&&(e.preventDefault(),At())},className:(l?"bg-gray-700 text-white":"bg-gray-50 text-gray-900")+" w-full h-20 px-3 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",placeholder:"输入公告内容","aria-label":"社区公告内容"})]}),"cocreation"===Nt&&i.jsx(A,{isDark:l,threads:j,onThreadsChange:_,mode:u,selectedStyle:y,selectedTopic:f,newTitle:N,onNewTitleChange:w,newContent:S,onNewContentChange:C,threadSearch:z,onThreadSearchChange:$,threadSort:T,onThreadSortChange:H,favOnly:Q,onFavOnlyChange:ee,favoriteThreads:te,onFavoriteThreadsChange:ie,replyText:ae,onReplyTextChange:se,threadDraft:k,onThreadDraftChange:I,hotTopics:Et,STYLE_LIST:x,TOPIC_LIST:h,onModeChange:p,onSelectedStyleChange:b,onSelectedTopicChange:v,onInsertRandomIdea:()=>{const e="style"===u?`围绕「${y}」视觉风格，分享你的配色、版式与元素融合建议；欢迎附上参考图或草图。`:`围绕「${f}」主题的传播视觉，讨论关键词选取、图文编排与落地物料。`;w("style"===u?`${y}风格联名海报设计讨论`:`${f}主题传播视觉讨论`),C(e)},upvoteGuard:fe,onUpvoteGuardChange:ve}),"cocreation"===Nt&&i.jsx(J,{isDark:l,scheduled:xe,onScheduledChange:he,scheduledTitle:le,onScheduledTitleChange:me,scheduledContent:de,onScheduledContentChange:ge,scheduledTime:ue,onScheduledTimeChange:pe,mode:u,onModeChange:p,selectedStyle:y,onSelectedStyleChange:b,selectedTopic:f,onSelectedTopicChange:v,STYLE_LIST:x,TOPIC_LIST:h,now:ye,threads:j,onThreadsChange:_}),"cocreation"===Nt&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"mb-2 font-medium",children:"相关作品（本地）"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Mt.slice(0,6).map(e=>i.jsxs(a.div,{whileHover:{y:-5},className:(l?"bg-gray-800":"bg-white")+" rounded-2xl shadow-md p-4",children:[i.jsx(n,{src:e.thumbnail||`https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=${encodeURIComponent(e.title)}&image_size=1024x1024`,alt:e.title,className:"w-full h-40 object-cover rounded-lg mb-3",ratio:"landscape"}),i.jsx("div",{className:"font-medium text-sm",children:e.title}),i.jsxs("div",{className:"text-xs opacity-70",children:["点赞 ",e.likes," • 评论 ",e.comments.length]})]},e.id)),0===Mt.length&&i.jsx("div",{className:(l?"bg-gray-800":"bg-white")+" rounded-2xl shadow-md p-4 text-sm opacity-60",children:"暂无相关作品"})]})]}),Ne&&Se&&i.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${l?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:i.jsxs(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:`rounded-2xl ${l?"bg-gray-800":"bg-white"} shadow-xl max-w-md w-full mx-4 overflow-hidden`,children:[i.jsxs("div",{className:`p-4 border-b ${l?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[i.jsx("h3",{className:"text-lg font-bold",children:"创作者详情"}),i.jsx("button",{onClick:()=>we(!1),className:`p-2 rounded-full ${l?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:i.jsx("i",{className:"fas fa-times"})})]}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(n,{src:Se.avatar,alt:Se.name,className:"w-12 h-12 rounded-full mr-3 ring-1 ring-gray-300",ratio:"square"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:Se.name}),i.jsx("div",{className:"text-sm "+(l?"text-gray-400":"text-gray-600"),children:Se.role})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"text-sm opacity-70 mb-1",children:"徽章"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[(Y[Se.name]||[]).map(e=>i.jsx("span",{className:`text-xs px-2 py-1 rounded-full text-white ${e.color}`,children:e.name},e.id)),!(Y[Se.name]||[]).length&&i.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:"暂无徽章"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:()=>Lt(Se.name),className:"px-4 py-2 rounded-lg text-sm "+(je.includes(Se.name)?"bg-blue-600 text-white":l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:je.includes(Se.name)?"已关注":"关注"})})]})]})}),It&&$t&&i.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${l?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:i.jsxs(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:`rounded-2xl ${l?"bg-gray-800":"bg-white"} shadow-xl max-w-lg w-full mx-4 overflow-hidden`,children:[i.jsxs("div",{className:`p-4 border-b ${l?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[i.jsx("h3",{className:"text-lg font-bold",children:"社群详情"}),i.jsx("button",{onClick:()=>zt(!1),className:`p-2 rounded-full ${l?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:i.jsx("i",{className:"fas fa-times"})})]}),i.jsxs("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:[i.jsx(n,{src:$t.cover,alt:$t.name,className:"w-full object-cover rounded-lg",ratio:"landscape"}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsx("div",{className:"font-medium text-lg",children:$t.name}),i.jsxs("div",{className:"flex flex-col items-end",children:[i.jsx("div",{className:"text-xs "+(l?"text-gray-400":"text-gray-600"),children:"成员数"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.members+(Ee.includes($t.id)?1:0)})]})]}),i.jsx("div",{className:`text-sm ${l?"text-gray-300":"text-gray-700"} mb-2`,children:$t.description}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:$t.tags.map((e,t)=>i.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+(l?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:["#",e]},t))}),i.jsx("button",{onClick:()=>Jt($t.id),className:`w-full py-2 rounded-full ${Ee.includes($t.id)?"bg-blue-600 text-white":"bg-gradient-to-r from-red-600 to-pink-600 text-white"} transition-colors hover:opacity-90`,children:Ee.includes($t.id)?"已加入":"加入"})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"text-sm opacity-70 mb-2",children:"近期讨论预览"}),i.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-1",children:[[...ze[$t.id]||[]].sort((e,t)=>Number(t.pinned)-Number(e.pinned)||(t.createdAt??0)-(e.createdAt??0)).slice(0,3).map((e,t)=>i.jsx("div",{className:`${l?"bg-gray-700":"bg-white"} p-4 rounded-lg ring-1 ${l?"ring-gray-600":"ring-gray-200"}`,children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("img",{src:e.avatar,alt:e.user,className:"w-10 h-10 rounded-full mr-3 object-cover",loading:"lazy",decoding:"async"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("div",{className:"text-sm font-medium",children:e.user})}),i.jsx("div",{className:"text-xs "+(l?"text-gray-400":"text-gray-600"),children:(()=>{const t=Math.max(0,Date.now()-(e.createdAt||Date.now())),i=Math.floor(t/6e4);if(i<1)return"刚刚";if(i<60)return`${i} 分钟前`;const a=Math.floor(i/60);return a<24?`${a} 小时前`:`${Math.floor(a/24)} 天前`})()})]}),i.jsx("div",{className:"text-sm "+(l?"text-gray-200":"text-gray-800"),children:e.text})]})]})},t)),0===(ze[$t.id]||[]).length&&i.jsx("div",{className:`${l?"bg-gray-700":"bg-white"} p-4 rounded-lg ring-1 ${l?"ring-gray-600":"ring-gray-200"} text-sm opacity-70`,children:"暂无交流"})]}),i.jsxs("div",{className:"mt-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"font-medium",children:"社群交流"}),!Ee.includes($t.id)&&i.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(l?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"),children:"加入后可发言"})]}),i.jsx(q,{isDark:l,messages:ze[$t.id]||[],onSend:e=>((e,t)=>{const i=t.trim();if(!i)return;if(!Ee.includes(e))return void s.warning("请先加入该社群再发言");const a=W.find(e=>e.online)||W[0],r={id:`cm-${Date.now()}`,user:a.name,text:i,avatar:a.avatar,createdAt:Date.now()};$e(t=>{const i=t[e]||[],a=[r,...i],s={...t,[e]:a};return localStorage.setItem(De,JSON.stringify(s)),s}),s.success("已发送到该社群")})($t.id,e),canSend:Ee.includes($t.id),showModeration:Ee.includes($t.id),onDelete:e=>((e,t)=>{$e(i=>{const a=(i[e]||[]).filter(e=>e.id!==t),s={...i,[e]:a};return localStorage.setItem(De,JSON.stringify(s)),s}),s.success("消息已删除")})($t.id,e),onTogglePin:e=>((e,t)=>{$e(i=>{const a=(i[e]||[]).map(e=>e.id===t?{...e,pinned:!e.pinned}:e),s={...i,[e]:a};return localStorage.setItem(De,JSON.stringify(s)),s}),s.success("置顶状态已更新")})($t.id,e)})]})]})]})]})}),i.jsx(e.Suspense,{fallback:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}),children:i.jsx(U,{isOpen:Fe,onClose:()=>Ke(!1)})})]})}},Symbol.toStringTag,{value:"Module"}));export{Q as C,u as _,O as p};
